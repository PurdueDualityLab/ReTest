{"custom_id": "kkos_oniguruma_issue_1", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"1\", \"title\": \"official website went offline?\", \"author\": \"kmaehashi\", \"labels\": [], \"description\": \"http://www.geocities.jp/kosako3/ cannot be accessed.\\n@kkos Is this intentional?\\n\", \"comments\": [{\"author\": \"elad\", \"body\": \"Yes, all of the information that was on the geocities website is now present in this github repository, including the documentation (doc/), examples (sample/), etc. It makes it easier to work with and contribute to. :)\\n\\nIs there anything missing?\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"Glad to hear that.\\nAs there were no announcement of GitHub migration, some people couldn't find this repo and started to look for a replacement: https://github.com/stedolan/jq/issues/936\\n\\nIf you can, could you please add [git tags](https://github.com/kkos/oniguruma/releases) to the release commit, so that we can easily download stable tarballs by URL like this: https://github.com/kkos/oniguruma/archive/v5.9.6.tar.gz (where `v5.9.6` is a tag for commit  87b1d7ff3eb28d44f868dbf5f242693bef472877, for example)\\n\"}, {\"author\": \"elad\", \"body\": \"Done, that link is now valid. Thanks for reporting!\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"Thanks a lot!\\n\"}, {\"author\": \"elad\", \"body\": \"Submitted upstream (to homebrew) as Homebrew/homebrew#43581.\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you very much.\\n\"}, {\"author\": \"elad\", \"body\": \"Hey @kkos, check out https://github.com/Homebrew/homebrew/pull/43581#issuecomment-137962867 - do you want to generate the autoconf/automake files or add that as a dependency? (I'm leaving that decision up to you. :)\\n\"}, {\"author\": \"kkos\", \"body\": \"Please add those files into the repository if it is impossible to include those files in a generated tarball.\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"Alternatively, instead of using auto-generated tarballs, you can attach your own (hand-generated) tarballs to a specific tag by clicking [Add release notes](https://github.com/kkos/oniguruma/tags) link, just FYI.\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\nI tried it. Is it OK?\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"The first line of README file of the attached tarball is `README  2007/05/31`, whereas the auto-generated tarball says `README  2015/08/04`.\\nPreferably manually attached tarballs be generated from the commit the tag points to. In this case, it is better to get [auto-generated tarball](https://github.com/kkos/oniguruma/archive/v5.9.6.tar.gz), decompress, run autoconf (and other processes needed for release archive), compress, then attach it to the release note.\\n\"}, {\"author\": \"kkos\", \"body\": \"Hmm... the onig-5.9.6.tar.gz is already released tarball in my old Geocities page.\\nSo I don't want to change the contents.\\n5.9.6 tag position should be moved to 87b1d ?\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"> 5.9.6 tag position should be moved to 87b1d ?\\n\\nI think that is a reasonable choice in this case.\\n\"}, {\"author\": \"elad\", \"body\": \"@kkos I agree. For future releases, I think it's a good idea to add the missing files to the repository itself like you said so that tarballs can be generated automatically.\\n\"}, {\"author\": \"kkos\", \"body\": \"I have moved v5.9.6 tag to 87b1d.\\nI will add generarted files into repository in the next release.\\n\"}, {\"author\": \"kmaehashi\", \"body\": \"Thanks!\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_2", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"2\", \"title\": \"emoji characters\", \"author\": \"1st1\", \"labels\": [], \"description\": \"It seems that oniguruma has some problems working with emoji unicode characters.  Unit tests in [MagicPython](https://github.com/MagicStack/MagicPython) are built on top of [first-mate](https://github.com/atom/first-mate) library, which uses [node-oniguruma](https://github.com/atom/node-oniguruma/tree/master/deps/onig), which in turn, uses oniguruma v0.9.6.  When we tried to investigate [this issue](https://github.com/MagicStack/MagicPython/issues/15#issuecomment-149962397), we discovered, that oniguruma consumes the \\\"üïê\\\" character (`\\\\xf0\\\\x9f\\\\x95\\\\x90` in UTF-8) with `\\\\w` or `.`, but then enters in some strange state.  It appears that there are some bugs in [Atom](https://atom.io) editor that might be related to this issue.\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't think so.\\nEmoji(\\\\xf0\\\\x9f\\\\x95\\\\x90) is not treated as word char(\\\\w) in Oniguruma.\\nBut the 4byte sequence is treated as one character and match with (.) in utf-8 encoding.\\n\"}, {\"author\": \"kkos\", \"body\": \"JavaScript use utf-16 encoding internaly.\\nEmoji character code points are surrogate pair area in utf-16.\\nJavaScript return invalid character length for surrogate pair.\\n\\n'üïê'.length\\n==> 2\\n\"}, {\"author\": \"1st1\", \"body\": \"Yeah, you're right, this wasn't an issue of Oniguruma.  Sorry for the disturbance.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_4", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"4\", \"title\": \"leak when -117 error\", \"author\": \"pigzang\", \"labels\": [\"bug\"], \"description\": \"ver5.9.2\\nregexpÔºö  20151101testA(string,[^,]_,[^,]_,[^,]*\\n\", \"comments\": [{\"author\": \"pigzang\", \"body\": \"onig_new() return -117, and with 16*44 bytes memory leaks.\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\nI have fixed it.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_5", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"5\", \"title\": \"Configure script is missing from ZIP file\", \"author\": \"kjanz1899\", \"labels\": [], \"description\": \"The `./configure` script is missing from the Githib ZIP file and is not listed in the repository. \\n\", \"comments\": [{\"author\": \"smetj\", \"body\": \"I had to:\\n\\n```\\n$ touch ChangeLog\\n$ touch NEWS\\n$ autoreconf -vfi\\n$ ./configure\\n```\\n\\nPerhaps these steps could be added to the docs\\n\"}, {\"author\": \"kkos\", \"body\": \"Thanks for your suggestion.\\nI added some files into repository.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_6", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"6\", \"title\": \"Thread-safety: initialization and tear-down should be automatic and thread-safe\", \"author\": \"nicowilliams\", \"labels\": [], \"description\": \"For initialization (`onig_init()`) use `pthread_once()` (POSIX) or `InitOnceExecuteOnce()` (WIN32).\\n\\nFor finalization (`onig_end()`) either do nothing (it's OK to leak some global state like Unicode tables) or use `.fini` section (ELF) or C++ destructors, or `DllMain()` (WIN32).  This includes lazy initialization of the cclass table (which could have its own once-initializer), and the EUC/JIS Hiragana and Katakana property lists initialization (which could have its own once-initializer).\\n\\nYou can then leave `onig_init()` and `onig_end()` as empty stubs.  For static-link archives it would help to have a `--disable-thread` option to not require `-lpthread` and to instead use a dumb once-initializer.\\n\\nFor `USE_PARSE_TREE_NODE_RECYCLE` use `pthread_key_create()` and `pthread_setspecific()` (POSIX) or thread-local storage and `DllMain()` (WIN32).  Or just delete the `USE_PARSE_TREE_NODE_RECYCLE` code?\\n\\nI think you can then drop all the `THREAD_ATOMIC_START` and `THREAD_ATOMIC_END` business and just declare that the remainder of thread safety is the application's job.\\n\\n(I don't understand `ONIG_STATE_DEC()` though.  Can you explain why it exists?  `reg->state` doesn't look like a reference count...)\\n\", \"comments\": [{\"author\": \"nicowilliams\", \"body\": \"I should explain why this is important.\\n\\nLibraries aren't used just by programs.  Sometimes (often!) libraries are used by other libraries.  Ensuring that there is only one call (or non-racing calls) to a library's initializer or finalizer is then impossible.  The situation for finalizers is worse because a library might call another's finalizer in its own, but this might happen as a result of a last `dlcose()`, and if the lower-level library was still in use by other callers in the same process... _boom_.\\n\\nFor example, [jq](https://github.com/stedolan/jq) uses Oniguruma in its `libjq`.\\n\"}, {\"author\": \"kkos\", \"body\": \"For ONIG_STATE_DEC() question.\\nThis is because it avoids that regexp recompile and regexp search rise at the same time.\\nRegexp recompile API existed in old GNU regex. I supported it for compatibility.\\nHowever, I do not support it now. (USE_RECOMPILE_API is not defined.)\\nSo, ONIG_STATE_INC() etc... is empty declarations.\\n\"}, {\"author\": \"kkos\", \"body\": \"I have removed all THREAD_ macro in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_7", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"7\", \"title\": \"Autoconf setup needs help\", \"author\": \"nicowilliams\", \"labels\": [], \"description\": \"- `configure.in` should be named `configure.ac`.\\n- The files in `m4/` should not be committed (but a `m4/.whatever` file must be included as otherwise `m4/` would be empty, and you need it present in order to have `autoreconf -fi` work).\\n- `autoreconf -fi` fails, but this patch helps:\\n  \\n  -AM_INIT_AUTOMAKE\\n  +AM_INIT_AUTOMAKE([-Wno-portability 1.14])\\n- `Makefile.am` and `sample/Makefile.am` use `INCLUDES` instead of `AM_CPPFLAGS`.\\n- There's some other automake error I haven't yet worked out.\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thanks for your indication.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_9", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"9\", \"title\": \"Can't compile with Visual Studio 2005\", \"author\": \"nmaya\", \"labels\": [], \"description\": \"[unicode.zip](https://github.com/kkos/oniguruma/files/272974/unicode.zip)\\n\", \"comments\": [{\"author\": \"elad\", \"body\": \"Spam.\\n\"}, {\"author\": \"nmaya\", \"body\": \"src/unicode.c is written in C99. Some local variable is not declared at head.\\n\\n```\\n    if (buk->fold_len == 1) {\\n      items[0].byte_len = len;\\n      items[0].code_len = 1;\\n      items[0].code[0]  = *FOLDS1_FOLD(buk->index);\\n      n++;\\n\\n      int un = FOLDS1_UNFOLDS_NUM(buk->index); // Error in ANSI-C compiler.\\n```\\n\\nattached zip file includes a patch.\\n\"}, {\"author\": \"nmaya\", \"body\": \"I learned about pull-request mechanism. #10 is new request.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_11", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"11\", \"title\": \"Positive lookahead doesn't look beyond the current line?\", \"author\": \"hediyi\", \"labels\": [\"question\"], \"description\": \"I want to make sure a character is followed by something that not necessarily on the current line. When that something is on next line, using `(?=)` doesn't work, as in\\n\\n``` ruby\\n/(\\\\/)(?=[^\\\\/]*\\\\/[ix]*)/\\n```\\n\\nIf `/ix` doesn't appear in the same line with the previous `/`, the regexp doesn't match.\\n\\nIf that's really the case, is there a way to make lookahead work across multiple lines?\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Oniguruma has variable syntax/behavior function.\\nI don't know which syntax mode you are using.\\nIf you are using default syntax(== Ruby), then [^\\\\/] can match a newline.\\nONIG_SYN_NOT_NEWLINE_IN_NEGATIVE_CC flag is disabled in default syntax.\\n\\nif /(\\\\/)(?=[^\\\\/]_\\\\/[ix]_)/ =~ \\\"/\\\\n/ix\\\"\\n  puts \\\"MATCH\\\"\\nelse\\n  puts \\\"NOT MATCH\\\"\\nend\\n\\n==> MATCH\\nruby 1.9.3p484 (2013-11-22 revision 43786) [x86_64-linux]\\n\\nYou should go to ruby community if you ask about behavior of ruby regexp.\\n\"}, {\"author\": \"hediyi\", \"body\": \"Thank you very much for the reply! üòá \\n\\nI'm trying to fix some bug of the Ruby language package of Atom, which I believe is using oniguruma as their regex engine. Actually, the bug is [the package can't recognize a multi-line regex](https://github.com/atom/language-ruby/issues/144). The problem lies somewhere in\\n\\n```\\n(?<![\\\\\\\\w)])((/))(?![?*+])\\n(?=\\n  (\\\\\\\\\\\\\\\\/|[^/])*\\n  /[eimnosux]*\\\\\\\\s*\\n)\\n```\\n\\nwhich is basically a more verbose version of the previous example. It's really tricky to differentiate the division operator `/` and regex delimiter `/` without parsing the Ruby code. üòÇ \\n\"}, {\"author\": \"hediyi\", \"body\": \"I even tried `((/))(?=[^/]*/)`, it matches a single-line regex, but still not multi-line regex, so I suspected that `[^/]` in the lookahead doesn't match a LF.\\n\\nNow that I think about it, maybe I've looked into the wrong spot.\\n\"}, {\"author\": \"kkos\", \"body\": \"I have never used Atom. I don't know about it.\\nBut if atom/language-ruby uses oniguruma as regexp engine, why the package.json dosn't include dependencies to oniguruma module.\\nIs Atom running on JavaScript on Browser?\\n\"}, {\"author\": \"hediyi\", \"body\": \"Pretty much, it's written in CoffeeScript, to be exact, and running on Node.js. The UI is basically parsed HTML and CSS, I guess you can call it a desktop editor created with Web technologies üòÑ \\n\\n> why the package.json dosn't include dependencies to oniguruma module\\n\\nIt has, in the core: https://github.com/atom/atom/blob/9ea68024acccd7dc7494f50d03496c16b193c0c4/package.json#L46\\nI think oniguruma backs up all its language packages, and also the find-and-replace feature.\\n\"}, {\"author\": \"kkos\", \"body\": \"I have installed Atom 1.8.0 in Windows.\\nI tried to run your last regexp in it.\\n(Very difficult for me to run coffee-script in Atom. I hacked character-count package.)\\nAnd it match with multi-line string.\\nm[0] = '/'.\\n\\nfile: .atom/.apm/character-count/lib/character-count.coffee\\nmodule.exports =\\n  count: ->\\n    m = \\\"/\\\\n\\\\n\\\\n/\\\".match(/((\\\\/))(?=[^\\\\/]*\\\\/)/)\\n    alert(m[0])\\n\\n  activate: (state) ->\\n    atom.commands.add 'atom-workspace', 'character-count:count', => @count()\\n\"}, {\"author\": \"hediyi\", \"body\": \"üëç  @kkos.\\n\\nI also tried `/[^/]*/` in the find-and-replace (to find slashes in ) with regex, it worked. But in the grammar file of a language package, no luck; even `/\\\\n*/` doesn't work, no idea why.\\n\\nTo minimize the possibilities why this doesn't work, I wrote a grammar file from scratch, this is the only rule in the grammar:\\n\\n![image](https://cloud.githubusercontent.com/assets/18070858/16560621/2db083b6-4227-11e6-8e82-ab1e01eabbcd.png)\\n\\nWhen the slashes are in the same line, it matches (see the scopes at cursor):\\n\\n![image](https://cloud.githubusercontent.com/assets/18070858/16560764/f1708562-4227-11e6-9db0-5c83cb1bb29e.png)\\n\\nBut if put newlines in between, it doesn't (see the scopes at cursor and the change of color):\\n\\n![image](https://cloud.githubusercontent.com/assets/18070858/16560853/68d336f4-4228-11e6-8d7a-b16529e58e82.png)\\n\\nIt looks like a pattern in the grammar file doesn't search across lines‚Äîif it can't find a match in a line, it just starts fresh in the next line.\\n\"}, {\"author\": \"hediyi\", \"body\": \"Found the answer in [TextMate's manual](http://manual.macromates.com/en/language_grammars.html) which Atom's grammars are based on:\\n\\n> Note that the regular expressions are matched against only a single line of the document at a time. That means it is not possible to use a pattern that matches multiple lines. The reason for this is technical: being able to restart the parser at an arbitrary line and having to re-parse only the minimal number of lines affected by an edit. In most situations, it is possible to use the begin/end model to overcome this limitation.\\n\\nThanks for your time, really really appreciate it üòâ \\n\"}, {\"author\": \"kkos\", \"body\": \"I thank for your investigation.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_12", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"12\", \"title\": \"Questions\", \"author\": \"hediyi\", \"labels\": [\"question\"], \"description\": \"Hi @kkos, I want to create a wiki page for this, just to make sure I get right. :)\\n- Outside character classes, characters that must be escaped to be used literally are:\\n  \\n  `^$.?*+()[\\\\|`\\n- In character classes, characters that must be escaped to be used literally are:\\n  \\n  `^-]\\\\` (please correct me if I get it wrong)\\n  \\n  `^` and `-` can get away with this by \\\"clever placement.\\\"\\n\\nWhat really confuses me is `[` and `]` in character classes (though I think they both should be escaped for clarity):\\n- In Ruby 2.3, `[` must be escaped in classes and unescaped `]` raises warnings but is allowed.\\n- But in some other implementation (Atom) that use Oniguruma, `[` can be used unescaped in classes but `]` can't. üòÇ \\n- In POSIX, `]` can be used literally by placing it at the start of a class. In Oniguruma, it can't, right?\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"1. Outside character classes, characters that must be escaped to be used literally are: ^$.?*+()[|\\n   Yes.\\n2. In character classes, characters that must be escaped to be used literally are: ^-]\\\\\\n   plus [\\n3. But in some other implementation (Atom) that use Oniguruma, [ can be used unescaped in classes but ] can't.\\n   No.\\n   I don't know what syntax Atom uses, but I suppose that is ONIG_SYNTAX_DEFAULT.\\n   [ in char-class means start of nested char-class. You must escape [ as normal character.\\n   You must escape ] in char-class unless it appears at the top of char-class.\\n\\n```\\nstatic void warn_func(const char* s)\\n{\\n  fprintf(stderr, \\\"WARN: %s\\\\n\\\", s);\\n}\\n\\nextern int main(int argc, char* argv[])\\n{\\n  onig_set_warn_func(warn_func);\\n\\n  exec(ONIG_ENCODING_UTF8, ONIG_ENCODING_UTF8, ONIG_OPTION_NONE,\\n       \\\"[]a]\\\", \\\"]\\\");\\n\\n  return 0;\\n}\\n\\n(* omit exec() code)\\n\\nresult:\\nWARN: character class has ']' without escape: /[]a]/\\nmatch at 0  (UTF-8)\\n0: (0-1)\\n```\\n\"}, {\"author\": \"hediyi\", \"body\": \"‚ú® Thanks very much for the clarification! ‚ú® \\n\\nhttps://github.com/kkos/oniguruma/wiki/Characters-That-Must-Be-Escaped-to-Be-Used-Literally Did I miss anything?\\n\\nAnd could you keep this open just in case I have further questions? :))\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\nThe content is correct.\\n\"}, {\"author\": \"hediyi\", \"body\": \"Isn't `\\\\w` equivalent to `[0-9A-Z_a-z]`? I thought it was, but I found it can match much much more than that.\\n\"}, {\"author\": \"kkos\", \"body\": \"\\\\w is equivalent to [0-9A-Z_a-z] if you are using ASCII encoding.\\n\\\\w matches many code points in Unicode(UTF-8, UTF-16, UTF-32) encoding.\\nUnicode word code points data is defined at CR_Word[] in src/unicode_property_data.c\\n\"}, {\"author\": \"hediyi\", \"body\": \"So in UTF-8 encoding, `\\\\w` can match the characters that are mapped to the code points defined in `CR_Word[]`, right?\\n\"}, {\"author\": \"kkos\", \"body\": \"Yes. And 654 is the number of code ranges.\\n\"}, {\"author\": \"hediyi\", \"body\": \"Thanks for your replies. They really helped me a lot!\\n\\nSo similarly, in UTF-8 encoding, `\\\\d` can match stuff specified in `CR_Digit[]`, right? And can I assume `[0-9_A-Za-z]` is \\\"faster\\\" than `\\\\w` in UTF-8?\\n\\nDo you mind if I help edit the doc of RE? It would just be some small refinements to make it easier to understand.\\n\"}, {\"author\": \"kkos\", \"body\": \"I do not know the difference of the speed\\b.\\nBecause single byte code range and multi byte code range are separated in compiled regexp code, it may be such not different.\\n\\nI have add you as collaborator.\\nPlease edit files in doc.\\n\"}, {\"author\": \"kkos\", \"body\": \"And please edit develop branch not master branch.\\n\"}, {\"author\": \"hediyi\", \"body\": \"üëå üòâ \\n\"}, {\"author\": \"hediyi\", \"body\": \"About `\\\\G`, does it mean \\\"where the current match attempt begins\\\", i.e., either `\\\\A` or \\\"where the last match left off\\\"?\\n\"}, {\"author\": \"kkos\", \"body\": \"onig_search() has search-range argument (start, range) and string argument (str, end).\\nSearch-range is matching start position range.\\n\\n\\\\G mean start position of search-range.\\n\\\\A mean start position of the string.\\nIn most cases, search-range and string are same value, then \\\\G == \\\\A.\\n\"}, {\"author\": \"hediyi\", \"body\": \"Tried digging around the definition of `onig_search`, I could understand only a part of it.\\n\\nI was trying to expand on/clarify some definitions in doc/RE, one of them is of `\\\\G`:\\n\\n> \\\\G      matching start position \\n\\n`\\\\G` is useful in a regexp applied to the same string more than once. To define it from the user's standpoint. The first time the regexp applied, it matches the beginning of string; later it matches where the last match ends, right? So I wanna change the definition to something like\\n\\n```\\nbeginning of the current search attempt\\n```\\n\\nDoes it look correct to you?\\n\"}, {\"author\": \"kkos\", \"body\": \"Yes. You are right.\\n\"}, {\"author\": \"hediyi\", \"body\": \"I was wondering, ~~apart from that `[:...:]` is only available in character class, what really is different between Unicode properties and the POSIX notation, why do we need them both~~? I mean, Unicode properties are so much more powerful, why do we still need the POSIX notation?\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you for improved document.\\n\\nPOSIX bracket is poor than Unicode property.\\nIt is not necessary anymore now.\\nBut it was included in GNU regex library.\\nMy first goal was to make GNU regex compatible library, and thereafter I was introduced character property function etc.. from Perl.\\n\"}, {\"author\": \"hediyi\", \"body\": \"üëå No problem, and I can get to know more about how Oniguruma processes regexps along the way. üòå  So are you planning to deprecate POSIX brackets?\\n\\nNew question: in doc/RE,\\n\\n> In the back reference by the multiplex definition name,\\n\\nWhat is a multiplex definition name?\\n\\nMind if I email you with the questions instead?\\n\"}, {\"author\": \"kkos\", \"body\": \"I will remove POSIX bracket from version 7.0 if it is removed in Perl6.\\nBut I don't know it is removed or not.\\n\\nYou can assign one name to the more than two groups.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_13", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"13\", \"title\": \"ReDoS\", \"author\": \"yohgaki\", \"labels\": [], \"description\": \"Ruby 2.3.1 on Fedora 24 has catastrophic ReDoS.\\nhttp://blog.ohgaki.net/redos-must-review-mail-address-validation\\n\\nReDoS is known for years, so I wrote the blog.  If you would like notify this kind of issue privately, please let know.\\n\\nBTW, it's also affected by ReDoS attack pattern that caused StachExchange outage.\\nhttp://blog.ohgaki.net/stackexchange-redos-attack\\n\", \"comments\": [{\"author\": \"yohgaki\", \"body\": \"It might be good idea to have backtrack/stack limit like PCRE. I briefly checked oniguruma.h and it seems it does not have such API/feature.  PHP's PCRE is not affected by the ReDoS mentioned first probably because backtrack limit. (latter one is affected)\\n\"}, {\"author\": \"kkos\", \"body\": \"I know the problem.\\nI have worked on this problem in old days.\\nIf USE_COMBINATION_EXPLOSION_CHECK flag in src/regint.h enabled, it solves several patterns.\\nHowever, it does not solve all pattern cases and it become slow.\\nTherefore, I was not able to use it.\\n\\nOniguruma has API limiting stack size. (default 0: unlimited)\\nonig_set_match_stack_limit_size()\\nBut I don't know how much size is appropriate.\\n\\n```\\nextern int main(int argc, char* argv[])\\n{\\n#define MAX_SIZE   1000000\\n\\n  int len;\\n  int i;\\n  char s[MAX_SIZE];\\n\\n  len = atoi(argv[1]);\\n  fprintf(stdout, \\\"len: %d\\\\n\\\", len);\\n  for (i = 0; i < len; i++) {\\n    s[i] = ' ';\\n  }\\n  s[len] = 'a';\\n  s[len + 1] = '\\\\0';\\n\\n  exec(ONIG_ENCODING_UTF8, ONIG_ENCODING_UTF8, ONIG_OPTION_NONE,\\n       \\\"\\\\\\\\s+$\\\", s);\\n  return 0;\\n}\\n\\n$ time ./t 50000\\nlen: 50000\\nsearch fail (UTF-8)\\n\\nreal    0m32.140s\\nuser    0m31.550s\\nsys 0m0.174s\\n```\\n\\n```\\nextern int main(int argc, char* argv[])\\n{\\n#define MAX_SIZE   1000000\\n\\n  int len;\\n  int i;\\n  char s[MAX_SIZE];\\n\\n  len = atoi(argv[1]);\\n  fprintf(stdout, \\\"len: %d\\\\n\\\", len);\\n  for (i = 0; i < len; i++) {\\n    s[i] = ' ';\\n  }\\n  s[len] = 'a';\\n  s[len + 1] = '\\\\0';\\n\\n  onig_set_match_stack_limit_size(30000);\\n\\n  exec(ONIG_ENCODING_UTF8, ONIG_ENCODING_UTF8, ONIG_OPTION_NONE,\\n       \\\"\\\\\\\\s+$\\\", s);\\n  return 0;\\n}\\n\\n$ ./t 50000\\nlen: 50000\\nERROR: match-stack limit over\\n  (UTF-8)\\n```\\n\"}, {\"author\": \"yohgaki\", \"body\": \"> Oniguruma has API limiting stack size. (default 0: unlimited)\\n> onig_set_match_stack_limit_size()\\n\\nThank you for the pointer. I'll add stack limit to PHP :)\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_14", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"14\", \"title\": \"documentation on backreference nesting level\", \"author\": \"ju1ius\", \"labels\": [], \"description\": \"Hi,\\nfirst thank you very much @kkos for this wonderful library! :heart:\\n\\nAs you may know, the PHP language uses Oniguruma (currently v5.9.6) as the regexp engine for it's [mbstring](http://php.net/manual/en/book.mbstring.php) extension.\\nThe PHP documentation on Oniguruma is unfortunately close to non-existent, so I'm currently trying to contribute a small reference chapter about it's syntax and distinctive features.\\n\\nHowever I'm having a hard time to understand the \\\"backreference with nesting level\\\" feature.\\nWhat I currently understand is that they allow referencing the result of a subexpression up or down the subexpression call stack. Is that right?\\n\\nFor example considering this simplified version of example 2 from the docs:\\n\\n```\\n(?<element>\\n    < (?<name> [a-z]+ ) >\\n    (?> [^<]+ | \\\\g<element> )*\\n    </ \\\\k<name+0> >\\n)\\n```\\n\\nIt's pretty clear to me that we ask the engine to refer to the result of the `<name>` subexpr at the current nesting level instead of referring to it's last captured value.\\n\\nBut in the [original version from the docs](https://github.com/kkos/oniguruma/blob/master/doc/RE#L272), you use `\\\\k<name+1>`.\\nSo you're asking for the result of `<name>` one level deeper than the current nesting level.\\nI don't understand why this works and why `\\\\k<name+0>` doesn't.\\n\\nWould you mind enlightening me on the subject?\\nThat would help me greatly in documenting the feature!\\n\\nThanks again!\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Because captured content of start tag is inside nested call frame <stag> and <name>.\\n\\n```\\n  exec(ONIG_ENCODING_UTF8, ONIG_ENCODING_UTF8, ONIG_OPTION_EXTEND,\\n       \\\"(?<element> \\\\\\\\g<stag> \\\\\\\\g<content>* \\\\\\\\g<etag> ){0}\\\"\\n       \\\"(?<stag> < \\\\\\\\g<name> \\\\\\\\s* > ){0}\\\"\\n       \\\"(?<name> [a-zA-Z_:]+ ){0}\\\"\\n       \\\"(?<content> [^<&]+ (\\\\\\\\g<element> | [^<&]+)* ){0}\\\"\\n       \\\"(?<etag> </ \\\\\\\\k<name+1> >){0}\\\"\\n       \\\"\\\\\\\\g<element>\\\",\\n       \\\"<foo>f</foo>\\\");\\n```\\n\\nSubexp call frame is placed on match stack.\\nThe stack is as follows at back-reference \\\\k<name+1> point\\n\\n```\\ncall <etag>\\nreturn <content>\\ncall <content>\\nreturn <stag>\\nreturn <name>\\ncaptured <name> info  <= referenced\\ncall <name>\\ncall <stag>\\n...\\n```\\n\\nYou can rewrite to \\\\k<name+0> if you don't use stag call.\\n\\n```\\n  exec(ONIG_ENCODING_UTF8, ONIG_ENCODING_UTF8, ONIG_OPTION_EXTEND,\\n       \\\"(?<element> <\\\\\\\\g<name>\\\\\\\\s*> \\\\\\\\g<content>* \\\\\\\\g<etag> ){0}\\\"\\n       \\\"(?<name> [a-zA-Z_:]+ ){0}\\\"\\n       \\\"(?<content> [^<&]+ (\\\\\\\\g<element> | [^<&]+)* ){0}\\\"\\n       \\\"(?<etag> </ \\\\\\\\k<name+0> >){0}\\\"\\n       \\\"\\\\\\\\g<element>\\\",\\n       \\\"<foo>f</foo>\\\");\\n```\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_15", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"15\", \"title\": \"Is Same Library Repository?\", \"author\": \"lucidmaj7\", \"labels\": [], \"description\": \"Hi.\\n\\nI have a question about this library.\\n\\nWhen I search Oniguruma Library on internet, I can find two repo.\\n\\nOne is https://github.com/k-takata/Onigmo/ and \\n\\nanother is https://github.com/kkos/oniguruma/ that is this repo.\\n\\nI think that latest release version is  kkos's repo.(6.0.0)\\n\\nbut, In K-takata's repo, lastest release version is 5.9.6.\\n\\nIs Same Library Repo?.\\n\\n Thank you.\\n\", \"comments\": [{\"author\": \"iwillspeak\", \"body\": \"Onigmo is a fork of Oniguruma. Onigmo contains some of the changes made to Oniguruma to support the Ruby programming language.\\n\"}, {\"author\": \"kkos\", \"body\": \"@iwillspeak, thanks for the answer.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_16", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"16\", \"title\": \"Out of bounds read in mbc_to_code()\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"For certain inputs to the regular expression parser via onig_new() an out of bounds read access will happen. This can be seen by compiling oniguruma with address sanitizer (-fsanitize=address). See code example below.\\n\\nI found this bug while fuzzing PHP with american fuzzy lop, yet it seems the bug is not in PHP itself, but in it's bundled oniguruma copy. Tested both with the git code and version 5.9.5.\\n\\n```\\n#include <oniguruma.h>\\n#include <string.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char *inp = \\\"0000\\\\xfb\\\";\\n\\n    onig_new(&reg, inp, inp + strlen(inp), ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nThe Address Sanitizer stack trace:\\n\\n```\\n==11030==ERROR: AddressSanitizer: global-buffer-overflow on address 0x00000044ad86 at pc 0x4433f3 bp 0x7fff0e435ba0 sp 0x7fff0e435b98\\nREAD of size 1 at 0x00000044ad86 thread T0\\n    #0 0x4433f2 in mbc_to_code /mnt/ram/oniguruma/src/utf8.c:105\\n    #1 0x41063c in fetch_token /mnt/ram/oniguruma/src/regparse.c:3039\\n    #2 0x41d161 in parse_exp /mnt/ram/oniguruma/src/regparse.c:4905\\n    #3 0x41ebd7 in parse_branch /mnt/ram/oniguruma/src/regparse.c:5195\\n    #4 0x41efc6 in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5232\\n    #5 0x41f375 in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5277\\n    #6 0x41f7c1 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5304\\n    #7 0x43c593 in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5263\\n    #8 0x43d54a in onig_new /mnt/ram/oniguruma/src/regcomp.c:5500\\n    #9 0x40113f in main /tmp/oniguruma-heap-oob-mbc_to_code.c:8\\n    #10 0x7f7379eea78f in __libc_start_main (/lib64/libc.so.6+0x2078f)\\n    #11 0x400f08 in _start (/tmp/a.out+0x400f08)\\n\\n0x00000044ad86 is located 0 bytes to the right of global variable '*.LC1' from 'oniguruma-heap-oob-mbc_to_code.c' (0x44ad80) of size 6\\nSUMMARY: AddressSanitizer: global-buffer-overflow /mnt/ram/oniguruma/src/utf8.c:105 mbc_to_code\\nShadow bytes around the buggy address:\\n  0x000080081560: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x000080081570: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x000080081580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x000080081590: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x0000800815a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n=>0x0000800815b0:[06]f9 f9 f9 f9 f9 f9 f9 00 00 00 00 00 00 00 00\\n  0x0000800815c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x0000800815d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x0000800815e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x0000800815f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x000080081600: 00 00 00 00 00 00 00 00 00 00 00 00 00 f9 f9 f9\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Contiguous container OOB:fc\\n  ASan internal:           fe\\n==11030==ABORTING\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the report.\\nI have fixed it in develop branch.\\n\"}, {\"author\": \"hannob\", \"body\": \"This fix also seems incomplete. Passing bytes 0xfb, 0x0a still triggers an out of bounds in the same code line:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[2] = { 0xfb, 0x0a };\\n\\n    onig_new(&reg, inp, inp + 2, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\"}, {\"author\": \"kkos\", \"body\": \"Thanks again.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_17", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"17\", \"title\": \"Out of bounds read in onig_strcpy()\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"Passing a single byte with the value 0xD8 will cause an out of bounds read access.\\nThis was found with libfuzzer and address sanitizer, tested against develop branch of oniguruma.\\n\\nExample code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[1] = { 0xd8 };\\n\\n    onig_new(&reg, inp, inp + 1, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nAddress Sanitizer stack trace:\\n\\n```\\n==15218==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffea0eeb01 at pc 0x0000004ab6d5 bp 0x7fffea0edd70 sp 0x7fffea0ed520\\nREAD of size 2 at 0x7fffea0eeb01 thread T0\\n    #0 0x4ab6d4 in __asan_memcpy (/mnt/ram/a.out+0x4ab6d4)\\n    #1 0x4f55e5 in onig_strcpy /mnt/ram/oniguruma/src/regparse.c:231:5\\n    #2 0x4f55e5 in onig_node_str_cat /mnt/ram/oniguruma/src/regparse.c:1350\\n    #3 0x506ee4 in node_new_str /mnt/ram/oniguruma/src/regparse.c:1409:7\\n    #4 0x506ee4 in parse_exp /mnt/ram/oniguruma/src/regparse.c:4912\\n    #5 0x505891 in parse_branch /mnt/ram/oniguruma/src/regparse.c:5206:7\\n    #6 0x50189a in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5243:7\\n    #7 0x4f8040 in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5288:7\\n    #8 0x4f8040 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5315\\n    #9 0x528d41 in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #10 0x551d0f in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n    #11 0x4f21dc in main /mnt/ram/oob.c:7:5\\n    #12 0x7fa84b0a978f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #13 0x419708 in _start (/mnt/ram/a.out+0x419708)\\n\\nAddress 0x7fffea0eeb01 is located in stack of thread T0 at offset 65 in frame\\n    #0 0x4f205f in main /mnt/ram/oob.c:3\\n\\n  This frame has 2 object(s):\\n    [32, 40) 'reg'\\n    [64, 65) 'inp' <== Memory access at offset 65 overflows this variable\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\n      (longjmp and C++ exceptions *are* supported)\\nSUMMARY: AddressSanitizer: stack-buffer-overflow (/mnt/ram/a.out+0x4ab6d4) in __asan_memcpy\\nShadow bytes around the buggy address:\\n  0x10007d415d10: 00 00 00 f2 f2 f2 f2 f2 f2 f2 f2 f2 00 00 f3 f3\\n  0x10007d415d20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d50: 00 00 00 00 00 00 00 00 f1 f1 f1 f1 00 f2 f2 f2\\n=>0x10007d415d60:[01]f3 f3 f3 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415d90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415da0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007d415db0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==15218==ABORTING\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the report.\\nI have fixed it in develop branch.\\n\"}, {\"author\": \"hannob\", \"body\": \"It seems this is not fully fixed, a different input (bytes 0x5c, 0xda) still cause an out of bounds. Test code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[2] = { '\\\\\\\\', 0xd8 };\\n\\n    onig_new(&reg, inp, inp + 2, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nASAN error:\\n\\n```\\n==29231==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffd81832a2 at pc 0x0000004ab6d5 bp 0x7fffd8181ae0 sp 0x7fffd8181290\\nREAD of size 2 at 0x7fffd81832a2 thread T0\\n    #0 0x4ab6d4 in __asan_memcpy (/mnt/ram/oniguruma/a.out+0x4ab6d4)\\n    #1 0x4f276c in onig_strcpy /mnt/ram/oniguruma/src/regparse.c:230:5\\n    #2 0x4f7856 in onig_node_str_cat /mnt/ram/oniguruma/src/regparse.c:1349:7\\n    #3 0x4f8531 in node_new_str /mnt/ram/oniguruma/src/regparse.c:1408:7\\n    #4 0x511fe2 in parse_exp /mnt/ram/oniguruma/src/regparse.c:4911:13\\n    #5 0x51089b in parse_branch /mnt/ram/oniguruma/src/regparse.c:5205:7\\n    #6 0x50745d in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5242:7\\n    #7 0x4faf0f in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5287:7\\n    #8 0x4fa754 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5319:7\\n    #9 0x53e97f in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #10 0x54ee52 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n    #11 0x4f21dc in main (/mnt/ram/oniguruma/a.out+0x4f21dc)\\n    #12 0x7f540f06678f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #13 0x419708 in _start (/mnt/ram/oniguruma/a.out+0x419708)\\n\\nAddress 0x7fffd81832a2 is located in stack of thread T0 at offset 66 in frame\\n    #0 0x4f205f in main (/mnt/ram/oniguruma/a.out+0x4f205f)\\n\\n  This frame has 2 object(s):\\n    [32, 40) 'reg'\\n    [64, 66) 'inp' <== Memory access at offset 66 overflows this variable\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\n      (longjmp and C++ exceptions *are* supported)\\nSUMMARY: AddressSanitizer: stack-buffer-overflow (/mnt/ram/oniguruma/a.out+0x4ab6d4) in __asan_memcpy\\nShadow bytes around the buggy address:\\n  0x10007b028600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028610: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028620: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028630: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028640: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1\\n=>0x10007b028650: 00 f2 f2 f2[02]f3 f3 f3 00 00 00 00 00 00 00 00\\n  0x10007b028660: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028670: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b028690: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10007b0286a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==29231==ABORTING\\n```\\n\"}, {\"author\": \"kkos\", \"body\": \"Thanks again.\\nI have fixed it in develop branch.\\n(commit: 873ba2d425db611dc51da2dbfa080e39c92aac32)\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_18", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"18\", \"title\": \"segfault / null pointer access in next_state_val()\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"Passing the byte sequence 0x5b, 0xff, 0x30 to onig_new() crashes with a null pointer access in next_state_val() (regparse.c). Tested with latest develop branch and libfuzzer.\\n\\nTest code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[3] = { 0x5b, 0xff, 0x30 };\\n\\n    onig_new(&reg, inp, inp + 3, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nAsan stack trace:\\n\\n```\\n==18989==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x000000534603 bp 0x7fffa020ff10 sp 0x7fffa020fc90 T0)\\n    #0 0x534602 in next_state_val /mnt/ram/oniguruma/src/regparse.c:4005:7\\n    #1 0x51f529 in parse_char_class /mnt/ram/oniguruma/src/regparse.c:4222:11\\n    #2 0x513836 in parse_exp /mnt/ram/oniguruma/src/regparse.c:5056:11\\n    #3 0x5106fb in parse_branch /mnt/ram/oniguruma/src/regparse.c:5221:7\\n    #4 0x5072bd in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5258:7\\n    #5 0x4faebf in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5303:7\\n    #6 0x4fa704 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5339:7\\n    #7 0x53e4ef in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #8 0x54e9c2 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n    #9 0x4f21b4 in main (/mnt/ram/oniguruma/a.out+0x4f21b4)\\n    #10 0x7f67975e478f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #11 0x419708 in _start (/mnt/ram/oniguruma/a.out+0x419708)\\n\\nAddressSanitizer can not provide additional info.\\nSUMMARY: AddressSanitizer: SEGV /mnt/ram/oniguruma/src/regparse.c:4005:7 in next_state_val\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the report.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_19", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"19\", \"title\": \"out of bounds heap read in add_bytes / regcomp.c\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"Passing a sequence of 19 bytes followed by 0xfd causes an out of bounds heap read. Tested against latest develop branch, found with libfuzzer+asan.\\n\\nTest code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[20] = {\\n'0','0','0','0','0','0','0','0',\\n'0','0','0','0','0','0','0','0',\\n'0','0','0',0xfd };\\n\\n    onig_new(&reg, inp, inp + 20, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nAsan error:\\n\\n```\\n==18957==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000eff8 at pc 0x0000004ab6d5 bp 0x7ffd83e081e0 sp 0x7ffd83e07990\\nREAD of size 6 at 0x60600000eff8 thread T0\\n    #0 0x4ab6d4 in __asan_memcpy (/mnt/ram/oniguruma/a.out+0x4ab6d4)\\n    #1 0x582be1 in add_bytes /mnt/ram/oniguruma/src/regcomp.c:284:3\\n    #2 0x58263c in add_compile_string /mnt/ram/oniguruma/src/regcomp.c:452:3\\n    #3 0x5757ad in compile_string_node /mnt/ram/oniguruma/src/regcomp.c:541:10\\n    #4 0x54b3ca in compile_tree /mnt/ram/oniguruma/src/regcomp.c:1628:11\\n    #5 0x53f779 in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5369:7\\n    #6 0x54e9c2 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n    #7 0x4f21b9 in main (/mnt/ram/oniguruma/a.out+0x4f21b9)\\n    #8 0x7f346c7d378f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #9 0x419708 in _start (/mnt/ram/oniguruma/a.out+0x419708)\\n\\n0x60600000eff8 is located 0 bytes to the right of 56-byte region [0x60600000efc0,0x60600000eff8)\\nallocated by thread T0 here:\\n    #0 0x4c1628 in __interceptor_malloc (/mnt/ram/oniguruma/a.out+0x4c1628)\\n    #1 0x4f6afa in node_new /mnt/ram/oniguruma/src/regparse.c:1088:18\\n    #2 0x4f82ee in node_new_str /mnt/ram/oniguruma/src/regparse.c:1416:16\\n    #3 0x511e42 in parse_exp /mnt/ram/oniguruma/src/regparse.c:4927:13\\n    #4 0x5106fb in parse_branch /mnt/ram/oniguruma/src/regparse.c:5221:7\\n    #5 0x5072bd in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5258:7\\n    #6 0x4faebf in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5303:7\\n    #7 0x4fa704 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5339:7\\n    #8 0x53e4ef in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #9 0x54e9c2 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n    #10 0x4f21b9 in main (/mnt/ram/oniguruma/a.out+0x4f21b9)\\n    #11 0x7f346c7d378f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n\\nSUMMARY: AddressSanitizer: heap-buffer-overflow (/mnt/ram/oniguruma/a.out+0x4ab6d4) in __asan_memcpy\\nShadow bytes around the buggy address:\\n  0x0c0c7fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n=>0x0c0c7fff9df0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00[fa]\\n  0x0c0c7fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==18957==ABORTING\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the report.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_20", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"20\", \"title\": \"out of bounds read in mbc_enc_len / utf8.c\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"The string \\\"\\\\g\\\" will cause an out of bounds read in mbc_enc_len. Code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char inp[2] = {'\\\\\\\\', 'g' };\\n\\n    onig_new(&reg, inp, inp + 2, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nAs usual: tested with develop tree, found with libfuzzer and asan.\\n\\nasan error:\\n\\n```\\n==10986==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffe31c2c742 at pc 0x000000561b46 bp 0x7ffe31c2bc40 sp 0x7ffe31c2bc38\\nREAD of size 1 at 0x7ffe31c2c742 thread T0\\n    #0 0x561b45 in mbc_enc_len /mnt/ram/oniguruma1/src/utf8.c:65:22\\n    #1 0x559574 in onigenc_mbc_enc_len_end /mnt/ram/oniguruma1/src/regenc.c:117:9\\n    #2 0x561c4d in mbc_to_code /mnt/ram/oniguruma1/src/utf8.c:99:9\\n    #3 0x4fbfbe in fetch_token /mnt/ram/oniguruma1/src/regparse.c:3443:9\\n    #4 0x4f6f7e in parse_regexp /mnt/ram/oniguruma1/src/regparse.c:5297:7\\n    #5 0x4f6f7e in onig_parse_make_tree /mnt/ram/oniguruma1/src/regparse.c:5351\\n    #6 0x51e543 in onig_compile /mnt/ram/oniguruma1/src/regcomp.c:5279:7\\n    #7 0x544468 in onig_new /mnt/ram/oniguruma1/src/regcomp.c:5518:7\\n    #8 0x4f233f in main /mnt/ram/oniguruma1/oob-mbc_enc_len.c:7:5\\n    #9 0x7f57bc43378f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #10 0x4198f8 in _start (/mnt/ram/oniguruma1/a.out+0x4198f8)\\n\\nAddress 0x7ffe31c2c742 is located in stack of thread T0 at offset 66 in frame\\n    #0 0x4f224f in main /mnt/ram/oniguruma1/oob-mbc_enc_len.c:3\\n\\n  This frame has 2 object(s):\\n    [32, 40) 'reg'\\n    [64, 66) 'inp' <== Memory access at offset 66 overflows this variable\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\n      (longjmp and C++ exceptions *are* supported)\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /mnt/ram/oniguruma1/src/utf8.c:65:22 in mbc_enc_len\\nShadow bytes around the buggy address:\\n  0x10004637d890: 00 00 00 00 00 00 00 00 00 00 00 f2 f2 f2 f2 f2\\n  0x10004637d8a0: f2 f2 f2 f2 00 00 f3 f3 00 00 00 00 00 00 00 00\\n  0x10004637d8b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d8c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d8d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n=>0x10004637d8e0: f1 f1 f1 f1 00 f2 f2 f2[02]f3 f3 f3 00 00 00 00\\n  0x10004637d8f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d910: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d920: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x10004637d930: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==10986==ABORTING\\n```\\n\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_21", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"21\", \"title\": \"out of bounds read in next_state_val /  regparse.c\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"Sample code:\\n\\n```\\n#include <oniguruma.h>\\nint main()\\n{\\n    regex_t *reg;\\n    unsigned char *inp = \\\"[0-0-\\\\xe2  \\\";\\n\\n    onig_new(&reg, inp, inp + 8, ONIG_OPTION_DEFAULT,\\n         ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, 0);\\n}\\n```\\n\\nasan error:\\n\\n```\\n==11115==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000f4cc at pc 0x00000051aa28 bp 0x7fff5dbf3f50 sp 0x7fff5dbf3f48\\nREAD of size 4 at 0x60600000f4cc thread T0\\n    #0 0x51aa27 in next_state_val /mnt/ram/oniguruma1/src/regparse.c:4001:7\\n    #1 0x5105bf in parse_char_class /mnt/ram/oniguruma1/src/regparse.c:4218:11\\n    #2 0x504720 in parse_exp /mnt/ram/oniguruma1/src/regparse.c:5052:11\\n    #3 0x5028cb in parse_branch /mnt/ram/oniguruma1/src/regparse.c:5217:7\\n    #4 0x4ffe2d in parse_subexp /mnt/ram/oniguruma1/src/regparse.c:5254:7\\n    #5 0x4f6f98 in parse_regexp /mnt/ram/oniguruma1/src/regparse.c:5299:7\\n    #6 0x4f6f98 in onig_parse_make_tree /mnt/ram/oniguruma1/src/regparse.c:5351\\n    #7 0x51e523 in onig_compile /mnt/ram/oniguruma1/src/regcomp.c:5279:7\\n    #8 0x544448 in onig_new /mnt/ram/oniguruma1/src/regcomp.c:5518:7\\n    #9 0x4f2317 in main /mnt/ram/oniguruma1/test.c:7:5\\n    #10 0x7f62e128c78f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #11 0x4198f8 in _start (/mnt/ram/oniguruma1/a.out+0x4198f8)\\n\\nAddressSanitizer can not describe address in more detail (wild memory access suspected).\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /mnt/ram/oniguruma1/src/regparse.c:4001:7 in next_state_val\\nShadow bytes around the buggy address:\\n  0x0c0c7fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n=>0x0c0c7fff9e90: fa fa fa fa fa fa fa fa fa[fa]fa fa fa fa fa fa\\n  0x0c0c7fff9ea0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9eb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9ec0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9ed0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9ee0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==11115==ABORTING\\n```\\n\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_22", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"22\", \"title\": \"Libfuzzer stub to use clang's fuzz testing functionality\", \"author\": \"hannob\", \"labels\": [], \"description\": \"All the memory safety bugs I reported recently were found with libfuzzer.\\nI'll attach a stub code here that can be used to test oniguruma with libfuzzer. Maybe you want to include  that in the source code. If not it can just stay here in the bugtracker.\\n\\nI've added some usage instructions as a comment. Feel free to reuse under whatever license you feel suitable.\\n[libfuzzer-onig.zip](https://github.com/kkos/oniguruma/files/436805/libfuzzer-onig.zip)\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you very much.\\nI intend to use it.\\n\"}, {\"author\": \"hannob\", \"body\": \"Just FYI, after the fix for #29 I was able to run this on the development branch for a day without any further issues showing up, so it seems quite resistant to fuzzing by now.\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you for giving me good advice.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_23", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"23\", \"title\": \"Curly braces with Oniguruma 6\", \"author\": \"fstab\", \"labels\": [\"bug\"], \"description\": \"The pattern `%{(.*?)}` yields an error _\\\"unmatched close parenthesis\\\"_. This pattern is supposed to match Grok expressions, like `%{HOSTNAME}`. It worked with Oniguruma 5.9.6.\\n\\nI am using `ONIG_OPTION_DEFAULT` and `ONIG_SYNTAX_DEFAULT`.\\n\\nIs there any way to make it work with Oniguruma 6?\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"This bug is caused from commit 8293fd46c309addc74700528ca206742fc288ade.\\nI have fixed it in develop branch.\\nI intend to release it within a few days.\\n\"}, {\"author\": \"fstab\", \"body\": \"Thanks for fixing!\\n\"}, {\"author\": \"kkos\", \"body\": \"I have released 6.1.1\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_24", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"24\", \"title\": \"ABI version bumps ?\", \"author\": \"matzeri\", \"labels\": [], \"description\": \"Question:\\nAre the last two ABI version number bumps really needed ? \\n\\nLTVERSION=\\\"2:0:0\\\" ->  cygonig-2.dll\\nLTVERSION=\\\"3:0:0\\\" ->  cygonig-3.dll\\nLTVERSION=\\\"4:0:0\\\" ->  cygonig-4.dll\\n\\nI saw from HISTORY that functions are added but I don't see removal or change of interfaces\\nfor existing function, so the changes could be compatible for old binary.  \\nExpected guideline is\\nhttps://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html\\n\\nWas the increment of age a possibility ?\\nLTVERSION=\\\"3:0:1\\\" ->  cygonig-2.dll\\nLTVERSION=\\\"4:0:2\\\" ->  cygonig-2.dll\\n\\nAs cygwin package maintainer the ABI version bumps are always additional work. \\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I'm very sorry.\\nI had updated current number because I have to add member functions into a data type OnigEncodingType in oniguruma.h for fix problems.\\n5.9.6 -> 6.0.0: is_initialized()\\n6.0.0 -> 6.1.0: is_valid_mbc_string()\\n\\nAll user applications use only constant pointer to constant data of OnigEncodingType. (ex. ONIG_ENCODING_ASCII)\\nIn this case, Isn't it needed to update current number?\\n\"}, {\"author\": \"matzeri\", \"body\": \"Thanks for the clarification. \\nI assume the binary interface was broken with this change and the ABI increment was needed.\\nI released the cygwin package \\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_26", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"26\", \"title\": \"Memory leaks after onig_new(), onig_free() when parsing regexp \\\"\\\\((\\\"\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"For some inputs onig_new() allocates memory that doesn't get free'd, even if one subsequently calls onig_free on the created regexp. This makes fuzzing oniguruma harder, because a fuzzing process with a tool like libfuzzer will constantly grow in memory usage due to the leaks.\\n\\nExample code:\\n\\n```\\n#include <stdio.h>\\n#include <oniguruma.h>\\n\\nint main()\\n{\\n    regex_t *reg;\\n    char foo[4] = \\\"\\\\((\\\";\\n    if (onig_new\\n        (&reg, (const OnigUChar *)foo, (const OnigUChar *)(foo+3), ONIG_OPTION_DEFAULT, ONIG_ENCODING_UTF8,\\n         ONIG_SYNTAX_DEFAULT, 0) == 0) {\\n        printf(\\\"success, freeing regexp\\\\n\\\");\\n        onig_free(reg);\\n    }\\n    return 0;\\n}\\n```\\n\\nIf you run this with a memory leak detector (e.g. valgrind or newer versions of address sanitizer) it'll report leaked memory.\\n\\nHere's a debugging output from asan:\\n\\n```\\n==11769==ERROR: LeakSanitizer: detected memory leaks\\n\\nDirect leak of 56 byte(s) in 1 object(s) allocated from:\\n    #0 0x4c1678 in __interceptor_malloc (/mnt/ram/a.out+0x4c1678)\\n    #1 0x4fe15a in node_new /mnt/ram/oniguruma/src/regparse.c:1072:18\\n    #2 0x4fe15a in node_new_enclose /mnt/ram/oniguruma/src/regparse.c:1278\\n    #3 0x4fe15a in node_new_enclose_memory /mnt/ram/oniguruma/src/regparse.c:1301\\n    #4 0x4fe15a in parse_enclose /mnt/ram/oniguruma/src/regparse.c:4639\\n    #5 0x4fe15a in parse_exp /mnt/ram/oniguruma/src/regparse.c:4899\\n    #6 0x4fd869 in parse_branch /mnt/ram/oniguruma/src/regparse.c:5222:7\\n    #7 0x4fb683 in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5259:7\\n    #8 0x4f5349 in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5304:7\\n    #9 0x4f5349 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5335\\n    #10 0x50f8c9 in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #11 0x52a083 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n\\nDirect leak of 56 byte(s) in 1 object(s) allocated from:\\n    #0 0x4c1678 in __interceptor_malloc (/mnt/ram/a.out+0x4c1678)\\n    #1 0x4fe15a in node_new /mnt/ram/oniguruma/src/regparse.c:1072:18\\n    #2 0x4fe15a in node_new_enclose /mnt/ram/oniguruma/src/regparse.c:1278\\n    #3 0x4fe15a in node_new_enclose_memory /mnt/ram/oniguruma/src/regparse.c:1301\\n    #4 0x4fe15a in parse_enclose /mnt/ram/oniguruma/src/regparse.c:4639\\n    #5 0x4fe15a in parse_exp /mnt/ram/oniguruma/src/regparse.c:4899\\n    #6 0x4fd869 in parse_branch /mnt/ram/oniguruma/src/regparse.c:5222:7\\n    #7 0x4fb683 in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5259:7\\n    #8 0x4fe326 in parse_enclose /mnt/ram/oniguruma/src/regparse.c:4649:7\\n    #9 0x4fe326 in parse_exp /mnt/ram/oniguruma/src/regparse.c:4899\\n    #10 0x4fd869 in parse_branch /mnt/ram/oniguruma/src/regparse.c:5222:7\\n    #11 0x4fb683 in parse_subexp /mnt/ram/oniguruma/src/regparse.c:5259:7\\n    #12 0x4f5349 in parse_regexp /mnt/ram/oniguruma/src/regparse.c:5304:7\\n    #13 0x4f5349 in onig_parse_make_tree /mnt/ram/oniguruma/src/regparse.c:5335\\n    #14 0x50f8c9 in onig_compile /mnt/ram/oniguruma/src/regcomp.c:5279:7\\n    #15 0x52a083 in onig_new /mnt/ram/oniguruma/src/regcomp.c:5518:7\\n\\nSUMMARY: AddressSanitizer: 112 byte(s) leaked in 2 allocation(s).\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_27", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"27\", \"title\": \"Use after free when parsing \\\"(|\\\"\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"The current develop branch has a use after free bug when parsing the regexp \\\"(|\\\". Here's some example code to trigger this:\\n\\n```\\n#include <oniguruma.h>\\nint main() {\\n    regex_t *reg;\\n    const OnigUChar * inp = (const OnigUChar * )\\\"(|\\\";\\n    if (onig_new\\n        (&reg, inp, inp+2, ONIG_OPTION_DEFAULT, ONIG_ENCODING_UTF8,\\n         ONIG_SYNTAX_DEFAULT, 0) == 0)\\n        onig_free(reg);\\n    return 0;\\n}\\n```\\n\\nI suspect that this got introduced when fixing issue #26.\\n\\nHere's the stack trace from address sanitizer:\\n\\n```\\n==3544==ERROR: AddressSanitizer: heap-use-after-free on address 0x60600000eea0 at pc 0x0000004f4365 bp 0x7ffd635e32f0 sp 0x7ffd635e32e8\\nREAD of size 4 at 0x60600000eea0 thread T0\\n    #0 0x4f4364 in onig_node_free /mnt/ram/x/oniguruma1/src/regparse.c:1020:11\\n    #1 0x4f4314 in onig_node_free /mnt/ram/x/oniguruma1/src/regparse.c:1030:5\\n    #2 0x508bf1 in parse_enclose /mnt/ram/x/oniguruma1/src/regparse.c:4664:5\\n    #3 0x508bf1 in parse_exp /mnt/ram/x/oniguruma1/src/regparse.c:4915\\n    #4 0x502fcf in parse_branch /mnt/ram/x/oniguruma1/src/regparse.c:5241:7\\n    #5 0x50021d in parse_subexp /mnt/ram/x/oniguruma1/src/regparse.c:5284:7\\n    #6 0x4f6f78 in parse_regexp /mnt/ram/x/oniguruma1/src/regparse.c:5331:7\\n    #7 0x4f6f78 in onig_parse_make_tree /mnt/ram/x/oniguruma1/src/regparse.c:5362\\n    #8 0x51ed42 in onig_compile /mnt/ram/x/oniguruma1/src/regcomp.c:5283:7\\n    #9 0x544ac8 in onig_new /mnt/ram/x/oniguruma1/src/regcomp.c:5522:7\\n    #10 0x4f2320 in main /mnt/ram/x/oniguruma1/onig-useafterfree-onig_node_free.c:8:6\\n    #11 0x7f2b6da246ff in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #12 0x4198f8 in _start (/mnt/ram/x/oniguruma1/a.out+0x4198f8)\\n\\n0x60600000eea0 is located 0 bytes inside of 56-byte region [0x60600000eea0,0x60600000eed8)\\nfreed by thread T0 here:\\n    #0 0x4c1510 in __interceptor_free (/mnt/ram/x/oniguruma1/a.out+0x4c1510)\\n    #1 0x4f4712 in onig_node_free /mnt/ram/x/oniguruma1/src/regparse.c:1071:3\\n    #2 0x508ab6 in parse_enclose /mnt/ram/x/oniguruma1/src/regparse.c:4662:7\\n    #3 0x508ab6 in parse_exp /mnt/ram/x/oniguruma1/src/regparse.c:4915\\n    #4 0x502fcf in parse_branch /mnt/ram/x/oniguruma1/src/regparse.c:5241:7\\n    #5 0x50021d in parse_subexp /mnt/ram/x/oniguruma1/src/regparse.c:5284:7\\n    #6 0x4f6f78 in parse_regexp /mnt/ram/x/oniguruma1/src/regparse.c:5331:7\\n    #7 0x4f6f78 in onig_parse_make_tree /mnt/ram/x/oniguruma1/src/regparse.c:5362\\n    #8 0x51ed42 in onig_compile /mnt/ram/x/oniguruma1/src/regcomp.c:5283:7\\n    #9 0x544ac8 in onig_new /mnt/ram/x/oniguruma1/src/regcomp.c:5522:7\\n    #10 0x0  (<unknown module>)\\n\\npreviously allocated by thread T0 here:\\n    #0 0x4c1818 in __interceptor_malloc (/mnt/ram/x/oniguruma1/a.out+0x4c1818)\\n    #1 0x503823 in node_new /mnt/ram/x/oniguruma1/src/regparse.c:1079:18\\n    #2 0x503823 in node_new_str /mnt/ram/x/oniguruma1/src/regparse.c:1410\\n    #3 0x503823 in node_new_empty /mnt/ram/x/oniguruma1/src/regparse.c:1442\\n    #4 0x503823 in parse_exp /mnt/ram/x/oniguruma1/src/regparse.c:4910\\n    #5 0x502fcf in parse_branch /mnt/ram/x/oniguruma1/src/regparse.c:5241:7\\n    #6 0x5004b5 in parse_subexp /mnt/ram/x/oniguruma1/src/regparse.c:5299:11\\n    #7 0x508ab6 in parse_enclose /mnt/ram/x/oniguruma1/src/regparse.c:4662:7\\n    #8 0x508ab6 in parse_exp /mnt/ram/x/oniguruma1/src/regparse.c:4915\\n    #9 0x502fcf in parse_branch /mnt/ram/x/oniguruma1/src/regparse.c:5241:7\\n    #10 0x50021d in parse_subexp /mnt/ram/x/oniguruma1/src/regparse.c:5284:7\\n    #11 0x4f6f78 in parse_regexp /mnt/ram/x/oniguruma1/src/regparse.c:5331:7\\n    #12 0x4f6f78 in onig_parse_make_tree /mnt/ram/x/oniguruma1/src/regparse.c:5362\\n    #13 0x51ed42 in onig_compile /mnt/ram/x/oniguruma1/src/regcomp.c:5283:7\\n    #14 0x544ac8 in onig_new /mnt/ram/x/oniguruma1/src/regcomp.c:5522:7\\n    #15 0x0  (<unknown module>)\\n\\nSUMMARY: AddressSanitizer: heap-use-after-free /mnt/ram/x/oniguruma1/src/regparse.c:1020:11 in onig_node_free\\nShadow bytes around the buggy address:\\n  0x0c0c7fff9d80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9d90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9dc0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 fa\\n=>0x0c0c7fff9dd0: fa fa fa fa[fd]fd fd fd fd fd fd fa fa fa fa fa\\n  0x0c0c7fff9de0: fd fd fd fd fd fd fd fa fa fa fa fa fd fd fd fd\\n  0x0c0c7fff9df0: fd fd fd fa fa fa fa fa 00 00 00 00 00 00 00 fa\\n  0x0c0c7fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_28", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"28\", \"title\": \"[Bug] Not work ^ after ?<=\", \"author\": \"Kristinita\", \"labels\": [], \"description\": \"I use Sublime Text. Sublime Text [uses](http://docs.sublimetext.info/en/latest/extensibility/syntaxdefs.html#matches) Oniguruma's syntax for regular expressions in syntax definitions. I have bug in Sublime Text and I post issue report in Sublime Text issue tracker. Will Bond, developer of Sublime Text, [say me](https://github.com/sublimehq/Packages/issues/610#issuecomment-246046515):\\n\\n> The oniguruma regex engine used when lookbehinds are present does not seem to support anchors in lookbehinds\\n\\n[My problem](https://github.com/sublimehq/Packages/issues/610):\\n\\n---\\n\\nI wrote my own small syntax for tables.\\n\\n_My syntax_: https://gist.github.com/Kristinita/4105b1b48fb3dfc7ba13a0c09f9fb216\\n_My color scheme for syntax_: https://github.com/Kristinita/SashaSublime/blob/master/SashaSublime.tmTheme\\n_Example file, when use this syntax_: https://gist.github.com/Kristinita/39286e4165fa74ea54b52aa41b14ef81\\n\\nIn syntax not works pattern, that work correctly on regex.101.com site:\\n\\n_Pattern_: `(?<=^\\\\| )[0-9]{1,2}(?= )`\\n_regex101_: https://regex101.com/r/gR8lV6/1\\n\\n![Screen1](http://i.imgur.com/WTcSOKJ.png)\\n\\nI want consume digits between `|` and space only when `|` is in the beginning of a line. If I don't write a symbol `^`, figures will be consume in other places, see https://regex101.com/r/gR8lV6/2:\\n\\n![Screen2](http://i.imgur.com/MGccaRY.png)\\n\\nI do not want to consume digits in other places as in the screen 2. But in Sublime Text pattern \\n\\n```\\n- match: (?<=^\\\\| )[0-9]{1,2}(?= )\\n  scope: kira.numbers\\n```\\n\\nall digits don't highlighted. Pattern `(?<=\\\\| )[0-9]{1,2}(?= )` is work for me in Sublime Text.\\n\\n---\\n### Environment\\n\\n**Operating system and version:**\\nWindows 10.0.14393\\n**Sublime Text:**\\nBuild 3126\\n\\nThanks.\\n\", \"comments\": [{\"author\": \"hediyi\", \"body\": \"> The oniguruma regex engine used when lookbehinds are present does not seem to support anchors in lookbehinds\\n\\nI don't think that's true: anchor `^` is effective in look-behind. And the only restriction about look-behind is probably you have to use a fixed-width pattern in it.\\n\"}, {\"author\": \"kkos\", \"body\": \"I don't know about Sublime Text and the incorrect case details. (oniguruma version, encoding, options etc..)\\nBut at least in my following test program, the pattern (?<=^| )[0-9]{1,2}(?= ) works.\\n(Oniguruma 6.1.1 and 5.9.6)\\n\\n```\\nmatch at 2\\n0: (2-4)\\nmatch at 42\\n0: (42-44)\\nmatch at 82\\n0: (82-84)\\nmatch at 122\\n0: (122-124)\\n```\\n\\n```\\n#include <stdio.h>\\n#include <stdlib.h>\\n#include <string.h>\\n#include \\\"oniguruma.h\\\"\\n\\nstatic int\\nscan(regex_t* reg, unsigned char* str, unsigned char* end)\\n{\\n  int r;\\n  UChar *start, *range;\\n  OnigRegion *region;\\n\\n  region = onig_region_new();\\n\\n  end   = str + strlen((char* )str);\\n  start = str;\\n  range = end;\\n\\n  while (start <= range) {\\n    r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\n    if (r >= 0) {\\n      int i;\\n\\n      fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\n      for (i = 0; i < region->num_regs; i++) {\\n    fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\n      }\\n\\n      start = str + region->end[0];\\n    }\\n    else if (r == ONIG_MISMATCH) {\\n      //fprintf(stderr, \\\"search fail\\\\n\\\");\\n      start += onig_enc_len(ONIG_ENCODING_UTF8, start, end);\\n    }\\n    else { /* error */\\n      char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\n      onig_error_code_to_str((UChar* )s, r);\\n      fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\n      return -1;\\n    }\\n\\n    onig_region_free(region, 0);\\n  }\\n\\n  return 0;\\n}\\n\\nstatic int\\nexec(OnigEncoding enc, OnigOptionType options, char* apattern, char* astr)\\n{\\n  int r;\\n  unsigned char *end;\\n  regex_t* reg;\\n  OnigErrorInfo einfo;\\n  UChar* pattern_end;\\n  UChar* pattern = (UChar* )apattern;\\n  UChar* str     = (UChar* )astr;\\n\\n  pattern_end = pattern + onigenc_str_bytelen_null(enc, pattern);\\n\\n  r = onig_new(&reg, pattern, pattern_end, options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\n  if (r != ONIG_NORMAL) {\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\n    onig_error_code_to_str((OnigUChar* )s, r, &einfo);\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\n    return -1;\\n  }\\n\\n  end = str + onigenc_str_bytelen_null(enc, str);\\n  r = scan(reg, str, end);\\n\\n  onig_free(reg);\\n  onig_end();\\n  return 0;\\n}\\n\\nextern int main(int argc, char* argv[])\\n{\\n  static char* pattern = \\\"(?<=^\\\\\\\\| )[0-9]{1,2}(?= )\\\";\\n  static char* str =\\n    \\\"| 23     | T   | +    | xxxxx         |\\\\n\\\"\\n    \\\"| 33     | T   | +    | 77            |\\\\n\\\"\\n    \\\"| 47     | T   | +    | abc ss        |\\\\n\\\"\\n    \\\"| 19     | T   | +    | cc            |\\\\n\\\";\\n\\n\\n  exec(ONIG_ENCODING_UTF8,\\n       ONIG_OPTION_IGNORECASE | ONIG_OPTION_MULTILINE,\\n       pattern, str);\\n\\n  return 0;\\n}\\n```\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_29", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"29\", \"title\": \"use after free for regexp ()(?!(?'a')\\\\1)\", \"author\": \"hannob\", \"labels\": [\"bug\"], \"description\": \"Example code:\\n\\n```\\n#include <oniguruma.h>\\nint main() {\\n    regex_t *reg;\\n    const OnigUChar* inp = (const OnigUChar*)\\\"()(?!(?'a')\\\\\\\\1)\\\";\\n    if (onig_new\\n        (&reg, inp, inp+14, ONIG_OPTION_DEFAULT, ONIG_ENCODING_UTF8,\\n         ONIG_SYNTAX_DEFAULT, 0) == 0)\\n        onig_free(reg);\\n    return 0;\\n}\\n```\\n\\nCompiling with asan will show a use after free error, see below. Latest develop branch, found with libfuzzer.\\n\\nasan error:\\n\\n```\\n==11794==ERROR: AddressSanitizer: heap-use-after-free on address 0x60600000efc4 at pc 0x00000052f459 bp 0x7ffd5bb5a110 sp 0x7ffd5bb5a108\\nREAD of size 4 at 0x60600000efc4 thread T0\\n    #0 0x52f458 in setup_tree /mnt/ram/oniguruma-develop-afl/src/regcomp.c:3731:9\\n    #1 0x52ade9 in setup_tree /mnt/ram/oniguruma-develop-afl/src/regcomp.c:3682:13\\n    #2 0x52e0e1 in setup_tree /mnt/ram/oniguruma-develop-afl/src/regcomp.c:3863:13\\n    #3 0x52ade9 in setup_tree /mnt/ram/oniguruma-develop-afl/src/regcomp.c:3682:13\\n    #4 0x5224ad in onig_compile /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5318:7\\n    #5 0x547d38 in onig_new /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5522:7\\n    #6 0x4f55a0 in main /mnt/ram/oniguruma-develop-afl/uaf.c:5:9\\n    #7 0x7f21b6f336ff in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.23-r2/work/glibc-2.23/csu/../csu/libc-start.c:289\\n    #8 0x419df8 in _start (/mnt/ram/oniguruma-develop-afl/a.out+0x419df8)\\n\\n0x60600000efc4 is located 4 bytes inside of 56-byte region [0x60600000efc0,0x60600000eff8)\\nfreed by thread T0 here:\\n    #0 0x4c1a10 in __interceptor_free (/mnt/ram/oniguruma-develop-afl/a.out+0x4c1a10)\\n    #1 0x4f7992 in onig_node_free /mnt/ram/oniguruma-develop-afl/src/regparse.c:1071:3\\n    #2 0x522165 in onig_compile /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5292:11\\n    #3 0x547d38 in onig_new /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5522:7\\n    #4 0x0  (<unknown module>)\\n\\npreviously allocated by thread T0 here:\\n    #0 0x4c1d18 in __interceptor_malloc (/mnt/ram/oniguruma-develop-afl/a.out+0x4c1d18)\\n    #1 0x507101 in node_new /mnt/ram/oniguruma-develop-afl/src/regparse.c:1079:18\\n    #2 0x507101 in node_new_enclose /mnt/ram/oniguruma-develop-afl/src/regparse.c:1288\\n    #3 0x507101 in node_new_enclose_memory /mnt/ram/oniguruma-develop-afl/src/regparse.c:1311\\n    #4 0x507101 in parse_enclose /mnt/ram/oniguruma-develop-afl/src/regparse.c:4652\\n    #5 0x507101 in parse_exp /mnt/ram/oniguruma-develop-afl/src/regparse.c:4915\\n    #6 0x50625f in parse_branch /mnt/ram/oniguruma-develop-afl/src/regparse.c:5241:7\\n    #7 0x5034a2 in parse_subexp /mnt/ram/oniguruma-develop-afl/src/regparse.c:5284:7\\n    #8 0x4fa1f8 in parse_regexp /mnt/ram/oniguruma-develop-afl/src/regparse.c:5331:7\\n    #9 0x4fa1f8 in onig_parse_make_tree /mnt/ram/oniguruma-develop-afl/src/regparse.c:5362\\n    #10 0x521fd2 in onig_compile /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5283:7\\n    #11 0x547d38 in onig_new /mnt/ram/oniguruma-develop-afl/src/regcomp.c:5522:7\\n    #12 0x0  (<unknown module>)\\n\\nSUMMARY: AddressSanitizer: heap-use-after-free /mnt/ram/oniguruma-develop-afl/src/regcomp.c:3731:9 in setup_tree\\nShadow bytes around the buggy address:\\n  0x0c0c7fff9da0: fa fa fa fa 00 00 00 00 00 00 00 fa fa fa fa fa\\n  0x0c0c7fff9db0: 00 00 00 00 00 00 00 fa fa fa fa fa 00 00 00 00\\n  0x0c0c7fff9dc0: 00 00 00 fa fa fa fa fa 00 00 00 00 00 00 00 fa\\n  0x0c0c7fff9dd0: fa fa fa fa 00 00 00 00 00 00 00 fa fa fa fa fa\\n  0x0c0c7fff9de0: 00 00 00 00 00 00 00 fa fa fa fa fa 00 00 00 00\\n=>0x0c0c7fff9df0: 00 00 00 fa fa fa fa fa[fd]fd fd fd fd fd fd fa\\n  0x0c0c7fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x0c0c7fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Heap right redzone:      fb\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack partial redzone:   f4\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==11794==ABORTING\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\nI have fixed it in develop branch.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_31", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"31\", \"title\": \"Multiple memory leaks with 6.1.1 (and 5.9.6)\", \"author\": \"bdb\", \"labels\": [], \"description\": \"Onig has several leaks when an invalid pattern is passed and the parser returns an error.\\n\\nHere are 3 patterns we use in our tests:\\n\\n\\\"[ab+\\\"\\n\\\"[ab]+\\\\\\\"\\n\\\"(\\\\d:\\\"\\n\\nEach one causes a different parse error, respectively:\\n\\n-103\\n-104\\n-117\\n\\nAnd each one results in leaks as reported by GCC 5.4 and ASAN/LSAN (on Ubuntu 16.04 with all patches applied).\\n\\nHere are 2 examples. I traced the first example by breaking on the only instance of ONIGERR_PREMATURE_END_OF_CHAR_CLASS in regparse.c and stepping out from there.\\n\\nThe root problem seems to be in parse_exp() where some return paths cause the 'qn' node to leak. I do not know the exact paths as I was stepping out from the error point.\\n\\nIn the 1st case below, the allocation of 'qn' occurs in the 'repeat' goto on line 5165 (frame 3). Then in the TK_CC_OPEN case handler in parse_exp() when parse_char_class() fails, parse_exp() immediately returns at that point leaking a live 'qn' allocation.\\n\\nThese leaks should be fixed as they could cause issues with a long running app that allows users to enter random patterns of their own (through UI or through a config file).\\n\\nFor our tests too, these leaks cause test harness failures with ASAN leaks active, so we have to disable ASAN leaks for our test harness.\\n\\n`Direct leak of 56 byte(s) in 1 object(s) allocated from:\\n    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\\n    #1 0x85c6ab in node_new /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:1072\\n    #2 0x85cbb5 in node_new_quantifier /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:1252\\n    #3 0x865c73 in parse_exp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5165\\n    #4 0x865eb6 in parse_branch /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5222\\n    #5 0x866048 in parse_subexp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5259\\n    #6 0x866204 in parse_regexp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5304\\n    #7 0x866324 in onig_parse_make_tree /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5335\\n    #8 0x870d60 in onig_compile /home/src/core/modules/regex/vendor/onig/onig/src/regcomp.c:5279\\n    #9 0x871448 in onig_new /home/src/core/modules/regex/vendor/onig/onig/src/regcomp.c:5518\\n...\\n\\nDirect leak of 56 byte(s) in 1 object(s) allocated from:\\n    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\\n    #1 0x85c6ab in node_new /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:1072\\n    #2 0x85cc67 in node_new_enclose /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:1278\\n    #3 0x85cd05 in node_new_enclose_memory /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:1301\\n    #4 0x86491a in parse_enclose /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:4639\\n    #5 0x8651ca in parse_exp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:4899\\n    #6 0x865eb6 in parse_branch /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5222\\n    #7 0x866048 in parse_subexp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5259\\n    #8 0x866204 in parse_regexp /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5304\\n    #9 0x866324 in onig_parse_make_tree /home/src/core/modules/regex/vendor/onig/onig/src/regparse.c:5335\\n    #10 0x870d60 in onig_compile /home/src/core/modules/regex/vendor/onig/onig/src/regcomp.c:5279\\n    #11 0x871448 in onig_new /home/src/core/modules/regex/vendor/onig/onig/src/regcomp.c:5518\\n...`\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think these problems has been fixed in develop branch by #26, #27 and #29.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_32", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"32\", \"title\": \"Does not build with node7 on windows\", \"author\": \"nojvek\", \"labels\": [], \"description\": \"```\\r\\n$ if not defined npm_config_node_gyp (node \\\"c:\\\\Program Files\\\\nodejs\\\\node_modules\\\\npm\\\\bin\\\\node-gyp-bin\\\\\\\\..\\\\..\\\\node_modules\\\\node-gyp\\\\bin\\\\node-gyp.js\\\" rebuild )  else (node \\\"\\\" rebuild )\\r\\ngyp ERR! UNCAUGHT EXCEPTION\\r\\ngyp ERR! stack Error: spawn msbuild ENOENT\\r\\ngyp ERR! stack     at exports._errnoException (util.js:1026:11)\\r\\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:193:32)\\r\\ngyp ERR! stack     at onErrorNT (internal/child_process.js:359:16)\\r\\ngyp ERR! stack     at _combinedTickCallback (internal/process/next_tick.js:74:11)\\r\\ngyp ERR! stack     at process._tickCallback (internal/process/next_tick.js:98:9)\\r\\ngyp ERR! System Windows_NT 10.0.14393\\r\\ngyp ERR! command \\\"c:\\\\\\\\program files\\\\\\\\nodejs\\\\\\\\node.exe\\\" \\\"c:\\\\\\\\Program Files\\\\\\\\nodejs\\\\\\\\node_modules\\\\\\\\npm\\\\\\\\node_modules\\\\\\\\node-gyp\\\\\\\\bin\\\\\\\\node-gyp.js\\\" \\\"rebuild\\\"\\r\\ngyp ERR! cwd D:\\\\github\\\\vscode\\\\node_modules\\\\oniguruma\\r\\ngyp ERR! node -v v7.0.0\\r\\ngyp ERR! node-gyp -v v3.4.0\\r\\ngyp ERR! This is a bug in `node-gyp`.\\r\\ngyp ERR! Try to update node-gyp and file an Issue if it does not help:\\r\\ngyp ERR!     <https://github.com/nodejs/node-gyp/issues>\\r\\nnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@github:bpasero/fsevents#vscode (node_modules\\\\chokidar\\\\node_modules\\\\fsevents):\\r\\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@0.3.8: wanted {\\\"os\\\":\\\"darwin\\\",\\\"arch\\\":\\\"any\\\"} (current: {\\\"os\\\":\\\"win32\\\",\\\"arch\\\":\\\"x64\\\"})\\r\\nnpm ERR! Windows_NT 10.0.14393\\r\\nnpm ERR! argv \\\"c:\\\\\\\\Program Files\\\\\\\\nodejs\\\\\\\\node.exe\\\" \\\"c:\\\\\\\\Program Files\\\\\\\\nodejs\\\\\\\\node_modules\\\\\\\\npm\\\\\\\\bin\\\\\\\\npm-cli.js\\\" \\\"install\\\" \\\"oniguruma\\\"\\r\\nnpm ERR! node v7.0.0\\r\\nnpm ERR! npm  v3.10.8\\r\\nnpm ERR! code ELIFECYCLE\\r\\n\\r\\nnpm ERR! oniguruma@6.1.1 install: `node-gyp rebuild`\\r\\nnpm ERR! Exit status 7\\r\\nnpm ERR!\\r\\nnpm ERR! Failed at the oniguruma@6.1.1 install script 'node-gyp rebuild'.\\r\\nnpm ERR! Make sure you have the latest version of node.js and npm installed.\\r\\nnpm ERR! If you do, this is most likely a problem with the oniguruma package,\\r\\nnpm ERR! not with npm itself.\\r\\nnpm ERR! Tell the author that this fails on your system:\\r\\nnpm ERR!     node-gyp rebuild\\r\\nnpm ERR! You can get information on how to open an issue for this project with:\\r\\nnpm ERR!     npm bugs oniguruma\\r\\nnpm ERR! Or if that isn't available, you can get their info via:\\r\\nnpm ERR!     npm owner ls oniguruma\\r\\nnpm ERR! There is likely additional logging output above.\\r\\n\\r\\nnpm ERR! Please include the following file with any support request:\\r\\nnpm ERR!     D:\\\\github\\\\vscode\\\\npm-debug.log\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Please write in it at an appropriate project.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_33", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"33\", \"title\": \"#define ‚áí enum?\", \"author\": \"elfring\", \"labels\": [], \"description\": \"Would you like to replace more defines for constant values by [enumerations](https://en.wikipedia.org/wiki/Enumerated_type#C_and_syntactically_similar_languages) to stress their relationships?\\r\\n- [ONIGENC_CTYPE_‚Ä¶](https://github.com/kkos/oniguruma/blob/48dfa028e432e97628fb4fbcd5cb6619a52c5262/src/oniguruma.h#L245)\\r\\n- [RE_MBCTYPE_‚Ä¶](https://github.com/kkos/oniguruma/blob/af8cdfc41f1cf4accbfaa75cd2d7a50dd74a85e2/src/oniggnu.h#L38)\", \"comments\": [{\"author\": \"kkos\", \"body\": \"fixed in 6.8.1\"}, {\"author\": \"elfring\", \"body\": \"Thanks for your small source code improvement.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_34", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"34\", \"title\": \"Completion of error handling\", \"author\": \"elfring\", \"labels\": [], \"description\": \"Would you like to add more error handling for return values from functions like the following?\\r\\n- [fprintf](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fprintf.html \\\"Print formatted output.\\\") ‚áí [exec](https://github.com/kkos/oniguruma/blob/be8af8fff605454847e22f8836fae9c9d7c01da1/src/mktable.c#L1106)\\r\\n- [fopen](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html \\\"Open a stream.\\\") ‚áí [stat_col](https://github.com/kkos/oniguruma/blob/be8af8fff605454847e22f8836fae9c9d7c01da1/src/st.c#L128)\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I added it in develop branch.\\n\"}, {\"author\": \"elfring\", \"body\": \"Are there [a few update candidates](https://github.com/kkos/oniguruma/blob/be8af8fff605454847e22f8836fae9c9d7c01da1/src/st.c#L141) left over?\\n\"}, {\"author\": \"elfring\", \"body\": \"I suggest to avoid [ignorance of return values](https://cwe.mitre.org/data/definitions/252.html \\\"Unchecked return values\\\") a bit more.\\r\\nWould you like to [detect every error situation](https://github.com/kkos/oniguruma/blob/5b6a9d370b43cd3ba30d216bbbf8e8fefb5a212f/src/regexec.c#L1245 \\\"Update candidate: onig_print_statistics()\\\") as early as possible?\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_35", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"35\", \"title\": \"/bin/sh: Syntax error: redirection unexpected (expecting word)\", \"author\": \"AlmightyOatmeal\", \"labels\": [], \"description\": \"Oniguruma seems to install just fine via package but when trying to compile from source, or install Python modules that require this, it fails.\\r\\n\\r\\n```\\r\\n$ uname -a\\r\\nFreeBSD microbox 11.0-RELEASE-p1 FreeBSD 11.0-RELEASE-p1 #0 r306420: Thu Sep 29 01:43:23 UTC 2016     root@releng2.nyi.freebsd.org:/usr/obj/usr/src/sys/GENERIC  amd64\\r\\n```\\r\\n\\r\\n```\\r\\n$ gcc --version\\r\\ngcc (FreeBSD Ports Collection) 4.8.5\\r\\nCopyright (C) 2015 Free Software Foundation, Inc.\\r\\nThis is free software; see the source for copying conditions.  There is NO\\r\\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\\r\\n```\\r\\n\\r\\n```\\r\\n# from https://github.com/kkos/oniguruma/releases/download/v5.9.6/onig-5.9.6.tar.gz\\r\\n$ ./configure CFLAGS=-fPIC\\r\\nchecking for a BSD-compatible install... /usr/bin/install -c\\r\\nchecking whether build environment is sane... yes\\r\\nchecking for a thread-safe mkdir -p... ./install-sh -c -d\\r\\nchecking for gawk... no\\r\\nchecking for mawk... no\\r\\nchecking for nawk... nawk\\r\\nchecking whether make sets $(MAKE)... yes\\r\\nchecking for gcc... gcc\\r\\nchecking whether the C compiler works... yes\\r\\nchecking for C compiler default output file name... a.out\\r\\nchecking for suffix of executables...\\r\\nchecking whether we are cross compiling... no\\r\\nchecking for suffix of object files... o\\r\\nchecking whether we are using the GNU C compiler... yes\\r\\nchecking whether gcc accepts -g... yes\\r\\nchecking for gcc option to accept ISO C89... none needed\\r\\nchecking for style of include used by make... GNU\\r\\nchecking dependency style of gcc... gcc3\\r\\nchecking build system type... x86_64-unknown-freebsd11.0\\r\\nchecking host system type... x86_64-unknown-freebsd11.0\\r\\nchecking how to print strings... printf\\r\\nchecking for a sed that does not truncate output... /usr/bin/sed\\r\\nchecking for grep that handles long lines and -e... /usr/bin/grep\\r\\nchecking for egrep... /usr/bin/grep -E\\r\\nchecking for fgrep... /usr/bin/grep -F\\r\\nchecking for ld used by gcc... /usr/local/bin/ld\\r\\nchecking if the linker (/usr/local/bin/ld) is GNU ld... yes\\r\\nchecking for BSD- or MS-compatible name lister (nm)... /usr/local/bin/nm -B\\r\\nchecking the name lister (/usr/local/bin/nm -B) interface... BSD nm\\r\\nchecking whether ln -s works... yes\\r\\nchecking the maximum length of command line arguments... 196608\\r\\nchecking whether the shell understands some XSI constructs... yes\\r\\nchecking whether the shell understands \\\"+=\\\"... no\\r\\nchecking how to convert x86_64-unknown-freebsd11.0 file names to x86_64-unknown-freebsd11.0 format... func_convert_file_noop\\r\\nchecking how to convert x86_64-unknown-freebsd11.0 file names to toolchain format... func_convert_file_noop\\r\\nchecking for /usr/local/bin/ld option to reload object files... -r\\r\\nchecking for objdump... objdump\\r\\nchecking how to recognize dependent libraries... pass_all\\r\\nchecking for dlltool... no\\r\\nchecking how to associate runtime and link libraries... printf %s\\\\n\\r\\nchecking for ar... ar\\r\\nchecking for archiver @FILE support... no\\r\\nchecking for strip... strip\\r\\nchecking for ranlib... ranlib\\r\\nchecking command to parse /usr/local/bin/nm -B output from gcc object... ok\\r\\nchecking for sysroot... no\\r\\nchecking for mt... mt\\r\\nchecking if mt is a manifest tool... no\\r\\nchecking how to run the C preprocessor... gcc -E\\r\\nchecking for ANSI C header files... yes\\r\\nchecking for sys/types.h... yes\\r\\nchecking for sys/stat.h... yes\\r\\nchecking for stdlib.h... yes\\r\\nchecking for string.h... yes\\r\\nchecking for memory.h... yes\\r\\nchecking for strings.h... yes\\r\\nchecking for inttypes.h... yes\\r\\nchecking for stdint.h... yes\\r\\nchecking for unistd.h... yes\\r\\nchecking for dlfcn.h... yes\\r\\nchecking for objdir... .libs\\r\\nchecking if gcc supports -fno-rtti -fno-exceptions... no\\r\\nchecking for gcc option to produce PIC... -fPIC -DPIC\\r\\nchecking if gcc PIC flag -fPIC -DPIC works... yes\\r\\nchecking if gcc static flag -static works... yes\\r\\nchecking if gcc supports -c -o file.o... yes\\r\\nchecking if gcc supports -c -o file.o... (cached) yes\\r\\nchecking whether the gcc linker (/usr/local/bin/ld) supports shared libraries... yes\\r\\nchecking whether -lc should be explicitly linked in... no\\r\\nchecking dynamic linker characteristics... freebsd11.0 ld.so\\r\\nchecking how to hardcode library paths into programs... immediate\\r\\nchecking whether stripping libraries is possible... no\\r\\nchecking if libtool supports shared libraries... yes\\r\\nchecking whether to build shared libraries... yes\\r\\nchecking whether to build static libraries... yes\\r\\nchecking whether make sets $(MAKE)... (cached) yes\\r\\nchecking for ANSI C header files... (cached) yes\\r\\nchecking for stdlib.h... (cached) yes\\r\\nchecking for string.h... (cached) yes\\r\\nchecking for strings.h... (cached) yes\\r\\nchecking sys/time.h usability... yes\\r\\nchecking sys/time.h presence... yes\\r\\nchecking for sys/time.h... yes\\r\\nchecking for unistd.h... (cached) yes\\r\\nchecking sys/times.h usability... yes\\r\\nchecking sys/times.h presence... yes\\r\\nchecking for sys/times.h... yes\\r\\nchecking size of int... 4\\r\\nchecking size of short... 2\\r\\nchecking size of long... 8\\r\\nchecking for an ANSI C-conforming const... yes\\r\\nchecking whether time.h and sys/time.h may both be included... yes\\r\\nchecking for size_t... yes\\r\\nchecking for working alloca.h... no\\r\\nchecking for alloca... yes\\r\\nchecking for working memcmp... yes\\r\\nchecking for prototypes... yes\\r\\nchecking for variable length prototypes and stdarg.h... yes\\r\\nconfigure: creating ./config.status\\r\\nconfig.status: creating Makefile\\r\\nconfig.status: creating onig-config\\r\\nconfig.status: creating sample/Makefile\\r\\nconfig.status: creating config.h\\r\\nconfig.status: executing depfiles commands\\r\\nconfig.status: executing libtool commands\\r\\nconfig.status: executing default commands\\r\\n```\\r\\n\\r\\n```\\r\\n$ make\\r\\nmake  all-recursive\\r\\nMaking all in .\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regerror.lo -MD -MP -MF .deps/regerror.Tpo -c -o regerror.lo regerror.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regerror.lo -MD -MP -MF .deps/regerror.Tpo -c regerror.c  -fPIC -DPIC -o .libs/regerror.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regerror.lo -MD -MP -MF .deps/regerror.Tpo -c regerror.c -o regerror.o >/dev/null 2>&1\\r\\nmv -f .deps/regerror.Tpo .deps/regerror.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regparse.lo -MD -MP -MF .deps/regparse.Tpo -c -o regparse.lo regparse.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regparse.lo -MD -MP -MF .deps/regparse.Tpo -c regparse.c  -fPIC -DPIC -o .libs/regparse.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regparse.lo -MD -MP -MF .deps/regparse.Tpo -c regparse.c -o regparse.o >/dev/null 2>&1\\r\\nmv -f .deps/regparse.Tpo .deps/regparse.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regext.lo -MD -MP -MF .deps/regext.Tpo -c -o regext.lo regext.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regext.lo -MD -MP -MF .deps/regext.Tpo -c regext.c  -fPIC -DPIC -o .libs/regext.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regext.lo -MD -MP -MF .deps/regext.Tpo -c regext.c -o regext.o >/dev/null 2>&1\\r\\nmv -f .deps/regext.Tpo .deps/regext.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regcomp.lo -MD -MP -MF .deps/regcomp.Tpo -c -o regcomp.lo regcomp.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regcomp.lo -MD -MP -MF .deps/regcomp.Tpo -c regcomp.c  -fPIC -DPIC -o .libs/regcomp.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regcomp.lo -MD -MP -MF .deps/regcomp.Tpo -c regcomp.c -o regcomp.o >/dev/null 2>&1\\r\\nmv -f .deps/regcomp.Tpo .deps/regcomp.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regexec.lo -MD -MP -MF .deps/regexec.Tpo -c -o regexec.lo regexec.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regexec.lo -MD -MP -MF .deps/regexec.Tpo -c regexec.c  -fPIC -DPIC -o .libs/regexec.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regexec.lo -MD -MP -MF .deps/regexec.Tpo -c regexec.c -o regexec.o >/dev/null 2>&1\\r\\nmv -f .deps/regexec.Tpo .deps/regexec.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT reggnu.lo -MD -MP -MF .deps/reggnu.Tpo -c -o reggnu.lo reggnu.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT reggnu.lo -MD -MP -MF .deps/reggnu.Tpo -c reggnu.c  -fPIC -DPIC -o .libs/reggnu.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT reggnu.lo -MD -MP -MF .deps/reggnu.Tpo -c reggnu.c -o reggnu.o >/dev/null 2>&1\\r\\nmv -f .deps/reggnu.Tpo .deps/reggnu.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regenc.lo -MD -MP -MF .deps/regenc.Tpo -c -o regenc.lo regenc.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regenc.lo -MD -MP -MF .deps/regenc.Tpo -c regenc.c  -fPIC -DPIC -o .libs/regenc.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regenc.lo -MD -MP -MF .deps/regenc.Tpo -c regenc.c -o regenc.o >/dev/null 2>&1\\r\\nmv -f .deps/regenc.Tpo .deps/regenc.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regsyntax.lo -MD -MP -MF .deps/regsyntax.Tpo -c -o regsyntax.lo regsyntax.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regsyntax.lo -MD -MP -MF .deps/regsyntax.Tpo -c regsyntax.c  -fPIC -DPIC -o .libs/regsyntax.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regsyntax.lo -MD -MP -MF .deps/regsyntax.Tpo -c regsyntax.c -o regsyntax.o >/dev/null 2>&1\\r\\nmv -f .deps/regsyntax.Tpo .deps/regsyntax.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regtrav.lo -MD -MP -MF .deps/regtrav.Tpo -c -o regtrav.lo regtrav.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regtrav.lo -MD -MP -MF .deps/regtrav.Tpo -c regtrav.c  -fPIC -DPIC -o .libs/regtrav.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regtrav.lo -MD -MP -MF .deps/regtrav.Tpo -c regtrav.c -o regtrav.o >/dev/null 2>&1\\r\\nmv -f .deps/regtrav.Tpo .deps/regtrav.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regversion.lo -MD -MP -MF .deps/regversion.Tpo -c -o regversion.lo regversion.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regversion.lo -MD -MP -MF .deps/regversion.Tpo -c regversion.c  -fPIC -DPIC -o .libs/regversion.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regversion.lo -MD -MP -MF .deps/regversion.Tpo -c regversion.c -o regversion.o >/dev/null 2>&1\\r\\nmv -f .deps/regversion.Tpo .deps/regversion.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT st.lo -MD -MP -MF .deps/st.Tpo -c -o st.lo st.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT st.lo -MD -MP -MF .deps/st.Tpo -c st.c  -fPIC -DPIC -o .libs/st.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT st.lo -MD -MP -MF .deps/st.Tpo -c st.c -o st.o >/dev/null 2>&1\\r\\nmv -f .deps/st.Tpo .deps/st.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regposix.lo -MD -MP -MF .deps/regposix.Tpo -c -o regposix.lo regposix.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regposix.lo -MD -MP -MF .deps/regposix.Tpo -c regposix.c  -fPIC -DPIC -o .libs/regposix.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regposix.lo -MD -MP -MF .deps/regposix.Tpo -c regposix.c -o regposix.o >/dev/null 2>&1\\r\\nmv -f .deps/regposix.Tpo .deps/regposix.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include     -fPIC -MT regposerr.lo -MD -MP -MF .deps/regposerr.Tpo -c -o regposerr.lo regposerr.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regposerr.lo -MD -MP -MF .deps/regposerr.Tpo -c regposerr.c  -fPIC -DPIC -o .libs/regposerr.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT regposerr.lo -MD -MP -MF .deps/regposerr.Tpo -c regposerr.c -o regposerr.o >/dev/null 2>&1\\r\\nmv -f .deps/regposerr.Tpo .deps/regposerr.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT unicode.lo -MD -MP -MF .deps/unicode.Tpo -c -o unicode.lo `test -f './enc/unicode.c' || echo './'`./enc/unicode.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT unicode.lo -MD -MP -MF .deps/unicode.Tpo -c ./enc/unicode.c  -fPIC -DPIC -o .libs/unicode.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT unicode.lo -MD -MP -MF .deps/unicode.Tpo -c ./enc/unicode.c -o unicode.o >/dev/null 2>&1\\r\\nmv -f .deps/unicode.Tpo .deps/unicode.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT ascii.lo -MD -MP -MF .deps/ascii.Tpo -c -o ascii.lo `test -f './enc/ascii.c' || echo './'`./enc/ascii.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT ascii.lo -MD -MP -MF .deps/ascii.Tpo -c ./enc/ascii.c  -fPIC -DPIC -o .libs/ascii.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT ascii.lo -MD -MP -MF .deps/ascii.Tpo -c ./enc/ascii.c -o ascii.o >/dev/null 2>&1\\r\\nmv -f .deps/ascii.Tpo .deps/ascii.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT utf8.lo -MD -MP -MF .deps/utf8.Tpo -c -o utf8.lo `test -f './enc/utf8.c' || echo './'`./enc/utf8.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf8.lo -MD -MP -MF .deps/utf8.Tpo -c ./enc/utf8.c  -fPIC -DPIC -o .libs/utf8.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf8.lo -MD -MP -MF .deps/utf8.Tpo -c ./enc/utf8.c -o utf8.o >/dev/null 2>&1\\r\\nmv -f .deps/utf8.Tpo .deps/utf8.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT utf16_be.lo -MD -MP -MF .deps/utf16_be.Tpo -c -o utf16_be.lo `test -f './enc/utf16_be.c' || echo './'`./enc/utf16_be.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf16_be.lo -MD -MP -MF .deps/utf16_be.Tpo -c ./enc/utf16_be.c  -fPIC -DPIC -o .libs/utf16_be.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf16_be.lo -MD -MP -MF .deps/utf16_be.Tpo -c ./enc/utf16_be.c -o utf16_be.o >/dev/null 2>&1\\r\\nmv -f .deps/utf16_be.Tpo .deps/utf16_be.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT utf16_le.lo -MD -MP -MF .deps/utf16_le.Tpo -c -o utf16_le.lo `test -f './enc/utf16_le.c' || echo './'`./enc/utf16_le.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf16_le.lo -MD -MP -MF .deps/utf16_le.Tpo -c ./enc/utf16_le.c  -fPIC -DPIC -o .libs/utf16_le.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf16_le.lo -MD -MP -MF .deps/utf16_le.Tpo -c ./enc/utf16_le.c -o utf16_le.o >/dev/null 2>&1\\r\\nmv -f .deps/utf16_le.Tpo .deps/utf16_le.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT utf32_be.lo -MD -MP -MF .deps/utf32_be.Tpo -c -o utf32_be.lo `test -f './enc/utf32_be.c' || echo './'`./enc/utf32_be.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf32_be.lo -MD -MP -MF .deps/utf32_be.Tpo -c ./enc/utf32_be.c  -fPIC -DPIC -o .libs/utf32_be.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf32_be.lo -MD -MP -MF .deps/utf32_be.Tpo -c ./enc/utf32_be.c -o utf32_be.o >/dev/null 2>&1\\r\\nmv -f .deps/utf32_be.Tpo .deps/utf32_be.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT utf32_le.lo -MD -MP -MF .deps/utf32_le.Tpo -c -o utf32_le.lo `test -f './enc/utf32_le.c' || echo './'`./enc/utf32_le.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf32_le.lo -MD -MP -MF .deps/utf32_le.Tpo -c ./enc/utf32_le.c  -fPIC -DPIC -o .libs/utf32_le.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT utf32_le.lo -MD -MP -MF .deps/utf32_le.Tpo -c ./enc/utf32_le.c -o utf32_le.o >/dev/null 2>&1\\r\\nmv -f .deps/utf32_le.Tpo .deps/utf32_le.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT euc_jp.lo -MD -MP -MF .deps/euc_jp.Tpo -c -o euc_jp.lo `test -f './enc/euc_jp.c' || echo './'`./enc/euc_jp.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_jp.lo -MD -MP -MF .deps/euc_jp.Tpo -c ./enc/euc_jp.c  -fPIC -DPIC -o .libs/euc_jp.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_jp.lo -MD -MP -MF .deps/euc_jp.Tpo -c ./enc/euc_jp.c -o euc_jp.o >/dev/null 2>&1\\r\\nmv -f .deps/euc_jp.Tpo .deps/euc_jp.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT sjis.lo -MD -MP -MF .deps/sjis.Tpo -c -o sjis.lo `test -f './enc/sjis.c' || echo './'`./enc/sjis.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT sjis.lo -MD -MP -MF .deps/sjis.Tpo -c ./enc/sjis.c  -fPIC -DPIC -o .libs/sjis.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT sjis.lo -MD -MP -MF .deps/sjis.Tpo -c ./enc/sjis.c -o sjis.o >/dev/null 2>&1\\r\\nmv -f .deps/sjis.Tpo .deps/sjis.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_1.lo -MD -MP -MF .deps/iso8859_1.Tpo -c -o iso8859_1.lo `test -f './enc/iso8859_1.c' || echo './'`./enc/iso8859_1.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_1.lo -MD -MP -MF .deps/iso8859_1.Tpo -c ./enc/iso8859_1.c  -fPIC -DPIC -o .libs/iso8859_1.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_1.lo -MD -MP -MF .deps/iso8859_1.Tpo -c ./enc/iso8859_1.c -o iso8859_1.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_1.Tpo .deps/iso8859_1.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_2.lo -MD -MP -MF .deps/iso8859_2.Tpo -c -o iso8859_2.lo `test -f './enc/iso8859_2.c' || echo './'`./enc/iso8859_2.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_2.lo -MD -MP -MF .deps/iso8859_2.Tpo -c ./enc/iso8859_2.c  -fPIC -DPIC -o .libs/iso8859_2.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_2.lo -MD -MP -MF .deps/iso8859_2.Tpo -c ./enc/iso8859_2.c -o iso8859_2.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_2.Tpo .deps/iso8859_2.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_3.lo -MD -MP -MF .deps/iso8859_3.Tpo -c -o iso8859_3.lo `test -f './enc/iso8859_3.c' || echo './'`./enc/iso8859_3.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_3.lo -MD -MP -MF .deps/iso8859_3.Tpo -c ./enc/iso8859_3.c  -fPIC -DPIC -o .libs/iso8859_3.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_3.lo -MD -MP -MF .deps/iso8859_3.Tpo -c ./enc/iso8859_3.c -o iso8859_3.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_3.Tpo .deps/iso8859_3.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_4.lo -MD -MP -MF .deps/iso8859_4.Tpo -c -o iso8859_4.lo `test -f './enc/iso8859_4.c' || echo './'`./enc/iso8859_4.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_4.lo -MD -MP -MF .deps/iso8859_4.Tpo -c ./enc/iso8859_4.c  -fPIC -DPIC -o .libs/iso8859_4.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_4.lo -MD -MP -MF .deps/iso8859_4.Tpo -c ./enc/iso8859_4.c -o iso8859_4.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_4.Tpo .deps/iso8859_4.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_5.lo -MD -MP -MF .deps/iso8859_5.Tpo -c -o iso8859_5.lo `test -f './enc/iso8859_5.c' || echo './'`./enc/iso8859_5.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_5.lo -MD -MP -MF .deps/iso8859_5.Tpo -c ./enc/iso8859_5.c  -fPIC -DPIC -o .libs/iso8859_5.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_5.lo -MD -MP -MF .deps/iso8859_5.Tpo -c ./enc/iso8859_5.c -o iso8859_5.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_5.Tpo .deps/iso8859_5.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_6.lo -MD -MP -MF .deps/iso8859_6.Tpo -c -o iso8859_6.lo `test -f './enc/iso8859_6.c' || echo './'`./enc/iso8859_6.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_6.lo -MD -MP -MF .deps/iso8859_6.Tpo -c ./enc/iso8859_6.c  -fPIC -DPIC -o .libs/iso8859_6.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_6.lo -MD -MP -MF .deps/iso8859_6.Tpo -c ./enc/iso8859_6.c -o iso8859_6.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_6.Tpo .deps/iso8859_6.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_7.lo -MD -MP -MF .deps/iso8859_7.Tpo -c -o iso8859_7.lo `test -f './enc/iso8859_7.c' || echo './'`./enc/iso8859_7.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_7.lo -MD -MP -MF .deps/iso8859_7.Tpo -c ./enc/iso8859_7.c  -fPIC -DPIC -o .libs/iso8859_7.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_7.lo -MD -MP -MF .deps/iso8859_7.Tpo -c ./enc/iso8859_7.c -o iso8859_7.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_7.Tpo .deps/iso8859_7.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_8.lo -MD -MP -MF .deps/iso8859_8.Tpo -c -o iso8859_8.lo `test -f './enc/iso8859_8.c' || echo './'`./enc/iso8859_8.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_8.lo -MD -MP -MF .deps/iso8859_8.Tpo -c ./enc/iso8859_8.c  -fPIC -DPIC -o .libs/iso8859_8.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_8.lo -MD -MP -MF .deps/iso8859_8.Tpo -c ./enc/iso8859_8.c -o iso8859_8.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_8.Tpo .deps/iso8859_8.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_9.lo -MD -MP -MF .deps/iso8859_9.Tpo -c -o iso8859_9.lo `test -f './enc/iso8859_9.c' || echo './'`./enc/iso8859_9.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_9.lo -MD -MP -MF .deps/iso8859_9.Tpo -c ./enc/iso8859_9.c  -fPIC -DPIC -o .libs/iso8859_9.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_9.lo -MD -MP -MF .deps/iso8859_9.Tpo -c ./enc/iso8859_9.c -o iso8859_9.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_9.Tpo .deps/iso8859_9.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_10.lo -MD -MP -MF .deps/iso8859_10.Tpo -c -o iso8859_10.lo `test -f './enc/iso8859_10.c' || echo './'`./enc/iso8859_10.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_10.lo -MD -MP -MF .deps/iso8859_10.Tpo -c ./enc/iso8859_10.c  -fPIC -DPIC -o .libs/iso8859_10.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_10.lo -MD -MP -MF .deps/iso8859_10.Tpo -c ./enc/iso8859_10.c -o iso8859_10.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_10.Tpo .deps/iso8859_10.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_11.lo -MD -MP -MF .deps/iso8859_11.Tpo -c -o iso8859_11.lo `test -f './enc/iso8859_11.c' || echo './'`./enc/iso8859_11.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_11.lo -MD -MP -MF .deps/iso8859_11.Tpo -c ./enc/iso8859_11.c  -fPIC -DPIC -o .libs/iso8859_11.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_11.lo -MD -MP -MF .deps/iso8859_11.Tpo -c ./enc/iso8859_11.c -o iso8859_11.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_11.Tpo .deps/iso8859_11.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_13.lo -MD -MP -MF .deps/iso8859_13.Tpo -c -o iso8859_13.lo `test -f './enc/iso8859_13.c' || echo './'`./enc/iso8859_13.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_13.lo -MD -MP -MF .deps/iso8859_13.Tpo -c ./enc/iso8859_13.c  -fPIC -DPIC -o .libs/iso8859_13.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_13.lo -MD -MP -MF .deps/iso8859_13.Tpo -c ./enc/iso8859_13.c -o iso8859_13.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_13.Tpo .deps/iso8859_13.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_14.lo -MD -MP -MF .deps/iso8859_14.Tpo -c -o iso8859_14.lo `test -f './enc/iso8859_14.c' || echo './'`./enc/iso8859_14.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_14.lo -MD -MP -MF .deps/iso8859_14.Tpo -c ./enc/iso8859_14.c  -fPIC -DPIC -o .libs/iso8859_14.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_14.lo -MD -MP -MF .deps/iso8859_14.Tpo -c ./enc/iso8859_14.c -o iso8859_14.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_14.Tpo .deps/iso8859_14.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_15.lo -MD -MP -MF .deps/iso8859_15.Tpo -c -o iso8859_15.lo `test -f './enc/iso8859_15.c' || echo './'`./enc/iso8859_15.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_15.lo -MD -MP -MF .deps/iso8859_15.Tpo -c ./enc/iso8859_15.c  -fPIC -DPIC -o .libs/iso8859_15.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_15.lo -MD -MP -MF .deps/iso8859_15.Tpo -c ./enc/iso8859_15.c -o iso8859_15.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_15.Tpo .deps/iso8859_15.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT iso8859_16.lo -MD -MP -MF .deps/iso8859_16.Tpo -c -o iso8859_16.lo `test -f './enc/iso8859_16.c' || echo './'`./enc/iso8859_16.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_16.lo -MD -MP -MF .deps/iso8859_16.Tpo -c ./enc/iso8859_16.c  -fPIC -DPIC -o .libs/iso8859_16.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT iso8859_16.lo -MD -MP -MF .deps/iso8859_16.Tpo -c ./enc/iso8859_16.c -o iso8859_16.o >/dev/null 2>&1\\r\\nmv -f .deps/iso8859_16.Tpo .deps/iso8859_16.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT euc_tw.lo -MD -MP -MF .deps/euc_tw.Tpo -c -o euc_tw.lo `test -f './enc/euc_tw.c' || echo './'`./enc/euc_tw.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_tw.lo -MD -MP -MF .deps/euc_tw.Tpo -c ./enc/euc_tw.c  -fPIC -DPIC -o .libs/euc_tw.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_tw.lo -MD -MP -MF .deps/euc_tw.Tpo -c ./enc/euc_tw.c -o euc_tw.o >/dev/null 2>&1\\r\\nmv -f .deps/euc_tw.Tpo .deps/euc_tw.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT euc_kr.lo -MD -MP -MF .deps/euc_kr.Tpo -c -o euc_kr.lo `test -f './enc/euc_kr.c' || echo './'`./enc/euc_kr.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_kr.lo -MD -MP -MF .deps/euc_kr.Tpo -c ./enc/euc_kr.c  -fPIC -DPIC -o .libs/euc_kr.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT euc_kr.lo -MD -MP -MF .deps/euc_kr.Tpo -c ./enc/euc_kr.c -o euc_kr.o >/dev/null 2>&1\\r\\nmv -f .deps/euc_kr.Tpo .deps/euc_kr.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT big5.lo -MD -MP -MF .deps/big5.Tpo -c -o big5.lo `test -f './enc/big5.c' || echo './'`./enc/big5.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT big5.lo -MD -MP -MF .deps/big5.Tpo -c ./enc/big5.c  -fPIC -DPIC -o .libs/big5.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT big5.lo -MD -MP -MF .deps/big5.Tpo -c ./enc/big5.c -o big5.o >/dev/null 2>&1\\r\\nmv -f .deps/big5.Tpo .deps/big5.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT gb18030.lo -MD -MP -MF .deps/gb18030.Tpo -c -o gb18030.lo `test -f './enc/gb18030.c' || echo './'`./enc/gb18030.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT gb18030.lo -MD -MP -MF .deps/gb18030.Tpo -c ./enc/gb18030.c  -fPIC -DPIC -o .libs/gb18030.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT gb18030.lo -MD -MP -MF .deps/gb18030.Tpo -c ./enc/gb18030.c -o gb18030.o >/dev/null 2>&1\\r\\nmv -f .deps/gb18030.Tpo .deps/gb18030.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT koi8_r.lo -MD -MP -MF .deps/koi8_r.Tpo -c -o koi8_r.lo `test -f './enc/koi8_r.c' || echo './'`./enc/koi8_r.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT koi8_r.lo -MD -MP -MF .deps/koi8_r.Tpo -c ./enc/koi8_r.c  -fPIC -DPIC -o .libs/koi8_r.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT koi8_r.lo -MD -MP -MF .deps/koi8_r.Tpo -c ./enc/koi8_r.c -o koi8_r.o >/dev/null 2>&1\\r\\nmv -f .deps/koi8_r.Tpo .deps/koi8_r.Plo\\r\\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include    -fPIC -MT cp1251.lo -MD -MP -MF .deps/cp1251.Tpo -c -o cp1251.lo `test -f './enc/cp1251.c' || echo './'`./enc/cp1251.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT cp1251.lo -MD -MP -MF .deps/cp1251.Tpo -c ./enc/cp1251.c  -fPIC -DPIC -o .libs/cp1251.o\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I. -I/usr/local/include -fPIC -MT cp1251.lo -MD -MP -MF .deps/cp1251.Tpo -c ./enc/cp1251.c -o cp1251.o >/dev/null 2>&1\\r\\nmv -f .deps/cp1251.Tpo .deps/cp1251.Plo\\r\\n/bin/sh ./libtool --tag=CC    --mode=link gcc  -fPIC  -version-info 2:0:0  -o libonig.la -rpath /usr/local/lib regerror.lo regparse.lo regext.lo regcomp.lo  regexec.lo reggnu.lo regenc.lo regsyntax.lo regtrav.lo  regversion.lo st.lo regposix.lo regposerr.lo unicode.lo  ascii.lo utf8.lo utf16_be.lo utf16_le.lo utf32_be.lo  utf32_le.lo euc_jp.lo sjis.lo iso8859_1.lo iso8859_2.lo  iso8859_3.lo iso8859_4.lo iso8859_5.lo iso8859_6.lo  iso8859_7.lo iso8859_8.lo iso8859_9.lo iso8859_10.lo  iso8859_11.lo iso8859_13.lo iso8859_14.lo iso8859_15.lo  iso8859_16.lo euc_tw.lo euc_kr.lo big5.lo gb18030.lo koi8_r.lo  cp1251.lo\\r\\nlibtool: link: gcc -shared  -fPIC -DPIC  .libs/regerror.o .libs/regparse.o .libs/regext.o .libs/regcomp.o .libs/regexec.o .libs/reggnu.o .libs/regenc.o .libs/regsyntax.o .libs/regtrav.o .libs/regversion.o .libs/st.o .libs/regposix.o .libs/regposerr.o .libs/unicode.o .libs/ascii.o .libs/utf8.o .libs/utf16_be.o .libs/utf16_le.o .libs/utf32_be.o .libs/utf32_le.o .libs/euc_jp.o .libs/sjis.o .libs/iso8859_1.o .libs/iso8859_2.o .libs/iso8859_3.o .libs/iso8859_4.o .libs/iso8859_5.o .libs/iso8859_6.o .libs/iso8859_7.o .libs/iso8859_8.o .libs/iso8859_9.o .libs/iso8859_10.o .libs/iso8859_11.o .libs/iso8859_13.o .libs/iso8859_14.o .libs/iso8859_15.o .libs/iso8859_16.o .libs/euc_tw.o .libs/euc_kr.o .libs/big5.o .libs/gb18030.o .libs/koi8_r.o .libs/cp1251.o      -Wl,-soname -Wl,libonig.so.2 -o .libs/libonig.so.2\\r\\nlibtool: link: (cd \\\".libs\\\" && rm -f \\\"libonig.so\\\" && ln -s \\\"libonig.so.2\\\" \\\"libonig.so\\\")\\r\\nlibtool: link: (cd \\\".libs\\\" && rm -f \\\"libonig.so\\\" && ln -s \\\"libonig.so.2\\\" \\\"libonig.so\\\")\\r\\nlibtool: link: ar cru .libs/libonig.a  regerror.o regparse.o regext.o regcomp.o regexec.o reggnu.o regenc.o regsyntax.o regtrav.o regversion.o st.o regposix.o regposerr.o unicode.o ascii.o utf8.o utf16_be.o utf16_le.o utf32_be.o utf32_le.o euc_jp.o sjis.o iso8859_1.o iso8859_2.o iso8859_3.o iso8859_4.o iso8859_5.o iso8859_6.o iso8859_7.o iso8859_8.o iso8859_9.o iso8859_10.o iso8859_11.o iso8859_13.o iso8859_14.o iso8859_15.o iso8859_16.o euc_tw.o euc_kr.o big5.o gb18030.o koi8_r.o cp1251.o\\r\\nlibtool: link: ranlib .libs/libonig.a\\r\\nlibtool: link: ( cd \\\".libs\\\" && rm -f \\\"libonig.la\\\" && ln -s \\\"../libonig.la\\\" \\\"libonig.la\\\" )\\r\\nsed                                           -e 's,[@]datadir[@],/usr/local/share,g'                  -e 's,[@]datarootdir[@],/usr/local/share,g'          -e 's,[@]PACKAGE_VERSION[@],5.9.6,g'  -e 's,[@]prefix[@],/usr/local,g'                    -e 's,[@]exec_prefix[@],/usr/local,g'          -e 's,[@]libdir[@],/usr/local/lib,g'                    -e 's,[@]includedir[@],/usr/local/include,g' <  > oniguruma.pc\\r\\n/bin/sh: Syntax error: redirection unexpected (expecting word)\\r\\n*** Error code 2\\r\\n\\r\\nStop.\\r\\nmake[2]: stopped in /usr/home/jamie/onig-5.9.6\\r\\n*** Error code 1\\r\\n\\r\\nStop.\\r\\nmake[1]: stopped in /usr/home/jamie/onig-5.9.6\\r\\n*** Error code 1\\r\\n\\r\\nStop.\\r\\nmake: stopped in /usr/home/jamie/onig-5.9.6\\r\\n```\", \"comments\": [{\"author\": \"AlmightyOatmeal\", \"body\": \"Anyone?\"}, {\"author\": \"k-takata\", \"body\": \"I think this is the same problem which was reported to Onigmo: https://github.com/k-takata/Onigmo/pull/55\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI have fixed it in develop branch.\"}, {\"author\": \"AlmightyOatmeal\", \"body\": \"Thank you but that won't help me until it gets released as I'm trying to use jq and the Python module *requires* to have this compiled from source. It's a shame that I have to wait for this fix to go to release then wait for the other project to pick up on the new version because I can actually use jq for a project I'm already behind in.  I appreciate the work on this though. :)\"}, {\"author\": \"kkos\", \"body\": \"6.1.3 released.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_36", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"36\", \"title\": \"Match regression\", \"author\": \"gundermanc\", \"labels\": [], \"description\": \"`(?:^|\\\\G)(#{1,6})\\\\s*(?=[\\\\S[^#]])` fails to match `##` in expression `## This is *great* stuff`.\\r\\n\\r\\nThis appears to be a regression as this same expression matches when run against the [Atom Node Oniguruma](http://github.com/atom/node-oniguruma) version of the Oniguruma library. \\r\\n\\r\\nI am not sure the root cause, however, it appears to be related to the `(?=[\\\\S[^#]])` portion of the regex, as removing it causes the regex to match again.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I can't read the subject string.\\r\\nIf the subject string is \\\"## in expression ##\\\", the pattern match it.\\r\\n\\r\\n```\\r\\nkosako@VirtualBox:~/tmp$ gcc -Wall a.c -o a -lonig\\r\\nkosako@VirtualBox:~/tmp$ ./a\\r\\nmatch at 0\\r\\n0: (0-3)\\r\\n1: (0-2)\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range, *end;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  static UChar* pattern = (UChar* )\\\"(?:^|\\\\\\\\G)(#{1,6})\\\\\\\\s*(?=[\\\\\\\\S[^#]])\\\";\\r\\n  static UChar* str     = (UChar* )\\\"## in expression ##\\\";\\r\\n  //static UChar* str     = (UChar* )\\\"##\\\";\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen((char* )pattern),\\r\\n\\tONIG_OPTION_DEFAULT, ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  end   = str + strlen((char* )str);\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"gundermanc\", \"body\": \"Hi, thanks for the quick response.\\r\\n\\r\\nThe subject string is\\r\\n\\r\\n\\\"## This is \\\\*great\\\\* stuff\\\"\\r\\n\\r\\nbut without the quotes.\\r\\n\\r\\nI am running version 6.1.2 with ONIG_SYNTAX_DEFAULT and ONIG_OPTION_CAPTURE_GROUP and am unable to match, though the same pattern and subject string match on Atom Node Oniguruma and on www.rubular.com\\r\\n\\r\\nIs there perhaps a difference of default options between the two?\"}, {\"author\": \"kkos\", \"body\": \"ONIG_OPTION_CAPTURE_GROUP has no effect for the pattern because it doesn't include named group.\\r\\nAt least in my environment, the string and pattern matches for ONIG_OPTION_CAPTURE_GROUP.\\r\\n\\r\\n```\\r\\n  static UChar* pattern = (UChar* )\\\"(?:^|\\\\\\\\G)(#{1,6})\\\\\\\\s*(?=[\\\\\\\\S[^#]])\\\";\\r\\n  static UChar* str = (UChar* )\\\"## This is *great* stuff\\\";\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen((char* )pattern),\\r\\n               ONIG_OPTION_CAPTURE_GROUP,\\r\\n               ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n```\"}, {\"author\": \"gundermanc\", \"body\": \"Being that it matches for you and your example in UTF8, but not for me in UTF16LE, could this be an encoding specific issue? I'll try converting my code to UTF8 and see if that mitigates the issue. By the way, if I remove the nested negative character match [^#] from the regex, it starts matching.\\r\\n\\r\\nLet me see if I can do a better job of isolating my repro.\"}, {\"author\": \"k-takata\", \"body\": \"Maybe the following change fixes the problem:\\r\\nhttps://github.com/k-takata/Onigmo/commit/609d0ea7d40a79bb1a68b9c9f73ac3067646cc9e\"}, {\"author\": \"gundermanc\", \"body\": \"That's a great suggestion, but it didn't seem to do the trick. This commit however looks related and appeared to fixe the bug for me: https://github.com/k-takata/Onigmo/commit/b5fec0b2184dd4fb9470b43dbff8817214f27cc0\"}, {\"author\": \"kkos\", \"body\": \"It is a bug for UTF-16.\\r\\nI want to fix it, but I don't have the time now.\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nFixed by PR #39.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_37", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"37\", \"title\": \"ONIG_OPTION_FIND_LONGEST both interprets regex to be greedy and skips shorter matches, need to only be greedy but not skip\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"Current behavior of ONIG_OPTION_FIND_LONGEST causes two effects:\\r\\n* regex is matched in a \\\"greedy\\\" way (the longest possible match is found at every location)\\r\\n* shorter matches are skipped by onig_match, so that it returns only the longest matches (multiples are allowed)\\r\\n\\r\\nI need it to not skip anything, but match in a greedy fashion. Is this currently possible?\\r\\nIf this is not possible, I would like to suggest to split ONIG_OPTION_FIND_LONGEST into two new options: ONIG_OPTION_GREEDY and ONIG_OPTION_ONLY_LONGEST. It's best to be able to specify different bits of behavior separately.\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I can't image the \\\"regex is matched in a \\\"greedy\\\" way\\\" or ONIG_OPTION_GREEDY.\\r\\nIs it different from a regex  which does not include any non-greedy operators.\"}, {\"author\": \"yurivict\", \"body\": \"For example, in the string ```\\\"2 km 1 km/h 5 km/h\\\"``` ```onig_search``` with regex ```\\\"[0-9]+[[:space:]](km|km/h)\\\"``` with ```ONIG_OPTION_NONE``` finds three matches: ```\\\"2 km\\\", \\\"1 km\\\"``` and ```\\\"5 km\\\"```, but with ```ONIG_OPTION_FIND_LONGEST``` the matches become greedy: ```\\\"1 km/h\\\"``` and ```\\\"5 km/h\\\"```.\\r\\n\\r\\nIt both makes group matches greedy, and only keeps the longest matches. This isn't logical that greediness of the group operator also changes, because some people might need to only get the longest matches, and some people might only need the greedy group operator, and this option does both at the same time.\"}, {\"author\": \"kkos\", \"body\": \"It is too difficult to select the longest element in alternatives at runtime.\\r\\nAnd as you know, alternative operator has priorities from the left to the right.\\r\\nI think that'll be enough for many cases.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_38", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"38\", \"title\": \"Request back port of issue #35 fix into 5.9.6\", \"author\": \"AlmightyOatmeal\", \"labels\": [], \"description\": \"I sincerely appreciate the effort that went in to resolve issue #35 but I was wondering if this could be backported into 5.9.6? The specific project that requires oniguruma is currently configured to use version 5.9.6 but I will be letting that project maintainer know that 6.1.3 is out.\\r\\n\\r\\nCheers!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"5.9.6_p1 released.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_45", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"45\", \"title\": \"Matching on streams\", \"author\": \"cpitclaudel\", \"labels\": [\"enhancement\"], \"description\": \"Hi,\\r\\n\\r\\nThis is a cross-post of https://github.com/k-takata/Onigmo/issues/83 ; I'm not sure where is would make most sense to implement this feature, or whether it would be feasible at all.\\r\\n\\r\\nHow hard would it be to extend this library to support matching on arbitrary streams, instead of strings? I'm looking for an equivalent of TRE's [`tre_reguexec`](http://laurikari.net/tre/documentation/reguexec/).\\r\\n\\r\\nThe basic idea is that the caller can pass the equivalent of an iterator over something that may not be a string.  This would make it possible to match over gap buffers, ropes, piece tables, and other string implementations that do not rely on a contiguous char array.\\r\\n\\r\\nThanks!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It is difficult for me.\\r\\nTRE uses indices to express current position of subject string, but Oniguruma uses pointers.\\r\\nTo your purpose, how about that you hack TRE?\"}, {\"author\": \"cpitclaudel\", \"body\": \"Things already work with TRE for my purpose.  My ultimate goal would be to use oniguruma as Emacs' regex engine.  The main thing that's missing at the moment is the ability to match on a gap buffer, which can essentially be thought of as two separate strings.  Maybe two strings is easier to support than arbitrary streams?\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_46", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"46\", \"title\": \"Please remove ONIG_MAX_CAPTURE_NUM and ONIGERR_TOO_MANY_CAPTURES\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"There is no need to assume that regular expressions are small and to limit something with the arbitrary number 32767.\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The capture numbers are expressed in a bytecode as short int.\"}, {\"author\": \"yurivict\", \"body\": \"Can this be expanded to 64 bit and this limit made consistent with the limit typedef?\"}, {\"author\": \"yurivict\", \"body\": \"Is it ```typedef short int MemNumType;```?\"}, {\"author\": \"k-takata\", \"body\": \"I'm really curious about your usage.\\r\\nWhat do you want to use such many capturing groups for?\\r\\nIsn't it enough using non-capturing groups `(?:foobar)`?\"}, {\"author\": \"yurivict\", \"body\": \"I use rather large regular expressions to find certain terms in texts. There are a lot of terms, lists can be arbitrarily large.\\r\\n\\r\\nIt works fine, except it hits this limit.\\r\\n\\r\\nSo I suggest you increase the limit, so that nobody has to hit it again. 16-bit vs. 32-bit field doesn't really save much performance-wise. Also please make the limit consistent with the data type.\"}, {\"author\": \"kkos\", \"body\": \"I have updated develop branch.\\r\\nNEW API: onig_set_capture_num_limit()\\r\\nThis is experimental and may put it back when my feeling changes.\\r\\n\\r\\nDefault capture number limit (32767) is not changed.\\r\\nCall onig_set_capture_num_limit(0) to be unlimited.\"}, {\"author\": \"yurivict\", \"body\": \"Thanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_47", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"47\", \"title\": \"Onig_sd.lib\", \"author\": \"nana88\", \"labels\": [], \"description\": \"Hello,\\r\\n\\r\\nI download a project, and it uses oniguruma library. It uses something like onig_sh.lib which I don't know how to export this one. Our oniguruma just have onig_s.lib. Could you help me with this one?\\r\\n\\r\\nBest Regards,\\r\\nNana,\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I can't help you.\\r\\nI don't know about onig_sh.lib.\\r\\n\\r\\n```\\r\\n[oniguruma]$ grep -r onig_s.lib *\\r\\nREADME:      src/onig_s.lib:  static link library\\r\\nREADME:  If you want to use static link library(onig_s.lib) in Win32,\\r\\nREADME.ja:      onig_s.lib:  static link library\\r\\nREADME.md:      onig_s.lib:  static link library\\r\\nREADME.md:  If you want to use static link library(onig_s.lib) in Win32,\\r\\n[oniguruma]$ \\r\\n[oniguruma]$ grep -r onig_sh.lib *\\r\\n[oniguruma]$ \\r\\n```\"}, {\"author\": \"nana88\", \"body\": \"Hello,\\r\\n\\r\\nThank you very much for your reply. I fixed the problem by copy the file onig_s.lib to onig_sh.lib. However, I faced another problem which is \\r\\n\\r\\n> Error\\t4\\terror LNK2019: unresolved external symbol _onig_error_code_to_str\\r\\n\\r\\nI use visual studio 2013 community, build the lib by run make_win32.bat.\\r\\n\\r\\nCould you guess what is the problem is?\\r\\n\\r\\nI also run the testc file and got a problem\\r\\n\\r\\n> NMAKE : fatal error U1077: '.\\\\testc.EXE' : return code '0xff'\\r\\n> Stop.\\r\\n\\r\\nBest Regards,\\r\\nNana,\"}, {\"author\": \"kkos\", \"body\": \"Is there anyone who can reproduce this problem?\\r\\nI want to close this issue.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_48", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"48\", \"title\": \"[feature request] Please have the function that returns the text of the regular expression from OnigRegex\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"This is convenient for debugging purposes. For example, I have the system that uses a lot of large pre-compiled regular expressions. When something is wrong, I need to read the regular expressions back to see what's wrong. One way is to keep their texts along with OnigRegex, but this consumes memory to store the texts just for debugging. The expressions are already there, in OnigRegex objects, but I can't read them back.\\r\\n\\r\\nPlease create the API function that will return the text of the expression in the newly allocated char* string. This will be useful primarily for debugging.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Regex pattern does not exist in OnigRegex.\"}, {\"author\": \"yurivict\", \"body\": \"Ok then, thanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_49", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"49\", \"title\": \"The beginning of the line symbol '^' doesn't work in lookahead\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"This regex ```(?<=(^|[[:space:]]))xxx``` fails: invalid pattern in look-behind(-122).\\r\\nThis regex ```(?<=^)xxx``` doesn't fail, but '^' only matches the beginning of input, not a newline inside of the input (ONIG_OPTION_MULTILINE is used).\\r\\n\\r\\nFor some reason, ```^xxx``` also only matches the beginning of input, not newlines (ONIG_OPTION_MULTILINE is used).\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think that it works on my following test normally.\\r\\n```\\r\\n$ ./anc\\r\\nmatch at 6\\r\\n0: (6-9)\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range, *end;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  UChar* pattern = (UChar* )\\\"(?<=^)xxx\\\";\\r\\n  UChar* str = (UChar* )\\\"xx\\\\nxx\\\\nxxx\\\\nxx\\\";\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen(pattern),\\r\\n               ONIG_OPTION_MULTILINE,\\r\\n               ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  end   = str + strlen(str);\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"yurivict\", \"body\": \"When ```str``` is replaced with ```\\\"xx\\\\nxxx\\\\nxxx\\\\nxx\\\"```, it only finds one occurrence:\\r\\n```\\r\\n0: (3-6)\\r\\n```\\r\\nIt should find it two times.\\r\\n\\r\\nThen, replacing pattern with ```\\\"(?<=(^|[[:space:]]))xxx\\\"``` makes the program fail:\\r\\n```\\r\\nERROR: invalid pattern in look-behind\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"onig_search() returns only first position.\\r\\nIf you want to get all postions, you have to repeat to call onig_search() by changing start argument.\\r\\nOr you can use onig_scan(). (sample/scan.c)\\r\\n\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Please use non-capturing group instead of capturing group.\\r\\n(?<=(?:^|[[:space:]]))xxx\\r\\nDifferent character length alternatives in look-behind allowed top-level only of the look-behind.\\r\\nIf you use a capturing group, the alternatives become second-level.\\r\\n\\r\\nResult:\\r\\nmatch at 6\\r\\n0: (6-9)\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_52", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"52\", \"title\": \"Segfault when matching long strings\", \"author\": \"wtlangford\", \"labels\": [], \"description\": \"Matching a string of length 160 causes a segfault in `stack_double`.\\r\\n\\r\\nMinimal case to reproduce:\\r\\n```#include <stdlib.h>\\r\\n#include <string.h>\\r\\n#include <oniguruma.h>\\r\\n\\r\\nint main(int argc, char **argv) {\\r\\n        const char *regstr = \\\".*\\\";\\r\\n        const char *inputstr =\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                \\\"aaaaaaaaaaaaaaaaaaaa\\\"\\r\\n                ;\\r\\n\\r\\n        regex_t *reg;\\r\\n        const UChar* start = (const UChar*)inputstr;\\r\\n        const UChar* end = start + strlen(inputstr);\\r\\n        int onigret = onig_new(&reg, (const UChar*)regstr, (const UChar*)regstr + strlen(regstr), ONIG_OPTION_CAPTURE_GROUP, ONIG_ENCODING_UTF8, ONIG_SYNTAX_PERL_NG, NULL);\\r\\n        OnigRegion *region = onig_region_new();\\r\\n        onig_search(reg, start, end, start, end, region, ONIG_OPTION_NONE);\\r\\n        return 0;\\r\\n}```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think this is fixed at master head by PR #51.\"}, {\"author\": \"wtlangford\", \"body\": \"Ah, I should have checked this. I'll check against master when I have the\\nchance.\\n\\nOn Sat, Apr 1, 2017, 22:33 K.Kosako <notifications@github.com> wrote:\\n\\n> I think this is fixed at master head by PR #51\\n> <https://github.com/kkos/oniguruma/pull/51>.\\n>\\n> ‚Äî\\n> You are receiving this because you authored the thread.\\n> Reply to this email directly, view it on GitHub\\n> <https://github.com/kkos/oniguruma/issues/52#issuecomment-290960560>, or mute\\n> the thread\\n> <https://github.com/notifications/unsubscribe-auth/ADQ4V7hTsUYDmwRgyomAr8EPZlVf2OAOks5rrwkQgaJpZM4Mwovh>\\n> .\\n>\\n\"}, {\"author\": \"wtlangford\", \"body\": \"Yes, this is fixed by PR #51.  My bad.  Closing.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_53", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"53\", \"title\": \"Make error; SyntaxError: Unexpected token {\", \"author\": \"themmes\", \"labels\": [], \"description\": \"Trying to `make` Moonbase (see <https://github.com/motif/moonbase>) i stumbled upon a syntax error in Oniguruma\\r\\n\\r\\n```\\r\\nDistributor ID:\\tUbuntu\\r\\nDescription:\\tUbuntu 16.04.2 LTS\\r\\nRelease:\\t16.04\\r\\nCodename:\\txenial\\r\\n\\r\\nnodejs --version\\r\\nv4.2.6\\r\\n\\r\\ngulp --version\\r\\n[22:14:20] CLI version 1.3.0\\r\\n```\\r\\n\\r\\nBut got the following error; `SyntaxError: Unexpected token {`\\r\\n\\r\\n```\\r\\n   __  ___               __\\r\\n  /  |/  /__  ___  ___  / /  ___ ____ ___\\r\\n / /|_/ / _ \\\\/ _ \\\\/ _ \\\\/ _ \\\\/ _ `(_-</ -_)\\r\\n/_/  /_/\\\\___/\\\\___/_//_/_.__/\\\\_,_/___/\\\\__/\\r\\n\\r\\n[22:08:15] Running watch for /home/tom/landing\\r\\n/home/tom/landing/node_modules/oniguruma/src/oniguruma.js:1\\r\\n(function (exports, require, module, __filename, __dirname) { const {OnigScanner, OnigString} = require('../build/Release/onig_scanner.node')\\r\\n                                                                    ^\\r\\n\\r\\nSyntaxError: Unexpected token {\\r\\n    at exports.runInThisContext (vm.js:53:16)\\r\\n    at Module._compile (module.js:374:25)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/grammar.js:10:16)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/grammar.js:380:4)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/grammar-registry.js:12:13)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/grammar-registry.js:268:4)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/first-mate.js:4:22)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/first-mate/lib/first-mate.js:8:4)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/highlights/lib/highlights.js:14:21)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/highlights/lib/highlights.js:420:4)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/moonbase/gulpfile.coffee:43:14)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/moonbase/gulpfile.coffee:1:1)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.loadFile (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:16:19)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/moonbase/run.coffee:46:12)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/moonbase/run.coffee:3:1)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.loadFile (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:16:19)\\r\\n    at Module.load (/home/tom/landing/node_modules/coffee-script/lib/coffee-script/register.js:45:36)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Module.require (module.js:354:17)\\r\\n    at require (internal/module.js:12:17)\\r\\n    at Object.<anonymous> (/home/tom/landing/node_modules/moonbase/run.js:4:11)\\r\\n    at Module._compile (module.js:410:26)\\r\\n    at Object.Module._extensions..js (module.js:417:10)\\r\\n    at Module.load (module.js:344:32)\\r\\n    at Function.Module._load (module.js:301:12)\\r\\n    at Function.Module.runMain (module.js:442:10)\\r\\n    at startup (node.js:136:18)\\r\\n    at node.js:966:3\\r\\n\\r\\nMakefile:20: recipe for target 'watch' failed\\r\\nmake: *** [watch] Error 1\\r\\n```\\r\\n\\r\\nDo you think you can help me out? Would love to experiment with your project, thanks in advance!\", \"comments\": [{\"author\": \"iwillspeak\", \"body\": \"This repo is the underlying native library. It looks like that error is coming from some JavaScript code. I think https://github.com/atom/node-oniguruma might be the source.\"}, {\"author\": \"themmes\", \"body\": \"Thanks for pointing me in the right direction!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_54", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"54\", \"title\": \"Infinite recursion within get_min_match_length() leads to SEGV\", \"author\": \"xixabangm4\", \"labels\": [], \"description\": \"Please see if still relevant, reproduce on PHP stable release.\\r\\n\\r\\nSolved & closed.\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I have fixed it at version 6.1.0\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_55", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"55\", \"title\": \"Heap corruption in next_state_val() in 15 encodings\", \"author\": \"xixabangm4\", \"labels\": [], \"description\": \"This heap corruption is due to a different cause than issue #18 and #21 , the following is found after applying the patches of both. The issue affects latest PHP 5/7 installations with mbstring enabled, when the regular expression is from network, this can be considered as a security issue. \\r\\n\\r\\nTested on 32-bit ASAN build, one of the 15 encodings below would cause an out-of-bound write:\\r\\n\\r\\n$ cat mb_regex_min.php\\r\\n```\\r\\n<?php \\r\\nif (!extension_loaded('mbstring')) print \\\"mbstring not loaded.\\\\n\\\";\\r\\nif (!function_exists('mb_regex_encoding')) print \\\"mb_regex_encoding() is not available\\\\n\\\";\\r\\nif (!function_exists('mb_ereg_search_pos')) print \\\"mb_ereg_search_pos() is not available\\\\n\\\";\\r\\nif (!function_exists('mb_ereg_search_init')) print \\\"mb_ereg_search_init() is not available\\\\n\\\";\\r\\n$encoding = array(\\r\\n                  'ASCII',\\r\\n                  'ISO-8859-1',\\r\\n                  'ISO-8859-2',\\r\\n                  'ISO-8859-3',\\t\\r\\n                  'ISO-8859-4',\\r\\n                  'ISO-8859-5',\\r\\n                  'ISO-8859-6',\\r\\n                  'ISO-8859-7',\\r\\n                  'ISO-8859-8',\\t\\r\\n                  'ISO-8859-9',\\r\\n                  'ISO-8859-10',\\r\\n                  'ISO-8859-13',\\r\\n                  'ISO-8859-14',\\r\\n                  'ISO-8859-15',\\r\\n                  'KOI8-R');\\r\\n\\r\\n$enc_id = rand(0, count($encoding));\\r\\necho \\\"*** testing encoding \\\" . $encoding[$enc_id] . \\\" ***\\\\n\\\";\\r\\nmb_regex_encoding($encoding[$enc_id]);\\r\\nif(mb_ereg_search_init(\\\"a\\\")) {\\r\\n    var_dump(mb_ereg_search_pos('[\\\\\\\\6000'));\\r\\n}\\r\\n?>\\r\\n```\\r\\n\\r\\n$ bin/php mb_regex_min.php\\r\\n```\\r\\n=================================================================\\r\\n==20048== ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb540d948 at pc 0x9e384dc bp 0xbfbc8948 sp 0xbfbc893c\\r\\nREAD of size 4 at 0xb540d948 thread T0\\r\\n    #0 0x9e384db in next_state_val /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:4087\\r\\n    #1 0x9e47185 in parse_char_class /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:4306\\r\\n    #2 0x9e85627 in parse_exp /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5272\\r\\n    #3 0x9ea4210 in parse_branch /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5437\\r\\n    #4 0x9ea57ee in parse_subexp /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5474\\r\\n    #5 0x9ea7ed2 in parse_regexp /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5518\\r\\n    #6 0x9ea7ed2 in onig_parse_make_tree /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5545\\r\\n    #7 0x9d62da8 in onig_compile /home/xie/php-7.1.5/ext/mbstring/oniguruma/regcomp.c:5305\\r\\n    #8 0x9d75ba1 in onig_new /home/xie/php-7.1.5/ext/mbstring/oniguruma/regcomp.c:5550\\r\\n    #9 0xa1b197b in php_mbregex_compile_pattern /home/xie/php-7.1.5/ext/mbstring/php_mbregex.c:456\\r\\n    #10 0xa1d70a4 in _php_mb_regex_ereg_search_exec /home/xie/php-7.1.5/ext/mbstring/php_mbregex.c:1241\\r\\n    #11 0xa1d70a4 in zif_mb_ereg_search_pos /home/xie/php-7.1.5/ext/mbstring/php_mbregex.c:1331\\r\\n    #12 0xc540ded in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/xie/php-7.1.5/Zend/zend_vm_execute.h:675\\r\\n    #13 0xc3afba1 in execute_ex /home/xie/php-7.1.5/Zend/zend_vm_execute.h:429\\r\\n    #14 0xcf50612 in zend_execute /home/xie/php-7.1.5/Zend/zend_vm_execute.h:474\\r\\n    #15 0xbcb52df in zend_execute_scripts /home/xie/php-7.1.5/Zend/zend.c:1476\\r\\n    #16 0xb3fd433 in php_execute_script /home/xie/php-7.1.5/main/main.c:2537\\r\\n    #17 0xcf6e3b1 in do_cli /home/xie/php-7.1.5/sapi/cli/php_cli.c:993\\r\\n    #18 0x811a9f6 in main /home/xie/php-7.1.5/sapi/cli/php_cli.c:1381\\r\\n    #19 0xb5fbba82 (/lib/i386-linux-gnu/libc.so.6+0x19a82)\\r\\n    #20 0x811c8b0 in _start (/home/xie/php_fuzz/bin/php+0x811c8b0)\\r\\n0xb540d948 is located 8 bytes to the left of 44-byte region [0xb540d950,0xb540d97c)\\r\\nallocated by thread T0 here:\\r\\n    #0 0xb61ca854 (/usr/lib/i386-linux-gnu/libasan.so.0+0x16854)\\r\\n    #1 0x9ea61a3 in node_new /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:1120\\r\\n    #2 0x9ea61a3 in onig_node_new_alt /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:1257\\r\\n    #3 0x9ea61a3 in parse_subexp /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:5492\\r\\n    #4 0x3fffffff (+0x17ffffff)\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/xie/php-7.1.5/ext/mbstring/oniguruma/regparse.c:4118 next_state_val\\r\\nShadow bytes around the buggy address:\\r\\n  0x36a81ad0: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81ae0: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81af0: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81b00: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81b10: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n=>0x36a81b20: fa fa 00 00 00 00 00 04 fa[fa]00 00 00 00 00 04\\r\\n  0x36a81b30: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81b40: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 04\\r\\n  0x36a81b50: fa fa 00 00 00 00 00 04 fa fa 00 00 00 00 00 00\\r\\n  0x36a81b60: fa fa 00 00 00 00 00 00 fa fa fd fd fd fd fd fa\\r\\n  0x36a81b70: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:     fa\\r\\n  Heap righ redzone:     fb\\r\\n  Freed Heap region:     fd\\r\\n  Stack left redzone:    f1\\r\\n  Stack mid redzone:     f2\\r\\n  Stack right redzone:   f3\\r\\n  Stack partial redzone: f4\\r\\n  Stack after return:    f5\\r\\n  Stack use after scope: f8\\r\\n  Global redzone:        f9\\r\\n  Global init order:     f6\\r\\n  Poisoned by user:      f7\\r\\n  ASan internal:         fe\\r\\n==20048== ABORTING\\r\\nAborted\\r\\n```\\r\\n\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I have fixed it in develop branch.\"}, {\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9226 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9226\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_56", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"56\", \"title\": \"Buffer Overflow in onigenc_unicode_get_case_fold_codes_by_str()\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"This buffer overflow is found in the latest develop branch with the code:\\r\\n\\r\\n```c\\r\\n#include <oniguruma.h>\\r\\nint main() {\\r\\n    regex_t *reg;\\r\\n    const OnigUChar* inp = (const OnigUChar*)\\\"\\\\x3f\\\\xff\\\\x63\\\\x7f\\\\xff\\\\xff\\\\xff\\\\xff\\\\x4d\\\\x22\\\\x00\\\\x00\\\";\\r\\n    if (onig_new\\r\\n        (&reg, inp, inp+12,ONIG_OPTION_IGNORECASE , ONIG_ENCODING_UTF32_BE,\\r\\n         ONIG_SYNTAX_DEFAULT, 0) == 0)\\r\\n        onig_free(reg);\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\nError reported in asan:\\r\\n\\r\\n```\\r\\n =================================================================\\r\\n==1944==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffc56669ea4 at pc 0x0000004483f9 bp 0x7ffc56669aa0 sp 0x7ffc56669a90\\r\\nWRITE of size 4 at 0x7ffc56669ea4 thread T0\\r\\n    #0 0x4483f8 in onigenc_unicode_get_case_fold_codes_by_str /home/xie/Downloads/oni/oni-asan-dev/src/unicode.c:553\\r\\n    #1 0x44354b in utf32be_get_case_fold_codes_by_str /home/xie/Downloads/oni/oni-asan-dev/src/utf32_be.c:170\\r\\n    #2 0x4318c5 in expand_case_fold_string /home/xie/Downloads/oni/oni-asan-dev/src/regcomp.c:3431\\r\\n    #3 0x432279 in setup_tree /home/xie/Downloads/oni/oni-asan-dev/src/regcomp.c:3733\\r\\n    #4 0x43c41f in onig_compile /home/xie/Downloads/oni/oni-asan-dev/src/regcomp.c:5361\\r\\n    #5 0x43d092 in onig_new /home/xie/Downloads/oni/oni-asan-dev/src/regcomp.c:5565\\r\\n    #6 0x401082 in main /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:5\\r\\n    #7 0x7f4ca3cc682f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #8 0x400ec8 in _start (/home/xie/Downloads/oni/oni-asan-dev/test/testc+0x400ec8)\\r\\n\\r\\nAddress 0x7ffc56669ea4 is located in stack of thread T0 at offset 420 in frame\\r\\n    #0 0x43160b in expand_case_fold_string /home/xie/Downloads/oni/oni-asan-dev/src/regcomp.c:3411\\r\\n\\r\\n  This frame has 3 object(s):\\r\\n    [32, 40) 'prev_node'\\r\\n    [96, 104) 'srem'\\r\\n    [160, 420) 'items' <== Memory access at offset 420 overflows this variable\\r\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\r\\n      (longjmp and C++ exceptions *are* supported)\\r\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/xie/Downloads/oni/oni-asan-dev/src/unicode.c:553 onigenc_unicode_get_case_fold_codes_by_str\\r\\nShadow bytes around the buggy address:\\r\\n  0x10000acc5380: 00 00 f4 f4 f3 f3 f3 f3 00 00 00 00 00 00 00 00\\r\\n  0x10000acc5390: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10000acc53a0: f1 f1 f1 f1 00 f4 f4 f4 f2 f2 f2 f2 00 f4 f4 f4\\r\\n  0x10000acc53b0: f2 f2 f2 f2 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10000acc53c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n=>0x10000acc53d0: 00 00 00 00[04]f4 f4 f4 f3 f3 f3 f3 00 00 00 00\\r\\n  0x10000acc53e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10000acc53f0: 00 00 00 00 00 00 f1 f1 f1 f1 04 f4 f4 f4 f3 f3\\r\\n  0x10000acc5400: f3 f3 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1\\r\\n  0x10000acc5410: f1 f1 00 f4 f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2\\r\\n  0x10000acc5420: f2 f2 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==1944==ABORTING\\r\\n```\", \"comments\": [{\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9225 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9225\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_57", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"57\", \"title\": \"Buffer Overflow in match_at()\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"The buffer-overflow is found with the code:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n               apttern_end,\\r\\n               options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\nint main() {\\r\\n    regex_t *reg;\\r\\n    unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n    unsigned char input[] = {0xf1, 0x5c, 0x69, 0x53, 0x53, 0x53, 0x53, 0x3c, 0x30, 0x53, \\r\\n\\t0x59, 0x54, 0x52, 0x33, 0x7c, 0x2e, 0x5c, 0xe2, 0x48, 0x5c, 0x7a, 0x53, 0x00, \\r\\n\\t0x06, 0x00, 0x00, 0x27, 0x19, 0x00, 0x54, 0x52, 0x54, 0x52, 0x33, 0x7c, 0x2e, 0x53, 0xe2, 0x48};\\r\\n    int r = exec( ONIG_ENCODING_SJIS ,ONIG_OPTION_IGNORECASE , (char*)input,input+39, (char*) str,str+7 );\\r\\n        return 0;\\r\\n}\\r\\n```\\r\\n\\r\\nThe asan err can be found as follows:\\r\\n```\\r\\n==4064==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffdd18d5447 at pc 0x00000044434c bp 0x7ffdd18d4910 sp 0x7ffdd18d4900\\r\\nREAD of size 1 at 0x7ffdd18d5447 thread T0\\r\\n    #0 0x44434b in match_at /home/xie/Downloads/oni/oni-asan-dev/src/regexec.c:1481\\r\\n    #1 0x457fdf in onig_search /home/xie/Downloads/oni/oni-asan-dev/src/regexec.c:3651\\r\\n    #2 0x401148 in search /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:18\\r\\n    #3 0x401786 in exec /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:65\\r\\n    #4 0x401a02 in main /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:77\\r\\n    #5 0x7f9bd023582f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #6 0x400f68 in _start (/home/xie/Downloads/oni/oni-asan-dev/test/testc+0x400f68)\\r\\n\\r\\nAddress 0x7ffdd18d5447 is located in stack of thread T0 at offset 39 in frame\\r\\n    #0 0x40186f in main /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:71\\r\\n\\r\\n  This frame has 2 object(s):\\r\\n    [32, 39) 'str' <== Memory access at offset 39 overflows this variable\\r\\n    [96, 135) 'input'\\r\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\r\\n      (longjmp and C++ exceptions *are* supported)\\r\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/xie/Downloads/oni/oni-asan-dev/src/regexec.c:1481 match_at\\r\\nShadow bytes around the buggy address:\\r\\n  0x10003a312a30: 00 00 00 00 00 00 00 00 00 00 00 02 f3 f3 f3 f3\\r\\n  0x10003a312a40: f3 f3 f3 f3 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10003a312a50: 00 00 00 00 f1 f1 f1 f1 00 f4 f4 f4 f2 f2 f2 f2\\r\\n  0x10003a312a60: 00 00 00 f4 f2 f2 f2 f2 00 00 00 00 00 00 00 00\\r\\n  0x10003a312a70: 00 00 00 02 f3 f3 f3 f3 f3 f3 f3 f3 00 00 00 00\\r\\n=>0x10003a312a80: 00 00 00 00 f1 f1 f1 f1[07]f4 f4 f4 f2 f2 f2 f2\\r\\n  0x10003a312a90: 00 00 00 00 07 f4 f4 f4 f3 f3 f3 f3 00 00 00 00\\r\\n  0x10003a312aa0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10003a312ab0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10003a312ac0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10003a312ad0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==4064==ABORTING\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9224 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9224\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_58", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"58\", \"title\": \"Bug in mbc_enc_len\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"The buffer overflow is found with the following code:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n               apttern_end,\\r\\n               options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\nint main() {\\r\\n    regex_t *reg;\\r\\n    unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n    unsigned char input[] = { 0x6a, 0x00, 0x01, 0x6c, 0x7b, 0x00, 0x01, 0x6c, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32,\\r\\n        0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b,\\r\\n        0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x6a, 0x00, 0x01, 0x6c, 0x7b,\\r\\n        0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d, 0x1d,\\r\\n        0x1d, 0x1d, 0x1d, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b,\\r\\n        0x32, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b, 0x32, 0x7d, 0x7b, 0x32, 0x32, 0x7d, 0x7b,\\r\\n        0x32, 0x32, 0x7d, 0x7b, 0x32, 0x7d};\\r\\n    int r = exec( ONIG_ENCODING_UTF8,ONIG_OPTION_IGNORECASE , (char*)input,input+95, (char*) str,str+7 );\\r\\n        return 0;\\r\\n}\\r\\n```\\r\\nasan error can be found:\\r\\n```\\r\\n==7085==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffed35e53c7 at pc 0x00000045e958 bp 0x7ffed35e4df0 sp 0x7ffed35e4de0\\r\\nREAD of size 1 at 0x7ffed35e53c7 thread T0\\r\\n    #0 0x45e957 in mbc_enc_len /home/xie/Downloads/oni/oni-asan-dev/src/utf8.c:66\\r\\n    #1 0x455c8d in forward_search_range /home/xie/Downloads/oni/oni-asan-dev/src/regexec.c:3162\\r\\n    #2 0x457c56 in onig_search /home/xie/Downloads/oni/oni-asan-dev/src/regexec.c:3614\\r\\n    #3 0x401138 in search /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:18\\r\\n    #4 0x401776 in exec /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:65\\r\\n    #5 0x401b41 in main /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:81\\r\\n    #6 0x7f6fd15bd82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #7 0x400f58 in _start (/home/xie/Downloads/oni/oni-asan-dev/test/testc+0x400f58)\\r\\n\\r\\nAddress 0x7ffed35e53c7 is located in stack of thread T0 at offset 39 in frame\\r\\n    #0 0x40185f in main /home/xie/Downloads/oni/oni-asan-dev/test/testc.c:71\\r\\n\\r\\n  This frame has 2 object(s):\\r\\n    [32, 39) 'str' <== Memory access at offset 39 overflows this variable\\r\\n    [96, 191) 'input'\\r\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\r\\n      (longjmp and C++ exceptions *are* supported)\\r\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/xie/Downloads/oni/oni-asan-dev/src/utf8.c:66 mbc_enc_len\\r\\nShadow bytes around the buggy address:\\r\\n  0x10005a6b4a20: 00 00 00 00 00 00 00 00 00 00 00 02 f3 f3 f3 f3\\r\\n  0x10005a6b4a30: f3 f3 f3 f3 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005a6b4a40: 00 00 00 00 f1 f1 f1 f1 00 f4 f4 f4 f2 f2 f2 f2\\r\\n  0x10005a6b4a50: 00 00 00 f4 f2 f2 f2 f2 00 00 00 00 00 00 00 00\\r\\n  0x10005a6b4a60: 00 00 00 02 f3 f3 f3 f3 f3 f3 f3 f3 00 00 00 00\\r\\n=>0x10005a6b4a70: 00 00 00 00 f1 f1 f1 f1[07]f4 f4 f4 f2 f2 f2 f2\\r\\n  0x10005a6b4a80: 00 00 00 00 00 00 00 00 00 00 00 07 f3 f3 f3 f3\\r\\n  0x10005a6b4a90: f3 f3 f3 f3 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005a6b4aa0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005a6b4ab0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005a6b4ac0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==7085==ABORTING\\r\\n\\r\\n```\\r\\n\\r\\n\", \"comments\": [{\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9227 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9227\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_59", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"59\", \"title\": \"SIGSEGV in left_adjust_char_head() due to bad dereference\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"Test code:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n               apttern_end,\\r\\n               options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\nint main() {\\r\\n    static unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n     OnigUChar* inp = (const OnigUChar*) \\\"\\\\x00\\\\x7c\\\\x2e\\\\x7b\\\\x39\\\\x7d\\\\x7b\\\\x39\\\\x30\\\\x7d\\\\x7b\\\\x39\\\\x7d\\\\x7b\\\\x2c\\\\x39\\\\x30\\\\x30\\\\x7d\\\\x30\\\";\\r\\n    int r = exec( ONIG_ENCODING_EUC_JP, ONIG_OPTION_NONE, inp, inp+20, (char *) str, str+7 );\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\nASAN output:\\r\\n```\\r\\n=================================================================\\r\\n==26842==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000045eef4 bp 0x7ffe5a633330 sp 0x7ffe5a633310 T0)\\r\\n    #0 0x45eef3 in left_adjust_char_head /home/xie/Downloads/oni/oni-asan-develop/src/euc_jp.c:194\\r\\n    #1 0x45914a in onigenc_get_right_adjust_char_head_with_prev /home/xie/Downloads/oni/oni-asan-develop/src/regenc.c:78\\r\\n    #2 0x4561ba in forward_search_range /home/xie/Downloads/oni/oni-asan-develop/src/regexec.c:3240\\r\\n    #3 0x457930 in onig_search /home/xie/Downloads/oni/oni-asan-develop/src/regexec.c:3611\\r\\n    #4 0x401148 in search /home/xie/Downloads/oni/oni-asan-develop/test/testc.c:15\\r\\n    #5 0x401786 in exec /home/xie/Downloads/oni/oni-asan-develop/test/testc.c:62\\r\\n    #6 0x40189e in main /home/xie/Downloads/oni/oni-asan-develop/test/testc.c:71\\r\\n    #7 0x7fd6ce5c682f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #8 0x400f68 in _start (/home/xie/Downloads/oni/oni-asan-develop/test/testc+0x400f68)\\r\\n\\r\\nAddressSanitizer can not provide additional info.\\r\\nSUMMARY: AddressSanitizer: SEGV /home/xie/Downloads/oni/oni-asan-develop/src/euc_jp.c:194 left_adjust_char_head\\r\\n==26842==ABORTING\\r\\n```\\r\\nIn regcomp.c:4995\\r\\n```c\\r\\nstatic void\\r\\nset_optimize_map_info(regex_t* reg, OptMapInfo* m)\\r\\n{\\r\\n  int i;\\r\\n\\r\\n  for (i = 0; i < ONIG_CHAR_TABLE_SIZE; i++)\\r\\n    reg->map[i] = m->map[i];\\r\\n\\r\\n  reg->optimize   = ONIG_OPTIMIZE_MAP;\\r\\n  reg->dmin       = m->mmd.min;\\r\\n  reg->dmax       = m->mmd.max;  **// set as 19683000**\\r\\n\\r\\n  if (reg->dmin != ONIG_INFINITE_DISTANCE) {\\r\\n    reg->threshold_len = reg->dmin + 1;\\r\\n  }\\r\\n}\\r\\n```\\r\\nLater reg->dmax is used in pointer arithmetic at forward_search_range, resulting in a bad reference from regexec.c:3238\\r\\n```c\\r\\n      if (reg->dmax != ONIG_INFINITE_DISTANCE) {\\r\\n        *low = p - reg->dmax;\\r\\n        if (*low > s) {\\r\\n          *low = onigenc_get_right_adjust_char_head_with_prev(reg->enc, s,\\r\\n                                          *low, (const UChar** )low_prev);\\r\\n          if (low_prev && IS_NULL(*low_prev))\\r\\n            *low_prev = onigenc_get_prev_char_head(reg->enc,\\r\\n                                                   (pprev ? pprev : s), *low);\\r\\n        }\\r\\n```\\r\\nBad dereference:\\r\\n```\\r\\n(gdb) r\\r\\nStarting program: /home/xie/Downloads/oni/oni-asan-develop/test/testc \\r\\n[Thread debugging using libthread_db enabled]\\r\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\r\\n\\r\\nProgram received signal SIGSEGV, Segmentation fault.\\r\\n0x000000000045eef4 in left_adjust_char_head (start=0x66b140 <str> \\\"\\\\307\\\\326\\\\376\\\\352\\\\340\\\", <incomplete sequence \\\\342>, s=0xffffffffff3a5a8e <error: Cannot access memory at address 0xffffffffff3a5a8e>)\\r\\n    at euc_jp.c:194\\r\\n194\\t  while (!eucjp_islead(*p) && p > start) p--;\\r\\n(gdb) \\r\\n```\", \"comments\": [{\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9229 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9229\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_60", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"60\", \"title\": \"Heap corruption in next_state_val() due to uninitialized local variable\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"The following non-deterministic behavior can be triggered from the following code. With ASAN enabled, on 64-bit platform, the crash reproduces within 3-10 runs. \\r\\n\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* astr,  int pattern_len,\\r\\n    unsigned char *end, OnigSyntaxType* sytax)\\r\\n{\\r\\n    int r;\\r\\n    regex_t* reg;\\r\\n    OnigErrorInfo einfo;\\r\\n    UChar* pattern = (UChar* )apattern;\\r\\n    UChar* str     = (UChar* )astr;\\r\\n\\r\\n    onig_initialize(&enc, 1);\\r\\n\\r\\n    r = onig_new(&reg, pattern,\\r\\n                 pattern + pattern_len,\\r\\n                 options, enc, sytax , &einfo);\\r\\n    if (r != ONIG_NORMAL) {\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str(s, r, &einfo);\\r\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n        return -1;\\r\\n    }\\r\\n\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n    int r;\\r\\n    /* ISO 8859-1 test */\\r\\n    static unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n\\r\\n    char* pattern = \\\"\\\\x5b\\\\x5c\\\\x48\\\\x2d\\\\xb0\\\\x30\\\\x8d\\\\x30\\\\x2a\\\\x5b\\\\x5d\\\\x20\\\\x20\\\\x5d\\\"\\r\\n        \\\"\\\\xf9\\\\x54\\\\x00\\\\x7f\\\\x5c\\\\x63\\\\xef\\\\xef\\\\xef\\\\xef\\\\x52\\\\xf7\\\\xf7\\\\x52\\\"\\r\\n        \\\"\\\\xf7\\\\xeb\\\\xeb\\\\x70\\\\x2b\\\\xf7\\\\x7b\\\\x30\\\\x2c\\\\x32\\\\x7d\\\";\\r\\n\\r\\n    r = exec(ONIG_ENCODING_GB18030, ONIG_OPTION_IGNORECASE,pattern, (char*) str, 39, str + 7, ONIG_SYNTAX_DEFAULT);\\r\\n    r = exec(ONIG_ENCODING_GB18030, ONIG_OPTION_IGNORECASE,pattern, (char*) str, 39, str + 7, ONIG_SYNTAX_DEFAULT);\\r\\n\\r\\n    return r;\\r\\n}\\r\\n```\\r\\nWith some add-on:\\r\\n```c\\r\\nstatic int\\r\\nparse_char_class(Node** np, OnigToken* tok, UChar** src, UChar* end,\\r\\n\\t\\t ScanEnv* env)\\r\\n{\\r\\n  int r, neg, len, fetched, and_start;\\r\\n  OnigCodePoint v, vs;\\r\\n  UChar *p;\\r\\n  Node* node;\\r\\n  CClassNode *cc, *prev_cc;\\r\\n  CClassNode work_cc;\\r\\n\\r\\n  printf(\\\"*vs (init) = %lu\\\\n\\\", (unsigned long)vs);\\r\\n```\\r\\n\\r\\n```c\\r\\nstatic void\\r\\nbitset_set_range(BitSetRef bs, int from, int to)\\r\\n{\\r\\n  int i;\\r\\n  for (i = from; i <= to && i < SINGLE_BYTE_SIZE; i++) {\\r\\n    fprintf(stderr, \\\"bs=%p, i=%lu\\\\n\\\", (unsigned int*)bs, i);\\r\\n    BITSET_SET_BIT(bs, i);\\r\\n  }\\r\\n}\\r\\n```\\r\\nASAN report:\\r\\n```\\r\\n*vs (init) = 2953750392\\r\\n*vs (from) = 2953750392, v=2955971888\\r\\nbs=0x60600000ef08, i=2953750392\\r\\nASAN:SIGSEGV\\r\\n=================================================================\\r\\n==22101==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x0000004030d0 bp 0x7ffe925592c0 sp 0x7ffe925592a0 T0)\\r\\n    #0 0x4030cf in bitset_set_range /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:203\\r\\n    #1 0x419b72 in next_state_val /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:4142\\r\\n    #2 0x41ab77 in parse_char_class /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:4329\\r\\n    #3 0x41f7b6 in parse_exp /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:5174\\r\\n    #4 0x420728 in parse_branch /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:5339\\r\\n    #5 0x420bae in parse_subexp /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:5385\\r\\n    #6 0x420fc8 in parse_regexp /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:5433\\r\\n    #7 0x421454 in onig_parse_make_tree /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:5464\\r\\n    #8 0x43de89 in onig_compile /home/xie/Downloads/oni/onig-test-develop/src/regcomp.c:5326\\r\\n    #9 0x43ed8b in onig_new /home/xie/Downloads/oni/onig-test-develop/src/regcomp.c:5565\\r\\n    #10 0x4011d8 in exec /home/xie/Downloads/oni/onig-test-develop/test/testc.c:17\\r\\n    #11 0x4013f6 in main /home/xie/Downloads/oni/onig-test-develop/test/testc.c:43\\r\\n    #12 0x7f62aebd082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #13 0x400f98 in _start (/home/xie/Downloads/oni/onig-test-develop/test/testc+0x400f98)\\r\\n\\r\\nAddressSanitizer can not provide additional info.\\r\\nSUMMARY: AddressSanitizer: SEGV /home/xie/Downloads/oni/onig-test-develop/src/regparse.c:203 bitset_set_range\\r\\n==22101==ABORTING\\r\\n```\\r\\nThe probabilistic reproducer triggers a heap OOB write when the local variable OnigCodePoint vs in parse_char_class() is not initialized, following the call as:\\r\\n\\r\\nparse_char_class() -> next_state_val() -> bitset_set_range()\\r\\n\\r\\nresulting in the said crash.\\r\\n\\r\\nNote the calls to exec() is currently necessary to trigger the crash.\", \"comments\": [{\"author\": \"xixabangm4\", \"body\": \"Thanks, please use CVE-2017-9228 to reference this issue.\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9228\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_61", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"61\", \"title\": \"Use after free in match_at()\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"The test code:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\nstatic int\\r\\nscan_callback(int n, int r, OnigRegion* region, void* arg)\\r\\n{\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nscan(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  r = onig_scan(reg, str, end, region, ONIG_OPTION_NONE, scan_callback, NULL);\\r\\n  if (r >= 0) {\\r\\n    fprintf(stdout, \\\"total: %d match\\\\n\\\", r);\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((OnigUChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* astr,  int pattern_len,\\r\\n    unsigned char *end, OnigSyntaxType* sytax)\\r\\n{\\r\\n    int r;\\r\\n    regex_t* reg;\\r\\n    OnigErrorInfo einfo;\\r\\n    UChar* pattern = (UChar* )apattern;\\r\\n    UChar* str     = (UChar* )astr;\\r\\n\\r\\n    onig_initialize(&enc, 1);\\r\\n\\r\\n    r = onig_new(&reg, pattern,\\r\\n                 pattern + pattern_len,\\r\\n                 options, enc, sytax , &einfo);\\r\\n    if (r != ONIG_NORMAL) {\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str(s, r, &einfo);\\r\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n        return -1;\\r\\n    }\\r\\n\\r\\n    r = scan(reg, str, end);\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n    int r;\\r\\n    /* ISO 8859-1 test */\\r\\n    static unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n    char* pattern =\\\"\\\\x28\\\\x7c\\\\x28\\\\x00\\\\x28\\\\x3f\\\\x3a\\\\x5c\\\\x67\\\\x27\\\\x31\\\\x27\\\\x29\\\\x2a\\\\x7c\\\\x7c\\\\x28\\\\x29\\\\x29\\\\x2a\\\\x7c\\\\x28\\\\x28\\\\x28\\\\x28\\\\x29\\\\x29\\\\x29\\\\x5c\\\\x6b\\\\x27\\\\x31\\\\x2d\\\\x30\\\\x27\\\\x29\\\\x29\\\\x30\\\\x7c\\\";\\r\\n    r = exec(ONIG_ENCODING_EUC_JP,ONIG_OPTION_NONE,pattern,(char*) str,39, (char*) str + 7, ONIG_SYNTAX_DEFAULT);\\r\\n    return r;\\r\\n}\\r\\n```\\r\\n\\r\\nAsan error:\\r\\n```\\r\\n=================================================================\\r\\n==10708==ERROR: AddressSanitizer: heap-use-after-free on address 0x62700001b9a0 at pc 0x00000044c760 bp 0x7ffcb93f6de0 sp 0x7ffcb93f6dd0\\r\\nREAD of size 8 at 0x62700001b9a0 thread T0\\r\\n    #0 0x44c75f in match_at /home/xie/Downloads/oniguruma-develop/src/regexec.c:2437\\r\\n    #1 0x457cb3 in onig_search /home/xie/Downloads/oniguruma-develop/src/regexec.c:3655\\r\\n    #2 0x458905 in onig_scan /home/xie/Downloads/oniguruma-develop/src/regexec.c:3790\\r\\n    #3 0x40117d in scan /home/xie/Downloads/oniguruma-develop/test/testu.c:17\\r\\n    #4 0x4014e3 in exec /home/xie/Downloads/oniguruma-develop/test/testu.c:55\\r\\n    #5 0x40162a in main /home/xie/Downloads/oniguruma-develop/test/testu.c:67\\r\\n    #6 0x7f6af4b4082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #7 0x400fa8 in _start (/home/xie/Downloads/oniguruma-develop/test/testcu+0x400fa8)\\r\\n\\r\\n0x62700001b9a0 is located 12448 bytes inside of 12912-byte region [0x627000018900,0x62700001bb70)\\r\\nfreed by thread T0 here:\\r\\n    #0 0x7f6af4f81961 in realloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98961)\\r\\n    #1 0x4412a6 in stack_double /home/xie/Downloads/oniguruma-develop/src/regexec.c:494\\r\\n    #2 0x44958d in match_at /home/xie/Downloads/oniguruma-develop/src/regexec.c:2148\\r\\n    #3 0x457cb3 in onig_search /home/xie/Downloads/oniguruma-develop/src/regexec.c:3655\\r\\n    #4 0x458905 in onig_scan /home/xie/Downloads/oniguruma-develop/src/regexec.c:3790\\r\\n    #5 0x40117d in scan /home/xie/Downloads/oniguruma-develop/test/testu.c:17\\r\\n    #6 0x4014e3 in exec /home/xie/Downloads/oniguruma-develop/test/testu.c:55\\r\\n    #7 0x40162a in main /home/xie/Downloads/oniguruma-develop/test/testu.c:67\\r\\n    #8 0x7f6af4b4082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n\\r\\npreviously allocated by thread T0 here:\\r\\n    #0 0x7f6af4f81602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\\r\\n    #1 0x4410fa in stack_double /home/xie/Downloads/oniguruma-develop/src/regexec.c:480\\r\\n    #2 0x44c8d2 in match_at /home/xie/Downloads/oniguruma-develop/src/regexec.c:2450\\r\\n    #3 0x457cb3 in onig_search /home/xie/Downloads/oniguruma-develop/src/regexec.c:3655\\r\\n    #4 0x458905 in onig_scan /home/xie/Downloads/oniguruma-develop/src/regexec.c:3790\\r\\n    #5 0x40117d in scan /home/xie/Downloads/oniguruma-develop/test/testu.c:17\\r\\n    #6 0x4014e3 in exec /home/xie/Downloads/oniguruma-develop/test/testu.c:55\\r\\n    #7 0x40162a in main /home/xie/Downloads/oniguruma-develop/test/testu.c:67\\r\\n    #8 0x7f6af4b4082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-use-after-free /home/xie/Downloads/oniguruma-develop/src/regexec.c:2437 match_at\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c4e7fffb6e0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb6f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb700: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb710: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb720: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n=>0x0c4e7fffb730: fd fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb740: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb750: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\\r\\n  0x0c4e7fffb760: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa\\r\\n  0x0c4e7fffb770: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c4e7fffb780: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==10708==ABORTING\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"At present, I cannot find a true solution.\\r\\nI invalidate PR #43 partially because segmentation fault caused after that.\"}, {\"author\": \"mtasaka\", \"body\": \"Yes, git bisect shows that d304e2a7c19e9edea13ee3731275ad53cc555312 is the first bad commit .\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_63", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"63\", \"title\": \"testcases print warnings\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"```\\r\\ntestc.c:857:11: warning: illegal character encoding in string literal [-Winvalid-source-encoding]\\r\\n  x2(\\\"a<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC><A5><C9><\\\\\\\\/b>\\\", \\\"a<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC>...\\r\\n          ^~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\ntestc.c:857:49: warning: illegal character encoding in string literal [-Winvalid-source-encoding]\\r\\n  ...\\\"a<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC><A5><C9></b>\\\", 0, 32);\\r\\n          ^~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\ntestc.c:858:11: warning: illegal character encoding in string literal [-Winvalid-source-encoding]\\r\\n  x2(\\\".<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC><A5><C9><\\\\\\\\/b>\\\", \\\"a<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC>...\\r\\n          ^~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\ntestc.c:858:49: warning: illegal character encoding in string literal [-Winvalid-source-encoding]\\r\\n  ...\\\"a<b><A5>–°<BC><A5><B8><A5><E7><A5><F3><A4>Œ•<C0><A5><A6><A5><F3><A5><ED><A1><BC><A5><C9></b>\\\", 0, 32);\\r\\n          ^~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n507 warnings generated.\\r\\n```\\r\\n\\r\\nFound on FreeBSD 11.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think that it is probably caused by Japanese character code EUC_JP.\\r\\nA good countermeasure was not found.\\r\\nPlease add IGNORE_EUC_JP flag to CFLAGS from version 6.4.0.\\r\\n$ make CFLAGS=\\\"-O2 -DIGNORE_EUC_JP\\\" test\\r\\n\"}, {\"author\": \"yurivict\", \"body\": \"Ok, thanks, this helped.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_64", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"64\", \"title\": \"Please fix security issues CVE-2017-9224, CVE-2017-9225, CVE-2017-9226, CVE-2017-9227, CVE-2017-9228, CVE-2017-9229\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9224\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9225\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9226\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9227\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9228\\r\\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9229\\r\\n\\r\\nIf they are already fixed, you should add the note in the README file that they are fixed. Otherwise various systems will be flagging oniguruma as vulnerable.\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI wrote that these issues were fixed into README and README.md.\\r\\n\"}, {\"author\": \"yurivict\", \"body\": \"Thanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_65", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"65\", \"title\": \"SIZEOF_SIZE_T doesn't exist on certain architecutres\", \"author\": \"kaplanlior\", \"labels\": [], \"description\": \"In  PHP we used this to build oniguruma on AIX and Linux POWER8 (ppc64le).\\r\\n\\r\\nhttps://github.com/php/php-src/commit/c2c60fcac75d74a5c6864af2723301c72cb73925\\r\\n\\r\\nWe prefer the patch to be upstream instead of keep applying it ourselves.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I have applied it into develop branch.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_66", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"66\", \"title\": \"--enable-combination-explosion-check is broken in 6.4.0\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"```\\r\\nlibtool: compile:  cc -DHAVE_CONFIG_H -I. -I.. -I/usr/local/include -fno-omit-frame-pointer -Wall -O2 -pipe -fno-omit-frame-pointer -DIGNORE_EUC_JP -fstack-protector -fno-strict-aliasing -MT regext.lo -MD -MP -MF .deps/regext.Tpo -c regext.c -o regext.o >/dev/null 2>&1\\r\\n--- regcomp.lo ---\\r\\n          if (env->curr_max_regnum < en->regnum)\\r\\n                                     ~~  ^\\r\\nregcomp.c:3623:40: error: no member named 'regnum' in 'EnclosureNode'\\r\\n            env->curr_max_regnum = en->regnum;\\r\\n                                   ~~  ^\\r\\n```\\r\\n\\r\\nclang-4.0.0 on FreeBSD 11.1\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_67", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"67\", \"title\": \"6.5.0 can't compile with Visual Studio 2005\", \"author\": \"nmaya\", \"labels\": [], \"description\": \"In Visual Studio 2005, regcomp.c causes compile error.\\r\\n\\r\\nError message.\\r\\n```\\r\\nregcomp.c(3132) : error C2143: ÊßãÊñá„Ç®„É©„Éº : ';' „Åå 'Âûã' „ÅÆÂâç„Å´„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ\\r\\nregcomp.c(3138) : error C2065: 'mem_env' : ÂÆöÁæ©„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑË≠òÂà•Â≠ê„Åß„Åô„ÄÇ\\r\\nregcomp.c(3138) : error C2109: ÈÖçÂàó„Åæ„Åü„ÅØ„ÄÅ„Éù„Ç§„É≥„Çø„Åß„Å™„ÅÑÂ§âÊï∞„Å´Ê∑ªÂ≠ó„Åå‰Ωø„Çè„Çå„Åæ„Åó„Åü„ÄÇ\\r\\nNMAKE : fatal error U1077: '\\\"C:\\\\Program Files\\\\Microsoft Visual Studio 8\\\\VC\\\\BIN\\\\cl.EXE\\\"' : „É™„Çø„Éº„É≥ „Ç≥„Éº„Éâ '0x2'\\r\\nStop.\\r\\n```\\r\\n\\r\\nregcomp.c\\r\\n```\\r\\n  case NODE_BACKREF:\\r\\n    {\\r\\n      int i;\\r\\n      BackRefNode* br = BACKREF_(node);\\r\\n      int* backs = BACKREFS_P(br);\\r\\n      MemEnv* mem_env = SCANENV_MEMENV(env); // line 3132\\r\\n\\r\\n      for (i = 0; i < br->back_num; i++) {\\r\\n        if (backs[i] > env->num_mem)\\r\\n          return ONIGERR_INVALID_BACKREF;\\r\\n\\r\\n        NODE_STATUS_ADD(mem_env[backs[i]].node, NST_BACKREF); // line 3138\\r\\n      }\\r\\n      r = 0;\\r\\n    }\\r\\n    break;\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I can' check with Visual Studio 2005.\\r\\nI have removed redundant semicolon in the definition of BACKREFS_P() in develop branch.\\r\\nPlease check it.\"}, {\"author\": \"nmaya\", \"body\": \"I confirmed that the compile error was gone with this fix.\\r\\nThank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_68", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"68\", \"title\": \"Compilation failure in out-of-source build\", \"author\": \"Arfrever\", \"labels\": [], \"description\": \"`sample/Makefile.am` and `test/Makefile.am` contain incorrect paths to directory with Oniguruma headers, which causes compilation failure in out-of-source build:\\r\\n\\r\\n```\\r\\n$ tar -xzf onig-6.6.1.tar.gz\\r\\n$ mkdir onig-6.6.1_build\\r\\n$ cd onig-6.6.1_build\\r\\n$ ../onig-6.6.1/configure\\r\\n...\\r\\n$ make\\r\\n...\\r\\n$ make -C sample check\\r\\nmake: Entering directory '/tmp/onig-6.6.1_build/sample'\\r\\nmake  encode listcap names posix simple sql syntax user_property bug_fix\\r\\nmake[1]: Entering directory '/tmp/onig-6.6.1_build/sample'\\r\\ngcc -DHAVE_CONFIG_H -I. -I../../onig-6.6.1/sample -I../src  -I../src -I/usr/local/include   -g -O2 -MT encode.o -MD -MP -MF .deps/encode.Tpo -c -o encode.o ../../onig-6.6.1/sample/encode.c\\r\\n../../onig-6.6.1/sample/encode.c:5:23: fatal error: oniguruma.h: No such file or directory\\r\\n #include \\\"oniguruma.h\\\"\\r\\n                       ^\\r\\ncompilation terminated.\\r\\nmake[1]: *** [Makefile:651: encode.o] Error 1\\r\\nmake[1]: Leaving directory '/tmp/onig-6.6.1_build/sample'\\r\\nmake: *** [Makefile:979: check-am] Error 2\\r\\nmake: Leaving directory '/tmp/onig-6.6.1_build/sample'\\r\\n$ make -C test check\\r\\nmake: Entering directory '/tmp/onig-6.6.1_build/test'\\r\\nmake  test_utf8 testc testp testcu\\r\\nmake[1]: Entering directory '/tmp/onig-6.6.1_build/test'\\r\\ngcc -DHAVE_CONFIG_H -I. -I../../onig-6.6.1/test -I../src  -I../src -I/usr/local/include   -g -O2 -MT test_utf8.o -MD -MP -MF .deps/test_utf8.Tpo -c -o test_utf8.o ../../onig-6.6.1/test/test_utf8.c\\r\\n../../onig-6.6.1/test/test_utf8.c:10:23: fatal error: oniguruma.h: No such file or directory\\r\\n #include \\\"oniguruma.h\\\"\\r\\n                       ^\\r\\ncompilation terminated.\\r\\nmake[1]: *** [Makefile:598: test_utf8.o] Error 1\\r\\nmake[1]: Leaving directory '/tmp/onig-6.6.1_build/test'\\r\\nmake: *** [Makefile:905: check-am] Error 2\\r\\nmake: Leaving directory '/tmp/onig-6.6.1_build/test'\\r\\n```\\r\\n\\r\\nFix:\\r\\n```\\r\\n--- sample/Makefile.am\\r\\n+++ sample/Makefile.am\\r\\n@@ -4,7 +4,7 @@\\r\\n LDADD  = $(lib_onig)\\r\\n \\r\\n AM_LDFLAGS  = -L$(prefix)/lib\\r\\n-AM_CPPFLAGS = -I../src -I$(includedir)\\r\\n+AM_CPPFLAGS = -I$(top_srcdir)/src -I$(includedir)\\r\\n \\r\\n TESTS = encode listcap names posix simple sql syntax user_property bug_fix\\r\\n \\r\\n--- test/Makefile.am\\r\\n+++ test/Makefile.am\\r\\n@@ -3,7 +3,7 @@\\r\\n \\r\\n AM_LDFLAGS  = -L$(prefix)/lib\\r\\n AM_CFLAGS =\\r\\n-AM_CPPFLAGS = -I../src -I$(includedir)\\r\\n+AM_CPPFLAGS = -I$(top_srcdir)/src -I$(includedir)\\r\\n \\r\\n TESTS = test_utf8 testc testp testcu\\r\\n \\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI have fixed it in develop branch.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_69", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"69\", \"title\": \"sample/posix.c: onig_end() function used without previous declaration\", \"author\": \"Arfrever\", \"labels\": [], \"description\": \"```\\r\\n/tmp/onig-6.6.1/sample/posix.c: In function ‚Äòmain‚Äô:\\r\\n/tmp/onig-6.6.1/sample/posix.c:94:3: warning: implicit declaration of function ‚Äòonig_end‚Äô [-Wimplicit-function-declaration]\\r\\n   onig_end();\\r\\n   ^~~~~~~~\\r\\n```\\r\\n\\r\\n`onig_end` is declared in `oniguruma.h`, but adding `#include \\\"oniguruma.h\\\"` in `sample/posix.c` causes errors about conflicting types.\\r\\nI am not sure what is correct fix. Some ideas:\\r\\n- Delete `onig_end();` line in `sample/posix.c`\\r\\n- Add `int onig_end P_((void));` line in `sample/posix.c`\\r\\n- Add `int onig_end P_((void));` line in `src/onigposix.h`\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_70", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"70\", \"title\": \"Matching the end of a string followed by an empty greedy regex and a word boundary (.*\\\\b) fails\", \"author\": \"jhriggs\", \"labels\": [], \"description\": \"For context, see https://bugs.ruby-lang.org/issues/13892.\\r\\n\\r\\nThis is a very specific regex failure that occurs when the final character of the string is matched by the end of a pattern that terminates with `.*\\\\b`. For example:\\r\\n\\r\\n```\\r\\n\\\"abc\\\" =~ /c.*\\\\b/\\r\\n\\\"abc\\\" =~ /abc.*\\\\b/\\r\\n\\\"abc\\\" =~ /\\\\b.*abc.*\\\\b/\\r\\n```\\r\\n\\r\\nIn Ruby 1.8.7 and every other language I have tested (perl, pcre, php, javascript, python, go, ...) this matches. With Oniguruma/Onigma, though, it appears that the greedy `.*` causes the `\\\\b` to fail, though it should match. I have tested this with every version of ruby >= 1.9, the included simple.c code, and php's mb_ereg(). The problem only occurs when the pattern matches at the end of the string being matched (i.e. matching against `abcd`  or `xyzabcdef` works, but `abc` or simply `c` does not). Based on my non-exhaustive testing, this only occurs with `.*\\\\b`; other patterns like `.?\\\\b` and specific characters such as `d*\\\\b` work as expected.\\r\\n\\r\\nSee also:\\r\\n* https://regex101.com/r/JBzSic/2 (PHP/PCRE, Javascript, Python, Go)\\r\\n* http://fiddle.re/gkm4ad (Go, Java, Javascript, .Net, Perl, PHP, Python, XRegExp)\\r\\n* http://java-regex-tester.appspot.com/regex/04925044-ca95-46c6-bec5-329057c04ab2 (Java)\", \"comments\": [{\"author\": \"jhriggs\", \"body\": \"Corresponding https://github.com/k-takata/Onigmo/issues/96 opened for Onigmo.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_71", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"71\", \"title\": \"Performance of case-insensitive regexp vs utf-8 string\", \"author\": \"dan42\", \"labels\": [], \"description\": \"When a regexp starts with a static value, it triggers an optimization where Oniguruma jumps to the first occurence of that static value.\\r\\n\\r\\nBut if the string being matched is utf8 **AND** the regexp is case-insensitive **AND** the static prefix contains the letter \\\"k\\\" or \\\"s\\\"... there's no optimization at all? Why just the letters \\\"k\\\" and \\\"s\\\"???\\r\\n\\r\\nBenchmark code: (in ruby but I'm pretty sure this is Oniguruma issue)\\r\\n~~~ ruby\\r\\nrequire \\\"benchmark\\\"\\r\\n\\r\\nSTR = {\\r\\n  ascii: (\\\" \\\"*1024*1024).encode!('ascii'),\\r\\n  utf_8: (\\\" \\\"*1024*1024).encode!('utf-8'),\\r\\n}\\r\\nN = 1000\\r\\n@n = 0\\r\\n\\r\\ndef test(b, k=:utf_8, rx)\\r\\n  str = STR[k] or raise\\r\\n  b.report(\\\"#{@n+=1}. #{k} =~ #{rx.inspect}\\\"){N.times{ str =~ rx and raise }}\\r\\nend\\r\\n\\r\\nBenchmark.bm(25) do |b|\\r\\n  test b, /----a/i\\r\\n  test b, /----k/i\\r\\n  test b, /----s/i\\r\\n  test b, /---- /i\\r\\n  test b, /----/i\\r\\n  test b, /a/i\\r\\n  test b, /----k/\\r\\n  test b, :ascii, /----k/i\\r\\n  test b, /----[ks]/i\\r\\n  test b, /----.k/i\\r\\n  test b, /----*k/i\\r\\n  test b, /^----k/i\\r\\n  test b, /-{23}k/i\\r\\n  test b, /-{24}k/i\\r\\nend\\r\\n~~~\\r\\n\\r\\nResults: \\r\\n\\r\\n\\t\\t                        user     system      total        real\\r\\n\\t1. utf_8 =~ /----a/i        1.130000   0.000000   1.130000 (  1.138215)\\r\\n\\t2. utf_8 =~ /----k/i        8.100000   0.000000   8.100000 (  8.101550)\\r\\n\\t3. utf_8 =~ /----s/i        8.210000   0.000000   8.210000 (  8.207743)\\r\\n\\t4. utf_8 =~ /---- /i        6.770000   0.000000   6.770000 (  6.778520)\\r\\n\\t5. utf_8 =~ /----/i         1.360000   0.000000   1.360000 (  1.349784)\\r\\n\\t6. utf_8 =~ /a/i            8.060000   0.000000   8.060000 (  8.071592)\\r\\n\\t7. utf_8 =~ /----k/         0.580000   0.000000   0.580000 (  0.571246)\\r\\n\\t8. ascii =~ /----k/i        1.120000   0.000000   1.120000 (  1.118922)\\r\\n\\t9. utf_8 =~ /----[ks]/i     1.520000   0.000000   1.520000 (  1.520390)\\r\\n\\t10. utf_8 =~ /----.k/i      1.340000   0.000000   1.340000 (  1.345556)\\r\\n\\t11. utf_8 =~ /----*k/i      1.690000   0.000000   1.690000 (  1.686180)\\r\\n\\t12. utf_8 =~ /^----k/i      8.160000   0.000000   8.160000 (  8.169461)\\r\\n\\t13. utf_8 =~ /-{23}k/i      8.190000   0.000000   8.190000 (  8.184952)\\r\\n\\t14. utf_8 =~ /-{24}k/i      0.280000   0.000000   0.280000 (  0.278359)\\r\\n\\r\\nNotes: In every test above, the match is negative. Both utf_8 and ascii string have the same value, 1MiB of spaces; only the encoding label is different.\\r\\n\\r\\n1. matching utf8 string with case-insensitive regexp, good performance\\r\\n2. but just by using \\\"k\\\" instead of \\\"a\\\", performance tanks\\r\\n3. same problem with \\\"s\\\"\\r\\n4. also bad performance with the space character used in the test string\\r\\n5. good performance with /----/i; since tests 2-4 have the same prefix I would expect at least the same performance\\r\\n6. bad performance is same as /a/i ... I assume because both are non-optimized?\\r\\n7. no problem when regex is case-**sensitive**\\r\\n8. no problem when matching with ascii string\\r\\n9. no problem when k/s is in character class (with more than 1 character)\\r\\n10. no problem when anychar appears before k/s\\r\\n11. no problem when repetition appears before k/s\\r\\n12. problem exists when anchor appears before k/s\\r\\n13. problem exists when k/s is in first 24 characters\\r\\n14. but not otherwise (prefix optimization limited to 24 characters?)\\r\\n\\r\\n\\r\\nSo what's so special about the letters \\\"k\\\" and \\\"s\\\" that it would cause optimization to be turned off?\", \"comments\": [{\"author\": \"k-takata\", \"body\": \"`/s/i` matches `≈ø` (U+017F, LATIN SMALL LETTER LONG S) and `/k/i` matches `‚Ñ™` (U+212A, KELVIN SIGN) also.\\r\\nThese characters are 2 or 3 bytes in UTF-8, so the lengths are differ from the original characters. Therefore optimization is turned off.\"}, {\"author\": \"dan42\", \"body\": \"Oh wow, this is really interesting.\\r\\n\\r\\nBut I still think that the optimization should apply to the \\\"----\\\" prefix. There's no reason to turn it off **entirely**.\"}, {\"author\": \"dan42\", \"body\": \"Also I think we could argue that an ASCII regexp should only match ASCII characters.\\r\\n\\r\\n\\tstr = \\\"≈ø\\\" \\r\\n\\tstr.encoding #=> UTF-8\\r\\n\\r\\n\\trx = /s/ui\\r\\n\\trx.encoding  #=> UTF-8\\r\\n\\trx =~ str    #=> 0, as expected\\r\\n\\r\\n\\trx = /s/i\\r\\n\\trx.encoding  #=> US-ASCII\\r\\n\\trx =~ str    #=> 0, but imho should not match\\r\\n\\r\\nBut maybe this is a ruby-specific issue?\"}, {\"author\": \"kkos\", \"body\": \"result (version 6.6.1)\\r\\n\\r\\n```\\r\\n/----a/i:    1.63\\r\\n/----k/i:    1.64\\r\\n/----s/i:    1.62\\r\\n/---- /i:    1.28\\r\\n/----/i:     1.63\\r\\n/a/i:        7.28\\r\\n/----k/i:    1.63\\r\\n/----[ks]/i: 1.61\\r\\n/----.k/i:   1.62\\r\\n/----*k/i:   2.16\\r\\n/^----k/i:   1.61\\r\\n/-{23}k/i:   0.29\\r\\n/-{24}k/i:   0.28\\r\\n```\\r\\n\\r\\nsource code\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include <time.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\n#define SLEN    1024*1024\\r\\n#define REPEAT       2000\\r\\n\\r\\nstatic void\\r\\nout_chars(char c, int n)\\r\\n{\\r\\n  int i;\\r\\n\\r\\n  for (i = 0; i < n; i++)\\r\\n    fputc(c, stdout);\\r\\n}\\r\\n\\r\\nstatic double\\r\\nget_sec(struct timespec* ts, struct timespec* te)\\r\\n{\\r\\n  double t;\\r\\n\\r\\n  t = (te->tv_sec - ts->tv_sec) +\\r\\n      (double )(te->tv_nsec - ts->tv_nsec) / 1000000000.0;\\r\\n  return t;\\r\\n}\\r\\n\\r\\nstatic int\\r\\ntest(UChar* pattern, UChar* str)\\r\\n{\\r\\n  int i;\\r\\n  int r;\\r\\n  unsigned char *start, *range, *end;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  OnigRegion *region;\\r\\n  struct timespec ts1, ts2;\\r\\n  double t;\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen((char* )pattern),\\r\\n\\tONIG_OPTION_IGNORECASE, ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fflush(stderr);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  end   = str + strlen((char* )str);\\r\\n  start = str;\\r\\n  range = end;\\r\\n\\r\\n  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &ts1);\\r\\n\\r\\n  for (i = 0; i < REPEAT; i++) {\\r\\n    r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  }\\r\\n\\r\\n  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &ts2);\\r\\n  t = get_sec(&ts1, &ts2);\\r\\n\\r\\n  fprintf(stdout, \\\"/%s/i:\\\", pattern);\\r\\n  out_chars(' ', 9 - strlen((char* )pattern));\\r\\n  fprintf(stdout, \\\"%4.2lf\\\\n\\\", t);\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  onig_free(reg);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nextern int\\r\\nmain(int argc, char* argv[])\\r\\n{\\r\\n  int i;\\r\\n  UChar str[SLEN+1];\\r\\n  OnigEncoding use_encs[] = { ONIG_ENCODING_UTF8 };\\r\\n  static char* patterns[] = {\\r\\n    \\\"----a\\\",\\r\\n    \\\"----k\\\",\\r\\n    \\\"----s\\\",\\r\\n    \\\"---- \\\",\\r\\n    \\\"----\\\",\\r\\n    \\\"a\\\",\\r\\n    \\\"----k\\\",\\r\\n    \\\"----[ks]\\\",\\r\\n    \\\"----.k\\\",\\r\\n    \\\"----*k\\\",\\r\\n    \\\"^----k\\\",\\r\\n    \\\"-{23}k\\\",\\r\\n    \\\"-{24}k\\\"\\r\\n  };\\r\\n\\r\\n  for (i = 0; i < SLEN; i++) {\\r\\n    str[i] = ' ';\\r\\n  }\\r\\n  str[SLEN] = '\\\\0';\\r\\n\\r\\n  onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n\\r\\n  for (i = 0; i < sizeof(patterns)/sizeof(patterns[0]); i++) {\\r\\n    test((UChar* )patterns[i], str);\\r\\n  }\\r\\n\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Don't write about Ruby here.\"}, {\"author\": \"k-takata\", \"body\": \"Very sorry.\\r\\nThis is an Onigmo specific problem with Sunday's quick search with support for case-insensitive search.\\r\\nSee k-takata/Onigmo#97 for detail.\"}, {\"author\": \"dan42\", \"body\": \"I thank you both very much for taking the time to look into such a specific edge case issue.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_73", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"73\", \"title\": \"Build breaks without autoreconf\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"When I try building it on FreeBSD using just 'configure', the build breaks:\\r\\n```\\r\\n--- ./Makefile.in ---\\r\\nWARNING: 'automake-1.15' is probably too old.\\r\\n         You should only need it if you modified 'Makefile.am' or\\r\\n         'configure.ac' or m4 files included by 'configure.ac'.\\r\\n         The 'automake' program is part of the GNU Automake package:\\r\\n         <http://www.gnu.org/software/automake>\\r\\n         It also requires GNU Autoconf, GNU m4 and Perl in order to run:\\r\\n         <http://www.gnu.org/software/autoconf>\\r\\n         <http://www.gnu.org/software/m4/>\\r\\n         <http://www.perl.org/>\\r\\n*** [./Makefile.in] Error code 63\\r\\n```\\r\\n\\r\\nIt succeeds with autoreconf.\\r\\n\\r\\nUsing automake-1.15.1, autoconf-2.69, which are the latest versions.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't know what is taking place.\\r\\nBut anyway, I have installed automake 1.15.1 and updated corresponding files in develop branch.\\r\\nI hope that this problem is solved in the next release.\\r\\nTarball is generated by \\\"make dist\\\".\"}, {\"author\": \"kkos\", \"body\": \"I have checked it on FreeBSD 11.2 in Virtual Box.\\r\\n./configure; make; cd test; make test; commands are executed normally.\\r\\n(onig-6.8.2.tar.gz, onig-6.7.1.tar.gz and onig-6.7.0.tar.gz)\\r\\n\\r\\n```\\r\\n$ uname -a\\r\\nFreeBSD kosakobsd 11.2-RELEASE FreeBSD 11.2-RELEASE #0 r335510: Fri Jun 22 04:32:14 UTC 2018     root@releng2.nyi.freebsd.org:/usr/obj/usr/src/sys/GENERIC  amd64\\r\\n```\"}, {\"author\": \"h1z1\", \"body\": \"Curious because this breaks jq.   1.13.4 is the current in Centos 7.   That comes from f97f216e46556fce95d085fb6d05dd47125615bd in configure.ac\\r\\n\\r\\n`AM_INIT_AUTOMAKE([-Wno-portability` 1.14])`\\r\\n\\r\\nDropping it to 1.13 builds OK, so why the dependency?  It's been that way for a few years\\r\\n\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I don't know the details about autoconf.\\r\\nI removed 1.14 from AM_INIT_AUTOMAKE().\\r\\nDoes this change fix the problem?\\r\\n\"}, {\"author\": \"h1z1\", \"body\": \"It does indeed.  Not sure if you want to leave that in but with a lower version requirement as a safety.\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI leave it this state unless somebody objects.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_74", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"74\", \"title\": \"Comprehensive overall description\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"I wrote up this description for the FreeBSD port.\\r\\nPlease make corrections, or add some major features if I missed some.\\r\\nPlease consider changing the description in your README file.\\r\\nParticularly, the word ```characteristics``` isn't a good description for a software package.\\r\\n\\r\\n----\\r\\n\\r\\n```\\r\\nOniguruma is a modern and flexible regular expressions library. It\\r\\nencompasses features from different regular expression implementations\\r\\nthat traditionally exist in different languages. It comes close to\\r\\nbeing a complete superset of all regular expression features found\\r\\nin other regular expression implementations.\\r\\n\\r\\nIts features include:\\r\\n* Character encoding can be specified per regular expression object.\\r\\n* Several regular expression types are supported:\\r\\n  * POSIX\\r\\n  * Grep\\r\\n  * GNU Regex\\r\\n  * Perl\\r\\n  * Java\\r\\n  * Ruby\\r\\n  * Emacs\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for your suggestion.\\r\\nI have nothing else to add to your description.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_76", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"76\", \"title\": \"error LNK2001: unresolved external symbol OnigEncodingXXX...\", \"author\": \"asukun\", \"labels\": [], \"description\": \"In my mfc console project, I included \\\"oniguruma.h\\\" header and used ONIG_ENCODING_UTF16_LE (using onig.lib, onig.dll)\\r\\nthen compile error appears as below\\r\\n=> error LNK2001: unresolved external symbol OnigEncodingUTF16_LE\\r\\n\\r\\nThat is because mfc console project always defines EXPORT macro in afxv_w32.h header\\r\\nThe proplem location is \\r\\n\\r\\n* afxv_w32.h header\\r\\n#ifndef EXPORT\\r\\n#define EXPORT\\r\\n#endif\\r\\n\\r\\n* \\\"oniguruma.h\\\" header\\r\\nifndef ONIG_EXTERN\\r\\n#if defined(_WIN32) && !defined(__GNUC__)\\r\\n#if defined(EXPORT) || defined(RUBY_EXPORT)\\r\\n#define ONIG_EXTERN   extern __declspec(dllexport)\\r\\n#else\\r\\n#define ONIG_EXTERN   extern __declspec(dllimport)\\r\\n#endif\\r\\n#endif\\r\\n#endif\\r\\n\\r\\nIf This part is removed, compile is fine.\\r\\nIn my opinion, EXPORT macro name should be different or removded in \\\"oniguruma.h\\\" header.\\r\\nplease reply me^^\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I have renamed EXPORT to ONIGURUMA_EXPORT on develop branch.\\r\\nIs it a right solution?\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_77", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"77\", \"title\": \"Building with Emscripten fails\", \"author\": \"zikaari\", \"labels\": [], \"description\": \"Followed this guide: http://kripken.github.io/emscripten-site/docs/compiling/Building-Projects.html#building-projects\\r\\n\\r\\nThese steps work without spitting non-zero exit code\\r\\n```bash\\r\\n# Run emconfigure with the normal configure command as an argument.\\r\\n./emconfigure ./configure\\r\\n\\r\\n# Run emmake with the normal make to generate linked LLVM bitcode.\\r\\n./emmake make\\r\\n```\\r\\n\\r\\nBut fails at last one : (\\r\\n```bash\\r\\n$ emcc src/.libs/libonig.a -s WASM=1 -o onig.js\\r\\nerror: Linking globals named 'regcomp': symbol multiply defined!\\r\\nERROR:root:Failed to run llvm optimizations:\\r\\n```\\r\\n\\r\\nAt this point (4 days of struggle with all this) I'd owe anyone for life. Help much appreciated.\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't know about Emscripten.\\r\\nBut regcomp() is a Oniguruma API function that provide POSIX API to user.\\r\\nIf you don't use Oniguruma POSIX API regcomp() etc.. you can remove it from libonig.a.\\r\\nPlease remove regposix.c and regposerr.c from src/Makefile.am.\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I have added a new configure option \\\"--enable-posix-api\\\" in develop branch.\\r\\n```\\r\\n$ make clean\\r\\n$ ./configure --enable-posix-api=no\\r\\n$ make\\r\\n```\"}, {\"author\": \"zikaari\", \"body\": \"Thank you for being so nice!\\r\\n\\r\\nI created the same [issue](https://github.com/kripken/emscripten/issues/6239) in `emscripten`'s repo and based on author's pointer, it turns out that `regcomp` symbol is also defined in `libc.bc` which I believe must be packed together with anything `emscripten` builds (`WASM` binary in this case)\\r\\n\\r\\n> libc.bc\\r\\n```bash\\r\\nsweetslush@ubuntu:~/.emscripten_cache/asmjs$ llvm-nm libc.bc | grep \\\"regcomp\\\"\\r\\n-------- T regcomp\\r\\n```\\r\\n\\r\\n> libonig.a\\r\\n```bash\\r\\nsweetslush@ubuntu:~/.../oniguruma$ llvm-nm src/.libs/libonig.a | grep \\\"regcomp\\\"\\r\\nregcomp_64e0bb8d.o:\\r\\n-------- T regcomp\\r\\n```\\r\\n\\r\\nIn search for all possible solutions, will there be any side effects (missing features) of not including `regposix.c` and `regposerr.c`? \\r\\n\\r\\nOr does `regcomp` from `libc` has same behaviour as `regcomp` in `oniguruma`?\\r\\n\\r\\nOnce again, I thank for being epic üéâ\"}, {\"author\": \"kkos\", \"body\": \"regcomp() in Oniguruma provides POSIX interface to users by using Oniguruma regex engine.\\r\\nIf you don't use POSIX interface (regcomp, regexec, regfree etc..  defined in onigposix.h) to use Oniguruma and use only Oniguruma native interface (onig_new, onig_search etc.. defined in oniguruma.h) then you don't need regposix.c and regposerr.c.\"}, {\"author\": \"zikaari\", \"body\": \"Everything's now nominal. Thank you for the help!\\r\\n\\r\\nüôÇ\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_78", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"78\", \"title\": \"Weird linking behaviour due to onig_error_code_to_str definition\", \"author\": \"zikaari\", \"labels\": [], \"description\": \"My apologies, not a C/C++ expert, but a nice description of this issue can be found in link below:\\r\\n\\r\\nhttps://github.com/kripken/emscripten/issues/6246#issuecomment-365802960\\r\\n\\r\\nThanks!\", \"comments\": [{\"author\": \"kkos\", \"body\": \" I will apologize to you about bad  header.\\r\\nI have fixed it in develop branch.\"}, {\"author\": \"zikaari\", \"body\": \"Thank you sir!\\r\\n\\r\\nBecause of these fixes (including `--enable-posix-api=no`), oniguruma is now officially port-able to web!\\r\\n\\r\\nAs simple as:\\r\\n```bash\\r\\n#!/bin/bash\\r\\n\\r\\n# start at ./\\r\\nmkdir onigwasm\\r\\ncd onigwasm\\r\\n\\r\\ngit clone https://github.com/kkos/oniguruma\\r\\n\\r\\n# Jump inside cloned repo and lift off\\r\\ncd oniguruma\\r\\ngit checkout develop\\r\\n\\r\\nautoreconf -vfi\\r\\nemconfigure ./configure --enable-posix-api=no\\r\\nemmake make\\r\\n\\r\\n# back to ./onigwasm\\r\\ncd ..\\r\\n\\r\\n# copy a bare minimum code which uses oniguruma lib\\r\\ncp oniguruma/sample/simple.c test.c\\r\\n\\r\\nemcc oniguruma/src/.libs/libonig.so test.c -Ioniguruma/src -s WASM=1 -o index.html\\r\\n```\\r\\n\\r\\n(of course, above script requires, Emscripten installed, and terminal set to recognize its commands)\"}, {\"author\": \"zikaari\", \"body\": \"Oops, didn't notice earlier, linking works, but with warnings ‚ö†\\r\\n\\r\\n```bash\\r\\nsrc/onigasm.c:26:28: warning: passing 'char [90]' to parameter of type 'OnigUChar *' (aka 'unsigned char *') converts between pointers to\\r\\n      integer types with different sign [-Wpointer-sign]\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n                           ^\\r\\noniguruma/src/oniguruma.h:784:44: note: passing argument to parameter 's' here\\r\\nint onig_error_code_to_str PV_((OnigUChar* s, int err_code, ...));\\r\\n                                           ^\\r\\nsrc/onigasm.c:50:28: warning: passing 'char [90]' to parameter of type 'OnigUChar *' (aka 'unsigned char *') converts between pointers to\\r\\n      integer types with different sign [-Wpointer-sign]\\r\\n    onig_error_code_to_str(s, r);\\r\\n                           ^\\r\\noniguruma/src/oniguruma.h:784:44: note: passing argument to parameter 's' here\\r\\nint onig_error_code_to_str PV_((OnigUChar* s, int err_code, ...));\\r\\n                                           ^\\r\\n2 warnings generated.\\r\\n```\\r\\n\\r\\nJust as info, I believe Emscripten uses clang if that matters (may your tests are passing?)\"}, {\"author\": \"kkos\", \"body\": \"Perhaps your test.c is sample/simple.c in master branch.\\r\\nPlease use sample/simple.c in develop branch.\\r\\nThe difference is only cast.\\r\\nonig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n\\r\\n\"}, {\"author\": \"zikaari\", \"body\": \"üò≥ Sorry for unnecessary interrupt, everything is nominal now.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_79", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"79\", \"title\": \"Incompatible changes in headers require to bump the shared library version\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"Hi K.Kosako,\\r\\n\\r\\nWith the version change 6.7.1 -> 6.8.0 you made some incompatible changes. For example, this function:\\r\\n> long onig_get_try_in_match_limit P_((void))\\r\\n\\r\\nis deleted,\\r\\nthis function:\\r\\n\\r\\n> int onig_set_try_in_match_limit P_((unsigned long n))\\r\\n\\r\\nis deleted.\\r\\n\\r\\nWhen you delete or change functions, you need to bump libonig.so such that SONAME changes. It didn't change: lib/libonig.so.4.0.0\\r\\n\\r\\nIf any package using oniguruma would use one of these functions, it would crash. They only get rebuilt when the dependency library changes SONAME.\\r\\n\\r\\nRegards,\\r\\nYuri\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I will update LTVERSION from \\\"4:0:0\\\" to \\\"5:0:0\\\".\\r\\nShould I update a version number from 6.8.0 to 6.8.1 ?\\r\\n\"}, {\"author\": \"yurivict\", \"body\": \"> Should I update a version number from 6.8.0 to 6.8.1 ?\\r\\n\\r\\nYes.\"}, {\"author\": \"yurivict\", \"body\": \"Thank you!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_80", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"80\", \"title\": \"UChar in header causes issue with hhvm compile\", \"author\": \"slackhappy\", \"labels\": [], \"description\": \"Looks like these definitions are using UChar\\r\\n\\r\\n```\\r\\nONIG_EXTERN\\r\\nint onig_get_callout_num_by_tag P_((OnigRegex reg, const UChar* tag, const UChar* tag_end));\\r\\nONIG_EXTERN\\r\\nint onig_get_callout_data_by_tag P_((OnigRegex reg, OnigMatchParam* mp, const UChar* tag, const UChar* tag_end, int slot, OnigType* type, OnigValue* val));\\r\\nONIG_EXTERN\\r\\nint onig_set_callout_data_by_tag P_((OnigRegex reg, OnigMatchParam* mp, const UChar* tag, const UChar* tag_end, int slot, OnigType type, OnigValue* val));\\r\\nONIG_EXTERN\\r\\nUChar* onigenc_strdup P_((OnigEncoding enc, const UChar* s, const UChar* end));\\r\\n```\\r\\n\\r\\nWhich looks similar to the problem pointed out here: https://github.com/kkos/oniguruma/commit/c4be742e20cd74db2fa7aa4360172183b2b8169e\\r\\n\\r\\nin hhvm issue 50 https://github.com/hhvm/homebrew-hhvm/issues/50\\r\\n\\r\\n```\\r\\nLast 15 lines from /Users/johng/Library/Logs/Homebrew/hhvm@3.21-lts/02.make:\\r\\n                                                                                                ^\\r\\n/usr/local/opt/oniguruma/include/oniguruma.h:916:79: error: unknown type name 'UChar'\\r\\nint onig_set_callout_data_by_tag P_((OnigRegex reg, OnigMatchParam* mp, const UChar* tag, const UChar* tag_end, int slot, OnigType type, OnigValue* val));\\r\\n                                                                              ^\\r\\n/usr/local/opt/oniguruma/include/oniguruma.h:916:97: error: unknown type name 'UChar'\\r\\nint onig_set_callout_data_by_tag P_((OnigRegex reg, OnigMatchParam* mp, const UChar* tag, const UChar* tag_end, int slot, OnigType type, OnigValue* val));\\r\\n                                                                                                ^\\r\\n[ 55%] Building CXX object hphp/runtime/CMakeFiles/hphp_runtime_static.dir/base/rds.cpp.o\\r\\n[ 55%] Building CXX object hphp/runtime/CMakeFiles/hphp_runtime_static.dir/base/repo-auth-type-array.cpp.o\\r\\n[ 55%] Building CXX object hphp/runtime/CMakeFiles/hphp_runtime_static.dir/base/repo-auth-type-codec.cpp.o\\r\\n9 errors generated.\\r\\nmake[2]: *** [hphp/runtime/CMakeFiles/hphp_runtime_static.dir/base/program-functions.cpp.o] Error 1\\r\\nmake[2]: *** Waiting for unfinished jobs....\\r\\nmake[1]: *** [hphp/runtime/CMakeFiles/hphp_runtime_static.dir/all] Error 2\\r\\nmake: *** [all] Error 2\\r\\n```\\r\\n\\r\\nUpdating them locally fixes my problem\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_82", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"82\", \"title\": \"move of regex structure to regint.h causes hhvm compile error\", \"author\": \"slackhappy\", \"labels\": [], \"description\": \"move regex structure from oniguruma.h to regint.h d3420778 causes issue with hhvm compile, because struct is no longer described\\r\\n\\r\\n```\\r\\nLast 15 lines from /Users/johng/Library/Logs/Homebrew/hhvm@3.21-lts/02.make:\\r\\n[ 92%] Building CXX object hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/mbstring/ext_mbstring.cpp.o\\r\\n[ 92%] Building CXX object hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/mcrypt/ext_mcrypt.cpp.o\\r\\n[ 92%] Building CXX object hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/memcache/ext_memcache.cpp.o\\r\\n[ 92%] Building CXX object hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/memcached/ext_memcached.cpp.o\\r\\n/tmp/hhvm@3.21-lts-20180320-98917-gmi4bf/hhvm-3.21.8/hphp/runtime/ext/mbstring/ext_mbstring.cpp:3334:16: error: member access into incomplete type 'regex_t' (aka 're_pattern_buffer')\\r\\n  if (!rc || rc->options != options || rc->enc != enc ||\\r\\n               ^\\r\\n/usr/local/opt/oniguruma/include/oniguruma.h:673:8: note: forward declaration of 're_pattern_buffer'\\r\\nstruct re_pattern_buffer;\\r\\n       ^\\r\\n1 error generated.\\r\\nmake[2]: *** [hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/mbstring/ext_mbstring.cpp.o] Error 1\\r\\nmake[2]: *** Waiting for unfinished jobs....\\r\\nmake[1]: *** [hphp/runtime/ext/CMakeFiles/hphp_runtime_ext.dir/all] Error 2\\r\\nmake: *** [all] Error 2\\r\\n```\\r\\n\\r\\nsimilar to #79 , I believe that making this struct private is an incompatible API change and would typically be a major version bump.\\r\\n\\r\\n\\r\\nI was able to get hhvm to compile by  reverting d3420778 and applying #81 \", \"comments\": [{\"author\": \"kkos\", \"body\": \"Sorry, but please use onig_get_options() and onig_get_encoding().\"}, {\"author\": \"slackhappy\", \"body\": \"i'm not an hhvm contributor, just a humble user of hhvm :)  , but if I were to step into my developer shoes, I'd say that making this struct private is a breaking change worthy of a major version bump, even if it is the right thing to do.  \\r\\n\\r\\nI agree that using apis like onig_get_options/onig_get_encoding would be a better way for hhvm to implement this, but I don't think that makes this change any less breaking.\"}, {\"author\": \"fredemmott\", \"body\": \"It looks like I'll be able to change HHVM to do this without too much trouble: we weren't using these accessors as they weren't available in the versions of oniguruma included in some distributions that we supported. Now we don't support anything older than Trusty, which appears to include a new enough oniguruma.\"}, {\"author\": \"kkos\", \"body\": \"I apologize for the inconvenience this has caused you.\\r\\nI will add a check of UChar in oniguruma.h into test program.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_84", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"84\", \"title\": \"stack-buffer-overflow  in mbc_enc_len\", \"author\": \"xcainiao\", \"labels\": [], \"description\": \"git log\\r\\n```\\r\\ncommit 0516ddd34e4504c8a0f556b3a99f9c3c7a532626\\r\\nAuthor: K.Kosako <kosako@sofnec.co.jp>\\r\\nDate:   Wed Mar 28 09:06:47 2018 +0900\\r\\n\\r\\n    follow #83: update distribution files\\r\\n```\\r\\ntest code\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\nstatic int\\r\\nscan_callback(int n, int r, char* region, void* arg)\\r\\n{\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nscan(regex_t* reg, char* str, char* end)\\r\\n{\\r\\n  int r;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  r = onig_scan(reg, str, end, region, ONIG_OPTION_NONE, scan_callback, NULL);\\r\\n  if (r >= 0) {\\r\\n    fprintf(stdout, \\\"total: %d match\\\\n\\\", r);\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((OnigUChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n  \\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nstatic int \\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* astr,  int pattern_len,\\r\\n    char *end, OnigSyntaxType* sytax)\\r\\n{\\r\\n    int r;\\r\\n    regex_t* reg;\\r\\n    OnigErrorInfo einfo;\\r\\n    UChar* pattern = (UChar* )apattern;\\r\\n    UChar* str     = (UChar* )astr;\\r\\n\\r\\n    onig_initialize(&enc, 1); \\r\\n\\r\\n    r = onig_new(&reg, pattern,\\r\\n                 pattern + pattern_len,\\r\\n                 options, enc, sytax , &einfo);\\r\\n    if (r != ONIG_NORMAL) {\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str(s, r, &einfo);\\r\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s); \\r\\n        return -1; \\r\\n    }   \\r\\n\\r\\n    r = scan(reg, str, end);\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nint main()\\r\\n{\\r\\n    int r;\\r\\n    int i;\\r\\n    char* pattern =\\\"\\\\x28\\\\x7c\\\\x28\\\\x00\\\\x28\\\\x3f\\\\x3a\\\\x5c\\\\x67\\\\x27\\\\x31\\\\x27\\\\x29\\\\x2a\\\\x7c\\\\x7c\\\\x28\\\\x29\\\\x29\\\\x2a\\\\x7c\\\\x28\\\\x28\\\\x28\\\\x28\\\\x29\\\\x29\\\\x29\\\\x5c\\\\x6b\\\\x27\\\\x31\\\\x2d\\\\x30\\\\x27\\\\x29\\\\x29\\\\x30\\\\x7c\\\";\\r\\n\\r\\n    char data[] = {0x0, 0xa, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};\\r\\n    r = exec(ONIG_ENCODING_EUC_JP,ONIG_OPTION_NONE,pattern,(char*) data,39, (char*) data + 64, ONIG_SYNTAX_DEFAULT);\\r\\n    return r;\\r\\n}\\r\\n```\\r\\nerror\\r\\n```\\r\\n==24985==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7ffef1365e80 at pc 0x7f863add3dc2 bp 0x7ffef1363b40 sp 0x7ffef1363b30\\r\\nREAD of size 1 at 0x7ffef1365e80 thread T0\\r\\n    #0 0x7f863add3dc1 in mbc_enc_len /home/github/onigurumag/src/euc_jp.c:56\\r\\n    #1 0x7f863adaf517 in match_at /home/github/onigurumag/src/regexec.c:3398\\r\\n    #2 0x7f863adbeb30 in onig_search_with_param /home/github/onigurumag/src/regexec.c:4837\\r\\n    #3 0x7f863adbd558 in onig_search /home/github/onigurumag/src/regexec.c:4596\\r\\n    #4 0x7f863adbf78e in onig_scan /home/github/onigurumag/src/regexec.c:4970\\r\\n    #5 0x400e8d in scan /home/github/onigurumag/fuzz2.c:17\\r\\n    #6 0x4011f3 in exec /home/github/onigurumag/fuzz2.c:55\\r\\n    #7 0x401404 in main /home/github/onigurumag/fuzz2.c:73\\r\\n    #8 0x7f863a97b82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #9 0x400cb8 in _start (/home/github/onigurumag/fuzz+0x400cb8)\\r\\n\\r\\nAddress 0x7ffef1365e80 is located in stack of thread T0 at offset 96 in frame\\r\\n    #0 0x4012dc in main /home/github/onigurumag/fuzz2.c:62\\r\\n\\r\\n  This frame has 1 object(s):\\r\\n    [32, 96) 'data' <== Memory access at offset 96 overflows this variable\\r\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext\\r\\n      (longjmp and C++ exceptions *are* supported)\\r\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/github/onigurumag/src/euc_jp.c:56 mbc_enc_len\\r\\nShadow bytes around the buggy address:\\r\\n  0x10005e264b80: f3 f3 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264b90: 00 00 f1 f1 f1 f1 00 f4 f4 f4 f2 f2 f2 f2 00 00\\r\\n  0x10005e264ba0: 00 f4 f2 f2 f2 f2 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264bb0: 00 02 f3 f3 f3 f3 f3 f3 f3 f3 00 00 00 00 00 00\\r\\n  0x10005e264bc0: 00 00 00 00 f1 f1 f1 f1 00 00 00 00 00 00 00 00\\r\\n=>0x10005e264bd0:[f3]f3 f3 f3 f3 f3 f3 f3 00 00 00 00 00 00 00 00\\r\\n  0x10005e264be0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264bf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264c00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264c10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x10005e264c20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==24985==ABORTING\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I have fixed it in develop branch.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_85", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"85\", \"title\": \"Obsolete/misplaced notice about some CVEs\", \"author\": \"Arfrever\", \"labels\": [], \"description\": \"`README` and `README.md` mention:\\r\\n```\\r\\nFIXED Security Issues:\\r\\n  CVE-2017-9224, CVE-2017-9225, CVE-2017-9226\\r\\n  CVE-2017-9227, CVE-2017-9228, CVE-2017-9229\\r\\n```\\r\\nAll of these CVEs were fixed in Oniguruma 6.3.0.\\r\\nThe content of `README.md` is displayed in https://github.com/kkos/oniguruma front page and this permanent `FIXED Security Issues: ...` looks quite funny.\\r\\n\\r\\n`README` does not have any version-specific section, so I suggest to delete this notice in this file.\\r\\n`README.md` has version-specific sections, so I suggest to move this notice to 6.3.0 section.\\r\\nSuggested changes:\\r\\n```\\r\\n--- README\\r\\n+++ README\\r\\n@@ -1,13 +1,9 @@\\r\\n-README  2018/01/14\\r\\n+README  2018/04/05\\r\\n \\r\\n Oniguruma  ----   (C) K.Kosako\\r\\n \\r\\n https://github.com/kkos/oniguruma\\r\\n \\r\\n-FIXED Security Issues:\\r\\n-  CVE-2017-9224, CVE-2017-9225, CVE-2017-9226\\r\\n-  CVE-2017-9227, CVE-2017-9228, CVE-2017-9229\\r\\n-\\r\\n ---\\r\\n Oniguruma is a modern and flexible regular expressions library. It\\r\\n encompasses features from different regular expression implementations\\r\\n--- README.md\\r\\n+++ README.md\\r\\n@@ -3,11 +3,6 @@\\r\\n \\r\\n https://github.com/kkos/oniguruma\\r\\n \\r\\n-FIXED Security Issues:\\r\\n---------------------------\\r\\n-  **CVE-2017-9224, CVE-2017-9225, CVE-2017-9226**\\r\\n-  **CVE-2017-9227, CVE-2017-9228, CVE-2017-9229**\\r\\n-\\r\\n Oniguruma is a modern and flexible regular expressions library. It\\r\\n encompasses features from different regular expression implementations\\r\\n that traditionally exist in different languages. It comes close to\\r\\n@@ -115,6 +110,12 @@\\r\\n --------------------------\\r\\n \\r\\n * NEW: octal codepoint \\\\o{.....}\\r\\n+* Fixed CVE-2017-9224\\r\\n+* Fixed CVE-2017-9225\\r\\n+* Fixed CVE-2017-9226\\r\\n+* Fixed CVE-2017-9227\\r\\n+* Fixed CVE-2017-9228\\r\\n+* Fixed CVE-2017-9229\\r\\n \\r\\n \\r\\n New feature of version 6.1.2\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thanks.\\r\\nI have update README.md and README in develop branch.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_86", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"86\", \"title\": \"typedef StateCheckNumType is unused\", \"author\": \"cmb69\", \"labels\": [], \"description\": \"The [typedef short int StateCheckNumType](https://github.com/kkos/oniguruma/blob/v6.8.1/src/regint.h#L713) is unused as of e2e9677111457064d703156487d84e977e5bfd8e, and could be removed.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thanks.\\r\\nI have fixed it in develop branch.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_87", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"87\", \"title\": \"Read unknown address in onig_error_code_to_str\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"Code:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n               apttern_end,\\r\\n               options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\nint main() {\\r\\n    static unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n     OnigUChar* inp = (const OnigUChar*) \\\"\\\\x30\\\\x5c\\\\x67\\\\x3c\\\\x2d\\\\x36\\\\x3e\\\";\\r\\n    int r = exec( ONIG_ENCODING_EUC_JP, ONIG_OPTION_NONE, inp, inp+7, (char *) str, str+7 );\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\nerror:\\r\\n\\r\\n```\\r\\nfot@fot:~/Downloads/oniguruma-develop/test$ ./testc\\r\\nASAN:DEADLYSIGNAL\\r\\n=================================================================\\r\\n==749==ERROR: AddressSanitizer: SEGV on unknown address 0x00000000001a (pc 0x0000005cdaed bp 0x7ffd0c785970 sp 0x7ffd0c7858b0 T0)\\r\\n==749==The signal is caused by a READ memory access.\\r\\n==749==Hint: address points to the zero page.\\r\\n    #0 0x5cdaec in to_ascii /home/fot/Downloads/oniguruma-develop/src/regerror.c:220:31\\r\\n    #1 0x5cd5cc in onig_error_code_to_str /home/fot/Downloads/oniguruma-develop/src/regerror.c:292:11\\r\\n    #2 0x510c4a in exec /home/fot/Downloads/oniguruma-develop/test/testc.c:57:5\\r\\n    #3 0x510948 in main /home/fot/Downloads/oniguruma-develop/test/testc.c:71:13\\r\\n    #4 0x7f2d825c182f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #5 0x419828 in _start (/home/fot/Downloads/oniguruma-develop/test/testc+0x419828)\\r\\n\\r\\nAddressSanitizer can not provide additional info.\\r\\nSUMMARY: AddressSanitizer: SEGV /home/fot/Downloads/oniguruma-develop/src/regerror.c:220:31 in to_ascii\\r\\n==749==ABORTING\\r\\n```\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Fixed it in develop branch.\"}, {\"author\": \"lxxxxfdh\", \"body\": \"Seems the bug is still there. @kkos \\r\\nNote: this error occurs only when compilted with \\\"-O0\\\".\\r\\nCode:\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n               apttern_end,\\r\\n               options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str(s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\nint main() {\\r\\n    static unsigned char str[] = \\\"abcdef\\\";\\r\\n    OnigUChar* inp = (const OnigUChar*) \\\"\\\\x5c\\\\x67\\\\x27\\\\x2d\\\\x32\\\\x33\\\\x27\\\\x27\\\\x27\\\\x27\\\\x15\\\\x27\\\\x33\\\\x27\\\\x27\\\\x3a\\\\x27\\\\x23\\\";\\r\\n    int r = exec( ONIG_ENCODING_EUC_CN, ONIG_OPTION_IGNORECASE, inp, inp+18, (char *) str, str+7 );\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\nerror:\\r\\n\\r\\n```\\r\\nfot@fot:~/Downloads/oniguruma-develop/test$ ./testc\\r\\nASAN:SIGSEGV\\r\\n=================================================================\\r\\n==12986==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000014 (pc 0x000000401e94 bp 0x7ffec2525940 sp 0x7ffec2525900 T0)\\r\\n    #0 0x401e93 in to_ascii (/home/fot/oniguruma-dev/test/testc+0x401e93)\\r\\n    #1 0x40240e in onig_error_code_to_str (/home/fot/oniguruma-dev/test/testc+0x40240e)\\r\\n    #2 0x40183d in exec (/home/fot/oniguruma-dev/test/testc+0x40183d)\\r\\n    #3 0x4019be in main (/home/fot/oniguruma-dev/test/testc+0x4019be)\\r\\n    #4 0x7fa1c98f082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #5 0x401088 in _start (/home/fot/oniguruma-dev/test/testc+0x401088)\\r\\n\\r\\nAddressSanitizer can not provide additional info.\\r\\nSUMMARY: AddressSanitizer: SEGV ??:0 to_ascii\\r\\n==12986==ABORTING\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \" That fault couldn't be reproduced and output error string normally at develop branch head by gcc and Clang.\\r\\nIs there anyone who can reproduce this fault?\\r\\n\\r\\nLinux x86_64\\r\\ngcc version 5.4.0\\r\\nclang version 5.0.0\\r\\n```\\r\\n$ ./configure CC=clang LD=clang CFLAGS=\\\"-g -O0 -fsanitize=fuzzer,address\\\" LDFLAGS=\\\"-fsanitize-coverage=trace-pc-guard -fsanitize=fuzzer,address\\\"\\r\\n$ make\\r\\n$ clang -g -O0 -o 87-2 ~/tmp/87-2.c src/.libs/libonig.a -fsanitize-coverage=trace-pc-guard -fsanitize=fuzzer,address\\r\\n```\"}, {\"author\": \"lxxxxfdh\", \"body\": \"Sorry, I ran on the wrong branch. This issue should be fixed. :)\\r\\n@kkos \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_88", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"88\", \"title\": \"Continious Integration\", \"author\": \"vors\", \"labels\": [], \"description\": \"Hello, thank you for the great library!\\r\\n\\r\\nWould it make sense to add a continuous integration to the project?\\r\\nIt will increase the confidence in the patches by using builds on all the supported platforms.\\r\\n\\r\\nThese are the most popular free solutions that are very easy to integrate:\\r\\nhttps://ci.appveyor.com/ - windows\\r\\nhttps://travis-ci.org/ - unix, mac\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I'm done it.\"}, {\"author\": \"vors\", \"body\": \"üéâ would you mind adding badges with links to CI builds to README.md ?\\r\\nThat way it's super easy to find them / take dev builds for new-comers like me.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_89", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"89\", \"title\": \"Behavior of isolated capture groups with alternation\", \"author\": \"Thom1729\", \"labels\": [], \"description\": \"The following two regexps seem to be equivalent:\\r\\n\\r\\n```regexp\\r\\na(?i)b|c\\r\\na(?i:b|c)\\r\\n```\\r\\n\\r\\nI expected the following to be equivalent instead:\\r\\n\\r\\n```regexp\\r\\na(?i)b|c\\r\\n(?:a(?i)b)|c\\r\\n```\\r\\n\\r\\nThe [documentation](https://github.com/kkos/oniguruma/blob/master/doc/RE#L501) mentions something like this, but it isn't completely clear to me. Is this behavior correct? If so, it might be helpful to add a test [somewhere around here](https://github.com/kkos/oniguruma/blob/master/test/testc.c#L419).\", \"comments\": [{\"author\": \"kkos\", \"body\": \"/a(?i)b|c/ is interpreted as /a(?i)(?:b|c)/ or /a(?i:b|c)/.\\r\\nIt is intended to match with Perl 5.\\r\\n```perl\\r\\n#!/usr/bin/perl\\r\\n\\r\\nif (\\\"C\\\" =~ /(?i)b|c/) {\\r\\n    print \\\"OK\\\\n\\\";\\r\\n}\\r\\nelse {\\r\\n    print \\\"FAIL\\\\n\\\";\\r\\n}\\r\\n\\r\\nif (\\\"aC\\\" =~ /a(?i)(?:b|c)/) {\\r\\n    print \\\"OK\\\\n\\\";\\r\\n}\\r\\nelse {\\r\\n    print \\\"FAIL\\\\n\\\";\\r\\n}\\r\\n\\r\\nif (\\\"C\\\" =~ /(?:a(?i)b)|c/) {\\r\\n    print \\\"OK\\\\n\\\";\\r\\n}\\r\\nelse {\\r\\n    print \\\"FAIL\\\\n\\\";\\r\\n}\\r\\n```\\r\\nOK\\r\\nOK\\r\\nFAIL\\r\\n\\r\\nBut I just found /a(?i)b|c/ is not interpreted as /a(?i)(?:b|c)/ in Perl 5.\\r\\n```perl\\r\\n\\r\\nif (\\\"C\\\" =~ /a(?i)b|c/) {\\r\\n    print \\\"OK\\\\n\\\";\\r\\n}\\r\\nelse {\\r\\n    print \\\"FAIL\\\\n\\\";\\r\\n}\\r\\n```\\r\\nOK\\r\\n\\r\\nThere are different scopes for alternatives and option.\\r\\nIt is strange behavior for me, and I don't want to follow it.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_95", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"95\", \"title\": \"Conflicts with libraries using posix regexec\", \"author\": \"kornelski\", \"labels\": [], \"description\": \"libgit2 uses `regexec` and expects it to be the [GNU implementation](https://github.com/libgit2/libgit2/blob/771dfd1dd1c27a4693dfdfea521c07e72f456b29/deps/regex/regex.h#L567).\\r\\n\\r\\nUnfortunately, when oniguruma is linked it the same project, it clobbers the `regexec` symbol and causes crashes [here](https://github.com/kkos/oniguruma/blob/7482ccfe948a0a4acc86da575c3230e6eba5c8bd/src/regposix.c#L203):\\r\\n\\r\\nhttps://github.com/libgit2/libgit2/issues/4738\\r\\n\\r\\nIs there any way around it?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Configure option \\\"--enable-posix-api=no\\\" removes POSIX objects.\\r\\n```\\r\\n$ ./configure --enable-posix-api=no\\r\\n```\\r\\n\\r\\nBut there is no support for Windows.\\r\\nPlease remove regposix.c and regposerr.c from src/Makefile.windows.\\r\\n\"}, {\"author\": \"kornelski\", \"body\": \"Thanks! \\r\\n\\r\\nIt looks like it's unconditional in CMake:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/master/CMakeLists.txt\\r\\n\\r\\nwould you be interested in a PR that adds such option to cmake?\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_98", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"98\", \"title\": \"AM_PROG_LIBTOOL is deprecated \", \"author\": \"BrokenFreelancer\", \"labels\": [], \"description\": \"`configure.ac` calls to `AM_PROG_LIBTOOL` but `AM_PROG_LIBTOOL` is now deprecated.\\r\\nThe name for the newer version of the macro that should be used now is `LT_INIT`. \\r\\n\\r\\nI will attempt to do a pull request and fix the issue myself, should be simple enough üòÖ, but wanted to formally report the issue first.\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Please send the pull request.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_121", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"121\", \"title\": \"Maybe Miss a NULL pointer check?\", \"author\": \"methyleneBlue\", \"labels\": [], \"description\": \"Hi, I am studying the code of oniguruma.\\r\\nIn the regparse.c file , parse_exp() function ,line 7716.\\r\\nbelow is the code:\\r\\n```\\r\\n  case TK_EOT:\\r\\n  end_of_token:\\r\\n    *np = node_new_empty();\\r\\n    return tok->type;\\r\\n```\\r\\nthere the node_new_empty function may return a NULL pointer,and it seems there should be a check about it.\\r\\nAnd I also wonder the return value, How can I find the return value meanning.\\r\\nIt seems r<0 means error ,and r>=0 means token type.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI have fixed it in develop branch.\\r\\nYou are right about the return value meaning.\"}, {\"author\": \"methyleneBlue\", \"body\": \"Hi,\\r\\nit seems I have found many similar problem about NULL pointer.\\r\\n\\r\\nfunction:onig_st_init_strend_table_with_size\\r\\n\\tregparse.c, line 957\\r\\n```\\r\\n\\tif (IS_NULL(t)) {\\r\\n\\t\\tt = onig_st_init_strend_table_with_size(INIT_NAMES_ALLOC_NUM);\\r\\n\\t\\treg->name_table = (void* )t;\\r\\n        }\\r\\n```\\r\\n\\t\\r\\nunicode.c, line 760\\r\\n```\\r\\n\\tif (UserDefinedPropertyTable == 0) {\\r\\n\\t\\tUserDefinedPropertyTable = onig_st_init_strend_table_with_size(10);\\r\\n\\t} \\r\\n\\t\\r\\n\\te = UserDefinedPropertyRanges + UserDefinedPropertyNum;\\r\\n```\\r\\n\\t\\r\\n\\r\\nfunction:onig_st_init_callout_name_table_with_size\\r\\n\\tregparse.c , line 1363\\r\\n```\\r\\n\\tif (IS_NULL(t)) {\\r\\n\\t\\tt = onig_st_init_callout_name_table_with_size(INIT_NAMES_ALLOC_NUM);\\r\\n\\t\\tGlobalCalloutNameTable = t;\\r\\n\\t}\\r\\n```\\r\\n\\r\\nfunction:onig_reg_callout_list_at\\r\\n\\tseems all call to onig_reg_callout_list_at() in regparse.c need a check.\\r\\n\\tregparse.c, line 1607\\r\\n```\\r\\n\\te = onig_reg_callout_list_at(reg, callout_num);\\r\\n\\treturn e->start_func;\\r\\n```\\r\\n\\r\\nfunction:onig_get_regex_ext\\r\\n\\tthere are many same situation in regparse.c\\r\\n\\tregparse.c, line 1892\\r\\n```\\r\\n\\text = onig_get_regex_ext(reg);\\r\\n\\tr = callout_tag_entry_raw(ext->tag_table, name, name_end, entry_val);\\r\\n```\\r\\n\\r\\nfunction:node_new_anychar\\r\\n\\tregparse.c, line 2129\\r\\n```\\r\\n\\tnode = node_new_anychar();\\r\\n\\tct = CTYPE_(node);\\r\\n\\tct->options = option;\\r\\n\\tNODE_STATUS_ADD(node, FIXED_OPTION);\\r\\n```\\r\\n\\r\\nfunction:node_new_str\\r\\n\\tregparse.c, line 3164\\r\\n```\\r\\n\\tNode* node = node_new_str(s, end);\\r\\n        NODE_STRING_SET_RAW(node);\\r\\n```\\r\\nand line 3196\\r\\n\\r\\nfunction:node_new_list\\r\\n\\tregparse.c, line 8085\\r\\n```\\r\\n    *top  = node_new_list(node, NULL);\\r\\n    headp = &(NODE_CDR(*top));\\r\\n```\\r\\n\\r\\nfunction:onig_node_new_alt\\r\\n\\tregparse.c, line 8131\\r\\n```\\r\\n\\t*top  = onig_node_new_alt(node, NULL);\\r\\n\\theadp = &(NODE_CDR(*top));\\r\\n\\twhile (r == TK_ALT) {\\r\\n\\t\\tr = fetch_token(tok, src, end, env);\\r\\n\\t\\tif (r < 0) return r;\\r\\n\\t\\tr = parse_branch(&node, tok, term, src, end, env);\\r\\n\\t\\tif (r < 0) {\\r\\n\\t\\t\\tonig_node_free(node);\\r\\n\\t\\t\\treturn r;\\r\\n\\t\\t}\\r\\n\\t\\t*headp = onig_node_new_alt(node, NULL);\\r\\n\\t\\theadp = &(NODE_CDR(*headp));\\r\\n\\t}\\r\\n```\\r\\n\\r\\nmacro:FOLDS_FOLD_ADDR_BUK\\r\\n\\tunicode.c, line 115\\r\\n\\tthe addr maybe NULL\\r\\n```\\r\\n\\tFOLDS_FOLD_ADDR_BUK(buk, addr);\\r\\n    rlen = 0;\\r\\n    for (i = 0; i < buk->fold_len; i++) {\\r\\n\\t\\tOnigCodePoint c = addr[i];\\r\\n\\t\\tlen = ONIGENC_CODE_TO_MBC(enc, c, fold);\\r\\n\\t\\tfold += len;\\r\\n\\t\\trlen += len;\\r\\n    }\\r\\n```\\r\\n\"}, {\"author\": \"methyleneBlue\", \"body\": \"Hi,\\r\\n\\r\\nregexec.c , line 4741\\r\\n```\\r\\n      UChar* pre_end = ONIGENC_STEP_BACK(reg->enc, str, end, 1);\\r\\n\\r\\n      max_semi_end = (UChar* )end;\\r\\n      if (ONIGENC_IS_MBC_NEWLINE(reg->enc, pre_end, end)) {\\r\\n        min_semi_end = pre_end;\\r\\n```\\r\\nThe pre_end maybe NULL pointer, and  in the ONIGENC_IS_MBC_NEWLINE ,it will be deferenced in utf_16_le encoding.\"}, {\"author\": \"kkos\", \"body\": \"I think ONIGENC_STEP_BACK(reg->enc, str, end, 1) doesn't return NULL if str < end and the string is a valid byte sequence for the encoding.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_126", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"126\", \"title\": \"Unable to compile when USE_CALLOUT is not defined\", \"author\": \"wbond\", \"labels\": [], \"description\": \"It appears that https://github.com/kkos/oniguruma/blob/6a13239e0c5b55e1c55c1f9d27429343407383e4/src/regexec.c#L1210-L1211 should be inside of the `#ifdef USE_CALLOUT` block.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI will fix it in master and develop branch.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_127", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"127\", \"title\": \"Windows VS 2008 build errors\", \"author\": \"jakirkham\", \"labels\": [], \"description\": \"Am seeing the following errors when building with VS 2008 on Windows. These are present in 6.9.1, but not 6.9.0. The build log is also linked below.\\r\\n\\r\\n```\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1566) : error C2275: 'OnigValue' : illegal use of this type as an expression\\r\\n        c:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\oniguruma.h(748) : see declaration of 'OnigValue'\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1566) : error C2065: 'val' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2275: 'OnigUChar' : illegal use of this type as an expression\\r\\n        c:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\oniguruma.h(76) : see declaration of 'OnigUChar'\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2065: 'ds' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2065: 'val' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2223: left of '->s' must point to struct/union\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2065: 'val' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2223: left of '->s' must point to struct/union\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1567) : error C2198: 'onigenc_strdup' : too few arguments for call\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1568) : error C2065: 'ds' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1570) : error C2065: 'ds' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1570) : warning C4047: '=' : 'OnigUChar *' differs in levels of indirection from 'int'\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1571) : error C2065: 'ds' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1571) : error C2065: 'val' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1571) : error C2223: left of '->s' must point to struct/union\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1571) : error C2065: 'val' : undeclared identifier\\r\\nC:\\\\bld\\\\oniguruma_1546175776687\\\\work\\\\src\\\\regparse.c(1571) : error C2223: left of '->s' must point to struct/union\\r\\nNMAKE : fatal error U1077: 'C:\\\\PROGRA~2\\\\MICROS~1.0\\\\VC\\\\bin\\\\amd64\\\\cl.exe' : return code '0x2'\\r\\nStop.\\r\\nNMAKE : fatal error U1077: '\\\"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 9.0\\\\VC\\\\BIN\\\\amd64\\\\nmake.exe\\\"' : return code '0x2'\\r\\nStop.\\r\\nNMAKE : fatal error U1077: '\\\"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio 9.0\\\\VC\\\\BIN\\\\amd64\\\\nmake.exe\\\"' : return code '0x2'\\r\\nStop.\\r\\n```\\r\\n\\r\\nref: https://ci.appveyor.com/project/conda-forge/oniguruma-feedstock/builds/21293922/job/36rg3s7oq02b1svd\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think this error caused by  a statement inserted before declarations.\\r\\nI want to fix this issue but I am in my hometown now.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_129", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"129\", \"title\": \"PHP 5.6.40 fixed several issues in mbstring bundled oniguruma\", \"author\": \"david-geiger\", \"labels\": [], \"description\": \"Hi, I'm the mageia maintainer of oniguruma package and now we have an open security issues bug report about:\\r\\n\\r\\nPHP 5.6.40 fixed several issues in mbstring:\\r\\nhttp://www.php.net/ChangeLog-5.php#5.6.40\\r\\n\\r\\nAll of the mbstring issues are in the bundled oniguruma, and it looks like they're all relevant to the packaged version.\\r\\n\\r\\nhttps://bugs.mageia.org/show_bug.cgi?id=24338\\r\\n\\r\\nWhat do you think about these security fixes? Should we consider to integrate all of those?\\r\\n\\r\\nRegards,\\r\\nDavid\", \"comments\": [{\"author\": \"kkos\", \"body\": \"#77382\\r\\nThis is fixed at version 6.1.2.\\r\\n\\r\\n#77418\\r\\nThough onig_search() and onig_match() has encoded byte length check option (ONIG_OPTION_CHECK_VALIDITY_OF_STRING),\\r\\nI think onig_search() and onig_match() should not be used for validity check of subject strings.\\r\\nIt is the responsibility of the application.\\r\\n\\r\\n#Others\\r\\nFixed at least 6.9.1.\"}, {\"author\": \"david-geiger\", \"body\": \"Ok great, Thanks for your answer!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_130", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"130\", \"title\": \"Build error on UWP with VS2017\", \"author\": \"myd7349\", \"labels\": [], \"description\": \"Hi! I created a port for `oniguruma` in `vcpkg` few days ago. There are some build errors on UWP with VS2017: \\r\\n\\r\\nhttps://github.com/Microsoft/vcpkg/pull/5432#issuecomment-467416167\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Fixed master branch.\\r\\nIs this fix works for you?\"}, {\"author\": \"myd7349\", \"body\": \"@kkos You are really fast! Thanks! It works for me now. I will close this issue. :-)\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_132", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"132\", \"title\": \"6.9.1: test core dumps\", \"author\": \"kloczek\", \"labels\": [], \"description\": \"<pre>make[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.1/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.1/test&apos;\\r\\n../test-driver: line 107: 31153 Segmentation fault      (core dumped) &quot;$@&quot; &gt; $log_file 2&gt;&amp;1\\r\\nFAIL: testp\\r\\n</pre>\\r\\n\\r\\n\\r\\n<pre>(gdb) r\\r\\nStarting program: /home/tkloczko/rpmbuild/BUILD/onig-6.9.1/test/.libs/lt-testp \\r\\nMissing separate debuginfos, use: dnf debuginfo-install glibc-2.29-7.fc30.x86_64\\r\\nOK: // &apos;&apos;\\r\\n\\r\\nProgram received signal SIGSEGV, Segmentation fault.\\r\\n<font color=\\\"#0000CD\\\">0x00007ffff7e8b610</font> in free () from /usr/lib64/libc.so.6\\r\\n(gdb) bt full\\r\\n<font color=\\\"#CDCD00\\\">#0  </font><font color=\\\"#0000CD\\\">0x00007ffff7e8b610</font> in free () from /usr/lib64/libc.so.6\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#1  </font><font color=\\\"#0000CD\\\">0x00007ffff7ee50ae</font> in regfree () from /usr/lib64/libc.so.6\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#2  </font><font color=\\\"#0000CD\\\">0x000055555555b5fd</font> in xx (<font color=\\\"#00CDCD\\\">pattern</font>=0x55555555c05b &quot;&quot;, <font color=\\\"#00CDCD\\\">str</font>=0x55555555c05b &quot;&quot;, <font color=\\\"#00CDCD\\\">from</font>=0, \\r\\nto=0, <font color=\\\"#00CDCD\\\">mem</font>=0, <font color=\\\"#00CDCD\\\">not</font>=0) at <font color=\\\"#00CD00\\\">testc.c</font>:79\\r\\n        <font color=\\\"#00CDCD\\\">r</font> = &lt;optimized out&gt;\\r\\n        <font color=\\\"#00CDCD\\\">reg</font> = {onig = <font color=\\\"#0000CD\\\">0x0</font>, re_nsub = 0, comp_options = 224}\\r\\n        <font color=\\\"#00CDCD\\\">buf</font> = &apos;\\\\377&apos; &lt;repeats 200 times&gt;\\r\\n        <font color=\\\"#00CDCD\\\">pmatch</font> = {{rm_so = 0, rm_eo = 0}, {rm_so = -1, rm_eo = -1} &lt;repeats 24 times&gt;}\\r\\n<font color=\\\"#CDCD00\\\">#3  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#4  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#5  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#6  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#7  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#8  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#9  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#10 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#11 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#12 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#13 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#14 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#15 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#16 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#17 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#18 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#19 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#20 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#21 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#22 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#23 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#24 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#25 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#26 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#27 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#28 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#29 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#30 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#31 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#32 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#33 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#34 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#35 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#36 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#37 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#38 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#39 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#40 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#41 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#42 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#43 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#44 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#45 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#46 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#47 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#48 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#49 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#50 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#51 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#52 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#53 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#54 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#55 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#56 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#57 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#58 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#59 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#60 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#61 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#62 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#63 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#64 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#65 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#66 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#67 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#68 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#69 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#70 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#71 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#72 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#73 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#74 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#75 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#76 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#77 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#78 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#79 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#80 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#81 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#82 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#83 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#84 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#85 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#86 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#87 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#88 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#89 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#90 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#91 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#92 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#93 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#94 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#95 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#96 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#97 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#98 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#99 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#100 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#101 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#102 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#103 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#104 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#105 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#106 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#107 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#108 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#109 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#110 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#111 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#112 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#113 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#114 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#115 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#116 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#117 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#118 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#119 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#120 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#121 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#122 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#123 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#124 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#125 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#126 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#127 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#128 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#129 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#130 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#131 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#132 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#133 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#134 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#135 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#136 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#137 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#138 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#139 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#140 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#141 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#142 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#143 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#144 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#145 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#146 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#147 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#148 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#149 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#150 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#151 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#152 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#153 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#154 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#155 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#156 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#157 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#158 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#159 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#160 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#161 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#162 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#163 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#164 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#165 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#166 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#167 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#168 </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#169 </font><font color=\\\"#0000CD\\\">0x6e752f6c61636f6c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#170 </font><font color=\\\"#0000CD\\\">0x706d742f403a7869</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#171 </font><font color=\\\"#0000CD\\\">0x6e752d4543492e2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#172 </font><font color=\\\"#0000CD\\\">0x2c343034312f7869</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#173 </font><font color=\\\"#0000CD\\\">0x696e752f78696e75</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#174 </font><font color=\\\"#0000CD\\\">0x2e2f706d742f3a78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#175 </font><font color=\\\"#0000CD\\\">0x78696e752d454349</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#176 </font><font color=\\\"#0000CD\\\">0x4f4300343034312f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#177 </font><font color=\\\"#0000CD\\\">0x3d4d524554524f4c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#178 </font><font color=\\\"#0000CD\\\">0x6f6c6f6365757274</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#179 </font><font color=\\\"#0000CD\\\">0x4f43545349480072</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#180 </font><font color=\\\"#0000CD\\\">0x67693d4c4f52544e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#181 </font><font color=\\\"#0000CD\\\">0x68746f6265726f6e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#182 </font><font color=\\\"#0000CD\\\">0x4e454d5f47445800</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#183 </font><font color=\\\"#0000CD\\\">0x5849464552505f55</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#184 </font><font color=\\\"#0000CD\\\">0x002d656d6f6e673d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#185 </font><font color=\\\"#0000CD\\\">0x455a495354534948</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#186 </font><font color=\\\"#0000CD\\\">0x4f4800303030313d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#187 </font><font color=\\\"#0000CD\\\">0x643d454d414e5453</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#188 </font><font color=\\\"#0000CD\\\">0x6f4d5f006b656d6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#189 </font><font color=\\\"#0000CD\\\">0x6c626154656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#190 </font><font color=\\\"#0000CD\\\">0x57623d5f32303065</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#191 </font><font color=\\\"#0000CD\\\">0x6d5a6c7857646b39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#192 </font><font color=\\\"#0000CD\\\">0x4754764d585a736c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#193 </font><font color=\\\"#0000CD\\\">0x434c69675864756c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#194 </font><font color=\\\"#0000CD\\\">0x334c794e58647649</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#195 </font><font color=\\\"#0000CD\\\">0x324c6c4a58596f4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#196 </font><font color=\\\"#0000CD\\\">0x575a7356485a7631</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#197 </font><font color=\\\"#0000CD\\\">0x304c7a564762705a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#198 </font><font color=\\\"#0000CD\\\">0x434c69556d63764e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#199 </font><font color=\\\"#0000CD\\\">0x334c794e58647649</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#200 </font><font color=\\\"#0000CD\\\">0x324c6c4a58596f4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#201 </font><font color=\\\"#0000CD\\\">0x4762765132627478</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#202 </font><font color=\\\"#0000CD\\\">0x32627439435a7631</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#203 </font><font color=\\\"#0000CD\\\">0x57616d5647623152</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#204 </font><font color=\\\"#0000CD\\\">0x3362443979636c78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#205 </font><font color=\\\"#0000CD\\\">0x464c397869496c4a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#206 </font><font color=\\\"#0000CD\\\">0x47647a6c33636973</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#207 </font><font color=\\\"#0000CD\\\">0x555a7a466d517456</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#208 </font><font color=\\\"#0000CD\\\">0x6c49495256515131</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#209 </font><font color=\\\"#0000CD\\\">0x47646c3969493930</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#210 </font><font color=\\\"#0000CD\\\">0x57646b395762764d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#211 </font><font color=\\\"#0000CD\\\">0x585a736c6d5a6c78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#212 </font><font color=\\\"#0000CD\\\">0x69637a56334c364d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#213 </font><font color=\\\"#0000CD\\\">0x535a794647617a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#214 </font><font color=\\\"#0000CD\\\">0x4762315232627439</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#215 </font><font color=\\\"#0000CD\\\">0x7a636c7857616d56</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#216 </font><font color=\\\"#0000CD\\\">0x334c794e5864766f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#217 </font><font color=\\\"#0000CD\\\">0x324c6c4a58596f4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#218 </font><font color=\\\"#0000CD\\\">0x575a7356485a7631</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#219 </font><font color=\\\"#0000CD\\\">0x304c7a564762705a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#220 </font><font color=\\\"#0000CD\\\">0x694f34566e627078</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#221 </font><font color=\\\"#0000CD\\\">0x3263764933633139</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#222 </font><font color=\\\"#0000CD\\\">0x576276556d636868</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#223 </font><font color=\\\"#0000CD\\\">0x6d5a6c7857646b39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#224 </font><font color=\\\"#0000CD\\\">0x3251764d585a736c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#225 </font><font color=\\\"#0000CD\\\">0x5864766f545a7939</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#226 </font><font color=\\\"#0000CD\\\">0x58596f4e334c794e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#227 </font><font color=\\\"#0000CD\\\">0x32627478324c6c4a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#228 </font><font color=\\\"#0000CD\\\">0x435a763147627651</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#229 </font><font color=\\\"#0000CD\\\">0x4762315232627439</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#230 </font><font color=\\\"#0000CD\\\">0x79636c7857616d56</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#231 </font><font color=\\\"#0000CD\\\">0x69496c4a33624439</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#232 </font><font color=\\\"#0000CD\\\">0x415f485353003978</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#233 </font><font color=\\\"#0000CD\\\">0x4b434f535f485455</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#234 </font><font color=\\\"#0000CD\\\">0x73752f6e75722f3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#235 </font><font color=\\\"#0000CD\\\">0x2f303030312f7265</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#236 </font><font color=\\\"#0000CD\\\">0x2f676e697279656b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#237 </font><font color=\\\"#0000CD\\\">0x4d4c5f5f00687373</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#238 </font><font color=\\\"#0000CD\\\">0x435f4645525f444f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#239 </font><font color=\\\"#0000CD\\\">0x444f4d5f544e554f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#240 </font><font color=\\\"#0000CD\\\">0x3d48544150454c55</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#241 </font><font color=\\\"#0000CD\\\">0x646f6d2f6374652f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#242 </font><font color=\\\"#0000CD\\\">0x73656c6966656c75</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#243 </font><font color=\\\"#0000CD\\\">0x2f7273752f3b313a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#244 </font><font color=\\\"#0000CD\\\">0x6f6d2f6572616873</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#245 </font><font color=\\\"#0000CD\\\">0x656c6966656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#246 </font><font color=\\\"#0000CD\\\">0x7273752f3b313a73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#247 </font><font color=\\\"#0000CD\\\">0x6d2f65726168732f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#248 </font><font color=\\\"#0000CD\\\">0x6c6966656c75646f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#249 </font><font color=\\\"#0000CD\\\">0x78756e694c2f7365</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#250 </font><font color=\\\"#0000CD\\\">0x2f7273752f3b313a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#251 </font><font color=\\\"#0000CD\\\">0x6f6d2f6572616873</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#252 </font><font color=\\\"#0000CD\\\">0x656c6966656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#253 </font><font color=\\\"#0000CD\\\">0x313a65726f432f73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#254 </font><font color=\\\"#0000CD\\\">0x68732f7273752f3b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#255 </font><font color=\\\"#0000CD\\\">0x646f6d6c2f657261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#256 </font><font color=\\\"#0000CD\\\">0x6f6d2f646f6d6c2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#257 </font><font color=\\\"#0000CD\\\">0x656c6966656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#258 </font><font color=\\\"#0000CD\\\">0x313a65726f432f73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#259 </font><font color=\\\"#0000CD\\\">0x494649444f4d5800</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#260 </font><font color=\\\"#0000CD\\\">0x3d6d69403d535245</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#261 </font><font color=\\\"#0000CD\\\">0x5345440073756269</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#262 </font><font color=\\\"#0000CD\\\">0x5345535f504f544b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#263 </font><font color=\\\"#0000CD\\\">0x6f6e673d4e4f4953</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#264 </font><font color=\\\"#0000CD\\\">0x4f4d5f434c00656d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#265 </font><font color=\\\"#0000CD\\\">0x653d59524154454e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#266 </font><font color=\\\"#0000CD\\\">0x6674752e42475f6e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#267 </font><font color=\\\"#0000CD\\\">0x444f4d4c5f5f0038</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#268 </font><font color=\\\"#0000CD\\\">0x554f435f4645525f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#269 </font><font color=\\\"#0000CD\\\">0x49464d4c5f5f544e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#270 </font><font color=\\\"#0000CD\\\">0x73752f3d5f53454c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#271 </font><font color=\\\"#0000CD\\\">0x2f65726168732f72</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#272 </font><font color=\\\"#0000CD\\\">0x6966656c75646f6d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#273 </font><font color=\\\"#0000CD\\\">0x687479702f73656c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#274 </font><font color=\\\"#0000CD\\\">0x6e696870732d6e6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#275 </font><font color=\\\"#0000CD\\\">0x6e6f687479702f78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#276 </font><font color=\\\"#0000CD\\\">0x786e696870732d33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#277 </font><font color=\\\"#0000CD\\\">0x5f444f4d4c00313a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#278 </font><font color=\\\"#0000CD\\\">0x7273752f3d524944</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#279 </font><font color=\\\"#0000CD\\\">0x6c2f65726168732f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#280 </font><font color=\\\"#0000CD\\\">0x646f6d6c2f646f6d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#281 </font><font color=\\\"#0000CD\\\">0x6365786562696c2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#282 </font><font color=\\\"#0000CD\\\">0x4145535f47445800</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#283 </font><font color=\\\"#0000CD\\\">0x0030746165733d54</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#284 </font><font color=\\\"#0000CD\\\">0x6d6f682f3d445750</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#285 </font><font color=\\\"#0000CD\\\">0x7a636f6c6b742f65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#286 </font><font color=\\\"#0000CD\\\">0x75626d70722f6f6b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#287 </font><font color=\\\"#0000CD\\\">0x4c4955422f646c69</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#288 </font><font color=\\\"#0000CD\\\">0x362d67696e6f2f44</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#289 </font><font color=\\\"#0000CD\\\">0x7365742f312e392e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#290 </font><font color=\\\"#0000CD\\\">0x45535f4744580074</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#291 </font><font color=\\\"#0000CD\\\">0x45445f4e4f495353</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#292 </font><font color=\\\"#0000CD\\\">0x6e673d504f544b53</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#293 </font><font color=\\\"#0000CD\\\">0x4e474f4c00656d6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#294 </font><font color=\\\"#0000CD\\\">0x6f6c6b743d454d41</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#295 </font><font color=\\\"#0000CD\\\">0x474458006f6b7a63</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#296 </font><font color=\\\"#0000CD\\\">0x4e4f49535345535f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#297 </font><font color=\\\"#0000CD\\\">0x61773d455059545f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#298 </font><font color=\\\"#0000CD\\\">0x4f4d00646e616c79</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#299 </font><font color=\\\"#0000CD\\\">0x4d4f4853454c5544</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#300 </font><font color=\\\"#0000CD\\\">0x732f7273752f3d45</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#301 </font><font color=\\\"#0000CD\\\">0x6f6d6c2f65726168</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#302 </font><font color=\\\"#0000CD\\\">0x4d00646f6d6c2f64</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#303 </font><font color=\\\"#0000CD\\\">0x2f3d485441504e41</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#304 </font><font color=\\\"#0000CD\\\">0x726168732f727375</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#305 </font><font color=\\\"#0000CD\\\">0x6c2f646f6d6c2f65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#306 </font><font color=\\\"#0000CD\\\">0x726168732f646f6d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#307 </font><font color=\\\"#0000CD\\\">0x4d003a6e616d2f65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#308 </font><font color=\\\"#0000CD\\\">0x524944504d545f43</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#309 </font><font color=\\\"#0000CD\\\">0x6d742f7261762f3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#310 </font><font color=\\\"#0000CD\\\">0x6c6b742d636d2f70</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#311 </font><font color=\\\"#0000CD\\\">0x4a47006f6b7a636f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#312 </font><font color=\\\"#0000CD\\\">0x5f47554245445f53</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#313 </font><font color=\\\"#0000CD\\\">0x4a3d534349504f54</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#314 </font><font color=\\\"#0000CD\\\">0x3b524f5252452053</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#315 </font><font color=\\\"#0000CD\\\">0x4c00474f4c20534a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#316 </font><font color=\\\"#0000CD\\\">0x0036333d53454e49</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#317 </font><font color=\\\"#0000CD\\\">0x474e414c5f4d4447</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#318 </font><font color=\\\"#0000CD\\\">0x552e42475f6e653d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#319 </font><font color=\\\"#0000CD\\\">0x5f434d00382d4654</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#320 </font><font color=\\\"#0000CD\\\">0x323731333d444953</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#321 </font><font color=\\\"#0000CD\\\">0x444f4d4c5f5f0030</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#322 </font><font color=\\\"#0000CD\\\">0x554f435f4645525f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#323 </font><font color=\\\"#0000CD\\\">0x3d485441505f544e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#324 </font><font color=\\\"#0000CD\\\">0x62696c2f7273752f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#325 </font><font color=\\\"#0000CD\\\">0x7479702f63657865</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#326 </font><font color=\\\"#0000CD\\\">0x6870732d336e6f68</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#327 </font><font color=\\\"#0000CD\\\">0x752f3b313a786e69</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#328 </font><font color=\\\"#0000CD\\\">0x313a6e69622f7273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#329 </font><font color=\\\"#0000CD\\\">0x62732f7273752f3b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#330 </font><font color=\\\"#0000CD\\\">0x73752f3b313a6e69</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#331 </font><font color=\\\"#0000CD\\\">0x2f6c61636f6c2f72</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#332 </font><font color=\\\"#0000CD\\\">0x4800313a6e696273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#333 </font><font color=\\\"#0000CD\\\">0x6d6f682f3d454d4f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#334 </font><font color=\\\"#0000CD\\\">0x7a636f6c6b742f65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#335 </font><font color=\\\"#0000CD\\\">0x4e52455355006f6b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#336 </font><font color=\\\"#0000CD\\\">0x6f6c6b743d454d41</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#337 </font><font color=\\\"#0000CD\\\">0x6f4d5f006f6b7a63</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#338 </font><font color=\\\"#0000CD\\\">0x6c626154656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#339 </font><font color=\\\"#0000CD\\\">0x00323d5f7a535f65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#340 </font><font color=\\\"#0000CD\\\">0x52455041505f434c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#341 </font><font color=\\\"#0000CD\\\">0x752e42475f6e653d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#342 </font><font color=\\\"#0000CD\\\">0x474e414c00386674</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#343 </font><font color=\\\"#0000CD\\\">0x552e42475f6e653d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#344 </font><font color=\\\"#0000CD\\\">0x4c5f5f00382d4654</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#345 </font><font color=\\\"#0000CD\\\">0x5f4645525f444f4d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#346 </font><font color=\\\"#0000CD\\\">0x4f4c5f544e554f43</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#347 </font><font color=\\\"#0000CD\\\">0x55444f4d44454441</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#348 </font><font color=\\\"#0000CD\\\">0x687479703d53454c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#349 </font><font color=\\\"#0000CD\\\">0x6e696870732d6e6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#350 </font><font color=\\\"#0000CD\\\">0x6e6f687479702f78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#351 </font><font color=\\\"#0000CD\\\">0x786e696870732d33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#352 </font><font color=\\\"#0000CD\\\">0x4f435f534c00313a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#353 </font><font color=\\\"#0000CD\\\">0x3d73723d53524f4c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#354 </font><font color=\\\"#0000CD\\\">0x3b38333d69643a30</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#355 </font><font color=\\\"#0000CD\\\">0x3d6e6c3a33333b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#356 </font><font color=\\\"#0000CD\\\">0x3a31353b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#357 </font><font color=\\\"#0000CD\\\">0x69703a30303d686d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#358 </font><font color=\\\"#0000CD\\\">0x353b38333b30343d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#359 </font><font color=\\\"#0000CD\\\">0x333d6f733a31313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#360 </font><font color=\\\"#0000CD\\\">0x643a33313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#361 </font><font color=\\\"#0000CD\\\">0x353b353b38333d6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#362 </font><font color=\\\"#0000CD\\\">0x353b38343d64623a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#363 </font><font color=\\\"#0000CD\\\">0x3b38333b3233323b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#364 </font><font color=\\\"#0000CD\\\">0x3d64633a31313b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#365 </font><font color=\\\"#0000CD\\\">0x3233323b353b3834</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#366 </font><font color=\\\"#0000CD\\\">0x3a333b353b38333b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#367 </font><font color=\\\"#0000CD\\\">0x3b353b38343d726f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#368 </font><font color=\\\"#0000CD\\\">0x353b38333b323332</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#369 </font><font color=\\\"#0000CD\\\">0x31303d696d3a393b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#370 </font><font color=\\\"#0000CD\\\">0x343b37333b35303b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#371 </font><font color=\\\"#0000CD\\\">0x3b38343d75733a31</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#372 </font><font color=\\\"#0000CD\\\">0x38333b3639313b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#373 </font><font color=\\\"#0000CD\\\">0x67733a35313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#374 </font><font color=\\\"#0000CD\\\">0x31313b353b38343d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#375 </font><font color=\\\"#0000CD\\\">0x36313b353b38333b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#376 </font><font color=\\\"#0000CD\\\">0x353b38343d61633a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#377 </font><font color=\\\"#0000CD\\\">0x3b38333b3639313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#378 </font><font color=\\\"#0000CD\\\">0x77743a3632323b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#379 </font><font color=\\\"#0000CD\\\">0x30313b353b38343d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#380 </font><font color=\\\"#0000CD\\\">0x36313b353b38333b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#381 </font><font color=\\\"#0000CD\\\">0x353b38343d776f3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#382 </font><font color=\\\"#0000CD\\\">0x353b38333b30313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#383 </font><font color=\\\"#0000CD\\\">0x343d74733a31323b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#384 </font><font color=\\\"#0000CD\\\">0x333b31323b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#385 </font><font color=\\\"#0000CD\\\">0x653a35313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#386 </font><font color=\\\"#0000CD\\\">0x343b353b38333d78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#387 </font><font color=\\\"#0000CD\\\">0x3d7261742e2a3a30</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#388 </font><font color=\\\"#0000CD\\\">0x2a3a393b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#389 </font><font color=\\\"#0000CD\\\">0x3b38333d7a67742e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#390 </font><font color=\\\"#0000CD\\\">0x72612e2a3a393b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#391 </font><font color=\\\"#0000CD\\\">0x393b353b38333d63</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#392 </font><font color=\\\"#0000CD\\\">0x333d6a72612e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#393 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#394 </font><font color=\\\"#0000CD\\\">0x353b38333d7a6174</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#395 </font><font color=\\\"#0000CD\\\">0x61686c2e2a3a393b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#396 </font><font color=\\\"#0000CD\\\">0x3a393b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#397 </font><font color=\\\"#0000CD\\\">0x38333d347a6c2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#398 </font><font color=\\\"#0000CD\\\">0x6c2e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#399 </font><font color=\\\"#0000CD\\\">0x3b353b38333d687a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#400 </font><font color=\\\"#0000CD\\\">0x616d7a6c2e2a3a39</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#401 </font><font color=\\\"#0000CD\\\">0x3a393b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#402 </font><font color=\\\"#0000CD\\\">0x38333d7a6c742e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#403 </font><font color=\\\"#0000CD\\\">0x742e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#404 </font><font color=\\\"#0000CD\\\">0x3b353b38333d7a78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#405 </font><font color=\\\"#0000CD\\\">0x3d6f7a742e2a3a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#406 </font><font color=\\\"#0000CD\\\">0x2a3a393b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#407 </font><font color=\\\"#0000CD\\\">0x3b38333d7a37742e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#408 </font><font color=\\\"#0000CD\\\">0x697a2e2a3a393b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#409 </font><font color=\\\"#0000CD\\\">0x393b353b38333d70</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#410 </font><font color=\\\"#0000CD\\\">0x3b38333d7a2e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#411 </font><font color=\\\"#0000CD\\\">0x7a642e2a3a393b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#412 </font><font color=\\\"#0000CD\\\">0x3a393b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#413 </font><font color=\\\"#0000CD\\\">0x3b38333d7a672e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#414 </font><font color=\\\"#0000CD\\\">0x726c2e2a3a393b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#415 </font><font color=\\\"#0000CD\\\">0x393b353b38333d7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#416 </font><font color=\\\"#0000CD\\\">0x38333d7a6c2e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#417 </font><font color=\\\"#0000CD\\\">0x6c2e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#418 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6f7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#419 </font><font color=\\\"#0000CD\\\">0x333d7a782e2a3a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#420 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#421 </font><font color=\\\"#0000CD\\\">0x353b38333d74737a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#422 </font><font color=\\\"#0000CD\\\">0x737a742e2a3a393b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#423 </font><font color=\\\"#0000CD\\\">0x393b353b38333d74</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#424 </font><font color=\\\"#0000CD\\\">0x333d327a622e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#425 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#426 </font><font color=\\\"#0000CD\\\">0x3b353b38333d7a62</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#427 </font><font color=\\\"#0000CD\\\">0x3d7a62742e2a3a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#428 </font><font color=\\\"#0000CD\\\">0x2a3a393b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#429 </font><font color=\\\"#0000CD\\\">0x38333d327a62742e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#430 </font><font color=\\\"#0000CD\\\">0x742e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#431 </font><font color=\\\"#0000CD\\\">0x393b353b38333d7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#432 </font><font color=\\\"#0000CD\\\">0x333d6265642e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#433 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#434 </font><font color=\\\"#0000CD\\\">0x353b38333d6d7072</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#435 </font><font color=\\\"#0000CD\\\">0x72616a2e2a3a393b</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#436 </font><font color=\\\"#0000CD\\\">0x3a393b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#437 </font><font color=\\\"#0000CD\\\">0x38333d7261772e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#438 </font><font color=\\\"#0000CD\\\">0x652e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#439 </font><font color=\\\"#0000CD\\\">0x3b353b38333d7261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#440 </font><font color=\\\"#0000CD\\\">0x3d7261732e2a3a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#441 </font><font color=\\\"#0000CD\\\">0x2a3a393b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#442 </font><font color=\\\"#0000CD\\\">0x3b38333d7261722e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#443 </font><font color=\\\"#0000CD\\\">0x6c612e2a3a393b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#444 </font><font color=\\\"#0000CD\\\">0x393b353b38333d7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#445 </font><font color=\\\"#0000CD\\\">0x333d6563612e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#446 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#447 </font><font color=\\\"#0000CD\\\">0x353b38333d6f6f7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#448 </font><font color=\\\"#0000CD\\\">0x6970632e2a3a393b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#449 </font><font color=\\\"#0000CD\\\">0x393b353b38333d6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#450 </font><font color=\\\"#0000CD\\\">0x38333d7a372e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#451 </font><font color=\\\"#0000CD\\\">0x722e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#452 </font><font color=\\\"#0000CD\\\">0x393b353b38333d7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#453 </font><font color=\\\"#0000CD\\\">0x333d6261632e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#454 </font><font color=\\\"#0000CD\\\">0x2e2a3a393b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#455 </font><font color=\\\"#0000CD\\\">0x353b38333d6d6977</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#456 </font><font color=\\\"#0000CD\\\">0x6d77732e2a3a393b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#457 </font><font color=\\\"#0000CD\\\">0x3a393b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#458 </font><font color=\\\"#0000CD\\\">0x38333d6d77642e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#459 </font><font color=\\\"#0000CD\\\">0x652e2a3a393b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#460 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6473</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#461 </font><font color=\\\"#0000CD\\\">0x3d67706a2e2a3a39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#462 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#463 </font><font color=\\\"#0000CD\\\">0x333d6765706a2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#464 </font><font color=\\\"#0000CD\\\">0x2a3a33313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#465 </font><font color=\\\"#0000CD\\\">0x38333d67706a6d2e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#466 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#467 </font><font color=\\\"#0000CD\\\">0x38333d6765706a6d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#468 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#469 </font><font color=\\\"#0000CD\\\">0x353b38333d666967</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#470 </font><font color=\\\"#0000CD\\\">0x6d622e2a3a33313b</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#471 </font><font color=\\\"#0000CD\\\">0x313b353b38333d70</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#472 </font><font color=\\\"#0000CD\\\">0x3d6d62702e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#473 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#474 </font><font color=\\\"#0000CD\\\">0x38333d6d67702e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#475 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#476 </font><font color=\\\"#0000CD\\\">0x353b38333d6d7070</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#477 </font><font color=\\\"#0000CD\\\">0x67742e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#478 </font><font color=\\\"#0000CD\\\">0x313b353b38333d61</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#479 </font><font color=\\\"#0000CD\\\">0x3d6d62782e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#480 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#481 </font><font color=\\\"#0000CD\\\">0x38333d6d70782e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#482 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#483 </font><font color=\\\"#0000CD\\\">0x353b38333d666974</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#484 </font><font color=\\\"#0000CD\\\">0x69742e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#485 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6666</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#486 </font><font color=\\\"#0000CD\\\">0x676e702e2a3a3331</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#487 </font><font color=\\\"#0000CD\\\">0x33313b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#488 </font><font color=\\\"#0000CD\\\">0x333d6776732e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#489 </font><font color=\\\"#0000CD\\\">0x2a3a33313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#490 </font><font color=\\\"#0000CD\\\">0x38333d7a6776732e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#491 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#492 </font><font color=\\\"#0000CD\\\">0x353b38333d676e6d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#493 </font><font color=\\\"#0000CD\\\">0x63702e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#494 </font><font color=\\\"#0000CD\\\">0x313b353b38333d78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#495 </font><font color=\\\"#0000CD\\\">0x3d766f6d2e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#496 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#497 </font><font color=\\\"#0000CD\\\">0x38333d67706d2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#498 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#499 </font><font color=\\\"#0000CD\\\">0x3b38333d6765706d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#500 </font><font color=\\\"#0000CD\\\">0x6d2e2a3a33313b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#501 </font><font color=\\\"#0000CD\\\">0x3b353b38333d7632</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#502 </font><font color=\\\"#0000CD\\\">0x766b6d2e2a3a3331</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#503 </font><font color=\\\"#0000CD\\\">0x33313b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#504 </font><font color=\\\"#0000CD\\\">0x3d6d6265772e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#505 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#506 </font><font color=\\\"#0000CD\\\">0x38333d6d676f2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#507 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#508 </font><font color=\\\"#0000CD\\\">0x353b38333d34706d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#509 </font><font color=\\\"#0000CD\\\">0x346d2e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#510 </font><font color=\\\"#0000CD\\\">0x313b353b38333d76</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#511 </font><font color=\\\"#0000CD\\\">0x7634706d2e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#512 </font><font color=\\\"#0000CD\\\">0x33313b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#513 </font><font color=\\\"#0000CD\\\">0x333d626f762e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#514 </font><font color=\\\"#0000CD\\\">0x2a3a33313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#515 </font><font color=\\\"#0000CD\\\">0x353b38333d74712e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#516 </font><font color=\\\"#0000CD\\\">0x756e2e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#517 </font><font color=\\\"#0000CD\\\">0x313b353b38333d76</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#518 </font><font color=\\\"#0000CD\\\">0x3d766d772e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#519 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#520 </font><font color=\\\"#0000CD\\\">0x38333d6673612e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#521 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#522 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6d72</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#523 </font><font color=\\\"#0000CD\\\">0x766d722e2a3a3331</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#524 </font><font color=\\\"#0000CD\\\">0x313b353b38333d62</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#525 </font><font color=\\\"#0000CD\\\">0x3d636c662e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#526 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#527 </font><font color=\\\"#0000CD\\\">0x38333d6976612e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#528 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#529 </font><font color=\\\"#0000CD\\\">0x353b38333d696c66</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#530 </font><font color=\\\"#0000CD\\\">0x6c662e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#531 </font><font color=\\\"#0000CD\\\">0x313b353b38333d76</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#532 </font><font color=\\\"#0000CD\\\">0x333d6c672e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#533 </font><font color=\\\"#0000CD\\\">0x2a3a33313b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#534 </font><font color=\\\"#0000CD\\\">0x353b38333d6c642e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#535 </font><font color=\\\"#0000CD\\\">0x63782e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#536 </font><font color=\\\"#0000CD\\\">0x313b353b38333d66</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#537 </font><font color=\\\"#0000CD\\\">0x3d6477782e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#538 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#539 </font><font color=\\\"#0000CD\\\">0x38333d7675792e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#540 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#541 </font><font color=\\\"#0000CD\\\">0x353b38333d6d6763</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#542 </font><font color=\\\"#0000CD\\\">0x6d652e2a3a33313b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#543 </font><font color=\\\"#0000CD\\\">0x313b353b38333d66</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#544 </font><font color=\\\"#0000CD\\\">0x3d76676f2e2a3a33</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#545 </font><font color=\\\"#0000CD\\\">0x3a33313b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#546 </font><font color=\\\"#0000CD\\\">0x38333d78676f2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#547 </font><font color=\\\"#0000CD\\\">0x2e2a3a33313b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#548 </font><font color=\\\"#0000CD\\\">0x353b38333d636161</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#549 </font><font color=\\\"#0000CD\\\">0x75612e2a3a35343b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#550 </font><font color=\\\"#0000CD\\\">0x35343b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#551 </font><font color=\\\"#0000CD\\\">0x3d63616c662e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#552 </font><font color=\\\"#0000CD\\\">0x3a35343b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#553 </font><font color=\\\"#0000CD\\\">0x38333d61346d2e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#554 </font><font color=\\\"#0000CD\\\">0x2e2a3a35343b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#555 </font><font color=\\\"#0000CD\\\">0x353b38333d64696d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#556 </font><font color=\\\"#0000CD\\\">0x696d2e2a3a35343b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#557 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6964</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#558 </font><font color=\\\"#0000CD\\\">0x616b6d2e2a3a3534</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#559 </font><font color=\\\"#0000CD\\\">0x35343b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#560 </font><font color=\\\"#0000CD\\\">0x333d33706d2e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#561 </font><font color=\\\"#0000CD\\\">0x2a3a35343b353b38</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#562 </font><font color=\\\"#0000CD\\\">0x3b38333d63706d2e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#563 </font><font color=\\\"#0000CD\\\">0x6f2e2a3a35343b35</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#564 </font><font color=\\\"#0000CD\\\">0x3b353b38333d6767</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#565 </font><font color=\\\"#0000CD\\\">0x3d61722e2a3a3534</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#566 </font><font color=\\\"#0000CD\\\">0x3a35343b353b3833</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#567 </font><font color=\\\"#0000CD\\\">0x38333d7661772e2a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#568 </font><font color=\\\"#0000CD\\\">0x2e2a3a35343b353b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#569 </font><font color=\\\"#0000CD\\\">0x353b38333d61676f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#570 </font><font color=\\\"#0000CD\\\">0x706f2e2a3a35343b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#571 </font><font color=\\\"#0000CD\\\">0x3b353b38333d7375</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#572 </font><font color=\\\"#0000CD\\\">0x7870732e2a3a3534</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#573 </font><font color=\\\"#0000CD\\\">0x35343b353b38333d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#574 </font><font color=\\\"#0000CD\\\">0x3d667073782e2a3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#575 </font><font color=\\\"#0000CD\\\">0x3a35343b353b3833</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#576 </font><font color=\\\"#0000CD\\\">0x5255435f47445800</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#577 </font><font color=\\\"#0000CD\\\">0x5345445f544e4552</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#578 </font><font color=\\\"#0000CD\\\">0x4f4e473d504f544b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#579 </font><font color=\\\"#0000CD\\\">0x4d554c4f4300454d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#580 </font><font color=\\\"#0000CD\\\">0x56003936313d534e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#581 </font><font color=\\\"#0000CD\\\">0x49535245565f4554</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#582 </font><font color=\\\"#0000CD\\\">0x00303935353d4e4f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#583 </font><font color=\\\"#0000CD\\\">0x5f444e414c594157</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#584 </font><font color=\\\"#0000CD\\\">0x3d59414c50534944</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#585 </font><font color=\\\"#0000CD\\\">0x2d646e616c796177</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#586 </font><font color=\\\"#0000CD\\\">0x535f444f4d4c0030</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#587 </font><font color=\\\"#0000CD\\\">0x465f475241545445</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#588 </font><font color=\\\"#0000CD\\\">0x505055535f4c4c55</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#589 </font><font color=\\\"#0000CD\\\">0x47006f6e3d54524f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#590 </font><font color=\\\"#0000CD\\\">0x5245545f454d4f4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#591 </font><font color=\\\"#0000CD\\\">0x43535f4c414e494d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#592 </font><font color=\\\"#0000CD\\\">0x726f2f3d4e454552</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#593 </font><font color=\\\"#0000CD\\\">0x2f656d6f6e672f67</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#594 </font><font color=\\\"#0000CD\\\">0x6c616e696d726554</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#595 </font><font color=\\\"#0000CD\\\">0x2f6e65657263732f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#596 </font><font color=\\\"#0000CD\\\">0x3635393430646137</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#597 </font><font color=\\\"#0000CD\\\">0x31345f336132345f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#598 </font><font color=\\\"#0000CD\\\">0x5f303962395f3331</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#599 </font><font color=\\\"#0000CD\\\">0x6666626664643761</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#600 </font><font color=\\\"#0000CD\\\">0x4f4d4c0063346334</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#601 </font><font color=\\\"#0000CD\\\">0x4f49535245565f44</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#602 </font><font color=\\\"#0000CD\\\">0x37312e382e373d4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#603 </font><font color=\\\"#0000CD\\\">0x4245445f534a4700</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#604 </font><font color=\\\"#0000CD\\\">0x555054554f5f4755</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#605 </font><font color=\\\"#0000CD\\\">0x7272656474733d54</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#606 </font><font color=\\\"#0000CD\\\">0x50454c55444f4d00</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#607 </font><font color=\\\"#0000CD\\\">0x544f4f525f485441</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#608 </font><font color=\\\"#0000CD\\\">0x68732f7273752f3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#609 </font><font color=\\\"#0000CD\\\">0x75646f6d2f657261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#610 </font><font color=\\\"#0000CD\\\">0x0073656c6966656c</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#611 </font><font color=\\\"#0000CD\\\">0x535345535f474458</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#612 </font><font color=\\\"#0000CD\\\">0x53414c435f4e4f49</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#613 </font><font color=\\\"#0000CD\\\">0x4c00726573753d53</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#614 </font><font color=\\\"#0000CD\\\">0x3d474b505f444f4d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#615 </font><font color=\\\"#0000CD\\\">0x6168732f7273752f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#616 </font><font color=\\\"#0000CD\\\">0x2f646f6d6c2f6572</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#617 </font><font color=\\\"#0000CD\\\">0x52455400646f6d6c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#618 </font><font color=\\\"#0000CD\\\">0x2d6d726574783d4d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#619 </font><font color=\\\"#0000CD\\\">0x726f6c6f63363532</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#620 </font><font color=\\\"#0000CD\\\">0x45504f5353454c00</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#621 </font><font color=\\\"#0000CD\\\">0x7273752f7c7c3d4e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#622 </font><font color=\\\"#0000CD\\\">0x73656c2f6e69622f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#623 </font><font color=\\\"#0000CD\\\">0x68732e6570697073</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#624 </font><font color=\\\"#0000CD\\\">0x5245535500732520</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#625 </font><font color=\\\"#0000CD\\\">0x6b7a636f6c6b743d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#626 </font><font color=\\\"#0000CD\\\">0x5f454d4f4e47006f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#627 </font><font color=\\\"#0000CD\\\">0x4c414e494d524554</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#628 </font><font color=\\\"#0000CD\\\">0x454349565245535f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#629 </font><font color=\\\"#0000CD\\\">0x4c0037382e313a3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#630 </font><font color=\\\"#0000CD\\\">0x444f4d444544414f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#631 </font><font color=\\\"#0000CD\\\">0x7479703d53454c55</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#632 </font><font color=\\\"#0000CD\\\">0x696870732d6e6f68</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#633 </font><font color=\\\"#0000CD\\\">0x6f687479702f786e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#634 </font><font color=\\\"#0000CD\\\">0x6e696870732d336e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#635 </font><font color=\\\"#0000CD\\\">0x414c505349440078</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#636 </font><font color=\\\"#0000CD\\\">0x4c485300303a3d59</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#637 </font><font color=\\\"#0000CD\\\">0x53414200323d4c56</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#638 </font><font color=\\\"#0000CD\\\">0x752f3d564e455f48</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#639 </font><font color=\\\"#0000CD\\\">0x65726168732f7273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#640 </font><font color=\\\"#0000CD\\\">0x6d6c2f646f6d6c2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#641 </font><font color=\\\"#0000CD\\\">0x2f74696e692f646f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#642 </font><font color=\\\"#0000CD\\\">0x4f4d4c0068736162</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#643 </font><font color=\\\"#0000CD\\\">0x694c3d7379735f44</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#644 </font><font color=\\\"#0000CD\\\">0x495f54510078756e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#645 </font><font color=\\\"#0000CD\\\">0x454c55444f4d5f4d</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#646 </font><font color=\\\"#0000CD\\\">0x564300737562693d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#647 </font><font color=\\\"#0000CD\\\">0x73733d4853525f53</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#648 </font><font color=\\\"#0000CD\\\">0x41454d5f434c0068</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#649 </font><font color=\\\"#0000CD\\\">0x544e454d45525553</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#650 </font><font color=\\\"#0000CD\\\">0x752e42475f6e653d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#651 </font><font color=\\\"#0000CD\\\">0x5f47445800386674</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#652 </font><font color=\\\"#0000CD\\\">0x5800323d524e5456</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#653 </font><font color=\\\"#0000CD\\\">0x49535345535f4744</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#654 </font><font color=\\\"#0000CD\\\">0x00323d44495f4e4f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#655 </font><font color=\\\"#0000CD\\\">0x54656c75646f4d5f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#656 </font><font color=\\\"#0000CD\\\">0x5f313030656c6261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#657 </font><font color=\\\"#0000CD\\\">0x56485a763130583d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#658 </font><font color=\\\"#0000CD\\\">0x786d596852565a73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#659 </font><font color=\\\"#0000CD\\\">0x4a795737317a586c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#660 </font><font color=\\\"#0000CD\\\">0x4e6e636c5a48564e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#661 </font><font color=\\\"#0000CD\\\">0x3054586934326270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#662 </font><font color=\\\"#0000CD\\\">0x3931596973464c7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#663 </font><font color=\\\"#0000CD\\\">0x785761314a575a79</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#664 </font><font color=\\\"#0000CD\\\">0x4a535a746c47566b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#665 </font><font color=\\\"#0000CD\\\">0x4e4862685a575064</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#666 </font><font color=\\\"#0000CD\\\">0x3931596973464c6c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#667 </font><font color=\\\"#0000CD\\\">0x524664793947617a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#668 </font><font color=\\\"#0000CD\\\">0x3154586955576270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#669 </font><font color=\\\"#0000CD\\\">0x78535a7a7857596d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#670 </font><font color=\\\"#0000CD\\\">0x5146613042585a6b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#671 </font><font color=\\\"#0000CD\\\">0x466d5a7330336539</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#672 </font><font color=\\\"#0000CD\\\">0x7458503578576174</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#673 </font><font color=\\\"#0000CD\\\">0x7458505531474c39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#674 </font><font color=\\\"#0000CD\\\">0x68476435426e4962</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#675 </font><font color=\\\"#0000CD\\\">0x6847637a31696276</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#676 </font><font color=\\\"#0000CD\\\">0x31545869676e6270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#677 </font><font color=\\\"#0000CD\\\">0x4a69626d4a795737</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#678 </font><font color=\\\"#0000CD\\\">0x4e58647649535064</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#679 </font><font color=\\\"#0000CD\\\">0x4a58596f4e334c79</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#680 </font><font color=\\\"#0000CD\\\">0x56485a7631324c6c</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#681 </font><font color=\\\"#0000CD\\\">0x564762705a575a73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#682 </font><font color=\\\"#0000CD\\\">0x6847643542334c7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#683 </font><font color=\\\"#0000CD\\\">0x6847637a31696276</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#684 </font><font color=\\\"#0000CD\\\">0x6c486376676e6270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#685 </font><font color=\\\"#0000CD\\\">0x31794d7539476130</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#686 </font><font color=\\\"#0000CD\\\">0x676e62706847637a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#687 </font><font color=\\\"#0000CD\\\">0x566e5a6973464c69</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#688 </font><font color=\\\"#0000CD\\\">0x5557626835456273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#689 </font><font color=\\\"#0000CD\\\">0x6c48636930545869</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#690 </font><font color=\\\"#0000CD\\\">0x4e584c7539476130</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#691 </font><font color=\\\"#0000CD\\\">0x394365756c476177</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#692 </font><font color=\\\"#0000CD\\\">0x3432626f52586577</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#693 </font><font color=\\\"#0000CD\\\">0x6c4761774e584c7a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#694 </font><font color=\\\"#0000CD\\\">0x4a79577349436575</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#695 </font><font color=\\\"#0000CD\\\">0x4a33546b46326273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#696 </font><font color=\\\"#0000CD\\\">0x3054586949585a6b</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#697 </font><font color=\\\"#0000CD\\\">0x4233627942484c78</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#698 </font><font color=\\\"#0000CD\\\">0x73464c3974585055</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#699 </font><font color=\\\"#0000CD\\\">0x7432596852336369</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#700 </font><font color=\\\"#0000CD\\\">0x4a43613042585a45</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#701 </font><font color=\\\"#0000CD\\\">0x4a79577341545064</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#702 </font><font color=\\\"#0000CD\\\">0x4d5864304647647a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#703 </font><font color=\\\"#0000CD\\\">0x4e57596930545869</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#704 </font><font color=\\\"#0000CD\\\">0x7869496c5a586130</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#705 </font><font color=\\\"#0000CD\\\">0x4a585a7a566e4962</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#706 </font><font color=\\\"#0000CD\\\">0x306c496c3157594f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#707 </font><font color=\\\"#0000CD\\\">0x68476435426e4939</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#708 </font><font color=\\\"#0000CD\\\">0x6847637a31696276</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#709 </font><font color=\\\"#0000CD\\\">0x30484c69676e6270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#710 </font><font color=\\\"#0000CD\\\">0x4647637478536673</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#711 </font><font color=\\\"#0000CD\\\">0x4979653945456130</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#712 </font><font color=\\\"#0000CD\\\">0x31324c6a52585a76</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#713 </font><font color=\\\"#0000CD\\\">0x5a575a7356485a76</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#714 </font><font color=\\\"#0000CD\\\">0x7769497a56476270</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#715 </font><font color=\\\"#0000CD\\\">0x3969637a56334c69</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#716 </font><font color=\\\"#0000CD\\\">0x39535a794647617a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#717 </font><font color=\\\"#0000CD\\\">0x5647623152326274</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#718 </font><font color=\\\"#0000CD\\\">0x4979636c7857616d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#719 </font><font color=\\\"#0000CD\\\">0x4933633139694973</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#720 </font><font color=\\\"#0000CD\\\">0x556d636868326376</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#721 </font><font color=\\\"#0000CD\\\">0x55525f4744580076</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#722 </font><font color=\\\"#0000CD\\\">0x49445f454d49544e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#723 </font><font color=\\\"#0000CD\\\">0x752f6e75722f3d52</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#724 </font><font color=\\\"#0000CD\\\">0x303030312f726573</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#725 </font><font color=\\\"#0000CD\\\">0x524f4c4f435f5300</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#726 </font><font color=\\\"#0000CD\\\">0x4c006f7475613d53</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#727 </font><font color=\\\"#0000CD\\\">0x653d454d49545f43</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#728 </font><font color=\\\"#0000CD\\\">0x6674752e42475f6e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#729 </font><font color=\\\"#0000CD\\\">0x2f3d485441500038</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#730 </font><font color=\\\"#0000CD\\\">0x6562696c2f727375</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#731 </font><font color=\\\"#0000CD\\\">0x687479702f636578</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#732 </font><font color=\\\"#0000CD\\\">0x696870732d336e6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#733 </font><font color=\\\"#0000CD\\\">0x2f7273752f3a786e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#734 </font><font color=\\\"#0000CD\\\">0x7273752f3a6e6962</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#735 </font><font color=\\\"#0000CD\\\">0x752f3a6e6962732f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#736 </font><font color=\\\"#0000CD\\\">0x6c61636f6c2f7273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#737 </font><font color=\\\"#0000CD\\\">0x4f4d006e6962732f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#738 </font><font color=\\\"#0000CD\\\">0x48544150454c5544</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#739 </font><font color=\\\"#0000CD\\\">0x6f6d2f6374652f3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#740 </font><font color=\\\"#0000CD\\\">0x656c6966656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#741 </font><font color=\\\"#0000CD\\\">0x732f7273752f3a73</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#742 </font><font color=\\\"#0000CD\\\">0x646f6d2f65726168</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#743 </font><font color=\\\"#0000CD\\\">0x73656c6966656c75</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#744 </font><font color=\\\"#0000CD\\\">0x68732f7273752f3a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#745 </font><font color=\\\"#0000CD\\\">0x75646f6d2f657261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#746 </font><font color=\\\"#0000CD\\\">0x2f73656c6966656c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#747 </font><font color=\\\"#0000CD\\\">0x752f3a78756e694c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#748 </font><font color=\\\"#0000CD\\\">0x65726168732f7273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#749 </font><font color=\\\"#0000CD\\\">0x66656c75646f6d2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#750 </font><font color=\\\"#0000CD\\\">0x726f432f73656c69</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#751 </font><font color=\\\"#0000CD\\\">0x732f7273752f3a65</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#752 </font><font color=\\\"#0000CD\\\">0x6f6d6c2f65726168</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#753 </font><font color=\\\"#0000CD\\\">0x6d2f646f6d6c2f64</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#754 </font><font color=\\\"#0000CD\\\">0x6c6966656c75646f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#755 </font><font color=\\\"#0000CD\\\">0x0065726f432f7365</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#756 </font><font color=\\\"#0000CD\\\">0x49535345534d4447</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#757 </font><font color=\\\"#0000CD\\\">0x656d6f6e673d4e4f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#758 </font><font color=\\\"#0000CD\\\">0x4c49465453494800</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#759 </font><font color=\\\"#0000CD\\\">0x30393d455a495345</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#760 </font><font color=\\\"#0000CD\\\">0x464d4c5f00303030</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#761 </font><font color=\\\"#0000CD\\\">0x752f3d5f53454c49</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#762 </font><font color=\\\"#0000CD\\\">0x65726168732f7273</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#763 </font><font color=\\\"#0000CD\\\">0x66656c75646f6d2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#764 </font><font color=\\\"#0000CD\\\">0x7479702f73656c69</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#765 </font><font color=\\\"#0000CD\\\">0x696870732d6e6f68</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#766 </font><font color=\\\"#0000CD\\\">0x6f687479702f786e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#767 </font><font color=\\\"#0000CD\\\">0x6e696870732d336e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#768 </font><font color=\\\"#0000CD\\\">0x535f535542440078</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#769 </font><font color=\\\"#0000CD\\\">0x425f4e4f49535345</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#770 </font><font color=\\\"#0000CD\\\">0x45524444415f5355</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#771 </font><font color=\\\"#0000CD\\\">0x3a78696e753d5353</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#772 </font><font color=\\\"#0000CD\\\">0x75722f3d68746170</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#773 </font><font color=\\\"#0000CD\\\">0x312f726573752f6e</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#774 </font><font color=\\\"#0000CD\\\">0x007375622f303030</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#775 </font><font color=\\\"#0000CD\\\">0x444d435f444f4d4c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#776 </font><font color=\\\"#0000CD\\\">0x68732f7273752f3d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#777 </font><font color=\\\"#0000CD\\\">0x646f6d6c2f657261</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#778 </font><font color=\\\"#0000CD\\\">0x696c2f646f6d6c2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#779 </font><font color=\\\"#0000CD\\\">0x6d6c2f6365786562</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#780 </font><font color=\\\"#0000CD\\\">0x3d4c49414d00646f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#781 </font><font color=\\\"#0000CD\\\">0x6f70732f7261762f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#782 </font><font color=\\\"#0000CD\\\">0x2f6c69616d2f6c6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#783 </font><font color=\\\"#0000CD\\\">0x6f6b7a636f6c6b74</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#784 </font><font color=\\\"#0000CD\\\">0x454d554e5f434c00</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#785 </font><font color=\\\"#0000CD\\\">0x475f6e653d434952</font> in ?? ()\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#786 </font><font color=\\\"#0000CD\\\">0x4f00386674752e42</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#787 </font><font color=\\\"#0000CD\\\">0x682f3d445750444c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#788 </font><font color=\\\"#0000CD\\\">0x6f6c6b742f656d6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#789 </font><font color=\\\"#0000CD\\\">0x6d70722f6f6b7a63</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#790 </font><font color=\\\"#0000CD\\\">0x55422f646c697562</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#791 </font><font color=\\\"#0000CD\\\">0x67696e6f2f444c49</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#792 </font><font color=\\\"#0000CD\\\">0x4200312e392e362d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#793 </font><font color=\\\"#0000CD\\\">0x434e55465f485341</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#794 </font><font color=\\\"#0000CD\\\">0x29283d25256c6d5f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#795 </font><font color=\\\"#0000CD\\\">0x6c61766520207b20</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#796 </font><font color=\\\"#0000CD\\\">0x444f4d4c24282420</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#797 </font><font color=\\\"#0000CD\\\">0x5f6c6d2f5249445f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#798 </font><font color=\\\"#0000CD\\\">0x2240242220646d63</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#799 </font><font color=\\\"#0000CD\\\">0x48534142007d0a29</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#800 </font><font color=\\\"#0000CD\\\">0x6f6d5f434e55465f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#801 </font><font color=\\\"#0000CD\\\">0x283d2525656c7564</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#802 </font><font color=\\\"#0000CD\\\">0x61766520207b2029</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\\r\\n<font color=\\\"#CDCD00\\\">#803 </font><font color=\\\"#0000CD\\\">0x4f4d4c242824206c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#804 </font><font color=\\\"#0000CD\\\">0x616220444d435f44</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#805 </font><font color=\\\"#0000CD\\\">0x2922402422206873</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#806 </font><font color=\\\"#0000CD\\\">0x6c61766520262620</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#807 </font><font color=\\\"#0000CD\\\">0x4f4d4c7b24282420</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#808 </font><font color=\\\"#0000CD\\\">0x5241545445535f44</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#809 </font><font color=\\\"#0000CD\\\">0x3a2d3a444d435f47</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#810 </font><font color=\\\"#0000CD\\\">0x29687320732d207d</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#811 </font><font color=\\\"#0000CD\\\">0x656d6f682f007d0a</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#812 </font><font color=\\\"#0000CD\\\">0x6b7a636f6c6b742f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#813 </font><font color=\\\"#0000CD\\\">0x6975626d70722f6f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#814 </font><font color=\\\"#0000CD\\\">0x444c4955422f646c</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#815 </font><font color=\\\"#0000CD\\\">0x2e362d67696e6f2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#816 </font><font color=\\\"#0000CD\\\">0x747365742f312e39</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#817 </font><font color=\\\"#0000CD\\\">0x6c2f7362696c2e2f</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#818 </font><font color=\\\"#0000CD\\\">0x0070747365742d74</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#819 </font><font color=\\\"#0000CD\\\">0x0000000000000000</font> in ?? ()\\r\\nNo symbol table info available.\\r\\nBacktrace stopped: Cannot access memory at address 0x7ffffffff000\\r\\n(gdb) \\r\\n</pre>\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It can not be reproduced in my environment. (Ubuntu 16.4 and Mac OSX)\\r\\nWhat is your platform?\\r\\n\\r\\nIf you execute test/.libs/testp directly from gdb and\\r\\nlibrary path is not setted, It can't link with /home/tkloczko/rpmbuild/BUILD/onig-6.9.1/src/.libs/*.so.\\r\\n\\r\\n```\\r\\n$ cd onig-6.9.1\\r\\n$ make clean\\r\\n$ make CFLAGS=\\\"-g -O0\\\"\\r\\n$ cd test\\r\\n$ make CFLAGS=\\\"-g -O0\\\" test\\r\\n$ gdb .libs/testp\\r\\n(gdb) set environment LD_LIBRARY_PATH /home/tkloczko/rpmbuild/BUILD/onig-6.9.1/src/.libs\\r\\n(gdb) r\\r\\n```\\r\\n\"}, {\"author\": \"kloczek\", \"body\": \"I've added -O0 at hre end of my CFLAGS but it does not help,\\r\\nMaybe it will  help if I'll show with what kind of compile options I'm building all my binaries.\\r\\n\\r\\n<pre>gcc -DHAVE_CONFIG_H -I. -I../src  -I../src -I/usr/include  -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto -O0 -c -o testp-testc.o `test -f &apos;testc.c&apos; || echo &apos;./&apos;`testc.c\\r\\nIn file included from <b>/usr/include/bits/libc-header-start.h:33</b>,\\r\\n                 from <b>/usr/include/stdio.h:27</b>,\\r\\n                 from <b>testc.c:5</b>:\\r\\n<b>/usr/include/features.h:382:4:</b> <font color=\\\"#CD00CD\\\"><b>warning: </b></font>#warning _FORTIFY_SOURCE requires compiling with optimization (-O) [<font color=\\\"#CD00CD\\\"><b>-Wcpp</b></font>]\\r\\n  382 | #  <font color=\\\"#CD00CD\\\"><b>warning</b></font> _FORTIFY_SOURCE requires compiling with optimization (-O)\\r\\n      |    <font color=\\\"#CD00CD\\\"><b>^~~~~~~</b></font>\\r\\n<b>cc1:</b> <font color=\\\"#CD00CD\\\"><b>warning: </b></font>unrecognized command line option ‚Äò<b>-Wno-invalid-source-encoding</b>‚Äô\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto -O0 -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto -fuse-linker-plugin -o testp testp-testc.o ../src/libonig.la \\r\\nlibtool: link: gcc -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto -O0 -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto -fuse-linker-plugin -o .libs/testp testp-testc.o  -L/usr/lib ../src/.libs/libonig.so\\r\\n/usr/bin/ld: skipping incompatible /usr/lib/libc.so when searching for -lc\\r\\n[Oniguruma API, UTF-8 check]\\r\\nRESULT   SUCC: 933,  FAIL: 0,  ERROR: 0      (by Oniguruma 6.9.1)\\r\\n[Oniguruma API, ASCII/EUC-JP check]\\r\\nRESULT   SUCC: 785,  FAIL: 0,  ERROR: 0      (by Oniguruma 6.9.1)\\r\\n[POSIX API, ASCII/EUC-JP check]\\r\\nmake: *** [Makefile:1055: test] Error 1\\r\\n\\r\\n[tkloczko@domek test]$ gdb .libs/testp\\r\\n<font color=\\\"#CD00CD\\\"><b>GNU gdb (GDB) Fedora 8.2.50.20190120-15.fc30</b></font>\\r\\nCopyright (C) 2019 Free Software Foundation, Inc.\\r\\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\\r\\nThis is free software: you are free to change and redistribute it.\\r\\nThere is NO WARRANTY, to the extent permitted by law.\\r\\nType &quot;show copying&quot; and &quot;show warranty&quot; for details.\\r\\nThis GDB was configured as &quot;x86_64-redhat-linux-gnu&quot;.\\r\\nType &quot;show configuration&quot; for configuration details.\\r\\nFor bug reporting instructions, please see:\\r\\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\\r\\nFind the GDB manual and other documentation resources online at:\\r\\n    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.\\r\\n\\r\\nFor help, type &quot;help&quot;.\\r\\nType &quot;apropos word&quot; to search for commands related to &quot;word&quot;...\\r\\nReading symbols from <font color=\\\"#00CD00\\\">.libs/testp</font>...\\r\\n(gdb) set environment LD_LIBRARY_PATH /home/tkloczko/rpmbuild/BUILD/onig-6.9.1/src/.libs\\r\\n(gdb) r\\r\\nStarting program: /home/tkloczko/rpmbuild/BUILD/onig-6.9.1/test/.libs/testp \\r\\nMissing separate debuginfos, use: dnf debuginfo-install glibc-2.29-7.fc30.x86_64\\r\\nOK: // &apos;&apos;\\r\\n\\r\\nProgram received signal SIGSEGV, Segmentation fault.\\r\\n<font color=\\\"#0000CD\\\">0x00007ffff7e60610</font> in free () from /lib64/libc.so.6\\r\\nMissing separate debuginfos, use: dnf debuginfo-install libgcc-9.0.1-0.4.fc30.x86_64\\r\\n(gdb) bt full\\r\\n<font color=\\\"#CDCD00\\\">#0  </font><font color=\\\"#0000CD\\\">0x00007ffff7e60610</font> in free () from /lib64/libc.so.6\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#1  </font><font color=\\\"#0000CD\\\">0x00007ffff7eba0ae</font> in regfree () from /lib64/libc.so.6\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#2  </font><font color=\\\"#0000CD\\\">0x00005555555554cb</font> in xx (<font color=\\\"#00CDCD\\\">pattern</font>=0x55555555b05b &quot;&quot;, <font color=\\\"#00CDCD\\\">str</font>=0x55555555b05b &quot;&quot;, <font color=\\\"#00CDCD\\\">from</font>=0, \\r\\nto=0, <font color=\\\"#00CDCD\\\">mem</font>=0, <font color=\\\"#00CDCD\\\">not</font>=0) at <font color=\\\"#00CD00\\\">testc.c</font>:79\\r\\n        <font color=\\\"#00CDCD\\\">r</font> = 0\\r\\n        <font color=\\\"#00CDCD\\\">reg</font> = {onig = <font color=\\\"#0000CD\\\">0x0</font>, re_nsub = 0, comp_options = 224}\\r\\n        <font color=\\\"#00CDCD\\\">buf</font> = &apos;\\\\377&apos; &lt;repeats 200 times&gt;\\r\\n        <font color=\\\"#00CDCD\\\">pmatch</font> = {{rm_so = 0, rm_eo = 0}, {rm_so = -1, rm_eo = -1} &lt;repeats 24 times&gt;}\\r\\n<font color=\\\"#CDCD00\\\">#3  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#4  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#5  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n<font color=\\\"#CDCD00\\\">#6  </font><font color=\\\"#0000CD\\\">0xffffffffffffffff</font> in ?? ()\\r\\nNo symbol table info available.\\r\\n</pre>\"}, {\"author\": \"kloczek\", \"body\": \"<pre><font color=\\\"#AAAAAA\\\">(lldb) bt </font>\\r\\n* thread #1, name = &apos;lt-testp&apos;, stop reason = signal SIGSEGV: invalid address (fault address: 0xfffffffffffffff7)\\r\\n  * frame #0: 0x00007ffff7e60610 libc.so.6`__GI___libc_free + 32\\r\\n    frame #1: 0x00007ffff7eba0ae libc.so.6`__regfree + 62\\r\\n    frame #2: 0x00005555555554cb lt-testp`xx(pattern=&quot;&quot;, str=&quot;&quot;, from=0, to=0, mem=0, not=0) at testc.c:79\\r\\n</pre>\\r\\n\\r\\nSo looks like it fails on x2(\\\"\\\", \\\"\\\", 0, 0);\"}, {\"author\": \"kkos\", \"body\": \"testp includes src/onigposix.h at compile time,\\r\\nbut it execute regcomp(), regexec() and regfree() in libc library, not oniguruma library.\\r\\n```\\r\\nframe #1: 0x00007ffff7eba0ae libc.so.6`__regfree + 62\\r\\n```\\r\\nThat must be the reason of segmentation fault.\\r\\nBut I don't know why testp doesn't execute libonig.so in \\\"make test\\\" on your platform.\\r\\nI suppose your platform is very strict, and does not allow same name function call in libc.\\r\\n\\r\\nPOSIX API has no advantage over Oniguruma API.\\r\\nI want to remove POSIX API, but I leave it for backward compatibility.\\r\\nIt can be removed by configure option.\\r\\n```\\r\\n$ ./configure --enable-posix-api=no\\r\\n```\\r\\nAnd please remove testp in test/Makefile.am.\\r\\n\"}, {\"author\": \"kloczek\", \"body\": \"As you library is used by php-mbstring I think that it may be a problem with php on Fedora.\\r\\nDoes this call should be theoretically compatible with glibc regex() ?\\r\\nif yes does it may mean that something is wrong with glibc regex() ?\\r\\n\\r\\nWill back to you later with results of the tests with --disable-posix-api.\"}, {\"author\": \"kkos\", \"body\": \"Very old Ruby used GNU regex library via POSIX API.\\r\\nSo I had to make POSIX API.\\r\\nPerhaps php-mbstring doesn't use POSIX API for this library.\\r\\nThe PHP community has tremendous technical power\\r\\nso we do not have to worry about this problem.\\r\\nAnd this library will be removed from PHP bundle.\"}, {\"author\": \"kkos\", \"body\": \"I was misunderstanding.\\r\\nVery old Ruby used GNU regex API, not POSIX API.\\r\\nIt was a mistake that I made POSIX API.\"}, {\"author\": \"kloczek\", \"body\": \"Any plans to make new release? :P \\r\\n(txh for have look on the issue :) )\"}, {\"author\": \"kkos\", \"body\": \"I hope to release it next month.\\r\\nHowever, the topics for that have not been implemented yet.\"}, {\"author\": \"kloczek\", \"body\": \"Just have been trying to apply https://github.com/kkos/oniguruma/commit/d1b5c80c1ae86722f308e0aaf86126dab564298d.patch on top of 6.9.1 dist source but patch generates rejects.\\r\\n\\r\\n<pre>[tkloczko@domek SPECS]$ rpmbuild -ba oniguruma.spec\\r\\nwarning: Downloading https://github.com/kkos/oniguruma/commit/d1b5c80c1ae86722f308e0aaf86126dab564298d.patch#/oniguruma-dont-execute-testp-if-ENABLE_POSIX_API-no.patch to /home/tkloczko/rpmbuild/SOURCES/oniguruma-dont-execute-testp-if-ENABLE_POSIX_API-no.patch\\r\\nExecuting(%prep): /bin/sh -e /var/tmp/rpm-tmp.fuwuL3\\r\\n+ umask 022\\r\\n+ cd /home/tkloczko/rpmbuild/BUILD\\r\\n+ cd /home/tkloczko/rpmbuild/BUILD\\r\\n+ rm -rf onig-6.9.1\\r\\n+ /usr/bin/gzip -dc /home/tkloczko/rpmbuild/SOURCES/onig-6.9.1.tar.gz\\r\\n+ /usr/bin/tar -xof -\\r\\n+ STATUS=0\\r\\n+ &apos;[&apos; 0 -ne 0 &apos;]&apos;\\r\\n+ cd onig-6.9.1\\r\\n+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w .\\r\\n+ /usr/bin/cat /home/tkloczko/rpmbuild/SOURCES/oniguruma-dont-execute-testp-if-ENABLE_POSIX_API-no.patch\\r\\n+ /usr/bin/patch -p1 -s --fuzz=0 --no-backup-if-mismatch\\r\\n1 out of 2 hunks FAILED -- saving rejects to file test/Makefile.am.rej\\r\\nerror: Bad exit status from /var/tmp/rpm-tmp.fuwuL3 (%prep)\\r\\n</pre>\"}, {\"author\": \"kkos\", \"body\": \"test/Makefile.am in develop branch has other changes from 6.9.1 to FIX#132.\\r\\nhttps://github.com/kkos/oniguruma/commits/develop/test/Makefile.am\\r\\n\\r\\nIf you want to make a patch for 6.9.1, you need to change test/Makefile.am in 6.9.1 or master branch by hand.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_138", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"138\", \"title\": \"Execute multiple regexps simultaneously and return the first match\", \"author\": \"Thom1729\", \"labels\": [\"enhancement\"], \"description\": \"Oniguruma is used for syntax highlighting in (at least) Sublime Text and Atom. Roughly speaking, the highlighting engines have a list of regexps and they want to find the earliest match. In case of a tie, the first regexp on the list wins.\\r\\n\\r\\nThe `node-oniguruma` bindings, which Atom uses, implement this by creating a separate `regex_t` object for each expression, calling `onig_search` on each in sequence, and determining the result from there. It is likely that many of the regexps will examine character positions far beyond the eventual best match.\\r\\n\\r\\nInstead, `node-oniguruma` could iterate over character positions first and regexps second, calling `onig_match`. This would probably examine a lot less of the string, but this would cost a lot more in overhead (which is presumably why `onig_search` doesn't merely loop over the string and call `onig_match` at every position).\\r\\n\\r\\nIt would be ideal if Oniguruma provided the best of both worlds -- a function that iterated over character positions before regexps, advancing all regexps one character at a time until a match was found.\\r\\n\\r\\nIn a \\\"pure\\\" regexp engine, this could be done fairly easily by merging state machines. I have no idea whether it would be practical in an engine as powerful as Oniguruma.\", \"comments\": [{\"author\": \"iwillspeak\", \"body\": \"Prior art on this:\\r\\n\\r\\n * https://docs.rs/regex/1.1.5/regex/struct.RegexSet.html\\r\\n * https://github.com/google/re2/blob/bc5d6ae59f2bf8fa887e1fa6b00e8662d5953d86/re2/set.h\\r\\n\\r\\nThis comes in very useful when you have a _lot_ of patterns that you want to find matches for in a given search text.\"}, {\"author\": \"kkos\", \"body\": \"@Thom1729, Thank you for your suggestion.\\r\\n@iwillspeak , Thank you for your information.\\r\\n\\r\\nCurrently, Oniguruma does not use multiple strings as optimization information.\\r\\nAt first, I have to implement multiple strings searching algorism for single regex.\\r\\nAfter that, I will try it.\\r\\nBut it's pretty hard, so I can't promise that I can finish it.\\r\\n(* Because each regex pattern has different anchor information for optimization.)\\r\\nI welcome someone to implement it.\"}, {\"author\": \"Thom1729\", \"body\": \"On second thought, could this be done almost entirely by the caller? Suppose that we have three regexps: R1, R2, and R3. We could scan for them as follows:\\r\\n\\r\\n```regexp\\r\\n.*?(?:(R1)|(R2)|(R3))\\r\\n```\\r\\n\\r\\nThen, as I understand it, Oniguruma will find the earliest match (i.e. minimizing `.*?`), and subject to that, it will find the first one of our expressions that matches at that position.\\r\\n\\r\\nCapture group names are a bit of an issue. The caller would have to do a lot of mapping. It would also be necessary to correct any backreferences, etc in the expressions. This would be a bit tricky to do on the caller side, because it would require partially parsing the expression.\\r\\n\\r\\nIf this makes sense, then it could be implemented in the library with a hopefully-simple tree transformation.\"}, {\"author\": \"kkos\", \"body\": \"I have been working on this issue from June.\\r\\nBut it has been suspended for a long time for libfuzzer testing.\\r\\nTherefore it will not be included in the next release (6.9.3).\\r\\n\\r\\nI think your proposal is very interesting.\\r\\n```\\r\\n\\\\O*?(?:(R1)|(R2)|(R3))\\r\\n```\\r\\nHowever, this pattern conversion makes it more difficult to use optimization information of each pattern.\\r\\nIt may not be true if I have implemented this library to build optimization information better.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_139", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"139\", \"title\": \"UAF in match_at()\", \"author\": \"geeknik\", \"labels\": [], \"description\": \"Root cause might be the same as #61, but the stack is a bit different. I found this while fuzzing PHP 7.3.2, verified it exists in 7.3.3 and probably exists in 7.3.4. The PHP devs said they were moving away from bundling this library so here I am with everything I provided to them.\\r\\n\\r\\n`php -r '$file=file_get_contents(\\\"test0011\\\"); print_r(mb_ereg($file, 0);'`\\r\\n\\r\\n```\\r\\necho \\\"KCg/KAApMCspKysrKCgoMFxnPDA+KTApfCgpKSsrKysoKD8oMSkoMFxnPDA+KSkrKysrKyswKigp\\r\\nKSsrKysoKD8oMSkoMFxnPDE+KSspKysrKysrKysrKyooKSkrKysrKCg/KDEpKCgwKVxnPDA+KSsp\\r\\nKysoKSkrMCsrKisrKygoKDBcZzwwPikpKigpKSsrKysoKD8oMSkoMFxnPDA+KSspKysrKysrKysr\\r\\nKyp8KSsrKysqKysrKCg/KDEpKCgwKVxnPDA+KSspKysrKysrKysrKCkpKysqfCkrKysrKCg/KAAp\\r\\nMCkpfA==\\\" | base64 -d | tee test0011\\r\\n```\\r\\n\\r\\nsha256sum test0011\\r\\nd2cf6b02cca2e840688fde31615732602888926dc537a1da65321882ce0f2341\\r\\n\\r\\n\\r\\n\\r\\n```\\r\\n==29451==ERROR: AddressSanitizer: heap-use-after-free on address 0x62600000bbf8 at pc 0x00000117cc7f bp 0x7ffc6692dcd0 sp 0x7ffc6692dcc8\\r\\nREAD of size 8 at 0x62600000bbf8 thread T0\\r\\n    #0 0x117cc7e in match_at /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c\\r\\n    #1 0x117eaff in onig_search_with_param /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4855:7\\r\\n    #2 0x117dbaf in onig_search /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4614:7\\r\\n    #3 0x1292c42 in _php_mb_regex_ereg_exec /root/php-7.3.3/ext/mbstring/php_mbregex.c:912:6\\r\\n    #4 0x1c0c821 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /root/php-7.3.3/Zend/zend_vm_execute.h:690:2\\r\\n    #5 0x1a56533 in execute_ex /root/php-7.3.3/Zend/zend_vm_execute.h:55334:7\\r\\n    #6 0x1a56cb0 in zend_execute /root/php-7.3.3/Zend/zend_vm_execute.h:60881:2\\r\\n    #7 0x18c1514 in zend_eval_stringl /root/php-7.3.3/Zend/zend_execute_API.c:1018:4\\r\\n    #8 0x18c1bdb in zend_eval_stringl_ex /root/php-7.3.3/Zend/zend_execute_API.c:1059:11\\r\\n    #9 0x18c1bdb in zend_eval_string_ex /root/php-7.3.3/Zend/zend_execute_API.c:1070\\r\\n    #10 0x1d05e68 in do_cli /root/php-7.3.3/sapi/cli/php_cli.c:1028:8\\r\\n    #11 0x1d03c08 in main /root/php-7.3.3/sapi/cli/php_cli.c:1389:18\\r\\n    #12 0x7f4c300592e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\\r\\n    #13 0x448109 in _start (/root/php-7.3.3/sapi/cli/php+0x448109)\\r\\n\\r\\n0x62600000bbf8 is located 11000 bytes inside of 11056-byte region [0x626000009100,0x62600000bc30)\\r\\nfreed by thread T0 here:\\r\\n    #0 0x4f426f in realloc /b/swarming/w/ir/k/src/third_party/llvm/compiler-rt/lib/asan/asan_malloc_linux.cc:164:3\\r\\n    #1 0x1189f47 in stack_double /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:1446:30\\r\\n    #2 0x116ea54 in match_at /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:3248:7\\r\\n    #3 0x117eaff in onig_search_with_param /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4855:7\\r\\n    #4 0x117dbaf in onig_search /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4614:7\\r\\n    #5 0x1292c42 in _php_mb_regex_ereg_exec /root/php-7.3.3/ext/mbstring/php_mbregex.c:912:6\\r\\n    #6 0x1c0c821 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /root/php-7.3.3/Zend/zend_vm_execute.h:690:2\\r\\n    #7 0x1a56533 in execute_ex /root/php-7.3.3/Zend/zend_vm_execute.h:55334:7\\r\\n    #8 0x1a56cb0 in zend_execute /root/php-7.3.3/Zend/zend_vm_execute.h:60881:2\\r\\n    #9 0x18c1514 in zend_eval_stringl /root/php-7.3.3/Zend/zend_execute_API.c:1018:4\\r\\n    #10 0x18c1bdb in zend_eval_stringl_ex /root/php-7.3.3/Zend/zend_execute_API.c:1059:11\\r\\n    #11 0x18c1bdb in zend_eval_string_ex /root/php-7.3.3/Zend/zend_execute_API.c:1070\\r\\n    #12 0x1d05e68 in do_cli /root/php-7.3.3/sapi/cli/php_cli.c:1028:8\\r\\n    #13 0x1d03c08 in main /root/php-7.3.3/sapi/cli/php_cli.c:1389:18\\r\\n    #14 0x7f4c300592e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\\r\\n\\r\\npreviously allocated by thread T0 here:\\r\\n    #0 0x4f426f in realloc /b/swarming/w/ir/k/src/third_party/llvm/compiler-rt/lib/asan/asan_malloc_linux.cc:164:3\\r\\n    #1 0x1189f47 in stack_double /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:1446:30\\r\\n    #2 0x116e672 in match_at /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:3487:7\\r\\n    #3 0x117eaff in onig_search_with_param /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4855:7\\r\\n    #4 0x117dbaf in onig_search /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c:4614:7\\r\\n    #5 0x1292c42 in _php_mb_regex_ereg_exec /root/php-7.3.3/ext/mbstring/php_mbregex.c:912:6\\r\\n    #6 0x1c0c821 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /root/php-7.3.3/Zend/zend_vm_execute.h:690:2\\r\\n    #7 0x1a56533 in execute_ex /root/php-7.3.3/Zend/zend_vm_execute.h:55334:7\\r\\n    #8 0x1a56cb0 in zend_execute /root/php-7.3.3/Zend/zend_vm_execute.h:60881:2\\r\\n    #9 0x18c1514 in zend_eval_stringl /root/php-7.3.3/Zend/zend_execute_API.c:1018:4\\r\\n    #10 0x18c1bdb in zend_eval_stringl_ex /root/php-7.3.3/Zend/zend_execute_API.c:1059:11\\r\\n    #11 0x18c1bdb in zend_eval_string_ex /root/php-7.3.3/Zend/zend_execute_API.c:1070\\r\\n    #12 0x1d05e68 in do_cli /root/php-7.3.3/sapi/cli/php_cli.c:1028:8\\r\\n    #13 0x1d03c08 in main /root/php-7.3.3/sapi/cli/php_cli.c:1389:18\\r\\n    #14 0x7f4c300592e0 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x202e0)\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-use-after-free /root/php-7.3.3/ext/mbstring/oniguruma/src/regexec.c in match_at\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Sorry, but I can't find PHP mbreg() function by Google search.\"}, {\"author\": \"geeknik\", \"body\": \"sorry about that copypasta fail, it should be mb_ereg().\"}, {\"author\": \"kkos\", \"body\": \"I could not reproduce the same result by pure C program on Mac OSX 10.13.6.\\r\\nI will test on Linux a few days later.\\r\\n\\r\\n```\\r\\n$ clang -I/usr/local/include -Wall -g -O0 -fsanitize-coverage=edge,trace-pc-guard  -fsanitize=address -o 139 139.c -L/usr/local/lib -lonig\\r\\n$ ./139\\r\\nmatch at 0  (UTF-8)\\r\\n0: (0-0)\\r\\n1: (-1--1)\\r\\n2: (-1--1)\\r\\n3: (-1--1)\\r\\n....\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n\\t       (UChar* )apttern_end,\\r\\n\\t       options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, (UChar* )end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  //char* str = \\\"a\\\";\\r\\n  char* pat;\\r\\n\\r\\n  pat = \\\"((?()0+)+++(((0\\\\\\\\g<0>)0)|())++++((?(1)(0\\\\\\\\g<0>))++++++0*())++++((?(1)(0\\\\\\\\g<1>)+)++++++++++*())++++((?(1)((0)\\\\\\\\g<0>)+)++())+0++*+++(((0\\\\\\\\g<0>))*())++++((?(1)(0\\\\\\\\g<0>)+)++++++++++*|)++++*+++((?(1)((0)\\\\\\\\g<0>)+)+++++++++())++*|)++++((?()0))|\\\";\\r\\n\\r\\n\\r\\n  //exec(ONIG_ENCODING_UTF8, ONIG_OPTION_NONE, pat, pat + strlen(pat), str, str + strlen(str));\\r\\n  exec(ONIG_ENCODING_UTF8, ONIG_OPTION_NONE, pat, pat + strlen(pat), 0, 0);\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"I could not reproduce \\\"heap use after free\\\" results by pure C program on Ubuntu 16.04.\\r\\nBut I found a problematic part in match_at() function.\\r\\nI think that this fix solves the problem.\"}, {\"author\": \"cmb69\", \"body\": \"It seems this ticket can be closed ‚Äì I have not been able to reproduce the PHP issue with Oniguruma 6.9.1 (only with 6.9.0; have not tested 6.9.2RC2 yet, though).\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI understood.\\r\\nPHP 7.3.2 and 7.3.3 include Oniguruma 6.9.0.\\r\\nPerhaps this issue was fixed between 6.9.0 to 6.9.1.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_140", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"140\", \"title\": \"not matching\", \"author\": \"Sysor\", \"labels\": [], \"description\": \"I am trying  this pattern \\\"(\\\\d{1,2}\\\\.){3}(\\\\d{1,2})\\\" for input string \\\"10.1.1.12\\\", but it does not match!!! Why? Any online regex test (example: https://www.regextester.com/97722) is passed with this data, but not oniguruma.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It matched. (6.9.2-rc2 and 6.9.1)\\r\\n\\r\\n```\\r\\n$ gcc -Wall -g -O0 -o 140 140.c -lonig\\r\\n$ ./140\\r\\nmatch at 0  (UTF-8)\\r\\n0: (0-9)\\r\\n1: (5-7)\\r\\n2: (7-9)\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n\\t       (UChar* )apttern_end,\\r\\n\\t       options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, (UChar* )end);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  char* str = \\\"10.1.1.12\\\";\\r\\n  char* pat;\\r\\n\\r\\n  pat = \\\"(\\\\\\\\d{1,2}.){3}(\\\\\\\\d{1,2})\\\";\\r\\n\\r\\n  exec(ONIG_ENCODING_UTF8, ONIG_OPTION_NONE, pat, pat + strlen(pat), str, str + strlen(str));\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"Sysor\", \"body\": \" i used VS2008 compiler.\\r\\n\\r\\n```\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#define STATIC_LIB\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic unsigned char *pattern = \\\"(\\\\d{1,2}\\\\.){3}(\\\\d{1,2})\\\";\\r\\n\\r\\nvoid warning(const char* warn){\\r\\n\\tprintf(\\\"%s\\\\n\\\",warn);\\r\\n}\\r\\n\\r\\nint main(int argc, char* argv[]){\\r\\n\\tint nRes = 0;\\r\\n\\tunsigned char *start, *range, *end, *str;\\r\\n\\tOnigRegex *reg = 0;\\r\\n\\tOnigErrorInfo einfo;\\r\\n\\tOnigRegion *region = 0;\\r\\n\\tOnigEncoding enc[] = {ONIG_ENCODING_CP1251};\\r\\n\\r\\n\\t/*if(argc >= 2){\\r\\n\\t\\tstr = argv[1];\\r\\n\\t}\\r\\n\\telse{\\r\\n\\t\\tprintf(\\\"need string\\\\n\\\");\\r\\n\\t\\tsystem(\\\"pause\\\");\\r\\n\\t\\texit(0);\\r\\n\\t}*/\\r\\n\\tstr = \\\"10.1.1.12\\\";\\r\\n\\r\\n\\tonig_initialize(enc, sizeof(enc)/sizeof(enc[0]));\\r\\n\\tonig_set_warn_func(&warning);\\r\\n\\tonig_set_verb_warn_func(&warning);\\r\\n\\tnRes = onig_new(&reg, pattern, pattern + strlen((char*)pattern), ONIG_OPTION_NONE, ONIG_ENCODING_CP1251, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n\\tif(nRes != ONIG_NORMAL){\\r\\n\\t\\tchar s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n\\t\\tonig_error_code_to_str((UChar* )s, nRes, &einfo);\\r\\n\\t\\tfprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n\\t}\\r\\n\\telse{\\r\\n\\t\\tregion = onig_region_new();\\r\\n\\t\\tend   = str + strlen((char* )str);\\r\\n\\t\\tstart = str;\\r\\n\\t\\trange = end;\\r\\n\\t\\tnRes = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n\\t\\tif (nRes >= 0) {\\r\\n\\t\\t\\tint i;\\r\\n\\r\\n\\t\\t\\tfprintf(stderr, \\\"match at %d\\\\n\\\", nRes);\\r\\n\\t\\t\\tfor (i = 0; i < region->num_regs; i++) {\\r\\n\\t\\t\\t\\tfprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n\\t\\t\\t}\\r\\n\\t\\t}\\r\\n\\t\\telse if (nRes == ONIG_MISMATCH) {\\r\\n\\t\\t\\tfprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n\\t\\t}\\r\\n\\t\\telse { /* error */\\r\\n\\t\\t\\tchar s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n\\t\\t\\tonig_error_code_to_str((UChar* )s, nRes);\\r\\n\\t\\t\\tfprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n\\t\\t\\treturn -1;\\r\\n\\t\\t}\\r\\n\\r\\n\\t\\tonig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n\\t\\tonig_free(reg);\\r\\n\\t\\tonig_end();\\r\\n\\t}\\r\\n\\r\\n\\tsystem(\\\"pause\\\");\\r\\n\\treturn 0;\\r\\n}\\r\\n\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Backslash characters have to be escaped by backslash in C literals.\\r\\n```\\r\\n\\\"(\\\\\\\\d{1,2}\\\\\\\\.){3}(\\\\\\\\d{1,2})\\\"\\r\\n```\\r\\n\"}, {\"author\": \"Sysor\", \"body\": \"sorry, it so stupid! Thanks.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_141", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"141\", \"title\": \"Please fix security issue CVE-2019-9023\", \"author\": \"fan1x\", \"labels\": [], \"description\": \"Is it possible to fix security issue (https://nvd.nist.gov/vuln/detail/CVE-2019-9023) otherwise the library is vulnerable. \\r\\nThere is already patch for this issue here: https://gist.github.com/hughdavenport/c5696e48ea3a83bfe12075f79b2b5abf\\r\\n\\r\\nThanks\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Which of the problem in the link do you mention?\\r\\nIs the problem not fixed in the latest version 6.9.2?\"}, {\"author\": \"fan1x\", \"body\": \"I see. I haven't tried any of the mentioned problem patterns. I just looked into documentation and quickly skimmed through the code that doesn't seem to check the bounds (as shown in the patches) so I expected that it's not fixed yet. \\r\\nAnyway, I see that you added test cases for the vulnerability so it might be fixed, which is great :) \\r\\nWould it be possible to mentioned the fixed security issue in the documentation/README then? (As you did previously with https://github.com/kkos/oniguruma/issues/64). \"}, {\"author\": \"kkos\", \"body\": \"It does not seem appropriate to write the CVE ID assigned to PHP into the Oniguruma README.\\r\\nAnd https://bugs.php.net/bug.php?id=77418 in CVE-2019-9023 is not fixed in Oniguruma.\\r\\nThe reason is written in Issue #129.\\r\\n\"}, {\"author\": \"fan1x\", \"body\": \"yes, you are right. Thanks for explaining and your time. \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_143", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"143\", \"title\": \"What does retry-limit-in-match mean?\", \"author\": \"fstab\", \"labels\": [], \"description\": \"I'm getting an error `retry-limit-in-match over`, and I don't understand what that means. I see from the release notes that this was enabled with rel 6.8.0, and I found an API function to configure it, but I didn't find documentation on what it does.\\r\\n\\r\\nCould you give me a short explanation or a link to documentation on this?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"In the matching at one position in the search range of the string, count the number of times to move from the failure of the match to another choice.\\r\\nAn error will occur if the number exceeds the limit.\\r\\n\\r\\nAmong the \\\"another choice from failure\\\" are:\\r\\n* Alternation  \\\"|\\\"\\r\\n* Quantifier   \\\"a*\\\" etc..\\r\\n* Using \\\"another choice\\\" internally:\\r\\n    \\\\X   (== (?>\\\\O(?:\\\\Y\\\\O)*))\\r\\n    Absent functions\\r\\n    Negative look-ahead\\r\\n    Negatvie look-behind\\r\\n\"}, {\"author\": \"fstab\", \"body\": \"Thanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_145", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"145\", \"title\": \"v6.9.2 breaks rust-onig\", \"author\": \"igor-raits\", \"labels\": [], \"description\": \"https://github.com/rust-onig/rust-onig/issues/103\\r\\n\\r\\nI did some git bisect and I got\\r\\n\\r\\nf000bbb7729bd250c6de006880c0cbbeaca6efb3 is the first bad commit\\r\\n```\\r\\ncommit f000bbb7729bd250c6de006880c0cbbeaca6efb3\\r\\nAuthor: K.Kosako <kosako@sofnec.co.jp>\\r\\nDate:   Wed Jan 30 10:47:09 2019 +0900\\r\\n\\r\\n    re-implement bytecode by using Operation struct\\r\\n\\r\\n src/regcomp.c |  841 +++++++++++++++++++++---------------------\\r\\n src/regexec.c | 1135 +++++++++++++++++++++++++++++++--------------------------\\r\\n src/regint.h  |  175 ++++++++-\\r\\n 3 files changed, 1228 insertions(+), 923 deletions(-)\\r\\n```\\r\\n\\r\\nThis is roughly what it does:\\r\\n\\r\\n```rust\\r\\n        let regex = Regex::new(\\\"(?<foo>he)(?<bar>l+)(?<bar>o)\\\").unwrap();\\r\\n        let names = regex.capture_names().collect::<Vec<_>>();\\r\\n        assert_eq!(\\r\\n            names,\\r\\n            [(\\\"foo\\\", &[1u32] as &[u32]), (\\\"bar\\\", &[2u32, 3] as &[u32])]\\r\\n);\\r\\n```\\r\\n\\r\\nhowever, it either segfaults or returns nothing.\\r\\n\\r\\nI did not have time to dig more into what is going on, but you might know what can be the problem.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"In the commit f000bbb, I made a mistake.\\r\\nONIG_DEBUG_PARSE and ONIG_DEBUG_COMPILE should not be enabled.\\r\\nIf these are enabled, debugging information will be output to stdout.\\r\\nThis mistake was fixed in 029c669.\\r\\n(However, I do not know if this mistake is related to the problem.)\\r\\n\\r\\nsrc/regint.h\\r\\n```\\r\\n/* #define ONIG_DEBUG_PARSE */\\r\\n/* #define ONIG_DEBUG_COMPILE */\\r\\n#define ONIG_DEBUG_PARSE\\r\\n#define ONIG_DEBUG_COMPILE\\r\\n```\\r\\n\"}, {\"author\": \"kornelski\", \"body\": \"rust_onig has been updated, so this issue can be closed now.\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_146", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"146\", \"title\": \"v6.9.2 breaks php parsing in vscode and atom\", \"author\": \"PF4Public\", \"labels\": [], \"description\": \"vscode gives the following error:\\r\\n\\r\\n> [renderer1] [error] invalid code point value: Error: invalid code point value\\r\\n>     at Object.createOnigScanner (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:67:24)\\r\\n>     at Grammar.createOnigScanner (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2478:30)\\r\\n>     at RegExpSourceList.compile (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:1853:38)\\r\\n>     at BeginEndRule.compile (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2008:45)\\r\\n>     at matchRule (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2724:28)\\r\\n>     at matchRuleOrInjections (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2743:23)\\r\\n>     at scanNext (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2833:17)\\r\\n>     at _tokenizeString (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2826:9)\\r\\n>     at Grammar._tokenize (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2582:25)\\r\\n>     at Grammar.tokenizeLine2 (/usr/lib64/vscode/node_modules.asar/vscode-textmate/release/main.js:2552:22)\\r\\n>     at D.tokenize2 (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:4365:788)\\r\\n>     at h._updateTokensUntilLine (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:1173:735)\\r\\n>     at h._tokenizeOneLine (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:1173:187)\\r\\n>     at P._revalidateTokensNow (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:1203:644)\\r\\n>     at P._warmUpTokens (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:1203:327)\\r\\n>     at P._tokenizationListener.C.TokenizationRegistry.onDidChange.e (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:1177:857)\\r\\n>     at d.fire (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:77:983)\\r\\n>     at r.fire (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:627:245)\\r\\n>     at register (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:627:336)\\r\\n>     at _promises.set.t.then.t (file:///usr/lib64/vscode/out/vs/workbench/workbench.main.js:627:543)\\r\\n\\r\\natom gives a similar error\\r\\n\\r\\nThis does not happen in v6.9.1\\r\\n\\r\\nSee elprans/atom-overlay#41 for a reference\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I changed the maximum number of bytes from 6 to 4 in utf-8 encoding to RFC 3629.\\r\\n(de6342d)\\r\\nI feel that this is related to the error, but I can not conclude that the regular expression pattern is unknown.\"}, {\"author\": \"PF4Public\", \"body\": \"Sorry, for the long delay.\\r\\n\\r\\nIs there any way to find out the cause and fix it? Is there any way I could help?\"}, {\"author\": \"kkos\", \"body\": \"I don't know atom-overlay, vscode-textmate etc..\\r\\nTherefore I can not investigate these.\\r\\n\\r\\n I created issue_146 branch.\\r\\nhttps://github.com/kkos/oniguruma/tree/issue_146\\r\\nIn this branch, when an error occurs in onig_new(), the pattern is output to standard error.\\r\\nI don't know if the patterns appear correctly in your execution environment, but that's all I can do.\"}, {\"author\": \"PF4Public\", \"body\": \"Thank you for your modifications, but this didn't catch the regexp.\\r\\n\\r\\nModifying the source further gave some results. \\r\\n\\r\\nLike you've said, `code_to_mbclen(OnigCodePoint code)` in utf8.c does check for a length. Disabling the check seemingly fixes the syntax highlight in vscode and atom.\\r\\n\\r\\nAdding print before returning with `return ONIGERR_INVALID_CODE_POINT_VALUE;` gave the following offending codepoint __2147483647__, which is __0x7FFFFFFF__, which is strange. \\r\\n\\r\\nHaving disabled the 4-byte check I've dumped every pattern, that `onig_new` receives. To my surprise not only __0x7FFFFFFF__ had no mentions, but even __0x7F__ didn't occur a single time.\\r\\n\\r\\nDigging further I caught a lot of occurrences of __2147483647__ in regparse.c in `case TK_CODE_POINT:` of `parse_char_class`. The beginning of a dump follows:\\r\\n\\r\\n> code: 45\\r\\n> code: 45\\r\\n> code: 45\\r\\n> code: 9\\r\\n> code: 45\\r\\n> code: 45\\r\\n> code: 9\\r\\n> code: 9\\r\\n> code: 183\\r\\n> code: 192\\r\\n> code: 214\\r\\n> code: 216\\r\\n> code: 246\\r\\n> code: 248\\r\\n> code: 893\\r\\n> code: 895\\r\\n> code: 8191\\r\\n> code: 8204\\r\\n> code: 8205\\r\\n> code: 8255\\r\\n> code: 8256\\r\\n> code: 8304\\r\\n> code: 8591\\r\\n> code: 11264\\r\\n> code: 12271\\r\\n> code: 12289\\r\\n> code: 55295\\r\\n> code: 63744\\r\\n> code: 64975\\r\\n> code: 65008\\r\\n> code: 65533\\r\\n> code: 65536\\r\\n> code: 983039\\r\\n> code: 183\\r\\n> code: 192\\r\\n> code: 214\\r\\n> code: 216\\r\\n> code: 246\\r\\n> code: 248\\r\\n> code: 893\\r\\n> code: 895\\r\\n> code: 8191\\r\\n> code: 8204\\r\\n> code: 8205\\r\\n> code: 8255\\r\\n> code: 8256\\r\\n> code: 8304\\r\\n> code: 8591\\r\\n> code: 11264\\r\\n> code: 12271\\r\\n> code: 12289\\r\\n> code: 55295\\r\\n> code: 63744\\r\\n> code: 64975\\r\\n> code: 65008\\r\\n> code: 65533\\r\\n> code: 65536\\r\\n> code: 983039\\r\\n> code: 183\\r\\n> code: 192\\r\\n> code: 214\\r\\n> code: 216\\r\\n> code: 246\\r\\n> code: 248\\r\\n> code: 893\\r\\n> code: 895\\r\\n> code: 8191\\r\\n> code: 8204\\r\\n> code: 8205\\r\\n> code: 8255\\r\\n> code: 8256\\r\\n> code: 8304\\r\\n> code: 8591\\r\\n> code: 11264\\r\\n> code: 12271\\r\\n> code: 12289\\r\\n> code: 55295\\r\\n> code: 63744\\r\\n> code: 64975\\r\\n> code: 65008\\r\\n> code: 65533\\r\\n> code: 65536\\r\\n> code: 983039\\r\\n> code: 183\\r\\n> code: 192\\r\\n> code: 214\\r\\n> code: 216\\r\\n> code: 246\\r\\n> code: 248\\r\\n> code: 893\\r\\n> code: 895\\r\\n> code: 8191\\r\\n> code: 8204\\r\\n> code: 8205\\r\\n> code: 8255\\r\\n> code: 8256\\r\\n> code: 8304\\r\\n> code: 8591\\r\\n> code: 11264\\r\\n> code: 12271\\r\\n> code: 12289\\r\\n> code: 55295\\r\\n> code: 63744\\r\\n> code: 64975\\r\\n> code: 65008\\r\\n> code: 65533\\r\\n> code: 65536\\r\\n> code: 983039\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 45\\r\\n> code: 45\\r\\n> code: 45\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n> code: 127\\r\\n> code: 2147483647\\r\\n\\r\\nUnfortunately, at this point I have no idea how to interpret this result and what to do next.\"}, {\"author\": \"kkos\", \"body\": \"0x7f is a valid code in UTF-8.\\r\\nIn your code point output, incorrect code looks like 0x7FFFFFFF only.\\r\\nYou should ask the PHP mode file maintainer to change 0x7FFFFFFF to 0x1FFFFF.\\r\\nI do not know who the person is.\"}, {\"author\": \"PF4Public\", \"body\": \">You should ask the PHP mode file maintainer to change 0x7FFFFFFF to 0x1FFFFF.\\r\\n\\r\\nMay I ask you to rephrase this? I don't get, what _PHP mode_ is :( Is it an extension, responsible for PHP or something?\"}, {\"author\": \"Thom1729\", \"body\": \"@PF4Public \\r\\n\\r\\n> May I ask you to rephrase this? I don't get, what PHP mode is :( Is it an extension, responsible for PHP or something?\\r\\n\\r\\nI believe that @kkos is referring to the syntax definition used for highlighting PHP. In some editors, these are known as ‚Äúmodes‚Äù.\\r\\n\\r\\nAt a glance, it seems that [this](https://github.com/atom/language-php/blob/master/grammars/php.cson) is Atom's PHP syntax definition. You can see `\\\\x{7f}-\\\\x{7fffffff}` all over the place in that file. As I understand it, the intent is to match any Unicode character whose UTF-8 representation contains only bytes >= 0x7f. By coincidence, this is every character whose code point is >= 0x7f. See https://github.com/atom/language-php/pull/302 for more discussion.\\r\\n\\r\\nThe problem is that \\\\x{7fffffff} is not a valid Unicode code point, so Oniguruma won't accept the expressions. Instead, the expressions should use `\\\\x{7f}-\\\\x{10ffff}`. There should be no downside to this, because there are no characters with code points greater than 0x10ffff.\\r\\n\\r\\nWhy did this break? Before 6.9.2, `\\\\x{7fffffff}` would have been interpreted as referring to a code point with a six-byte UTF-8 encoding. In 6.9.2, a code point that would require five or six bytes will instead result in an error\"}, {\"author\": \"kkos\", \"body\": \"Thanks @Thom1729.\\r\\nCorrect my previous comment.\\r\\nIt was better to use 0x10FFFF instead of 0x1FFFFF for Unicode range.\\r\\n\\r\\nBy the way, in the current master branch, I added ONIG_SYN_ALLOW_INVALID_CODE_END_OF_RANGE_IN_CC and enabled it in DEFAULT syntax only.\\r\\nThis allows invalid character code values at the end of a range in a character class.\"}, {\"author\": \"PF4Public\", \"body\": \"@kkos , @Thom1729 Thank you for your replies. After updating to oniguruma-6.9.3 this seems to be fixed‚Ä¶\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_147", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"147\", \"title\": \"Stack Exhaustion Problem caused by some parsing functions in regcomp.c making recursive calls to themselves.\", \"author\": \"RKX1209\", \"labels\": [], \"description\": \"If Oniguruma try to parse very deep regex nodes, it causes stack buffer overflow due to deep recursive calls to some parsing functions like optimize_nodes(), tree_min_len().\\r\\n\\r\\nHere is a POC source code that simply executes onig_search() with very large regular expression \\\"X+++++++++++++++++++++++++++++++ .... \\\". \\r\\n\\r\\n```oniguruma_sbof.c\\r\\n/*\\r\\n * oniguruma_sbof.c\\r\\n */\\r\\n#include <stdio.h>\\r\\n#include <stdlib.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nextern int exec(OnigSyntaxType* syntax, char* apattern, char* astr)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range, *end;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  OnigRegion *region;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen((char* )pattern),\\r\\n               ONIG_OPTION_DEFAULT, ONIG_ENCODING_ASCII, syntax, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  end   = str + strlen((char* )str);\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n    onig_free(reg);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  onig_free(reg);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\n#define REGEX_SZ 0x10000\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  int r, i;\\r\\n\\r\\n  OnigEncoding use_encs[] = { ONIG_ENCODING_ASCII };\\r\\n  char regex[REGEX_SZ] = {0};  \\r\\n  regex[0] = 'X';\\r\\n  for (i = 1; i < REGEX_SZ; i++) regex[i] = '+';\\r\\n\\r\\n  onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n  \\r\\n  r = exec(ONIG_SYNTAX_RUBY, regex, \\\"bgc\\\");\\r\\n\\r\\n  onig_end();\\r\\n  return r;\\r\\n}\\r\\n```\\r\\n```\\r\\ngcc -g -o oniguruma_stack oniguruma_stack.c -lonig\\r\\n./oniguruma_stack\\r\\nSegmentation fault (core dumped)\\r\\n```\\r\\n\\r\\n```\\r\\ngdb -q ./oniguruma_syntax -c core\\r\\nReading symbols from ./oniguruma_stack...done.                                        \\r\\n[New LWP 19257]                                                                       \\r\\nCore was generated by `./oniguruma_stack'.                                            \\r\\nProgram terminated with signal SIGSEGV, Segmentation fault.                           \\r\\n#0  0x00007fe64f65fde5 in tree_min_len (                                              \\r\\n    node=<error reading variable: Cannot access memory at address 0x7ffcc7ec9fe8>,    \\r\\n    env=<error reading variable: Cannot access memory at address 0x7ffcc7ec9fe0>)     \\r\\n    at regcomp.c:2839                                                                 \\r\\n2839    {                                                                             \\r\\n(gdb) bt                    \\r\\n#0  0x00007fe64f65fde5 in tree_min_len (                                              \\r\\n    node=<error reading variable: Cannot access memory at address 0x7ffcc7ec9fe8>,    \\r\\n    env=<error reading variable: Cannot access memory at address 0x7ffcc7ec9fe0>)     \\r\\n    at regcomp.c:2839\\r\\n#1  0x00007fe64f660196 in tree_min_len (node=0x55b2d734a570, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2942\\r\\n#2  0x00007fe64f66009b in tree_min_len (node=0x55b2d734a5b0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2913\\r\\n#3  0x00007fe64f660196 in tree_min_len (node=0x55b2d734a5f0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2942\\r\\n#4  0x00007fe64f66009b in tree_min_len (node=0x55b2d734a630, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2913\\r\\n#5  0x00007fe64f660196 in tree_min_len (node=0x55b2d734a670, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2942\\r\\n#6  0x00007fe64f66009b in tree_min_len (node=0x55b2d734a6b0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2913\\r\\n#7  0x00007fe64f660196 in tree_min_len (node=0x55b2d734a6f0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2942\\r\\n#8  0x00007fe64f66009b in tree_min_len (node=0x55b2d734a730, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2913\\r\\n#9  0x00007fe64f660196 in tree_min_len (node=0x55b2d734a770, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2942\\r\\n#10 0x00007fe64f66009b in tree_min_len (node=0x55b2d734a7b0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c:2913\\r\\n#11 0x00007fe64f660196 in tree_min_len (node=0x55b2d734a7f0, env=0x7ffcc86b7470)\\r\\n    at regcomp.c\\r\\n....\\r\\n```\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thanks for your report.\\r\\nI have fixed it in develop branch.\"}, {\"author\": \"RKX1209\", \"body\": \"Wow. Thank you so much. \\r\\nI appreciate your very quick response!\"}, {\"author\": \"nluedtke\", \"body\": \"This was assigned [CVE-2019-16163](https://nvd.nist.gov/vuln/detail/CVE-2019-16163).\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_148", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"148\", \"title\": \"ERROR(-206): too short multibyte code string\", \"author\": \"jwhur72\", \"labels\": [], \"description\": \"Hi.\\r\\n\\r\\nI found some problem in oniguruma 6.9.2.\\r\\nmy code is below.\\r\\nthe error message is \\\"ERROR(-206): too short multibyte code string\\\".\\r\\nplease let me know how to solve this problem.\\r\\n\\r\\nPlatform : macOS 10.14.5\\r\\nXCode : Version 10.2.1 (10E1001)\\r\\noniguruma : Version 6.9.2\\r\\n\\r\\n#include <string>\\r\\n\\r\\nint main()\\r\\n{\\r\\n    OnigEncoding use_encs[] = { ONIG_ENCODING_UTF16_LE };\\r\\n    onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n    \\r\\n    std::u16string pattern = u\\\"%(\\\\\\\\[\\\\\\\\d+\\\\\\\\])?([\\\\\\\\+#\\\\\\\\-0\\\\\\\\x20]{,2}((\\\\\\\\d+|\\\\\\\\*)?(\\\\\\\\.?(\\\\\\\\d+|\\\\\\\\*|(\\\\\\\\[\\\\\\\\d+\\\\\\\\])\\\\\\\\*?)?(\\\\\\\\[\\\\\\\\d+\\\\\\\\])?)?))?[vT%tbcdoqxXUbeEfFgGsp]\\\";\\r\\n    std::u16string text = u\\\"   switch(test)\\\\n\\\";\\r\\n    \\r\\n    size_t n = pattern.length();\\r\\n    UChar *s = (UChar* )(pattern.c_str());\\r\\n    UChar *e = (UChar* )(pattern.c_str() + n);\\r\\n    \\r\\n    regex_t* reg = nullptr;\\r\\n    OnigErrorInfo einfo;\\r\\n    myassert(ONIG_SYNTAX_DEFAULT->op & ONIG_SYN_OP_ESC_CAPITAL_G_BEGIN_ANCHOR);\\r\\n    int r = onig_new(&reg, s, e, ONIG_OPTION_CAPTURE_GROUP, ONIG_ENCODING_UTF16_LE, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n    if (r != ONIG_NORMAL)\\r\\n    {\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n        fprintf(stderr, \\\"ERROR(%d): %s\\\\n\\\", r, s);\\r\\n        return -1;\\r\\n    }\\r\\n    \\r\\n    OnigRegion *region = onig_region_new();\\r\\n\\r\\n    const UChar *start = (UChar *)(text.c_str());\\r\\n    const UChar *end   = (UChar *)(text.c_str() + text.length());\\r\\n    const UChar *range = end;\\r\\n    r = onig_search(reg, (UChar *)text.c_str(), (UChar *)end, (UChar *)start, (UChar *)range, region, ONIG_OPTION_NONE);\\r\\n    if (r >= 0)\\r\\n    {\\r\\n        fprintf(stderr, \\\"match at %d\\\\n\\\", r / 2);\\r\\n        for (int i = 0; i < region->num_regs; i++)\\r\\n        {\\r\\n            fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i] / 2, region->end[i] / 2);\\r\\n        }\\r\\n    }\\r\\n    else if (r == ONIG_MISMATCH)\\r\\n    {\\r\\n        fprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n    }\\r\\n    else\\r\\n    { /* error */\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str((UChar* )s, r);\\r\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n        onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n        onig_free(reg);\\r\\n        onig_end();\\r\\n        return -1;\\r\\n    }\\r\\n\\r\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    \\r\\n    return 0;\\r\\n}\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"If it is not single-byte encoding, \\\\xHH specifies a byte value, not a codepoint value.\\r\\nReplace with the following:\\r\\n```\\r\\n\\\\\\\\x20 => \\\\\\\\x20\\\\\\\\x00\\r\\n```\\r\\n\"}, {\"author\": \"jwhur72\", \"body\": \"Thank you for your quick reply...\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_153", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"153\", \"title\": \"onig_new_deluxe() function usage in PHP and Ruby\", \"author\": \"ghost\", \"labels\": [], \"description\": \"Hi,\\r\\n\\r\\nLooked though PHP source and found that it actually uses only onig_new() in mb_* functions. Do you know how can I use onig_new_deluxe() in PHP? \\r\\n\\r\\nIs the situation the same in Ruby? Do you know it?\\r\\n\\r\\nWhat is the purpose of  onig_new_deluxe()?\\r\\n\\r\\nThanks,\", \"comments\": [{\"author\": \"ghost\", \"body\": \"Actually looked it up also in Ruby (2.5.1), and I was only able to see the onig_new() function in Debugger also.\\r\\n\\r\\nSo how and when is onig_new_deluxe() used in PHP and Ruby?\\r\\n\\r\\nThanks,\"}, {\"author\": \"ghost\", \"body\": \"I doubt it is used by default in PHP, Ruby. My investigation showed the onig_new_deluxe() is not used by default. However, modified PHP and fuzzed it and was able to reproduce UAF in 7 mins :)\"}, {\"author\": \"kkos\", \"body\": \"* First comment:\\r\\nI'm not a PHP developer so there is no answer.\\r\\nRuby has been using another regular expression library for quite some time, so it has nothing to do with me.\\r\\n\\r\\n* Third comment:\\r\\nIf I have a problem to fix, I need to know the following items:\\r\\n\\r\\n  -- Oniguruma version / or master branch\\r\\n  -- character encoding\\r\\n  -- regex pattern\\r\\n  -- subject string\\r\\n  -- options\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I noticed today that my libFuzzer test code is loose.\\r\\nAfter fixing it, I found a problem.\\r\\nThe problem has been corrected and is in the master branch.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_154", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"154\", \"title\": \"UBSan warning in callout_name_table_hash\", \"author\": \"nikic\", \"labels\": [], \"description\": \"For https://github.com/kkos/oniguruma/blob/f5ac8dc381ed059c4878d6efe15f9751bfa6225e/src/regparse.c#L564 ubsan prints a warning:\\r\\n\\r\\n> regparse.c:553:15: runtime error: signed integer overflow: 69645508 * 997 cannot be represented in type 'int'\\r\\n\\r\\nSigned integer overflow is undefined behavior in C. This can be fixed by performing the computation on `unsigned` instead of `int`.\\r\\n\\r\\nThis issue may be reproduced by compiling with `CFLAGS=\\\"-fsanitize=undefined\\\"`.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_156", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"156\", \"title\": \"Heap buffer overflow in match_at() with case-insensitive match\", \"author\": \"nikic\", \"labels\": [], \"description\": \"`mb_eregi(\\\".+Isss«∞\\\", \\\".+Isss«∞\\\")` (pattern matched against itself, case-insensitively) produces the following heap-buffer-overflow with current oniguruma master. The hex encoding of the pattern is `2e2b49737373c7b0`.\\r\\n\\r\\n```\\r\\n==17207==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000049f4 at pc 0x000001878dbc bp 0x7ffe6afdc570 sp 0x7ffe6afdc568\\r\\nREAD of size 1 at 0x6020000049f4 thread T0\\r\\n    #0 0x1878dbb in match_at /home/nikic/oniguruma/src/regexec.c:2892:17\\r\\n    #1 0x18841a3 in search_in_range /home/nikic/oniguruma/src/regexec.c:5425:7\\r\\n    #2 0x1886e31 in onig_search_with_param /home/nikic/oniguruma/src/regexec.c:5555:10\\r\\n    #3 0xa99782 in _php_mb_onig_search /home/nikic/php-src-fuzz/ext/mbstring/php_mbregex.c:876:8\\r\\n    #4 0xa99782 in _php_mb_regex_ereg_exec /home/nikic/php-src-fuzz/ext/mbstring/php_mbregex.c:934:6\\r\\n    #5 0x168f1c7 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:1326:2\\r\\n    #6 0x148642c in execute_ex /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:53753:7\\r\\n    #7 0x1486b0c in zend_execute /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:58034:2\\r\\n    #8 0x13056cf in zend_execute_scripts /home/nikic/php-src-fuzz/Zend/zend.c:1643:4\\r\\n    #9 0x10ef3c5 in php_execute_script /home/nikic/php-src-fuzz/main/main.c:2585:14\\r\\n    #10 0x1792be0 in do_cli /home/nikic/php-src-fuzz/sapi/cli/php_cli.c:959:5\\r\\n    #11 0x178fc2f in main /home/nikic/php-src-fuzz/sapi/cli/php_cli.c:1350:18\\r\\n    #12 0x7fe6075adb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310\\r\\n    #13 0x4473e9 in _start (/home/nikic/php-src-fuzz/sapi/cli/php+0x4473e9)\\r\\n\\r\\n0x6020000049f4 is located 0 bytes to the right of 4-byte region [0x6020000049f0,0x6020000049f4)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x4bf2ed in malloc (/home/nikic/php-src-fuzz/sapi/cli/php+0x4bf2ed)\\r\\n    #1 0x180cd14 in ops_make_string_pool /home/nikic/oniguruma/src/regcomp.c:337:26\\r\\n    #2 0x180cd14 in onig_compile /home/nikic/oniguruma/src/regcomp.c:6661:9\\r\\n    #3 0x1828811 in onig_new /home/nikic/oniguruma/src/regcomp.c:6794:7\\r\\n    #4 0xa9fffd in php_mbregex_compile_pattern /home/nikic/php-src-fuzz/ext/mbstring/php_mbregex.c:465:19\\r\\n    #5 0xa9967b in _php_mb_regex_ereg_exec /home/nikic/php-src-fuzz/ext/mbstring/php_mbregex.c:925:7\\r\\n    #6 0x168f1c7 in ZEND_DO_ICALL_SPEC_RETVAL_USED_HANDLER /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:1326:2\\r\\n    #7 0x148642c in execute_ex /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:53753:7\\r\\n    #8 0x1486b0c in zend_execute /home/nikic/php-src-fuzz/Zend/zend_vm_execute.h:58034:2\\r\\n    #9 0x13056cf in zend_execute_scripts /home/nikic/php-src-fuzz/Zend/zend.c:1643:4\\r\\n    #10 0x10ef3c5 in php_execute_script /home/nikic/php-src-fuzz/main/main.c:2585:14\\r\\n    #11 0x1792be0 in do_cli /home/nikic/php-src-fuzz/sapi/cli/php_cli.c:959:5\\r\\n    #12 0x178fc2f in main /home/nikic/php-src-fuzz/sapi/cli/php_cli.c:1350:18\\r\\n    #13 0x7fe6075adb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310\\r\\n```\\r\\n\\r\\nThe relevant line is https://github.com/kkos/oniguruma/blob/bc4a2ba4aa2bcd3ea9add76a2bca3c9ba5637e14/src/regexec.c#L2892.\\r\\n\\r\\nIf needed I can try to reproduce this with a pure C implementation.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_157", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"157\", \"title\": \"Slow match despite retry_limit\", \"author\": \"nikic\", \"labels\": [], \"description\": \"Matching `x*{3}?+{3,}?{3,}?+{3,}?+{3,}?+{3,}+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?{3,}?+}j6,+{3,}?+{3'?+6,` against itself takes about 8.5s, albeit on an instrumented build, with the retry_limit set to 100000. I haven't looked into the execution profile yet, but feel like there *might* be some limiting missing somewhere.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the previous PR.\\r\\nSomething may be wrong, but it doesn't take much time on my home computer (iMac I bought 9 years ago). \\r\\n\\r\\n```\\r\\n$ gcc -Wall -g -O0 -o 157 157.c -lonig\\r\\n$ time ./157\\r\\nERROR: retry-limit-in-match over\\r\\n  (UTF-8)\\r\\nretry limit: 100000\\r\\n\\r\\nreal\\t0m1.752s\\r\\nuser\\t0m1.740s\\r\\nsys\\t0m0.008s\\r\\n\\r\\n$ gcc -v\\r\\nConfigured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\\r\\nApple LLVM version 10.0.0 (clang-1000.10.44.4)\\r\\nTarget: x86_64-apple-darwin17.7.0\\r\\nThread model: posix\\r\\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  unsigned long limit;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  onig_set_retry_limit_in_match(100000);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n\\t       (UChar* )apttern_end,\\r\\n\\t       options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, (UChar* )end);\\r\\n\\r\\n  limit = onig_get_retry_limit_in_match();\\r\\n  fprintf(stdout, \\\"retry limit: %lu\\\\n\\\", limit);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nextern int\\r\\nmain(int argc, char* argv[])\\r\\n{\\r\\n  char* pat;\\r\\n  char* str;\\r\\n\\r\\n  pat = \\\"x*{3}?+{3,}?{3,}?+{3,}?+{3,}?+{3,}+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?{3,}?+}j6,+{3,}?+{3'?+6\\\";\\r\\n\\r\\n  str = \\\"x*{3}?+{3,}?{3,}?+{3,}?+{3,}?+{3,}+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?{3,}?+}j6,+{3,}?+{3'?+6\\\";\\r\\n\\r\\n  exec(ONIG_ENCODING_UTF8, ONIG_OPTION_NONE, pat, pat + strlen(pat), str, str + strlen(str));\\r\\n\\r\\n  return 0;\\r\\n}\\r\\n```\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Rethinking, I thought it was certainly slow.\\r\\nThere are two reasons.\\r\\n\\r\\n(1) \\r\\nFor a range iteration operator, push the current iteration number on the stack at the time of matching.\\r\\nAt this time, the local variable normally holds the position on the stack, but if the range repetition operator is in another iteration, this method cannot be used, so it will be searched on the stack.\\r\\n\\r\\n(2)\\r\\nThe object to be repeated has the possibility of becoming zero length.\\r\\n/x*{3}?+/\\r\\nEach time it is repeated, it must be checked whether it is repeated with zero length.\\r\\n\\r\\n--\\r\\nThe range repetition operator is compiled by expanding to other operators if possible, but limits the code size to be expanded.\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/b952ba559387cd79cfba541f8de29d8a2f9896c4/src/regcomp.c#L1037\\r\\n\\r\\nIf you change the value of QUANTIFIER_EXPAND_LIMIT_SIZE from 10 to 100, the search time  changes.\\r\\n\\r\\nQUANTIFIER_EXPAND_LIMIT_SIZE = 10\\r\\n```\\r\\n$ ./157\\r\\ntime: 1.751\\r\\nERROR: retry-limit-in-match over\\r\\n  (UTF-8)\\r\\nretry limit: 100000\\r\\n```\\r\\n\\r\\nQUANTIFIER_EXPAND_LIMIT_SIZE = 100\\r\\n```\\r\\n$ ./157\\r\\ntime: 0.290\\r\\nERROR: retry-limit-in-match over\\r\\n  (UTF-8)\\r\\nretry limit: 100000\\r\\n```\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include <stdlib.h>\\r\\n#include <time.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic double\\r\\nget_sec(struct timespec* ts, struct timespec* te)\\r\\n{\\r\\n  double t;\\r\\n\\r\\n  t = (te->tv_sec - ts->tv_sec) +\\r\\n      (double )(te->tv_nsec - ts->tv_nsec) / 1000000000.0;\\r\\n  return t;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n  struct timespec ts1, ts2;\\r\\n  double t;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n\\r\\n  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &ts1);\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  clock_gettime(CLOCK_PROCESS_CPUTIME_ID, &ts2);\\r\\n  t = get_sec(&ts1, &ts2);\\r\\n  fprintf(stdout, \\\"time: %.3lf\\\\n\\\", t);\\r\\n\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail (%s)\\\\n\\\",\\r\\n\\t    ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stderr, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* apttern_end, char* astr, char* end)\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  unsigned long limit;\\r\\n  UChar* pattern = (UChar* )apattern;\\r\\n  UChar* str     = (UChar* )astr;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  onig_set_retry_limit_in_match(100000);\\r\\n\\r\\n  r = onig_new(&reg, pattern,\\r\\n\\t       (UChar* )apttern_end,\\r\\n\\t       options, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  r = search(reg, str, (UChar* )end);\\r\\n\\r\\n  limit = onig_get_retry_limit_in_match();\\r\\n  fprintf(stdout, \\\"retry limit: %lu\\\\n\\\", limit);\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nextern int\\r\\nmain(int argc, char* argv[])\\r\\n{\\r\\n  char* pat;\\r\\n  char* str;\\r\\n\\r\\n  pat = \\\"x*{3}?+{3,}?{3,}?+{3,}?+{3,}?+{3,}+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?{3,}?+}j6,+{3,}?+{3'?+6\\\";\\r\\n\\r\\n  str = \\\"x*{3}?+{3,}?{3,}?+{3,}?+{3,}?+{3,}+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?+{3,}?{3,}?+}j6,+{3,}?+{3'?+6\\\";\\r\\n\\r\\n  exec(ONIG_ENCODING_UTF8, ONIG_OPTION_NONE, pat, pat + strlen(pat), str, str + strlen(str));\\r\\n\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"I tried some ideas to solve this problem.\\r\\nThere was some improvement with one method.\\r\\n```\\r\\n$ ./157\\r\\ntime: 0.572\\r\\nERROR: retry-limit-in-match over\\r\\n  (UTF-8)\\r\\nretry limit: 100000\\r\\n```\\r\\n\\r\\nHowever, it is not a fundamental solution and there is extra overhead for normal patterns, so this method is not enabled.(Define USE_REPEAT_AND_EMPTY_CHECK_LOCAL_VAR to enable.)\\r\\nSorry for not being able to solve this issue.\\r\\n\\r\\nWhile doing this work, I discovered that I could eliminate two op-codes and one kind of data stack.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_159", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"159\", \"title\": \"Request for a new release to fix Catalina issues in some apps \", \"author\": \"kevinnio\", \"labels\": [], \"description\": \"Hi there. \\r\\n\\r\\nWe have identified issues while using `oniguruma` in macOS 10.15 Catalina while using the latest release. However, if we use `master` everything works as expected. Would you guys consider releasing a new version so we can point our tools to it? Or do you think it's safe for us to point to `master`? The tools I'm talking about are [delta](https://github.com/dandavison/delta) and [bat](https://github.com/sharkdp/bat).\\r\\n\\r\\nhttps://github.com/dandavison/delta/issues/24\\r\\nhttps://github.com/sharkdp/bat/issues/680\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think the current master branch is stable. (Because my libFuzzer test has no problem)\\r\\nI don't want to release it for at least another month. (excluding release candidates)\\r\\n\"}, {\"author\": \"foobarnum\", \"body\": \"Issues also exist in jq for some users:\\r\\n```\\r\\nbash-3.2$ lldb $(which jq) -- 'map(select(.name | test(\\\"foo\\\")))' ~/jqfile.json\\r\\n(lldb) target create \\\"/usr/local/bin/jq\\\"\\r\\nCurrent executable set to '/usr/local/bin/jq' (x86_64).\\r\\n(lldb) settings set -- target.run-args  \\\"map(select(.name | test(\\\\\\\"foo\\\\\\\")))\\\" \\\"/Users/element/jqfile.json\\\"\\r\\n(lldb) process launch\\r\\nProcess 90897 launched: '/usr/local/bin/jq' (x86_64)\\r\\nProcess 90897 stopped\\r\\n* thread #1, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=EXC_I386_GPFLT)\\r\\n    frame #0: 0x000000010015b8a6 libonig.5.dylib`match_at + 662\\r\\nlibonig.5.dylib`match_at:\\r\\n->  0x10015b8a6 <+662>: jmpq   *(%r10)\\r\\n    0x10015b8a9 <+665>: movq   -0x80(%rbp), %rsi\\r\\n    0x10015b8ad <+669>: movl   %esi, %edx\\r\\n    0x10015b8af <+671>: subl   -0x118(%rbp), %edx\\r\\nTarget 0: (jq) stopped.\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Is this a bug report?\\r\\nIf so, I don't know the regular expression pattern and the target string.\\r\\nAnd does this happen with 6.9.3? Or with master head?\\r\\n\"}, {\"author\": \"foobarnum\", \"body\": \"Here's what I have: \\r\\n* onigaruma 6.9.3 successfully  Installed by home brew on MacOS Yosemite as part of `brew install jq`  and works correctly\\r\\n* Upgrade Mac to Catalina\\r\\n* ANY regex in jq causes the segfault above, i used a simple example in lldb above but any regex in jq will do.\\r\\nWe found a workaround that might help pinpoint the issue:\\r\\n* From the mac with the crash `sha1sum /usr/local/Cellar/oniguruma/6.9.3/lib/libonig.5.dylib` returns `8689f5977ac887ab07eb1f5fcfb73e673d0c8541`\\r\\n* Another engineer had done `brew install jq` earlier (we're guessing that the Mac had Mojove then) and did not have the same crash above even after upgrading to Catalina; in this case `sha1sum /usr/local/Cellar/oniguruma/6.9.3/lib/libonig.5.dylib` returns `dec726905e0fb932f5a8bf5e95178cad1fae4172`\\r\\n* We copied the working libonig.5.dylib to the Catalina machine\\r\\n* The Mac threw a \\\"unsigned code\\\" block when we tried to run the sample code\\r\\n* We allowed a specific exemption for this library in Security prefs\\r\\n* Ran the sample code again and the crash is gone \\r\\n```\\r\\nbash-3.2$ echo '[{ \\\"name\\\": \\\"foo\\\" }]' | jq 'map(select(.name | test(\\\"foo\\\")))'\\r\\n[\\r\\n  {\\r\\n    \\\"name\\\": \\\"foo\\\"\\r\\n  }\\r\\n]\\r\\n```\\r\\n\\r\\nIssue is resolved on the Catalina upgraded machine with the older installed library. I hope this helps.\"}, {\"author\": \"kkos\", \"body\": \"I compiled jq and oniguruma with sanitinze check.\\r\\nRunning your sample code with version 6.9.2, 6.9.3 and master head,  no problems were detected.\\r\\n```\\r\\n(Ubuntu 18.04)\\r\\n$ git clone https://github.com/kkos/oniguruma.git\\r\\n$ cd oniguruma\\r\\n$ git checkout X.X.X\\r\\n$ autoreconf -vfi\\r\\n$ ./configure CC=clang LD=clang CFLAGS=\\\"-g -fsanitize=address -fno-omit-frame-pointer\\\" LDFLAGS=\\\"-g -fsanitize=address -fno-omit-frame-pointer\\\"\\r\\n$ make\\r\\n$ cp -p src/oniguruma.h ~/work/tmp/local/X.X.X/include\\r\\n$ cp -p src/.libs/libonig.a ~/work/tmp/local/X.X.X/lib\\r\\n$ cd ~/work\\r\\n$ git clone https://github.com/stedolan/jq.git\\r\\n$ cd jq\\r\\n$ autoreconf -vfi\\r\\n.$ /configure --with-oniguruma=/home/kosako/work/tmp/local/X.X.X CC=clang LD=clang CFLAGS=\\\"-g -fsanitize=address -fno-omit-frame-pointer\\\" LDFLAGS=\\\"-g -fsanitize=address -fno-omit-frame-pointer\\\"\\r\\n$ make\\r\\n$ echo '[{ \\\"name\\\": \\\"foo\\\" }]' | ./jq 'map(select(.name | test(\\\"foo\\\")))'\\r\\n[\\r\\n  {\\r\\n    \\\"name\\\": \\\"foo\\\"\\r\\n  }\\r\\n]\\r\\n```\\r\\n\\r\\nWhen I ran your sample code with debug output of oniguruma, I found that it was called only once with a simple regular expression /foo/.\\r\\nI don't think there would be any problems with this simple call.\\r\\n```\\r\\n$ echo '[{ \\\"name\\\": \\\"foo\\\" }]' | ./jq 'map(select(.name | test(\\\"foo\\\")))'\\r\\n\\r\\nPATTERN: /foo/\\r\\nMAX PARSE DEPTH: 2\\r\\nTREE (parsed)\\r\\n<string:0x606000001460>foo\\r\\n\\r\\nTREE (after setup)\\r\\n<string:0x606000001460>foo\\r\\n\\r\\noptimize: STR_FAST\\r\\n  anchor: []\\r\\n  sub anchor: []\\r\\n\\r\\nexact: [foo]: length: 3\\r\\npush_mem_start: 0x0, push_mem_end: 0x0\\r\\ncode-length: 2\\r\\n   0: exact3:foo\\r\\n   1: end\\r\\n\\r\\n[\\r\\n  {\\r\\n    \\\"name\\\": \\\"foo\\\"\\r\\n  }\\r\\n]\\r\\n```\\r\\nI'll do some research on Homebrew, but I can't expect much.\"}, {\"author\": \"dandavison\", \"body\": \"Thanks for investigating @kkos! I believe that to reproduce the problems referenced in this ticket we need to test on MacOS 10.15 Catalina.\"}, {\"author\": \"foobarnum\", \"body\": \"I would agree. This only occured on a machine that was upgraded to Catalina\"}, {\"author\": \"Shagon94\", \"body\": \"I can confirm, this only occurs on MacOS Catalina.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_160", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"160\", \"title\": \"Potential uninitialized read in function re_mbcinit\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"Hi guys,\\r\\n\\r\\nIn source MdeModulePkg/Universal/RegularExpressionDxe/Oniguruma/reggnu.c in function re_mbcinit() we have:\\r\\n\\r\\nextern void\\r\\nre_mbcinit(int mb_code)\\r\\n{\\r\\n  OnigEncoding enc;\\r\\n\\r\\n  switch (mb_code) {\\r\\n  case RE_MBCTYPE_ASCII:\\r\\n    enc = ONIG_ENCODING_ASCII;\\r\\n    break;\\r\\n  }\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  onigenc_set_default_encoding(enc);\\r\\n}\\r\\n\\r\\nIf mb_code is not RE_MBCTYPE_ASCII, enc will be passed to onig_initialize without being initialized.\\r\\nI want to add default option in the switch structure. Does anybody know what i should use?\\r\\nThings like below:\\r\\n\\r\\n{\\r\\ncase RE_MBCTYPE_ASCII:\\r\\n    enc = ONIG_ENCODING_ASCII;\\r\\n    break;\\r\\n\\r\\ndefalt:\\r\\n   enc = ?\\r\\n}\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Only character encodings in the repository can be used.\\r\\nIn the respository https://github.com/tianocore/edk2/tree/master/MdeModulePkg/Universal/RegularExpressionDxe/Oniguruma\\r\\nascii.c and utf16_le.c are included.\\r\\nYou can use ONIG_ENCODING_ASCII or ONIG_ENCODING_UTF16_LE.\\r\\n\\r\\nI have no knowledge of MdeModulePkg, so I don't know which character encoding is appropriate for that module.\"}, {\"author\": \"kkos\", \"body\": \"Speaking of my repository, not that repository,\\r\\n\\r\\nI want to change that function to return an error.\\r\\nBut not for compatibility.\\r\\nOriginally defined to match other library.\\r\\nI can set a default encoding, but whether it is good to do so is subtle.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_162", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"162\", \"title\": \"heap-buffer-overflow in fetch_interval_quantifier due to double PFETCH\", \"author\": \"ManhNDd\", \"labels\": [], \"description\": \"At regparse.c:4182 in fetch_interval_quantifier, PFETCH is called without checking PEND:\\r\\n```PFETCH(c);\\r\\n  if (IS_SYNTAX_OP(env->syntax, ONIG_SYN_OP_ESC_BRACE_INTERVAL)) {\\r\\n    if (c != MC_ESC(env->syntax)) goto invalid;\\r\\n    PFETCH(c);\\r\\n  }\\r\\n```\\r\\nThis leads to heap-buffer-overflow.\\r\\nPoC:\\r\\n```\\r\\n#include <stdlib.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nint main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  char *pattern = (char*)malloc(6);\\r\\n  memcpy(pattern, \\\"_\\\\\\\\{21\\\\\\\\\\\", 6);\\r\\n  char *pattern_end = pattern + 6;\\r\\n  OnigEncodingType *enc = ONIG_ENCODING_ASCII;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  r = onig_new(&reg, (unsigned char *)pattern, (unsigned char *)pattern_end,\\r\\n               ONIG_OPTION_NONE, enc, ONIG_SYNTAX_GREP, &einfo);\\r\\n  if (r == ONIG_NORMAL) {\\r\\n    onig_free(reg);\\r\\n  }\\r\\n\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\\r\\nCompilation of oniguruma and PoC:\\r\\n```\\r\\n./configure CFLAGS=-fsanitize=address LDFLAGS=-fsanitize=address CC=gcc\\r\\nmake\\r\\ngcc -fsanitize=address -I./src poc.c ./src/.libs/libonig.a -o poc\\r\\n```\\r\\nOutput of PoC:\\r\\n```\\r\\n=================================================================\\r\\n==32058==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000eff6 at pc 0x00000044cb35 bp 0x7fffe9b35350 sp 0x7fffe9b35340\\r\\nREAD of size 1 at 0x60200000eff6 thread T0\\r\\n    #0 0x44cb34 in onigenc_single_byte_mbc_to_code /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regenc.c:704\\r\\n    #1 0x4683a0 in fetch_interval_quantifier /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:4182\\r\\n    #2 0x46e79a in fetch_token /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:5009\\r\\n    #3 0x481e9f in parse_exp /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:7974\\r\\n    #4 0x483de7 in parse_branch /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:8303\\r\\n    #5 0x48431b in parse_alts /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:8354\\r\\n    #6 0x484808 in parse_regexp /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:8413\\r\\n    #7 0x484db1 in onig_parse_tree /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regparse.c:8468\\r\\n    #8 0x423c6b in onig_compile /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regcomp.c:6694\\r\\n    #9 0x424e53 in onig_new /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regcomp.c:6964\\r\\n    #10 0x401265 in main poc-fetch_interval_quantifier-2-PFETCH.c:24\\r\\n    #11 0x7ff6af3ff82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #12 0x401048 in _start (/root/fuzz/fuzz_oniguruma/poc-fetch_interval_quantifier-2-PFETCH+0x401048)\\r\\n\\r\\n0x60200000eff6 is located 0 bytes to the right of 6-byte region [0x60200000eff0,0x60200000eff6)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x7ff6af841602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\\r\\n    #1 0x4011e2 in main poc-fetch_interval_quantifier-2-PFETCH.c:17\\r\\n    #2 0x7ff6af3ff82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regenc.c:704 onigenc_single_byte_mbc_to_code\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9dc0: fa fa 04 fa fa fa 00 00 fa fa 00 04 fa fa 00 00\\r\\n  0x0c047fff9dd0: fa fa 06 fa fa fa 00 00 fa fa 06 fa fa fa 00 00\\r\\n  0x0c047fff9de0: fa fa 04 fa fa fa 00 00 fa fa 00 01 fa fa 00 00\\r\\n=>0x0c047fff9df0: fa fa 00 00 fa fa 05 fa fa fa 00 00 fa fa[06]fa\\r\\n  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==32058==ABORTING\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nFor a long time I forgot to fuzz test other than the default syntax.\\r\\nThis problem occurs in PosixBasic, Emacs, Grep syntaxes.\"}, {\"author\": \"ManhNDd\", \"body\": \"This was assigned CVE-2019-19204.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_163", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"163\", \"title\": \"heap-buffer-overflow in gb18030_mbc_enc_len\", \"author\": \"ManhNDd\", \"labels\": [], \"description\": \"In gb18030_mbc_enc_len, p ++ then p is dereferenced without checking if it passes the end of string, which leads to heap-buffer-overflow.\\r\\n```\\r\\nstatic int\\r\\ngb18030_mbc_enc_len(const UChar* p)\\r\\n{\\r\\n  if (GB18030_MAP[*p] != CM)\\r\\n    return 1;\\r\\n\\r\\n  p++;\\r\\n  if (GB18030_MAP[*p] == C4)\\r\\n    return 4;\\r\\n\\r\\n  return 2;\\r\\n}\\r\\n```\\r\\nPoC:\\r\\n```\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0 ) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stdout, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stdout, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stdout, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stdout, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stdout, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    \\r\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nint main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n\\r\\n  char *pattern = (char*)malloc(6);\\r\\n  memcpy(pattern, \\\"[\\\\\\\\W]\\\\\\\\w\\\", 6);\\r\\n  char *pattern_end = pattern + 6;\\r\\n  OnigEncodingType *enc = ONIG_ENCODING_GB18030;\\r\\n\\r\\n  char* str = (char*)malloc(2);\\r\\n  memcpy(str, \\\"\\\\xe1\\\\xe1\\\", 2);\\r\\n  char* str_end = str+2;\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  r = onig_new(&reg, (unsigned char *)pattern, (unsigned char *)pattern_end,\\r\\n               ONIG_OPTION_NONE, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stdout, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    onig_end();\\r\\n\\r\\n    if (r == ONIGERR_PARSER_BUG ||\\r\\n        r == ONIGERR_STACK_BUG  ||\\r\\n        r == ONIGERR_UNDEFINED_BYTECODE ||\\r\\n        r == ONIGERR_UNEXPECTED_BYTECODE) {\\r\\n      return -2;\\r\\n    }\\r\\n    else\\r\\n      return -1;\\r\\n  }\\r\\n\\r\\n  if (onigenc_is_valid_mbc_string(enc, str, str_end) != 0) {\\r\\n    r = search(reg, str, str_end);\\r\\n  } else {\\r\\n    fprintf(stdout, \\\"Invalid string\\\\n\\\");\\r\\n  }\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n``` \\r\\nCompilation:\\r\\n```\\r\\n./configure CFLAGS=-fsanitize=address LDFLAGS=-fsanitize=address CC=gcc\\r\\nmake\\r\\ngcc -fsanitize=address -I./oniguruma-gcc-asan/src ./poc-gb18030_mbc_enc_len.c ./oniguruma-gcc-asan/src/.libs/libonig.a -o poc-gb18030_mbc_enc_len\\r\\n```\\r\\nOutput of PoC:\\r\\n```\\r\\n=================================================================\\r\\n==1657==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000efd2 at pc 0x000000487af9 bp 0x7ffcaa15b840 sp 0x7ffcaa15b830\\r\\nREAD of size 1 at 0x60200000efd2 thread T0\\r\\n    #0 0x487af8 in gb18030_mbc_enc_len /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/gb18030.c:72\\r\\n    #1 0x47bf9a in onigenc_mbn_mbc_to_code /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regenc.c:774\\r\\n    #2 0x487df4 in gb18030_mbc_to_code /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/gb18030.c:121\\r\\n    #3 0x45eb99 in match_at /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regexec.c:3271\\r\\n    #4 0x474479 in search_in_range /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regexec.c:5382\\r\\n    #5 0x473370 in onig_search /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/regexec.c:5168\\r\\n    #6 0x401278 in search (/root/fuzz/fuzz_oniguruma/poc-gb18030_mbc_enc_len+0x401278)\\r\\n    #7 0x401993 in main (/root/fuzz/fuzz_oniguruma/poc-gb18030_mbc_enc_len+0x401993)\\r\\n    #8 0x7f3fc8e9c82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n    #9 0x401098 in _start (/root/fuzz/fuzz_oniguruma/poc-gb18030_mbc_enc_len+0x401098)\\r\\n\\r\\n0x60200000efd2 is located 0 bytes to the right of 2-byte region [0x60200000efd0,0x60200000efd2)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x7f3fc92de602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)\\r\\n    #1 0x4017e3 in main (/root/fuzz/fuzz_oniguruma/poc-gb18030_mbc_enc_len+0x4017e3)\\r\\n    #2 0x7f3fc8e9c82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan/src/gb18030.c:72 gb18030_mbc_enc_len\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa 04 fa\\r\\n  0x0c047fff9dc0: fa fa 00 00 fa fa 00 04 fa fa 00 00 fa fa 06 fa\\r\\n  0x0c047fff9dd0: fa fa 00 00 fa fa 06 fa fa fa 00 00 fa fa 04 fa\\r\\n  0x0c047fff9de0: fa fa 00 00 fa fa 00 01 fa fa 00 00 fa fa 00 00\\r\\n=>0x0c047fff9df0: fa fa 05 fa fa fa 00 00 fa fa[02]fa fa fa 06 fa\\r\\n  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Heap right redzone:      fb\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack partial redzone:   f4\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n==1657==ABORTING\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the report.\\r\\n\\r\\nI can't believe I couldn't detect this problem before.\\r\\nWhy didn't an error occur when GB18030 eocoding was included in encode-harness.c?\\r\\nAdded \\\"[\\\\\\\\W]\\\" pattern to ascii_compatible.dict.\\r\\nHowever, it is unclear whether the quality of the fuzz test will improve.\\r\\n\\r\\nThis problem is caused by registering an incorrect code value as a single byte value of the character class.\"}, {\"author\": \"ManhNDd\", \"body\": \"This was assigned CVE-2019-19203.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_164", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"164\", \"title\": \"Integer overflow related to reg->dmax in search_in_range (regexec.c)\", \"author\": \"ManhNDd\", \"labels\": [], \"description\": \"Hello,\\r\\nI found an integer overflow in search_in_range at regexec.c:5365:\\r\\n```\\r\\n5360\\t      sch_range = (UChar* )range;\\r\\n5361\\t      if (reg->dmax != 0) {\\r\\n5362\\t        if (reg->dmax == INFINITE_LEN)\\r\\n5363\\t          sch_range = (UChar* )end;\\r\\n5364\\t        else {\\r\\n5365\\t          sch_range += reg->dmax;  //// => overflow\\r\\n5366\\t          if (sch_range > end) sch_range = (UChar* )end;\\r\\n5367\\t        }\\r\\n5368\\t      }\\r\\n``` \\r\\nreg->dmax is max repeat num, whose type is unsigned int. ONIG_MAX_REPEAT_NUM is 100000, but it can be multiplied into a very large number with distance_multiply at:\\r\\n```\\r\\n6152\\t        }\\r\\n6153\\t\\r\\n6154\\t        max = (xo.len.max > 0 ? INFINITE_LEN : 0);\\r\\n6155\\t      }\\r\\n6156\\t      else {\\r\\n6157\\t        max = distance_multiply(xo.len.max, qn->upper);    //// => multiply into dmax\\r\\n6158\\t      }\\r\\n6159\\t\\r\\n6160\\t      min = distance_multiply(xo.len.min, qn->lower);      //// => multiply into dmin\\r\\n6161\\t      set_mml(&opt->len, min, max); \\r\\n```\\r\\nAnd Sch_range is a pointer. So if compiled in 32bit, sch_range += reg->dmax results into integer overflow.\\r\\nThere should be other places related to reg->dmax/dmin which are vulnerable to integer overflow.\\r\\n\\r\\nPoC:\\r\\n```\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nstatic int\\r\\nsearch(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  start = str;\\r\\n  range = end;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0 ) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stdout, \\\"match at %d  (%s)\\\\n\\\", r,\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stdout, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stdout, \\\"search fail (%s)\\\\n\\\",\\r\\n            ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stdout, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    fprintf(stdout, \\\"  (%s)\\\\n\\\", ONIGENC_NAME(onig_get_encoding(reg)));\\r\\n    \\r\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nint main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n\\r\\n  char *pattern = argv[1];\\r\\n  char *pattern_end = pattern + strlen(pattern);\\r\\n  OnigEncodingType *enc = ONIG_ENCODING_ASCII;\\r\\n\\r\\n  char* str = argv[2];\\r\\n  char* str_end = str+strlen(str);\\r\\n\\r\\n  onig_initialize(&enc, 1);\\r\\n  r = onig_new(&reg, (unsigned char *)pattern, (unsigned char *)pattern_end,\\r\\n               ONIG_OPTION_IGNORECASE, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stdout, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    onig_end();\\r\\n\\r\\n    if (r == ONIGERR_PARSER_BUG ||\\r\\n        r == ONIGERR_STACK_BUG  ||\\r\\n        r == ONIGERR_UNDEFINED_BYTECODE ||\\r\\n        r == ONIGERR_UNEXPECTED_BYTECODE) {\\r\\n      return -2;\\r\\n    }\\r\\n    else\\r\\n      return -1;\\r\\n  }\\r\\n\\r\\n  if (onigenc_is_valid_mbc_string(enc, str, str_end) != 0) {\\r\\n    r = search(reg, str, str_end);\\r\\n  } else {\\r\\n    fprintf(stdout, \\\"Invalid string\\\\n\\\");\\r\\n  }\\r\\n\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\\r\\nCompilation:\\r\\n```\\r\\n./configure CC=gcc CFLAGS=\\\"-m32 -O0 -ggdb3 -fsanitize=address\\\" LDFLAGS=\\\"-m32 -O0 -ggdb3 -fsanitize=address\\\"\\r\\ngcc -m32 -fsanitize=address -O0 -I./oniguruma-gcc-asan-32/src -ggdb3 poc-dmax-search-in-range.c ./oniguruma-gcc-asan-32/src/.libs/libonig.a -o poc-dmax-search-in-range\\r\\n```\\r\\nOutput with pattern = x{55380}{77548}0 and string = x:\\r\\n```\\r\\nroot@manh-ubuntu16:~/fuzz/fuzz_oniguruma# ./poc-dmax-search-in-range x{55380}{77548}0 x\\r\\nASAN:SIGSEGV\\r\\n=================================================================\\r\\n==1347==ERROR: AddressSanitizer: SEGV on unknown address 0xffc6fd0b (pc 0x080bf994 bp 0xffcc6768 sp 0xffcc6730 T0)\\r\\n    #0 0x80bf993 in sunday_quick_search /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan-32/src/regexec.c:4831\\r\\n    #1 0x80c0685 in forward_search /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan-32/src/regexec.c:4956\\r\\n    #2 0x80c2830 in search_in_range /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan-32/src/regexec.c:5375\\r\\n    #3 0x80c17f4 in onig_search /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan-32/src/regexec.c:5168\\r\\n    #4 0x8048cc4 in search /root/fuzz/fuzz_oniguruma/poc-dmax-search-in-range.c:17\\r\\n    #5 0x8049536 in main /root/fuzz/fuzz_oniguruma/poc-dmax-search-in-range.c:78\\r\\n    #6 0xf703d636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)\\r\\n    #7 0x8048b00  (/root/fuzz/fuzz_oniguruma/poc-dmax-search-in-range+0x8048b00)\\r\\n\\r\\nAddressSanitizer can not provide additional info.\\r\\nSUMMARY: AddressSanitizer: SEGV /root/fuzz/fuzz_oniguruma/oniguruma-gcc-asan-32/src/regexec.c:4831 sunday_quick_search\\r\\n==1347==ABORTING\\r\\n```\\r\\nIn sunday_quick_search, the PoC gets crashed because p points to an invalid memory address. If it does not crash, p luckily points to a valid memory address.\\r\\nThat it crashes or does not crash depends on the supplied pattern. This bug at least can be used to detect if the target system is 32bit or not. And if the target system is 32bit, is the KASLR is enable or not (constantly crashes or constantly no-crashes means no KASLR).\\r\\n\\r\\n--\\r\\nThanks & Regards,\\r\\nNguy·ªÖn ƒê·ª©c M·∫°nh\\r\\n[E] v.manhnd@vincss.net\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I could not reproduce the same result(SEGV).\\r\\nBut overflow is a problem, I fixed it.\"}, {\"author\": \"ManhNDd\", \"body\": \"You can make it crash by changing a, b in x{a}{b}0.\\r\\nCan I request a CVE for this issue?\"}, {\"author\": \"kkos\", \"body\": \"Yes.\\r\\nPlease tell me when you know the number.\\r\\nIt is better not to contact me as much as possible from the organization.\"}, {\"author\": \"ManhNDd\", \"body\": \"This was assigned CVE-2019-19012.\"}, {\"author\": \"Beuc\", \"body\": \"Hi,\\r\\nI'm part of the Debian Long Term Support team and I'm working on a libonig security update.\\r\\nIs there plan to fix this vulnerability in the 5.9 branch?\"}, {\"author\": \"kkos\", \"body\": \"I'm not going to do anything about this or anything else.\"}, {\"author\": \"Beuc\", \"body\": \"I backported the 5 patches to 5.9.5. Comments welcome:\\r\\n[CVE-2019-19012.patch.zip](https://github.com/kkos/oniguruma/files/3881134/CVE-2019-19012.patch.zip)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I have not confirmed the execution.\\r\\n\\r\\n(1) Casting with ptrdiff_t is unnecessary.\\r\\nCasting was put in, but on the contrary, the result was strange, so I stopped it.\\r\\n\\r\\n(2) The last change is different from me.\\r\\n\\r\\n```\\r\\n      else { /* check only. */\\r\\n        if ((end - range) < reg->threshold_len) goto mismatch;\\r\\n\\r\\n        if (backward_search_range(reg, str, end, sch_start, min_range, adjrange,\\r\\n                                  &low, &high) <= 0) goto mismatch;\\r\\n      }\\r\\n```\\r\\n\\r\\n```\\r\\n      else { /* check only. */\\r\\n        sch_start = onigenc_get_prev_char_head(reg->enc, str, end);\\r\\n        if (backward_search_range(reg, str, end, sch_start, min_range, adjrange,\\r\\n                                  &low, &high) <= 0) goto mismatch;\\r\\n      }\\r\\n```\\r\\n\"}, {\"author\": \"Beuc\", \"body\": \"Thanks a lot for having a look.\\r\\n\\r\\n(1) I missed one ptrdiff_t when applying 778a43d , this is now fixed (and I dropped the extra #include as well).\\r\\n\\r\\n(2) the [original 5.x file](https://github.com/kkos/oniguruma/blob/5.9.6/regexec.c#L3677) is different too and doesn't use `onigenc_get_prev_char_head` at all; I tried to stick to the original logic but I may be wrong.\\r\\n\\r\\nFor execution I [tested](https://wiki.debian.org/LTS/TestSuites/libonig) with `make check` and php5's mbstring testsuite.\\r\\n\\r\\nUpdated 5.x patch:  [CVE-2019-19012.patch.zip](https://github.com/kkos/oniguruma/files/3886547/CVE-2019-19012.patch.zip)\"}, {\"author\": \"kkos\", \"body\": \"I confirmed the contents.\\r\\nI think this is good.\"}, {\"author\": \"Beuc\", \"body\": \"Thank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_165", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"165\", \"title\": \"6.9.4: test suite still core dumps\", \"author\": \"kloczek\", \"labels\": [], \"description\": \"<pre>+ /usr/bin/make -O -j48 V=1 VERBOSE=1 check\\r\\nMaking check in src\\r\\nMaking check in test\\r\\n/usr/bin/make  test_utf8 testc testp testcu test_regset\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\ngcc -DHAVE_CONFIG_H -I. -I../src  -I../src  -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -c -o test_regset.o test_regset.c\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\ngcc -DHAVE_CONFIG_H -I. -I../src  -I../src  -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -c -o testu.o testu.c\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\ngcc -DHAVE_CONFIG_H -I. -I../src  -I../src  -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -c -o testc.o testc.c\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\ngcc -DHAVE_CONFIG_H -I. -I../src  -I../src  -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -c -o testp-testc.o `test -f &apos;testc.c&apos; || echo &apos;./&apos;`testc.c\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\ngcc -DHAVE_CONFIG_H -I. -I../src  -I../src  -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -c -o test_utf8.o test_utf8.c\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o test_regset test_regset.o ../src/libonig.la \\r\\nlibtool: link: gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o .libs/test_regset test_regset.o  -L/usr/lib ../src/.libs/libonig.so\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o testp testp-testc.o ../src/libonig.la \\r\\nlibtool: link: gcc -DPOSIX_TEST -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o .libs/testp testp-testc.o  -L/usr/lib ../src/.libs/libonig.so\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o testcu testu.o ../src/libonig.la \\r\\nlibtool: link: gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o .libs/testcu testu.o  -L/usr/lib ../src/.libs/libonig.so\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o testc testc.o ../src/libonig.la \\r\\nlibtool: link: gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o .libs/testc testc.o  -L/usr/lib ../src/.libs/libonig.so\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -L/usr/lib -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o test_utf8 test_utf8.o ../src/libonig.la \\r\\nlibtool: link: gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -flto=auto -flto-partition=none -Wl,-z -Wl,relro -Wl,--as-needed -Wl,-z -Wl,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -flto=auto -flto-partition=none -fuse-linker-plugin -o .libs/test_utf8 test_utf8.o  -L/usr/lib ../src/.libs/libonig.so\\r\\nmake[2]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n/usr/bin/make  check-TESTS\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nPASS: test_regset\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nPASS: testcu\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nPASS: testc\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nPASS: test_utf8\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n../test-driver: line 107: 3283683 Segmentation fault      (core dumped) &quot;$@&quot; &gt; $log_file 2&gt;&amp;1\\r\\nFAIL: testp\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[3]: Entering directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\n=====================================\\r\\n   onig 6.9.4: test/test-suite.log\\r\\n=====================================\\r\\n\\r\\n# TOTAL: 5\\r\\n# PASS:  4\\r\\n# SKIP:  0\\r\\n# XFAIL: 0\\r\\n# FAIL:  1\\r\\n# XPASS: 0\\r\\n# ERROR: 0\\r\\n\\r\\n.. contents:: :depth: 2\\r\\n\\r\\nFAIL: testp\\r\\n===========\\r\\n\\r\\nFAIL testp (exit status: 139)\\r\\n\\r\\n============================================================================\\r\\nTestsuite summary for onig 6.9.4\\r\\n============================================================================\\r\\n# TOTAL: 5\\r\\n# PASS:  4\\r\\n# SKIP:  0\\r\\n# XFAIL: 0\\r\\n# FAIL:  1\\r\\n# XPASS: 0\\r\\n# ERROR: 0\\r\\n============================================================================\\r\\nSee test/test-suite.log\\r\\n============================================================================\\r\\nmake[3]: *** [Makefile:732: test-suite.log] Error 1\\r\\nmake[3]: Leaving directory &apos;/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test&apos;\\r\\nmake[2]: *** [Makefile:840: check-TESTS] Error 2\\r\\nmake[1]: *** [Makefile:942: check-am] Error 2\\r\\nmake: *** [Makefile:494: check-recursive] Error 1\\r\\nerror: Bad exit status from /var/tmp/rpm-tmp.10nOqW (%check)\\r\\n</pre>\\r\\n\\r\\n<pre>[tkloczko@barrel SPECS]$ coredumpctl |tail -1\\r\\nFri 2019-11-29 06:04:55 GMT  3283683  1000  1000  11 present   /home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test/.libs/lt-testp\\r\\n[tkloczko@barrel SPECS]$ coredumpctl gdb 3283683\\r\\n           PID: <b>3283683</b> (lt-testp)\\r\\n           UID: 1000 (tkloczko)\\r\\n           GID: 1000 (tkloczko)\\r\\n        Signal: 11 (SEGV)\\r\\n     Timestamp: Fri 2019-11-29 06:04:55 GMT (2min 38s ago)\\r\\n  Command Line: ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩSIZE=1000\\r\\n    Executable: <b>/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test/.libs/lt-testp</b>\\r\\n Control Group: /user.slice/user-1000.slice/session-28.scope\\r\\n          Unit: session-28.scope\\r\\n         Slice: user-1000.slice\\r\\n       Session: 28\\r\\n     Owner UID: 1000 (tkloczko)\\r\\n       Boot ID: e48477e1a2e647b7af13d0169d223436\\r\\n    Machine ID: d033f66b249a4ec09acfa81ac205554f\\r\\n      Hostname: barrel\\r\\n       Storage: /var/lib/systemd/coredump/core.lt-testp.1000.e48477e1a2e647b7af13d0169d223436.3283683.1575007495000000000000.lz4\\r\\n       Message: Process 3283683 (lt-testp) of user 1000 dumped core.\\r\\n                \\r\\n                Stack trace of thread 3283683:\\r\\n                #0  0x00007fb348189620 __libc_free (libc.so.6)\\r\\n                #1  0x00007fb3481e2c6e regfree (libc.so.6)\\r\\n                #2  0x0000561c8d58b5f9 n/a (/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test/.libs/lt-testp)\\r\\n\\r\\n<font color=\\\"#75507B\\\"><b>GNU gdb (GDB) Fedora 9.0.50.20191119-2.fc32</b></font>\\r\\nCopyright (C) 2019 Free Software Foundation, Inc.\\r\\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\\r\\nThis is free software: you are free to change and redistribute it.\\r\\nThere is NO WARRANTY, to the extent permitted by law.\\r\\nType &quot;show copying&quot; and &quot;show warranty&quot; for details.\\r\\nThis GDB was configured as &quot;x86_64-redhat-linux-gnu&quot;.\\r\\nType &quot;show configuration&quot; for configuration details.\\r\\nFor bug reporting instructions, please see:\\r\\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\\r\\nFind the GDB manual and other documentation resources online at:\\r\\n    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.\\r\\n\\r\\nFor help, type &quot;help&quot;.\\r\\nType &quot;apropos word&quot; to search for commands related to &quot;word&quot;...\\r\\nReading symbols from <font color=\\\"#4E9A06\\\">/home/tkloczko/rpmbuild/BUILD/onig-6.9.4/test/.libs/lt-testp</font>...\\r\\n[New LWP 3283683]\\r\\nCore was generated by `ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&apos;.\\r\\nProgram terminated with signal SIGSEGV, Segmentation fault.\\r\\n#0  <font color=\\\"#3465A4\\\">0x00007fb348189620</font> in <font color=\\\"#C4A000\\\">free</font> () from <font color=\\\"#4E9A06\\\">/lib64/libc.so.6</font>\\r\\n glibc-2.30.9000-19.fc32.x86_64\\r\\n(gdb) bt full\\r\\nMissing separate debuginfos, use: dnf debuginfo-install#0  <font color=\\\"#3465A4\\\">0x00007fb348189620</font> in <font color=\\\"#C4A000\\\">free</font> () from <font color=\\\"#4E9A06\\\">/lib64/libc.so.6</font>\\r\\nNo symbol table info available.\\r\\n#1  <font color=\\\"#3465A4\\\">0x00007fb3481e2c6e</font> in <font color=\\\"#C4A000\\\">regfree</font> () from <font color=\\\"#4E9A06\\\">/lib64/libc.so.6</font>\\r\\nNo symbol table info available.\\r\\n#2  <font color=\\\"#3465A4\\\">0x0000561c8d58b5f9</font> in <font color=\\\"#C4A000\\\">xx</font> (<font color=\\\"#06989A\\\">pattern</font>=0x561c8d58c05b &quot;&quot;, <font color=\\\"#06989A\\\">str</font>=0x561c8d58c05b &quot;&quot;, <font color=\\\"#06989A\\\">from</font>=0, <font color=\\\"#06989A\\\">to</font>=0, <font color=\\\"#06989A\\\">mem</font>=0, <font color=\\\"#06989A\\\">not</font>=0) at <font color=\\\"#4E9A06\\\">testc.c</font>:80\\r\\n        <font color=\\\"#06989A\\\">r</font> = &lt;optimized out&gt;\\r\\n        <font color=\\\"#06989A\\\">reg</font> = {onig = <font color=\\\"#3465A4\\\">0x0</font>, re_nsub = 0, comp_options = 224}\\r\\n        <font color=\\\"#06989A\\\">buf</font> = &apos;\\\\377&apos; &lt;repeats 200 times&gt;\\r\\n        <font color=\\\"#06989A\\\">pmatch</font> = {{rm_so = 0, rm_eo = 0}, {rm_so = -1, rm_eo = -1} &lt;repeats 24 times&gt;}\\r\\n#3  <font color=\\\"#3465A4\\\">0xffffffffffffffff</font> in <font color=\\\"#C4A000\\\">??</font> ()\\r\\n</pre>\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It does not happen in my environment.\\r\\nI don't know about your environment, but maybe the POSIX API is clashing with the original.\\r\\nPlease make it with a setting that does not have POSIX API.\\r\\n``` \\r\\n$ ./configure --enable-posix-api=no\\r\\n```\\r\\n\\r\\nI want to remove POSIX API but leaving for backward compatibility.\\r\\n\"}, {\"author\": \"kloczek\", \"body\": \"OK after configure source tree with `--disable-posix-api` it works.\\r\\n\\r\\nWhy it is not disabled by default? :)\"}, {\"author\": \"kkos\", \"body\": \"Thanks  for confirmation.\\r\\nI will change the default to NO POSIX API in the next release.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_166", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"166\", \"title\": \"6.9.4 can build test suite with old glibc\", \"author\": \"remicollet\", \"labels\": [], \"description\": \"On RHEL-6 with glibc 2.12\\r\\n```\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -L/usr/lib  -o test_regset test_regset.o ../src/libonig.la \\r\\nlibtool: link: gcc -Wall -Wno-invalid-source-encoding -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -o .libs/test_regset test_regset.o  -L/usr/lib ../src/.libs/libonig.so -Wl,-rpath -Wl,/usr/lib64\\r\\ntest_regset.o: In function `time_test':\\r\\n/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:96: undefined reference to `clock_gettime'\\r\\n/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:107: undefined reference to `clock_gettime'\\r\\n/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:111: undefined reference to `clock_gettime'\\r\\n/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:122: undefined reference to `clock_gettime'\\r\\n/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:107: undefined reference to `clock_gettime'\\r\\ntest_regset.o:/builddir/build/BUILD/onig-6.9.4/test/test_regset.c:111: more undefined references to `clock_gettime' follow\\r\\ncollect2: ld returned 1 exit status\\r\\n```\\r\\n\\r\\nFrom man page `Link with -lrt (only for glibc versions before 2.17).`\\r\\n\\r\\nTrivial workaround\\r\\n`sed -e '/^test_regset_LDADD/s/$/ -lrt/' -i test/Makefile`\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the information.\\r\\nI will change it to use clock() instead of clock_gettime().\\r\\nOr should I stop measuring time in the test program?\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_167", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"167\", \"title\": \"src/regexec.c:match_at(): Misusage of macro MATCH_AT_ERROR_RETURN\", \"author\": \"Arfrever\", \"labels\": [], \"description\": \"Oniguruma 6.9.4 (commit e760024504a8e77da1956e3f34850ae00228026f) introduced the following new compiler warning which looks like indicating real bug in source code:\\r\\n```\\r\\nsrc/regexec.c: In function ‚Äòmatch_at‚Äô:\\r\\nsrc/regexec.c:2577:42: warning: macro expands to multiple statements [-Wmultistatement-macros]\\r\\n 2577 | #define MATCH_AT_ERROR_RETURN(err_code)  best_len = err_code; goto match_at_end\\r\\n      |                                          ^~~~~~~~\\r\\nsrc/regexec.c:2849:26: note: in expansion of macro ‚ÄòMATCH_AT_ERROR_RETURN‚Äô\\r\\n 2849 |               if (r < 0) MATCH_AT_ERROR_RETURN(r);\\r\\n      |                          ^~~~~~~~~~~~~~~~~~~~~\\r\\nsrc/regexec.c:2849:15: note: some parts of macro expansion are not guarded by this ‚Äòif‚Äô clause\\r\\n 2849 |               if (r < 0) MATCH_AT_ERROR_RETURN(r);\\r\\n      |               ^~\\r\\n```\\r\\n\\r\\nProbably `{` and `}` should be added: `if (r < 0) { MATCH_AT_ERROR_RETURN(r); }`\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI can't confirm if the warning is gone, but I've fixed it.\\r\\nThis issue affects when the capture history feature is used (disabled in default syntax) and ONIG_OPTION_FIND_LONGEST or ONIG_OPTION_FIND_NOT_EMPTY is specified.\"}, {\"author\": \"Arfrever\", \"body\": \"I confirm that this warning is fixed.\\r\\n(This type of warning is reported when using GCC >=8.\\r\\nGCC 7 or Clang 9 does not report this type of warning.)\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_169", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"169\", \"title\": \"Use of uninitialized value with lookbehind assertion\", \"author\": \"nikic\", \"labels\": [], \"description\": \"I get a memory sanitizer report when compiling the regex `(?<= ?)` since ~Dec 26:\\r\\n\\r\\n```\\r\\n--\\r\\n¬† | ==1==WARNING: MemorySanitizer: use-of-uninitialized-value\\r\\n¬† | #0 0x16f44b6 in distance_multiply php-src/oniguruma/src/regcomp.c:534:7\\r\\n¬† | #1 0x1701697 in mml_range_multiply php-src/oniguruma/src/regcomp.c:656:13\\r\\n¬† | #2 0x16ffc80 in node_char_len1 php-src/oniguruma/src/regcomp.c:758:11\\r\\n¬† | #3 0x16fe281 in tune_look_behind php-src/oniguruma/src/regcomp.c:4045:7\\r\\n¬† | #4 0x16f7c8a in tune_anchor php-src/oniguruma/src/regcomp.c:0\\r\\n¬† | #5 0x16e6d7e in tune_tree php-src/oniguruma/src/regcomp.c:5193:9\\r\\n¬† | #6 0x16deef2 in onig_compile php-src/oniguruma/src/regcomp.c:6595:7\\r\\n¬† | #7 0x16ed581 in onig_new php-src/oniguruma/src/regcomp.c:6815:7\\r\\n¬† | #8 0x99bbfd in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:466:19\\r\\n¬† | #9 0x9945da in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:929:7\\r\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_170", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"170\", \"title\": \"Code to sumbit\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"Hi kkos,\\r\\n\\r\\nI want to use oniguruma as a submodule in tiano/edk2. So here are some changes I'd like to make happen in oniguruma. I have forked a copy in my github and uploaded the changes. Could you help take a look and see if it feasible?\\r\\nhttps://github.com/shenglei10/oniguruma/commits/master\", \"comments\": [{\"author\": \"kkos\", \"body\": \"PRINT_UNSUPPORT has been renamed to ONIGURUMA_UNSUPPORTED_PRINT.\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I accepted ONIGURUMA_SYS_UEFI, but after reconsideration I don't accept this name.\\r\\nRegular expressions libraries should know nothing about UEFI.\\r\\nFor example, I want to change the name to ONIG_NO_STANDARD_C_HEADERS.\\r\\nFor that reason, I reduced the range of ONIGURUMA_SYS_UEFI with some rewriting that seemed OK.\\r\\nCurrently, there is only one ONIGURUMA_SYS_UEFI in regint.h.\\r\\nDo you have any comments on the name?\\r\\n\\r\\nAnd today I have reduced the direct inclusion of system header files and moved them into ONIGURUMA_SYS_UEFI.\\r\\nWhat remains now is:\\r\\n```\\r\\n$ grep \\\"#include\\\\s*<\\\" *.h\\r\\nonigposix.h:#include <stddef.h>\\r\\nregenc.h:#include <stddef.h>\\r\\n(* exclude regint.h)\\r\\n\\r\\n$ grep \\\"#include\\\\s*<\\\" *.c\\r\\nregposerr.c:#include <string.h>\\r\\nregposerr.c:#include <stdio.h>\\r\\n(* exclude mktable.c)\\r\\n```\\r\\nWhich of these files should not be included in SYS_UEFI?\\r\\n\"}, {\"author\": \"shenglei10\", \"body\": \"All OS based header files should be in SYS_UEFI, including the files you list.\\r\\nAnd there is another thing I want to raise. Please see below.\\r\\n\\r\\nIn regint.h\\r\\n\\r\\n#ifndef xmemset\\r\\n#define xmemset     memset\\r\\n#endif\\r\\n\\r\\n#ifndef xmemcpy\\r\\n#define xmemcpy     memcpy\\r\\n#endif\\r\\n\\r\\n#ifndef xmemmove\\r\\n#define xmemmove    memmove\\r\\n#endif\\r\\n\\r\\n\\r\\nmemset, memcpy and memmove are Windows based API. Can you also include them into SYS_UEFI?\\r\\nOr the name you raise ONIG_NO_STANDARD_C_HEADERS. This name is OK to me.\"}, {\"author\": \"kkos\", \"body\": \"I have implemented your request.\\r\\n```\\r\\nONIGURUMA_SYS_UEFI -> ONIG_NO_STANDARD_C_HEADERS\\r\\nONIGURUMA_UNSUPPORTED_PRINT -> ONIG_NO_PRINT\\r\\n```\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_171", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"171\", \"title\": \"Add an attribute to function onig_snprintf_with_pattern\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"Hi kkos,\\r\\n\\r\\nPlease refer to this change.\\r\\nhttps://github.com/shenglei10/oniguruma/commits/master\\r\\n\\r\\nThanks,\\r\\nShenglei\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Is this change required for all variadic function declarations?\\r\\nIf so, the following function declaration in oniguruma.h also needs to be changed:\\r\\n```\\r\\nint onig_error_code_to_str  PV_((OnigUChar* s, int err_code, ...));\\r\\n```\\r\\n\\r\\nIn a normal environment, EFIAPI is not defined, so switching is required.\\r\\nCan I switch based on whether ONIGURUMA_SYS_UEFI is defined?\\r\\n\"}, {\"author\": \"lgao4\", \"body\": \"Yes. This change is required for all variadic function declarations and implementation. Shenglei will prepare the patches to fix them all. In normal case, EFIAPI is not used. It is not required to be defined. So, there is no impact. In UEFI Tiano Edk2 code, EFIAPI is required. It will be defined as C compiler flag, because the different compiler will have the different definition. So, EFIAPI is not required to be defined in C source code. It is different from ONIGURUMA_SYS_UEFI flag.\"}, {\"author\": \"kkos\", \"body\": \"I don't want to include EFIAPI symbol in oniguruma.h.\\r\\nI have added ONIG_VARIADIC_FUNC_ATTR in master branch.\\r\\nPlease use -DONIG_VARIADIC_FUNC_ATTR=EFIAPI\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_173", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"173\", \"title\": \"Use-after-free in lookbehind compilation\", \"author\": \"nikic\", \"labels\": [], \"description\": \"I've got some reports for use-after-free in lookbehind compilation recently. One of them is:\\r\\n\\r\\n```\\r\\n(?<=D|)(?<=@!nnnnnnnnnIIIIn;{1}D?()|<x@x*xxxD|)(?<=@xxx|xxxxx\\\\g<1>;{1}x)\\r\\n```\\r\\n\\r\\nWith stack trace:\\r\\n\\r\\n```\\r\\n¬† | ==569071==ERROR: AddressSanitizer: heap-use-after-free on address 0x6070081cdd40 at pc 0x000000f1de61 bp 0x7fffffffc650 sp 0x7fffffffc648\\r\\n¬† | READ of size 4 at 0x6070081cdd40 thread T0\\r\\n¬† | SCARINESS: 45 (4-byte-read-heap-use-after-free)\\r\\n¬† | #0 0xf1de60 in check_called_node_in_look_behind php-src/oniguruma/src/regcomp.c:3406:11\\r\\n¬† | #1 0xf1d030 in check_node_in_look_behind php-src/oniguruma/src/regcomp.c:3505:11\\r\\n¬† | #2 0xf1d030 in check_node_in_look_behind php-src/oniguruma/src/regcomp.c:3505:11\\r\\n¬† | #3 0xf199ee in tune_anchor php-src/oniguruma/src/regcomp.c:5610:9\\r\\n¬† | #4 0xf1088b in tune_tree php-src/oniguruma/src/regcomp.c:5715:13\\r\\n¬† | #5 0xf0c67e in onig_compile php-src/oniguruma/src/regcomp.c:7223:7\\r\\n¬† | #6 0xf1466d in onig_new php-src/oniguruma/src/regcomp.c:7443:7\\r\\n¬† | #7 0x73ac37 in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:466:19\\r\\n¬† | #8 0x7363b5 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:929:7\\r\\n¬† | #9 0xb9cb57 in zend_call_function php-src/Zend/zend_execute_API.c:0\\r\\n¬† | #10 0xb9b559 in _call_user_function_ex php-src/Zend/zend_execute_API.c:606:9\\r\\n¬† | #11 0xedaa37 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #12 0xedad92 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #13 0xed9a0d in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #14 0xf6f3b9 in HonggfuzzPersistentLoop\\r\\n¬† | #15 0xf6f354 in HonggfuzzMain\\r\\n¬† | #16 0x7ffff6cca82f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/libc-start.c:291\\r\\n¬† | #17 0x443028 in _start\\r\\n¬† | ¬†\\r\\n¬† | 0x6070081cdd40 is located 0 bytes inside of 72-byte region [0x6070081cdd40,0x6070081cdd88)\\r\\n¬† | freed by thread T0 here:\\r\\n¬† | #0 0x4bb98d in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:123:3\\r\\n¬† | #1 0xedeffc in node_free_body php-src/oniguruma/src/regparse.c:2074:7\\r\\n¬† | #2 0xededd9 in onig_node_free php-src/oniguruma/src/regparse.c:2135:3\\r\\n¬† | #3 0xedef98 in node_free_body php-src/oniguruma/src/regparse.c:2070:5\\r\\n¬† | #4 0xededd9 in onig_node_free php-src/oniguruma/src/regparse.c:2135:3\\r\\n¬† | #5 0xedef1c in node_free_body php-src/oniguruma/src/regparse.c:2114:7\\r\\n¬† | #6 0xee052a in node_reset_str php-src/oniguruma/src/regparse.c:3350:3\\r\\n¬† | #7 0xf1d867 in tune_look_behind php-src/oniguruma/src/regcomp.c:4685:13\\r\\n¬† | #8 0xf1088b in tune_tree php-src/oniguruma/src/regcomp.c:5715:13\\r\\n¬† | #9 0xf0c67e in onig_compile php-src/oniguruma/src/regcomp.c:7223:7\\r\\n¬† | #10 0xf1466d in onig_new php-src/oniguruma/src/regcomp.c:7443:7\\r\\n¬† | #11 0x73ac37 in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:466:19\\r\\n¬† | #12 0x7363b5 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:929:7\\r\\n¬† | #13 0xb9cb57 in zend_call_function php-src/Zend/zend_execute_API.c:0\\r\\n¬† | #14 0xb9b559 in _call_user_function_ex php-src/Zend/zend_execute_API.c:606:9\\r\\n¬† | #15 0xedaa37 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #16 0xedad92 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #17 0xed9a0d in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #18 0xf6f3b9 in HonggfuzzPersistentLoop\\r\\n¬† | ¬†\\r\\n¬† | previously allocated by thread T0 here:\\r\\n¬† | #0 0x4bbc0d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\\r\\n¬† | #1 0xedf579 in node_new php-src/oniguruma/src/regparse.c:2152:18\\r\\n¬† | #2 0xedf9aa in node_new_bag php-src/oniguruma/src/regparse.c:2520:16\\r\\n¬† | #3 0xefd639 in node_new_memory php-src/oniguruma/src/regparse.c:2573:16\\r\\n¬† | #4 0xef240b in parse_bag php-src/oniguruma/src/regparse.c:7770:11\\r\\n¬† | #5 0xeefc68 in parse_exp php-src/oniguruma/src/regparse.c:8095:9\\r\\n¬† | #6 0xeef75f in parse_branch php-src/oniguruma/src/regparse.c:8496:11\\r\\n¬† | #7 0xeeac7c in parse_alts php-src/oniguruma/src/regparse.c:8531:7\\r\\n¬† | #8 0xef2526 in parse_bag php-src/oniguruma/src/regparse.c:7780:7\\r\\n¬† | #9 0xeefc68 in parse_exp php-src/oniguruma/src/regparse.c:8095:9\\r\\n¬† | #10 0xeef75f in parse_branch php-src/oniguruma/src/regparse.c:8496:11\\r\\n¬† | #11 0xeeac7c in parse_alts php-src/oniguruma/src/regparse.c:8531:7\\r\\n¬† | #12 0xee2bf3 in parse_regexp php-src/oniguruma/src/regparse.c:8591:7\\r\\n¬† | #13 0xee2695 in onig_parse_tree php-src/oniguruma/src/regparse.c:8646:7\\r\\n¬† | #14 0xf0c1d9 in onig_compile php-src/oniguruma/src/regcomp.c:7175:7\\r\\n¬† | #15 0xf1466d in onig_new php-src/oniguruma/src/regcomp.c:7443:7\\r\\n¬† | #16 0x73ac37 in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:466:19\\r\\n¬† | #17 0x7363b5 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:929:7\\r\\n¬† | #18 0xb9cb57 in zend_call_function php-src/Zend/zend_execute_API.c:0\\r\\n¬† | #19 0xb9b559 in _call_user_function_ex php-src/Zend/zend_execute_API.c:606:9\\r\\n¬† | #20 0xedaa37 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #21 0xedad92 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #22 0xed9a0d in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #23 0xf6f3b9 in HonggfuzzPersistentLoop\\r\\n```\\r\\n\\r\\nThere are a few more, but they all look like the cause is the same.\", \"comments\": [{\"author\": \"nikic\", \"body\": \"Also a leak:\\r\\n\\r\\n```\\r\\n(?<=(?<= )| )\\r\\n```\\r\\n\\r\\n```\\r\\nDirect leak of 72 byte(s) in 1 object(s) allocated from:\\r\\n--\\r\\n¬† | #0 0x54872d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\\r\\n¬† | #1 0xf338d7 in node_new php-src/oniguruma/src/regparse.c:2152:18\\r\\n¬† | #2 0xf336e4 in onig_node_copy php-src/oniguruma/src/regparse.c:2187:10\\r\\n¬† | #3 0xf71143 in tune_look_behind php-src/oniguruma/src/regcomp.c:4717:17\\r\\n¬† | #4 0xf6427a in tune_tree php-src/oniguruma/src/regcomp.c:5726:11\\r\\n¬† | #5 0xf70d26 in tune_look_behind php-src/oniguruma/src/regcomp.c:4673:7\\r\\n¬† | #6 0xf600b8 in onig_compile php-src/oniguruma/src/regcomp.c:7223:7\\r\\n¬† | #7 0xf67ee1 in onig_new php-src/oniguruma/src/regcomp.c:7443:7\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Well, the test by libFuzzer (8 billion times, max_len = 43, dict = ascii_compatible.dict) failed to produce the same phenomenon.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_174", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"174\", \"title\": \"php7.4 not found\", \"author\": \"cjieyan\", \"labels\": [], \"description\": \"No package 'oniguruma' found:\\r\\n\\r\\n\\r\\nexport ONIG_CFLAGS=\\\"-I/usr/local/include\\\" ONIG_LIBS=\\\"-L/usr/local/lib -lonig\\\"\", \"comments\": [{\"author\": \"mblackritter\", \"body\": \"Did you come here from installing PHP 7.4 via ```phpbrew```?\\r\\n\\r\\nJust install Oniguruna package via macports:\\r\\n```> sudo port install oniguruma6```\"}, {\"author\": \"kkos\", \"body\": \"@mblackritter, Thank you for your support.\\r\\n\\r\\n@cjieyan \\r\\nI have never released a package.\\r\\nI only release source code archives.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_175", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"175\", \"title\": \"Use-after-free in optimize_nodes\", \"author\": \"nikic\", \"labels\": [], \"description\": \"Regex:\\r\\n\\r\\n```\\r\\n(())\\\\g<3>{0}(?<=|())\\r\\n```\\r\\n\\r\\nAddress sanitizer report:\\r\\n\\r\\n```\\r\\n\\r\\n==1==ERROR: AddressSanitizer: heap-use-after-free on address 0x60700000c0a0 at pc 0x000000f7ccc0 bp 0x7ffe30aa14f0 sp 0x7ffe30aa14e8\\r\\n--\\r\\n¬† | READ of size 4 at 0x60700000c0a0 thread T0\\r\\n¬† | #0 0xf7ccbf in optimize_nodes php-src/oniguruma/src/regcomp.c:6465:11\\r\\n¬† | #1 0xf7c0d7 in optimize_nodes /src/php-src/oniguruma/src/regcomp.c\\r\\n¬† | #2 0xf7b657 in optimize_nodes php-src/oniguruma/src/regcomp.c:6637:11\\r\\n¬† | #3 0xf7b979 in optimize_nodes php-src/oniguruma/src/regcomp.c:6473:13\\r\\n¬† | #4 0xf6cac5 in set_optimize_info_from_tree php-src/oniguruma/src/regcomp.c:6836:7\\r\\n¬† | #5 0xf675a5 in onig_compile php-src/oniguruma/src/regcomp.c:7277:7\\r\\n¬† | #6 0xf6f041 in onig_new php-src/oniguruma/src/regcomp.c:7457:7\\r\\n¬† | #7 0x7be9ea in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:467:19\\r\\n¬† | #8 0x7ba335 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:930:7\\r\\n¬† | #9 0xc0cb42 in zend_call_function /src/php-src/Zend/zend_execute_API.c\\r\\n¬† | #10 0xc0b59c in _call_user_function_ex php-src/Zend/zend_execute_API.c:607:9\\r\\n¬† | #11 0xf360b0 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #12 0xf36428 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #13 0xf35054 in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #14 0x480c01 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15\\r\\n¬† | #15 0x46b721 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6\\r\\n¬† | #16 0x4713de in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9\\r\\n¬† | #17 0x49b302 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10\\r\\n¬† | #18 0x7ff39c35d82f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291\\r\\n¬† | #19 0x444b98 in _start (/mnt/scratch0/clusterfuzz/bot/builds/clusterfuzz-builds_php_e9de66a0ceecce608bb4fb08fd650bb8aad9865f/revisions/php-fuzz-mbstring+0x444b98)\\r\\n¬† | ¬†\\r\\n¬† | 0x60700000c0a0 is located 0 bytes inside of 72-byte region [0x60700000c0a0,0x60700000c0e8)\\r\\n¬† | freed by thread T0 here:\\r\\n¬† | #0 0x54851d in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:123:3\\r\\n¬† | #1 0xf3a50c in node_free_body php-src/oniguruma/src/regparse.c:2074:7\\r\\n¬† | #2 0xf3a304 in onig_node_free php-src/oniguruma/src/regparse.c:2135:3\\r\\n¬† | #3 0xf3a43a in node_free_body php-src/oniguruma/src/regparse.c:2114:7\\r\\n¬† | #4 0xf3ba08 in node_reset_str php-src/oniguruma/src/regparse.c:3350:3\\r\\n¬† | #5 0xf77eca in tune_look_behind php-src/oniguruma/src/regcomp.c:4698:13\\r\\n¬† | #6 0xf6b2eb in tune_tree php-src/oniguruma/src/regcomp.c:5729:13\\r\\n¬† | #7 0xf67218 in onig_compile php-src/oniguruma/src/regcomp.c:7237:7\\r\\n¬† | #8 0xf6f041 in onig_new php-src/oniguruma/src/regcomp.c:7457:7\\r\\n¬† | #9 0x7be9ea in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:467:19\\r\\n¬† | #10 0x7ba335 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:930:7\\r\\n¬† | #11 0xc0cb42 in zend_call_function /src/php-src/Zend/zend_execute_API.c\\r\\n¬† | #12 0xc0b59c in _call_user_function_ex php-src/Zend/zend_execute_API.c:607:9\\r\\n¬† | #13 0xf360b0 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #14 0xf36428 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #15 0xf35054 in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #16 0x480c01 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15\\r\\n¬† | #17 0x46b721 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6\\r\\n¬† | #18 0x4713de in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9\\r\\n¬† | #19 0x49b302 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10\\r\\n¬† | #20 0x7ff39c35d82f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291\\r\\n¬† | ¬†\\r\\n¬† | previously allocated by thread T0 here:\\r\\n¬† | #0 0x54879d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\\r\\n¬† | #1 0xf3aa37 in node_new php-src/oniguruma/src/regparse.c:2152:18\\r\\n¬† | #2 0xf3ae58 in node_new_bag php-src/oniguruma/src/regparse.c:2520:16\\r\\n¬† | #3 0xf58798 in node_new_memory php-src/oniguruma/src/regparse.c:2573:16\\r\\n¬† | #4 0xf4d67d in parse_bag php-src/oniguruma/src/regparse.c:7770:11\\r\\n¬† | #5 0xf4b03a in parse_exp php-src/oniguruma/src/regparse.c:8095:9\\r\\n¬† | #6 0xf4a935 in parse_branch php-src/oniguruma/src/regparse.c:8478:7\\r\\n¬† | #7 0xf461cf in parse_alts php-src/oniguruma/src/regparse.c:8551:11\\r\\n¬† | #8 0xf4d794 in parse_bag php-src/oniguruma/src/regparse.c:7780:7\\r\\n¬† | #9 0xf4b03a in parse_exp php-src/oniguruma/src/regparse.c:8095:9\\r\\n¬† | #10 0xf4ab36 in parse_branch php-src/oniguruma/src/regparse.c:8496:11\\r\\n¬† | #11 0xf45fd0 in parse_alts php-src/oniguruma/src/regparse.c:8531:7\\r\\n¬† | #12 0xf3e118 in parse_regexp php-src/oniguruma/src/regparse.c:8591:7\\r\\n¬† | #13 0xf3dbcd in onig_parse_tree php-src/oniguruma/src/regparse.c:8646:7\\r\\n¬† | #14 0xf66da5 in onig_compile php-src/oniguruma/src/regcomp.c:7189:7\\r\\n¬† | #15 0xf6f041 in onig_new php-src/oniguruma/src/regcomp.c:7457:7\\r\\n¬† | #16 0x7be9ea in php_mbregex_compile_pattern php-src/ext/mbstring/php_mbregex.c:467:19\\r\\n¬† | #17 0x7ba335 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:930:7\\r\\n¬† | #18 0xc0cb42 in zend_call_function /src/php-src/Zend/zend_execute_API.c\\r\\n¬† | #19 0xc0b59c in _call_user_function_ex php-src/Zend/zend_execute_API.c:607:9\\r\\n¬† | #20 0xf360b0 in fuzzer_call_php_func_zval php-src/sapi/fuzzer/fuzzer-sapi.c:247:2\\r\\n¬† | #21 0xf36428 in fuzzer_call_php_func php-src/sapi/fuzzer/fuzzer-sapi.c:267:2\\r\\n¬† | #22 0xf35054 in LLVMFuzzerTestOneInput php-src/sapi/fuzzer/fuzzer-mbstring.c:44:2\\r\\n¬† | #23 0x480c01 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15\\r\\n¬† | #24 0x46b721 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6\\r\\n¬† | #25 0x4713de in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9\\r\\n¬† | #26 0x49b302 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10\\r\\n¬† | #27 0x7ff39c35d82f in __libc_start_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291\\r\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_176", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"176\", \"title\": \"Warning treated as error\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"In regcomp.c    line 2057\\r\\n\\r\\n    COP(reg)->move.n = (RelPositionType )(-ci.min);\\r\\n\\r\\nci.min is type of unsigned int. But there is a minus operator before it, so the result is still unsigned.\\r\\nShould it be changed to 'COP(reg)->move.n = -((RelPositionType )ci.min);'?\\r\\n\\r\\nSame at line 2204\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_177", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"177\", \"title\": \"Signed integer overflow in regenc.c\", \"author\": \"nikic\", \"labels\": [], \"description\": \"I'm not sure whether this is important or not, so reporting this just in case...\\r\\n\\r\\nRegex:\\r\\n\\r\\n```\\r\\n(?<!xxxxxxxxxxxxxxxxxxxxxxx{32774}{65521}xxxxxxxx{65521}xxxxxxxxxxxxxx{32774}xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx)\\r\\n```\\r\\n\\r\\nSubject: Empty string.\\r\\n\\r\\nStack trace:\\r\\n\\r\\n```\\r\\nregenc.c:206:34: runtime error: signed integer overflow: -2147483648 - 1 cannot be represented in type 'int'\\r\\n--\\r\\n¬† | #0 0xb6d83d in onigenc_step_back php-src/oniguruma/src/regenc.c:206:34\\r\\n¬† | #1 0xb630e3 in match_at php-src/oniguruma/src/regexec.c:3940:22\\r\\n¬† | #2 0xb668c8 in search_in_range php-src/oniguruma/src/regexec.c:5344:7\\r\\n¬† | #3 0xb67a61 in onig_search_with_param php-src/oniguruma/src/regexec.c:5469:10\\r\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_178", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"178\", \"title\": \"Oniguruma on oss-fuzz\", \"author\": \"nikic\", \"labels\": [], \"description\": \"Google provides a cluster fuzzing service for open-source projects, see https://github.com/google/oss-fuzz. Currently oniguruma is being fuzzed indirectly through PHP, but this very inefficient and only covers part of the surface area.\\r\\n\\r\\nAs you already include libfuzzer harnesses in this repo, it probably wouldn't be hard to add oniguruma to oss-fuzz. Documentation for how to do the setup is available here: https://google.github.io/oss-fuzz/getting-started/\", \"comments\": [{\"author\": \"kkos\", \"body\": \"For a week, I ran oss-fuzz test on my PC(MacOSX, 8GB)\\r\\nSeveral issues were found and fixed, but some issues still remain.\\r\\n\\r\\nThe fuzzer program usually dies with an uncaught segmentation fault within 10 million iterations.\\r\\nI don't know if this is because of my poor environment or if there is a problem with Oniguruma.\\r\\n\\r\\nSometimes it ends with timeout.\\r\\nTo avoid this, I now think it might be better to add a feature to limit the fail count across searches.\\r\\nThe limit on the fail count in matching alone would mean specifying a very small number.\"}, {\"author\": \"nikic\", \"body\": \"> For a week, I ran oss-fuzz test on my PC(MacOSX, 8GB)\\r\\n> Several issues were found and fixed, but some issues still remain.\\r\\n> \\r\\n> The fuzzer program usually dies with an uncaught segmentation fault within 10 million iterations.\\r\\n> I don't know if this is because of my poor environment or if there is a problem with Oniguruma.\\r\\n\\r\\nWhat do you mean by an uncaught segmentation fault? The fuzzer itself crashes without reporting a stack trace?\\r\\n\\r\\n> Sometimes it ends with timeout.\\r\\n> To avoid this, I now think it might be better to add a feature to limit the fail count across searches.\\r\\n> The limit on the fail count in matching alone would mean specifying a very small number.\\r\\n\\r\\nYes, timeouts are an issue when fuzzing oniguruma. It seems that none of the limits that exist right now are fully effective at preventing timeouts. It's not strictly necessary to fix this, but it of course degrades fuzzer performance a lot.\"}, {\"author\": \"kkos\", \"body\": \"run_fuzzer ends with the following output. (without stack trace and file of data where the problem was detected)\\r\\n(The default is to end with out of memory, so I added -rss_limit_mb=3072 option.)\\r\\n\\r\\n```\\r\\n$ python infra/helper.py run_fuzzer oniguruma fuzzer\\r\\n....\\r\\n#14484722REDUCE cov: 4877 ft: 26351 corp: 9736/948Kb lim: 4096 exec/s: 566 rss: 196Mb L: 32/4038 MS: 1 EraseBytes-\\r\\n#14486886REDUCE cov: 4877 ft: 26351 corp: 9736/948Kb lim: 4096 exec/s: 566 rss: 196Mb L: 123/4038 MS: 4 ChangeBit-ManualDict-EraseBytes-ChangeBinInt- DE: \\\"(?x:\\\"-\\r\\n#14490713REDUCE cov: 4877 ft: 26351 corp: 9736/948Kb lim: 4096 exec/s: 566 rss: 196Mb L: 136/4038 MS: 2 ChangeBit-EraseBytes-\\r\\n#14492299REDUCE cov: 4877 ft: 26351 corp: 9736/948Kb lim: 4096 exec/s: 566 rss: 196Mb L: 88/4038 MS: 1 EraseBytes-\\r\\n#14492790REDUCE cov: 4877 ft: 26351 corp: 9736/948Kb lim: 4096 exec/s: 566 rss: 196Mb L: 131/4038 MS: 1 EraseBytes-\\r\\nbash: line 1:    15 Segmentation fault      /out/fuzzer -rss_limit_mb=2560 -timeout=25 /tmp/fuzzer_corpus -dict=ascii_compatible.dict -rss_limit_mb=3072 < /dev/null\\r\\n$ \\r\\n```\\r\\n\\r\\nRetry limit in search functions was added to the master branch.\"}, {\"author\": \"kkos\", \"body\": \"The cause of the problem was found, so it has already been fixed in 6.9.5.\\r\\nNow, it's running over 310 million iterations without stopping on my PC.\\r\\n\\r\\nhttps://github.com/kkos/oss-fuzz/tree/20200417/projects/oniguruma\"}, {\"author\": \"nikic\", \"body\": \"@kkos Can you share what the problem was? Do you plan to submit this to the oss-fuzz project, to make use of their cluster infrastructure?\"}, {\"author\": \"kkos\", \"body\": \"The problem occurs when look-behinds include a backreference and the backreference are mutually recurring.\\r\\nex. /(\\\\2)|(?<=(\\\\1))/\\r\\n\\r\\nWith such a pattern, the function node_char_len1() is called recursively infinitely.\\r\\nThis does not happen in version 6.9.4 and earlier versions, because backreferences were allowed in look-behind after 6.9.4.\\r\\n\\r\\nI don't know how much code coverage this test has, so I'm putting aside participation in oss-fuzz. (I don't even know if there are any criteria for code coverage.)\\r\\nI tried following the steps below, but could not get code coverage. (Forgot details)\\r\\nhttps://google.github.io/oss-fuzz/advanced-topics/code-coverage/\\r\\n\"}, {\"author\": \"nikic\", \"body\": \"> The problem occurs when look-behinds include a backreference and the backreference are mutually recurring.\\r\\n> ex. /(\\\\2)|(?<=(\\\\1))/\\r\\n> \\r\\n> With such a pattern, the function node_char_len1() is called recursively infinitely.\\r\\n> This does not happen in version 6.9.4 and earlier versions, because backreferences were allowed in look-behind after 6.9.4.\\r\\n\\r\\nAh, thanks. I saw those stack overflows as well, but assumed they were false positives due to deep parse tree or similar.\\r\\n\\r\\n> I don't know how much code coverage this test has, so I'm putting aside participation in oss-fuzz. (I don't even know if there are any criteria for code coverage.)\\r\\n> I tried following the steps below, but could not get code coverage. (Forgot details)\\r\\n> https://google.github.io/oss-fuzz/advanced-topics/code-coverage/\\r\\n\\r\\nI don't think there is any particular code coverage requirement. For PHP, the edge coverage of each individual fuzzer is only 2-6%.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_179", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"179\", \"title\": \"Fail to build under Linux X64\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"In Regcomp.c  line 4820\\r\\n\\r\\n  int i, len, minlen, maxlen;\\r\\n  minlen = INT_MAX;\\r\\n\\r\\nminlen is still 32-bit under Linux X64 and INT_MAX is defined as 0x7FFFFFFFFFFFFFFF in my work environment , which causes overflow.\\r\\n\\r\\nCould you help make a change to make minlen and maxlen 64-bit variables under 64-bit Linux?\\r\\n\\r\\nThanks,\\r\\nShenglei\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Then, are the values of UINT_MAX and LONG_MAX correct?\\r\\nIs there a way to refer to the correct int-max value?\"}, {\"author\": \"shenglei10\", \"body\": \"Then, are the values of UINT_MAX and LONG_MAX correct?\\r\\nUINT_MAX and LONG_MAX are correct, because they can be defined by myself.\\r\\n\\r\\nIs there a way to refer to the correct int-max value?\\r\\nI made such changes to make the build pass.\\r\\nhttps://github.com/shenglei10/oniguruma/commit/1549e0a2f9f5be82f0b62e08cd15f1ae1dbc839a\\r\\n\\r\\nAnd I wonder if there is a rule to follow, that in which case you use 'int' to declare length variables and in which case you use 'OnigLen'.\\r\\n\\r\\nThanks,\\r\\nShenglei\\r\\n\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"The use of INT_MAX has been reduced as much as possible, but only one remains in regint.h.\\r\\nI know that the usage of types is inconsistent, but fixing the whole thing can be quite a challenge.\"}, {\"author\": \"shenglei10\", \"body\": \"Thank you for the code changes. It makes my build pass.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_180", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"180\", \"title\": \"Not able install on Linux - Centos\", \"author\": \"msonnad\", \"labels\": [], \"description\": \"I'm not able to install the oniguruma on Linux -centos system.\\r\\n\\r\\n./configure is not available to run.\\r\\n\\r\\nHow to install oniguruma?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"If the configure file does not exist, run autoreconf -vfi to generate the configure file.\\r\\nIf you get an error because autoreconf or something else is not installed, install them all. The name of the package that needs to be installed depends on the platform, so I can't answer it.\\r\\n\\r\\nThere is a release file (onig-6.9.4.tar.gz) below, and there is a confiugre file in it. If this is fine, use this.\\r\\nhttps://github.com/kkos/oniguruma/releases\\r\\n\\r\\nUnfortunately, I don't know if you have a configure file and it doesn't work.\"}, {\"author\": \"msonnad\", \"body\": \"Thanks @kkos \\r\\nI am able to install it now. I have downloaded the wrong file earlier.\\r\\n\\r\\nThe downloaded file from (https://github.com/kkos/oniguruma/releases) will work without any issues.\\r\\n\\r\\nThanks\\r\\nManjunath  S\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_181", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"181\", \"title\": \"Multi-line regular expressions parsing\", \"author\": \"tommai78101\", \"labels\": [], \"description\": \"It is mentioned in this issue:\\r\\n\\r\\nhttps://github.com/atom/language-java/issues/186\\r\\n\\r\\nWhere the RegExp engine, oniguruma, cannot do multi-line regular expressions parsing. I'm wondering if this is the case, and if so, whether there will be additional support for multi-line parsing?\\r\\n\\r\\nThanks.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't know exactly what multi-line you are saying, but it is possible if it simply means searching for a string containing multiple lines.\\r\\nIn any case, you need to show the regular expression pattern, the target character string, and the character encoding.\\r\\n\\r\\nAre the following old issues relevant?\\r\\nhttps://github.com/kkos/oniguruma/issues/11#issuecomment-230464079\"}, {\"author\": \"tommai78101\", \"body\": \"Somewhat.\\r\\n\\r\\nThe issue I referred to was actually referring to something where it's parsing the lines incorrectly and thus applying the Java syntax highlighting incorrectly.\\r\\n\\r\\nThe very original issue came from here:   https://github.com/microsoft/vscode/issues/63137\\r\\n\\r\\nBut, given how your old issue mentioned there's a technical limitation, it makes sense.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_182", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"182\", \"title\": \"What's the difference between retry limit in match and search?\", \"author\": \"nikic\", \"labels\": [], \"description\": \"Recently the option was added to set the retry limit in search, while previously only the retry limit in match was available. However, I don't really understand what the difference between these two options is.\\r\\n\\r\\nIs \\\"retry limit in match\\\" the retry limit for one particular position, while \\\"retry limit in search\\\" limits the number of retries for the entire search?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Yes.\\r\\nHowever, I didn't want to do two checks every time the process failed, so the specification was strange.\\r\\nReconsidered and fixed it now.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_183", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"183\", \"title\": \"Direct-leak in stack_double\", \"author\": \"nikic\", \"labels\": [], \"description\": \"Matching\\r\\n```\\r\\n.{,3}?{,3}+{3}+{3}?{,3}+{19}{,3}{,3}+{28}+\\r\\n```\\r\\non itself results in\\r\\n```\\r\\nDirect leak of 204808 byte(s) in 1 object(s) allocated from:\\r\\n--\\r\\n¬† | #0 0x81850f7 in realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:164:3\\r\\n¬† | #1 0x8de5ce7 in stack_double php-src/oniguruma/src/regexec.c:1629:30\\r\\n¬† | #2 0x8dc9d99 in match_at php-src/oniguruma/src/regexec.c:3915:7\\r\\n¬† | #3 0x8dde094 in search_in_range php-src/oniguruma/src/regexec.c:5429:7\\r\\n¬† | #4 0x8de0166 in onig_search_with_param php-src/oniguruma/src/regexec.c:5554:10\\r\\n¬† | #5 0x845aab9 in _php_mb_onig_search php-src/ext/mbstring/php_mbregex.c:881:8\\r\\n¬† | #6 0x8454af0 in _php_mb_regex_ereg_exec php-src/ext/mbstring/php_mbregex.c:939:6\\r\\n¬† | #7 0x8454610 in zif_mb_ereg php-src/ext/mbstring/php_mbregex.c:980:2\\r\\n```\\r\\nwith the regression range being https://github.com/kkos/oniguruma/compare/7b33ca998b1af491ef4915c6cc379ff03a59c908...eb8042ab9ad41e408da0eb263fd1ead3a02c6d88.\\r\\n\\r\\nLooking at the diff, I suspect that this is because of a confusion between `is_alloca` (pointer, always non-null) and `*is_alloca` (the wanted value) inside the STACK_SAVE macro.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"In my environment, the pattern did not do the same thing.\\r\\nBut obviously, as you say, the code is wrong.\\r\\nThank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_184", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"184\", \"title\": \"Query about tag\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"Hi,\\r\\n\\r\\nDo you have a plan to create a tag? If so, when will it happen?\\r\\n\\r\\nThanks,\\r\\nShenglei\", \"comments\": [{\"author\": \"kkos\", \"body\": \"If it's a release, I have no plans to release it until April.\\r\\nDoes it mean that only create a tag without releasing?\\r\\nAs a convention on GitHub, if it's okay to do that, I can just create a tag.\\r\\n\\r\\nWait about a week, and if no one says it's weird, make a tag.\"}, {\"author\": \"shenglei10\", \"body\": \"I have no idea of the naming convention of tags in oniguruma.\\r\\nLike v6.9.4_rc4, is this a release tag? Tag name like this looks OK to me.\"}, {\"author\": \"kkos\", \"body\": \"I am going to make the tag name 6.9.4_mark1.\"}, {\"author\": \"shenglei10\", \"body\": \"The name is OK to me. Thanks.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_185", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"185\", \"title\": \"regset cannot `search` at end of string (but a normal regex can)\", \"author\": \"asottile\", \"labels\": [], \"description\": \"Here's a small demo:\\r\\n\\r\\n```c\\r\\n#include <oniguruma.h>\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n\\r\\nint err(int code) {\\r\\n    if (code < 0) {\\r\\n        OnigUChar buf[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        int len = onig_error_code_to_str(buf, code);\\r\\n        printf(\\\"%.*s\\\\n\\\", len, buf);\\r\\n    }\\r\\n    return code;\\r\\n}\\r\\n\\r\\nint compile(regex_t** reg, const char* pattern) {\\r\\n    OnigErrorInfo err_info;\\r\\n    int ret = onig_new(\\r\\n        reg,\\r\\n        pattern, pattern + strlen(pattern),\\r\\n        ONIG_OPTION_NONE,\\r\\n        ONIG_ENCODING_UTF8,\\r\\n        ONIG_SYNTAX_ONIGURUMA,\\r\\n        &err_info\\r\\n    );\\r\\n    if (ret < 0) {\\r\\n        OnigUChar buf[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        int len = onig_error_code_to_str(buf, ret);\\r\\n        printf(\\\"%.*s\\\\n\\\", len, buf);\\r\\n    }\\r\\n    return ret;\\r\\n}\\r\\n\\r\\nint main(void) {\\r\\n    int ret;\\r\\n    OnigErrorInfo err_info;\\r\\n\\r\\n    OnigEncoding enc = ONIG_ENCODING_UTF8;\\r\\n    if (err(onig_initialize(&enc, 1)) < 0) {\\r\\n        return 1;\\r\\n    }\\r\\n\\r\\n    /* show that a single regex can match at end of a string */\\r\\n\\r\\n    regex_t* regex1;\\r\\n    if (compile(&regex1, \\\".*\\\") < 0) {\\r\\n        return 1;\\r\\n    }\\r\\n\\r\\n    const char* s = \\\"hello\\\";\\r\\n    OnigRegion* region = onig_region_new();\\r\\n    ret = onig_search(\\r\\n        regex1,\\r\\n        s, s + strlen(s),\\r\\n        s + strlen(s), s + strlen(s),\\r\\n        region,\\r\\n        ONIG_OPTION_NONE\\r\\n    );\\r\\n    if (ret < 0) {\\r\\n        return err(ret);\\r\\n    } else {\\r\\n        printf(\\\"single regex matched: %d\\\\n\\\", ret);\\r\\n    }\\r\\n\\r\\n    /* but can't do it with regset? */\\r\\n\\r\\n    regex_t* regexes[2];\\r\\n    if (compile(&regexes[0], \\\"a\\\") < 0) {\\r\\n        return 1;\\r\\n    }\\r\\n    if (compile(&regexes[1], \\\".*\\\") < 0) {\\r\\n        return 1;\\r\\n    }\\r\\n\\r\\n    OnigRegSet* rset;\\r\\n    if (err(onig_regset_new(&rset, 2, regexes))) {\\r\\n        return 1;\\r\\n    }\\r\\n\\r\\n    int _unused_match_pos;\\r\\n    ret = onig_regset_search(\\r\\n        rset,\\r\\n        s, s + strlen(s),\\r\\n        s + strlen(s), s + strlen(s),\\r\\n        ONIG_REGSET_POSITION_LEAD,\\r\\n        ONIG_OPTION_NONE,\\r\\n        &_unused_match_pos\\r\\n    );\\r\\n    if (ret < 0) {\\r\\n        return err(ret);\\r\\n    } else {\\r\\n        printf(\\\"regset matched: %d\\\\n\\\", ret);\\r\\n        OnigRegion* region = onig_regset_get_region(rset, ret);\\r\\n        printf(\\\"groups: %d\\\\n\\\", region->num_regs);\\r\\n        for (int i = 0; i < region->num_regs; i += 1) {\\r\\n            printf(\\\"region: %d - %d\\\\n\\\", region->beg[i], region->end[i]);\\r\\n        }\\r\\n    }\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\nI expect this to print out:\\r\\n\\r\\n```console\\r\\n$ ./bin/ctx oniguruma/prefix ./a.out \\r\\nsingle regex matched: 5\\r\\nregset matched: 1\\r\\ngroups: 1\\r\\nregion: 5 - 5\\r\\n```\\r\\n\\r\\nbut for master (1c1d2f6870d7f0e97e4578e790523bcc188982f1) this prints:\\r\\n\\r\\n```console\\r\\n$ ./a.out\\r\\nsingle regex matched: 5\\r\\ninvalid argument\\r\\n```\\r\\n\\r\\nappears to be an off-by-one error [here](https://github.com/kkos/oniguruma/blob/1c1d2f6870d7f0e97e4578e790523bcc188982f1/src/regexec.c#L4557-L4559)\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_187", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"187\", \"title\": \"wide character api\", \"author\": \"asottile\", \"labels\": [\"enhancement\"], \"description\": \"I'm working on a wrapper in python for oniguruma and I've noticed that a lot of time is spent encoding/decoding strings to work with it.  in python, it is common to work with the `str` type in memory (can be thought of as a sequence of unicode code points)\\r\\n\\r\\nwith this, compiling / using a regex usually involves:\\r\\n\\r\\n1. str -> bytes (encode to utf8)\\r\\n2. oniguruma internals (likely *decodes* utf8 to code points)\\r\\n3. (looking at match results) bytes -> str (decode from utf8)\\r\\n\\r\\nit would be nice if a wide character api (sequence of codepoints, encoding-agnostic) was provided such that the encode/decode/decode overhead could be avoided\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It's hard to add such an interface, as I didn't consider it at all when I started this project.\\r\\nI hope there is someone who can do it.\\r\\nAt present, the definition of the OnigEncodingType structure is put in oniguruma.h, so it is necessary to implement the function without changing it.\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"If the code point is expressed in 4 byte size, couldn't UTF-32BE or UTF-32LE be used?\\r\\nThe return value is returned in byte position, so it needs to be converted to code point position.\"}, {\"author\": \"asottile\", \"body\": \"hmmm that is a very good point, I made some incorrect assumptions about `wchar_t`.  after looking it up it is much less convenient.  the first is that `wchar_t` appears to be platform-dependent (notably 16bit int on windows, 32 bit int most everywhere else) -- and the second is what you've pointed out (BE vs LE).\\r\\n\\r\\nthis probably makes such an api much less useful and significantly more complicated than I thought -- maybe makes this less worth it\\r\\n\\r\\nI guess a middle ground would be a more efficient way to expose the character offsets\"}, {\"author\": \"kkos\", \"body\": \"I don't know about Python internals, but I think from your comments:\\r\\n\\r\\n(1) The string is represented by array of wchar_t.\\r\\n(2) wchar_t is 2 or 4 bytes.\\r\\nAnd from (2), each character fits in wchar_t in 2 bytes like UTF-16LE / BE.\\r\\n\\r\\nIf so, adding such a new character encoding to Oniguruma will do the job.\"}, {\"author\": \"kkos\", \"body\": \"The following branch was created.\\r\\nhttps://github.com/kkos/oniguruma/tree/issue_187_python_wchar_t\\r\\n\\r\\nAdded two encodings:\\r\\nONIG_ENCODING_UTF16_BE_WCHAR and ONIG_ENCODING_UTF16_LE_WCHAR\\r\\n\\r\\nNo test code.\\r\\nI just leave it as sample code.\"}, {\"author\": \"asottile\", \"body\": \"cheers, I'll check it out when I get a chance!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_188", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"188\", \"title\": \"static linking on windows\", \"author\": \"asottile\", \"labels\": [], \"description\": \"it could be entirely possible I don't know what I'm doing but here's what I've tried so far:\\r\\n\\r\\n- locate and run `vcvars64.bat`\\r\\n- then run `make_win.bat`\\r\\n- then set up the environment to link against that\\r\\n\\r\\n```batch\\r\\nSET INCLUDE=C:\\\\Path\\\\to\\\\oniguruma\\\\src;%INCLUDE%\\r\\nSET LIB=C:\\\\path\\\\to\\\\oniguruma;%LIB%\\r\\nSET LIBPATH=C:\\\\path\\\\to\\\\oniguruma;%LIBPATH%\\r\\n```\\r\\n\\r\\n- then inside [`onigurumacffi`](https://github.com/asottile/onigurumacffi) (downstream project) apply this patch:\\r\\n\\r\\n```diff\\r\\n(venv) C:\\\\Users\\\\IEUser\\\\workspace\\\\onigurumacffi>git diff\\r\\ndiff --git a/onigurumacffi_build.py b/onigurumacffi_build.py\\r\\nindex e94e1b9..b912934 100644\\r\\n--- a/onigurumacffi_build.py\\r\\n+++ b/onigurumacffi_build.py\\r\\n@@ -132,7 +132,7 @@ int onigcffi_regset_search(\\r\\n\\r\\n ffibuilder = FFI()\\r\\n ffibuilder.cdef(CDEF)\\r\\n-ffibuilder.set_source('_onigurumacffi', SRC, libraries=['onig'])\\r\\n+ffibuilder.set_source('_onigurumacffi', SRC, libraries=['onig_s'])\\r\\n\\r\\n if __name__ == '__main__':\\r\\n     ffibuilder.compile(verbose=True)\\r\\n```\\r\\n\\r\\n- then run `python onigurumacffi_build.py`\\r\\n\\r\\nI get output that looks like:\\r\\n\\r\\n```\\r\\n...\\r\\nC:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.25.28610\\\\bin\\\\HostX86\\\\x64\\\\link.exe /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:C:\\\\Users\\\\IEUser\\\\workspace\\\\onigurumacffi\\\\venv\\\\libs \\\"/LIBPATH:C:\\\\Program Files\\\\WindowsApps\\\\PythonSoftwareFoundation.Python.3.7_3.7.1776.0_x64__qbz5n2kfra8p0\\\\libs\\\" /LIBPATH:C:\\\\Users\\\\IEUser\\\\AppData\\\\Local\\\\Microsoft\\\\WindowsApps\\\\PythonSoftwareFoundation.Python.3.7_qbz5n2kfra8p0 /LIBPATH:C:\\\\Users\\\\IEUser\\\\workspace\\\\onigurumacffi\\\\venv\\\\PCbuild\\\\amd64 \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.25.28610\\\\lib\\\\x64\\\" \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\lib\\\\10.0.18362.0\\\\ucrt\\\\x64\\\" \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\lib\\\\10.0.18362.0\\\\um\\\\x64\\\" /LIBPATH:C:\\\\Users\\\\IEUSER\\\\workspace\\\\oniguruma \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2019\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.25.28610\\\\lib\\\\x64\\\" \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\lib\\\\10.0.18362.0\\\\ucrt\\\\x64\\\" \\\"/LIBPATH:C:\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\lib\\\\10.0.18362.0\\\\um\\\\x64\\\" onig_s.lib /EXPORT:PyInit__onigurumacffi .\\\\Release\\\\_onigurumacffi.obj /OUT:.\\\\_onigurumacffi.cp37-win_amd64.pyd /IMPLIB:.\\\\Release\\\\_onigurumacffi.cp37-win_amd64.lib\\r\\n   Creating library .\\\\Release\\\\_onigurumacffi.cp37-win_amd64.lib and object .\\\\Release\\\\_onigurumacffi.cp37-win_amd64.exp\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_initialize\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_region_free\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_search\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_OnigEncodingUTF8\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_free\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_OnigSyntaxOniguruma\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_number_of_captures\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_regset_search\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_error_code_to_str\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_version\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_match\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_regset_free\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_region_new\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_regset_get_region\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_regset_new\\r\\n_onigurumacffi.obj : error LNK2001: unresolved external symbol __imp_onig_new\\r\\n.\\\\_onigurumacffi.cp37-win_amd64.pyd : fatal error LNK1120: 16 unresolved externals\\r\\n```\\r\\n\\r\\ndoing some googling, this appears related to [this issue](https://software.intel.com/en-us/forums/intel-c-compiler/topic/673427) around dllimport vs dllexport\\r\\n\\r\\nindeed I can \\\"fix\\\" this by adding `define_macros=[('ONIGURUMA_EXPORT', None)]` to my call -- however I don't see this documented anywhere and I found it by chance\\r\\n\\r\\n___\\r\\n\\r\\nnot sure if there's anything actionable here, hopefully this helps someone else in the future üëç thanks again!\", \"comments\": [{\"author\": \"k-takata\", \"body\": \"It is written in README.md.\\r\\n\\r\\nhttps://github.com/kkos/oniguruma#usage\\r\\n> If you want to use static link library(onig_s.lib) in Win32, add option -DONIG_EXTERN=extern to C compiler.\"}, {\"author\": \"asottile\", \"body\": \"oh of course! thanks ü§¶‚Äç‚ôÇ \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_189", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"189\", \"title\": \"encoding type\", \"author\": \"shenglei10\", \"labels\": [], \"description\": \"Hi,\\r\\n\\r\\noniguruma\\\\test\\\\testc.c and oniguruma\\\\windows\\\\testc.c are encoding type of ANSI and Shift-JIS.\\r\\nIs this the case you want?Or they can be converted to UTF-8.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The encoding of testc.c is EUC-JP.\\r\\nIt is inappropriate to convert testc.c to UTF-8 mechanically.\\r\\nThis is because EUC-JP and UTF-8 differ in the number of bytes of the same character.\\r\\n\\r\\nI created testp.c by separating only the ASCII character test part from testc.c using POSIX API.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_192", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"192\", \"title\": \"Unexpected regex match\", \"author\": \"alexdima\", \"labels\": [], \"description\": \"In the `sample/bug_fix.c` file, insert the following:\\r\\n\\r\\n```c\\r\\n  exec(ONIG_ENCODING_UTF8, ONIG_OPTION_FIND_LONGEST,\\r\\n       \\\"(?x)\\\\n  (?<!\\\\\\\\+\\\\\\\\+|--)(?<=[({\\\\\\\\[,?=>:*]|&&|\\\\\\\\|\\\\\\\\||\\\\\\\\?|\\\\\\\\*\\\\\\\\/|^await|[^\\\\\\\\._$[:alnum:]]await|^return|[^\\\\\\\\._$[:alnum:]]return|^default|[^\\\\\\\\._$[:alnum:]]default|^yield|[^\\\\\\\\._$[:alnum:]]yield|^)\\\\\\\\s*\\\\n  (?!<\\\\\\\\s*[_$[:alpha:]][_$[:alnum:]]*((\\\\\\\\s+extends\\\\\\\\s+[^=>])|,)) # look ahead is not type parameter of arrow\\\\n  (?=(<)\\\\\\\\s*(?:([_$[:alpha:]][-_$[:alnum:].]*)(?<!\\\\\\\\.|-)(:))?((?:[a-z][a-z0-9]*|([_$[:alpha:]][-_$[:alnum:].]*))(?<!\\\\\\\\.|-))(?=((<\\\\\\\\s*)|(\\\\\\\\s+))(?!\\\\\\\\?)|\\\\\\\\/?>))\\\", \\\"    while (i < len && f(array[i]))\\\");\\r\\n```\\r\\n\\r\\nI would expect to see in the output:\\r\\n\\r\\n```\\r\\nsearch fail (UTF-8)\\r\\n```\\r\\n\\r\\nBut instead there is printed:\\r\\n```\\r\\nmatch at 12  (UTF-8)\\r\\n0: (12-13)\\r\\n1: (-1--1)\\r\\n2: (-1--1)\\r\\n3: (13-14)\\r\\n4: (-1--1)\\r\\n5: (-1--1)\\r\\n6: (15-18)\\r\\n7: (-1--1)\\r\\n8: (18-19)\\r\\n9: (-1--1)\\r\\n10: (18-19)\\r\\n```\\r\\n\\r\\nI have done `git bisect` and it led towards 32e688b0c71bd3912867c5107a5efdbcdde3ff2c:\\r\\n```\\r\\n32e688b0c71bd3912867c5107a5efdbcdde3ff2c is the first bad commit\\r\\ncommit 32e688b0c71bd3912867c5107a5efdbcdde3ff2c\\r\\nAuthor: K.Kosako <kosako@sofnec.co.jp>\\r\\nDate:   Tue Jan 21 08:37:19 2020 +0900\\r\\n\\r\\n    optimize for min len == 0 and min len is sure case\\r\\n```\\r\\n\\r\\nI am sorry for the very complex regular expression and for not spending more time to simplify it, but I believe it has something to do with the look behind starting with `(?<=[({\\\\\\\\[ ... `. It is almost as if it is not checked. I have hit this regular expression in [VS Code's JavaScript TM grammar](https://github.com/microsoft/vscode/blob/70a890efb6601c04e5235b06e537bdf47d85281d/extensions/javascript/syntaxes/JavaScript.tmLanguage.json#L5507), while validating/updating VS Code's oniguruma version with a fresh WASM implementation [here](https://github.com/microsoft/vscode-oniguruma). \\r\\n\\r\\nThank you for your great work, and special thanks for the new RegSet API, which might save a lot of time in parsing TM grammars. \", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for your research.\\r\\nFixed.\\r\\nThis is a bug that if the look-behind contains a branch with a character length of 0 and an anchor is included in the branch, the whole look-behind is ignored.\\r\\n\\r\\nIt may be quite serious, so an urgent release may be needed.\\r\\nBut there may be some other problems, so wait a while.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_194", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"194\", \"title\": \"the release dir in the path to the asset should match the asset name also for revisions\", \"author\": \"msimion\", \"labels\": [], \"description\": \"The release dir name should match the asset name in the asset URL. It is the case with normal releases, but not for this particular case --> 6.9.5-rev1.\\r\\n\\r\\nCurrent form:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/releases/download/**v6.9.5_rev1**/onig-6.9.5-rev1.tar.gz\\r\\n\\r\\nExpected form:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/releases/download/**v6.9.5-rev1**/onig-6.9.5-rev1.tar.gz\\r\\n\\r\\nJustification:\\r\\n\\r\\nUsing a script that composes the URL to this lib starting from the version and then passes it to cURL. It works fine with a normal release like 6.9.5, but breaks for 6.9.5 rev 1.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I'm sorry to have inconvenienced you.\\r\\nIs it wrong to add a file with a file name that matches the current tag name?\\r\\n\\r\\n.../v6.9.5_rev1/onig-6.9.5_rev1.tar.gz\"}, {\"author\": \"msimion\", \"body\": \"no problem at all.\\n\\nthat will certainly do the trick for me :)\\n\\n\\nthank you\\n\\nOn Sat, May 30, 2020, 15:32 K.Kosako <notifications@github.com> wrote:\\n\\n> I'm sorry to have inconvenienced you.\\n> Is it wrong to add a file with a file name that matches the current tag\\n> name?\\n>\\n> .../v6.9.5_rev1/onig-6.9.5_rev1.tar.gz\\n>\\n> ‚Äî\\n> You are receiving this because you authored the thread.\\n> Reply to this email directly, view it on GitHub\\n> <https://github.com/kkos/oniguruma/issues/194#issuecomment-636331514>, or\\n> unsubscribe\\n> <https://github.com/notifications/unsubscribe-auth/AK3IZEL3BP3ZK4SR2AZPWJDRUEDGVANCNFSM4NOR6KRQ>\\n> .\\n>\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_195", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"195\", \"title\": \"Removal of the onigposix.h header in 6.9.5_rev1 breaks other packages\", \"author\": \"yurivict\", \"labels\": [], \"description\": \"Hello,\\r\\n\\r\\nThis change broke libevhtp and some other packages.\\r\\n\\r\\nIs this removal intended?\\r\\n\\r\\nThank you,\\r\\nYuri@FreeBSD.org\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It was intended.\\r\\nBut if you pass --enable-posix-api=yes as an argument to the configure script, I think it will be the same as before.\\r\\n\\r\\nOn some platforms, the POSIX API conflicts with the original one and terminates abnormally, so I couldn't think of any other way to remove it.\\r\\nIssue #165\"}, {\"author\": \"yurivict\", \"body\": \"Thank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_198", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"198\", \"title\": \"selectively disabling \\\\A and \\\\G\", \"author\": \"asottile\", \"labels\": [], \"description\": \"üëã thanks again for the library, really wonderful!\\r\\n\\r\\ntextmate grammars uses oniguruma for pattern matching in expanding text editor grammars, but they are done in a line-by-line fashion.\\r\\n\\r\\nas such, they impose some \\\"special\\\" interpretation of \\\\A and \\\\G, as far as I can tell this is how they are handled:\\r\\n\\r\\n- \\\\A is only honored on the first line when looking at position 0\\r\\n- \\\\G is only honored at the first position of a line *or* on a boundary condition (previous node was a start/end match, and a few other cases)\\r\\n\\r\\neither way, this requires some special disabling/enabling of these two regex flags\\r\\n\\r\\nthe way vs code currently implements this is to replace \\\\A and \\\\G with \\\\uffff however this is error prone for several reasons:\\r\\n\\r\\n- it doesn't properly handle special cases such as `[\\\\ABC]`\\r\\n- it doesn't properly handle negation such as `(?!\\\\G)`\\r\\n\\r\\nwould it be possible to add flags (similar to the _BOL and _EOL flags) which toggle the behaviours of \\\\A and \\\\G? and/or is there a better way to handle the special constraints of textmate grammars here.  (the issue I'm dealing with actually comes from https://github.com/asottile/babi/issues/73)\", \"comments\": [{\"author\": \"kkos\", \"body\": \"In short, do you mean that you want the following?\\r\\n(1) The specifications for \\\\A and \\\\G remain the same as they are now.\\r\\n(2) \\\\A and \\\\G always fail when a new option is specified.\\r\\n\\r\\nIf so, should that option be separate for \\\\A and \\\\G?  Then,\\r\\n```\\r\\nONIG_OPTION_NOT_BEGIN_STRING\\r\\nONIG_OPTION_NOT_BEGIN_POSITION\\r\\n```\\r\\n\"}, {\"author\": \"asottile\", \"body\": \"yes that would be perfect!\"}, {\"author\": \"asottile\", \"body\": \"awesome!  thank you for working on this!  I started playing with the implementation on master, and for the most part it seems to work how I would expect: https://github.com/asottile/onigurumacffi/pull/23\\r\\n\\r\\none issue I ran into is I think this shouldn't match, but seems to currently:\\r\\n\\r\\n```\\r\\n# pattern\\r\\n(?!\\\\G)\\r\\n# flags\\r\\nONIG_OPTION_NOT_BEGIN_POSITION\\r\\n# string (doesn't matter)\\r\\nfoo\\r\\n# method\\r\\nmatch\\r\\n```\\r\\n\\r\\nfor example using my python code:\\r\\n\\r\\n```pycon\\r\\n>>> import onigurumacffi\\r\\n>>> reg = onigurumacffi.compile(r'(?!\\\\G)')\\r\\n>>> reg.match('foo', flags=onigurumacffi.OnigSearchOption.NOT_BEGIN_POSITION)\\r\\n<onigurumacffi._Match span=(0, 0) match=''>\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"For me, I have no problem with that outcome.\\r\\n(?!\\\\G) always succeeds because \\\\G always fails.\\r\\n\\r\\nPerhaps you and I have a different meaning of \\\"FAIL\\\".\\r\\nTo me, it's just that \\\\G fails, but to you, it probably means that the whole matching of that regular expression fails.\\r\\nI'm not at all keen on introducing such a specification to \\\\G.\\r\\nThe reason for this is\\r\\n(1) Such behavior is strange for a regular expression operator.\\r\\n(2) While such an interpretation of \\\\G may be useful for certain applications, it has not been shown to be useful in general.\"}, {\"author\": \"asottile\", \"body\": \"hmm ok I can accept that, though it seems to work for other anchors:\\r\\n\\r\\n```\\r\\n>>> reg = onigurumacffi.compile('(?!^)')\\r\\n>>> reg.match('foo')\\r\\n>>> \\r\\n```\\r\\n\\r\\nfwiw, here's the real world example for that: https://github.com/textmate/html.tmbundle/blob/0c3d5ee54de3a993f747f54186b73a4d2d3c44a2/Syntaxes/HTML.plist#L138\"}, {\"author\": \"asottile\", \"body\": \"oh actually I'm just confused!  this works exactly how I want -- sorry for the runaround!\\r\\n\\r\\n```pycon\\r\\n>>> import onigurumacffi\\r\\n>>> reg = onigurumacffi.compile(r'(?!\\\\G)')\\r\\n>>> reg.match('foo')\\r\\n>>> reg.match('foo',  flags=onigurumacffi.OnigSearchOption.NOT_BEGIN_POSITION)\\r\\n<onigurumacffi._Match span=(0, 0) match=''>\\r\\n```\"}, {\"author\": \"asottile\", \"body\": \"thanks for this feature by the way, super awesome!\"}, {\"author\": \"asottile\", \"body\": \"ü§¶ I forgot about `\\\\z` (it seems it is already toggled by `NOTEOL` -- but that also toggles `$` and `\\\\Z` which is undesirable)\"}, {\"author\": \"asottile\", \"body\": \"awesome -- just tried this out -- it works great!  thanks again for the responsiveness and this awesome library\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_199", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"199\", \"title\": \"6.9.5 release is not available for Centos\", \"author\": \"RobCannon\", \"labels\": [], \"description\": \"There is a vulnerability that has been identified by Nexus in the 6.8.2 version of onigurumu that is blocking us being able to install docker-ce.  The centos7-epel repo does not have a new version of oniguruma.  How can the 6.9.5 version of oniguruma be delivered to the centos7-epel repo?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"No one here seems to know anything about it.\\r\\nI'm sorry, but you can ask your question elsewhere.\\r\\nI have not reported any more security-related issues in version 6.9.5. There is nothing I can do.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_200", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"200\", \"title\": \"Please consider change tagging/versioning convention\", \"author\": \"kloczek\", \"labels\": [], \"description\": \"Issue is that none of the packaging software allows use underscores in version string..\\r\\nOn next release please use version string consisting only from digits and dots.\", \"comments\": [{\"author\": \"kloczek\", \"body\": \"BTW leading \\\"v\\\" in version string is acceptable as github automatically strips that on autogenerate tar ball from git tags..\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nThen I will do the following.\\r\\n\\r\\nv6.9.6\\r\\nv6.9.6.1\\r\\n\"}, {\"author\": \"kloczek\", \"body\": \"Thank you very much :)\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_202", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"202\", \"title\": \"What is the impact of upgrading from version 5 to 6 on the regular expressions in PHP?\", \"author\": \"jpelletier-sv\", \"labels\": [], \"description\": \"\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't know how much of an impact it will have, but I haven't received many complaints about the change in specifications.\\r\\nThere are changes in the specifications for two reasons.\\r\\n\\r\\n(1) Specification changed because the original specs was not appropriate.\\r\\n(2) In the process of fixing problems, the specs were changed without realizing it.\\r\\n\\r\\nI am not aware of (2).\\r\\nFor (1), there are more things I've forgotten, but here's what I remember.\\r\\n\\r\\n* When the character encoding is Unicode, an error occurs if the code point value is greater than 1FFFFF. (from 6.9.2)\\r\\nHowever, only the upper limit of the code point range of character classes is not made an error.\\r\\n\\r\\n```\\r\\n/\\\\x{200000}/  => error\\r\\n/[\\\\x{7f}-\\\\x{7fffffff}]/  => no error\\r\\n```\\r\\n\\r\\n* The meaning of ONIG_OPTION_NOTBOL/NOTEOL has been corrected. (master branch)\\r\\n  (I don't know if these options are available in PHP though.)\\r\\n\"}, {\"author\": \"bdb\", \"body\": \"So what exactly is the change? Just wondering as moving from 6.9.5 to .6 broke our NOT_BOL tests. Thanks.\"}, {\"author\": \"kkos\", \"body\": \"I don't know about your NOT_BOL test, but what has changed about the NOTBOL option is the following\\r\\n\\r\\nWhen ONIG_OPTION_NOTBOL is specified, the beginning of the target string no longer matches the \\\\A.\\r\\n(And ^ in single line mode becomes equal to \\\\A)\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_203", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"203\", \"title\": \"autoreconf error\", \"author\": \"rehack\", \"labels\": [], \"description\": \"The error msg:\\r\\n<pre>\\r\\n‚ûú  oniguruma-6.9.5_rev1 ./autogen.sh                   \\r\\nGenerating autotools files.\\r\\nsrc/Makefile.am:19: error: Libtool library used but 'LIBTOOL' is undefined\\r\\nsrc/Makefile.am:19:   The usual way to define 'LIBTOOL' is to add 'LT_INIT'\\r\\nsrc/Makefile.am:19:   to 'configure.ac' and run 'aclocal' and 'autoconf' again.\\r\\nsrc/Makefile.am:19:   If 'LT_INIT' is in 'configure.ac', make sure\\r\\nsrc/Makefile.am:19:   its definition is in aclocal's search path.\\r\\nautoreconf: automake failed with exit status: 1\\r\\n‚ûú  oniguruma-6.9.5_rev1 which libtool\\r\\n/usr/bin/libtool\\r\\n‚ûú  oniguruma-6.9.5_rev1 libtool -V\\r\\nApple Inc. version cctools-921\\r\\n‚ûú  oniguruma-6.9.5_rev1 \\r\\n</pre>\\r\\n\\r\\nthe error is 'LIBTOOL' is undefined\\r\\nbut libtool exist in reality.\\r\\n![QQ20200818-174712](https://user-images.githubusercontent.com/9047357/90498428-e2780e80-e17a-11ea-9c45-4ad344940b66.png)\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Do you have glibtoolize and glibtool installed on your Mac OSX?\\r\\n\\r\\nIn my environment, I'm installing autoconf and libtool with Homebrew.\\r\\n```\\r\\n[bin]$ pwd\\r\\n/usr/local/bin\\r\\n[bin]$ ll glibtool* autoreconf\\r\\nlrwxr-xr-x  1 kosako  staff  38  3 26  2016 autoreconf -> ../Cellar/autoconf/2.69/bin/autoreconf\\r\\nlrwxr-xr-x  1 kosako  staff  36  3 26  2016 glibtool -> ../Cellar/libtool/2.4.6/bin/glibtool\\r\\nlrwxr-xr-x  1 kosako  staff  39  3 26  2016 glibtoolize -> ../Cellar/libtool/2.4.6/bin/glibtoolize\\r\\n```\\r\\nWhen I tried to run autogen.sh after temporarily renaming the glibtoolize file, I got an error.\\r\\nHowever, the error message was completely different from yours, so it may not matter.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_204", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"204\", \"title\": \"6.9.5 can't compile with Visual Studio 2005\", \"author\": \"nmaya\", \"labels\": [], \"description\": \"The type of `Bits' was changed to uint32_t in https://github.com/kkos/oniguruma/commit/e75db3c9b4b4f52a769c4ab494a25e3ce069944e.\\r\\nVisual Studio 2005 doesn't have uint32_t(stdint.h) and build failed.\\r\\n\\r\\nWhen I changed \\\"typedef uint32_t  Bits;\\\" to \\\"typedef unsigned int Bits;\\\", build completed successfully. I guess only this one line is the cause of build error.\\r\\nCould you please consider to change uint32_t to other type that is not cause the error in old compiler?\\r\\n\\r\\nThank you.\", \"comments\": [{\"author\": \"nmaya\", \"body\": \"I confirmed that https://github.com/kkos/oniguruma/commit/d432bc049f5519c4d8f46f54497ef202ccc7406b fixes this error.\\r\\n\\r\\nThank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_205", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"205\", \"title\": \"LTVERSION is not being updated in accordance with libtool guidelines\", \"author\": \"nickgaya\", \"labels\": [], \"description\": \"Per the libtool manual, `LTVERSION` should be updated for each release, depending on the nature of the change:\\r\\n\\r\\n* If there are no interface changes, update `LTVERSION` from `c:r:a` to `c:r+1:a`.\\r\\n* If there are backward-compatible interface changes, update `LTVERSION` from `c:r:a` to `c+1:0:a+1`.\\r\\n* If there are backward-incompatible changes, update `LTVERSION` from `c:r:a` to `c+1:0:0`.\\r\\n\\r\\nThis project does not fully adhere to these rules. For example, in version 6.8.2 a new function was added to the public API, so the libtool version should have been updated from 5:0:0 to 6:0:1.\\r\\n\\r\\nPlease consider adhering to this convention in future releases, as it will help with version management in projects that depend on this library.\\r\\n\\r\\nReferences:\\r\\n* https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html\\r\\n* https://autotools.io/libtool/version.html\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the suggestion.\\r\\nIf I add a function, it looks like I'll have to increment the CURRENT.\\r\\nI can't release it often enough, as changing CURRENT might mean more work for package administrators.\\r\\nI can't do anything about it, so I'll hold off on the next release for a year or so.\"}, {\"author\": \"nickgaya\", \"body\": \"> If I add a function, it looks like I'll have to increment the CURRENT.\\r\\n\\r\\nAdding a new function does not break ABI compatibility, so you would increment both *current* and *age* and set *revision* to 0.\\r\\n\\r\\n> I can't release it often enough, as changing CURRENT might mean more work for package administrators.\\r\\n\\r\\nThis is not correct.  In fact, it's the opposite.  By following the guidelines described in the libtool manual, you will ensure that linking works correctly for projects that dynamically link to this library.\\r\\n\\r\\nFor example, if you add a new public function to the API and increment the libtool version from 5:0:0 to 6:0:1, this indicates that the new version of the library supports interface versions 5‚Äì6.  This means that binaries linked against the old version of the library can continue to work with the new version.  See https://www.gnu.org/software/libtool/manual/html_node/Libtool-versioning.html for a more detailed explanation.\\r\\n\\r\\n> I can't do anything about it, so I'll hold off on the next release for a year or so.\\r\\n\\r\\nYou should update the libtool version (according to the guidelines) each time you release the library.  This should not impact your release schedule.\"}, {\"author\": \"kkos\", \"body\": \"Thank you for that.\\r\\nI forgot the rules a few years ago and was wrong all along.\\r\\nSince this change only adds functions and options, I'll go with 6.0.1.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_206", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"206\", \"title\": \"Suggestion: continuous formal verification of your test suite\", \"author\": \"jakub-zwolakowski\", \"labels\": [], \"description\": \"Hi, I'm Jakub from TrustInSoft, an advanced source code analyzer publisher for C and C++. I've [set up TrustInSoft CI](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/2) on your test suite located in the `/tests` folder.\\r\\n\\r\\nTrustInSoft CI has found several Undefined Behaviors on the tested execution paths. For each test, TrustInSoft CI stops the analysis on the first UB, so I went step-by-step: provided a fix for the first UB, reviewed the updated analysis results, provided a fix for the next UB, etc. This is¬†the typical workflow, we can iterate like this until all tests are green, but I've stopped at the twelfth encountered UB.\\r\\n\\r\\nYou can see all the steps¬†here:¬†[https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma)\\r\\n\\r\\nBelow is a summary of suggested fixes (or workarounds, when I was not sure how to fix the UB properly) for the first 11 UBs.\\r\\n\\r\\n1. Can you let me know if you find those results interesting?\\r\\n2. As side note, we are¬†currently testing this new tool with the open-source community, so any feedback from¬†oniguruma¬†team will be much appreciated!\\r\\n\\r\\n| UB  | Summary | Fix / Workaround |\\r\\n| --- | --- | --- |\\r\\n| [UB#1](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/2?page=1&test=4) | **Invalid pointer arithmetic**¬†[in file 'src/regexec.c' line 4868](https://github.com/jakub-zwolakowski/oniguruma/blob/f4df6829835ae7ef9980d1b6911ff011f3abb4f0/src/regexec.c#L4868). | [https://github.com/jakub-zwolakowski/oniguruma/commit/ad7001c86578ee30c56869f4759d39bbcd2d1bd9](https://github.com/jakub-zwolakowski/oniguruma/commit/ad7001c86578ee30c56869f4759d39bbcd2d1bd9) |\\r\\n| [UB#2](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/3?page=1&test=4,6) | **Dangling pointer**¬†[in file 'src/regparse.c' line 449](https://github.com/jakub-zwolakowski/oniguruma/blob/ad7001c86578ee30c56869f4759d39bbcd2d1bd9/src/regparse.c#L449). | [https://github.com/jakub-zwolakowski/oniguruma/commit/8ecfc02a1baaf2efc618cb533aa22e533726d136](https://github.com/jakub-zwolakowski/oniguruma/commit/8ecfc02a1baaf2efc618cb533aa22e533726d136) |\\r\\n| [UB#3](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/4?page=1&test=1,5,3,2) | **Invalid pointer arithmetic**¬†[in file 'src/regexec.c' line 4907](https://github.com/jakub-zwolakowski/oniguruma/blob/8ecfc02a1baaf2efc618cb533aa22e533726d136/src/regexec.c#L4907). | [https://github.com/jakub-zwolakowski/oniguruma/commit/ae2743b82acf1578284fdaf84353cca1b6e68023](https://github.com/jakub-zwolakowski/oniguruma/commit/ae2743b82acf1578284fdaf84353cca1b6e68023) |\\r\\n| [UB#4](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/5?page=1&test=1,5,3,2) | **Invalid pointer arithmetic**¬†[in file 'src/regexec.c' line 4914](https://github.com/jakub-zwolakowski/oniguruma/blob/ae2743b82acf1578284fdaf84353cca1b6e68023/src/regexec.c#L4914). | [https://github.com/jakub-zwolakowski/oniguruma/commit/4336a573571dd2672df6d3dd396dbf0ba7f544dd](https://github.com/jakub-zwolakowski/oniguruma/commit/4336a573571dd2672df6d3dd396dbf0ba7f544dd) |\\r\\n| [UB#5](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/6?page=1&test=1,4,5,3,6) | **Invalid pointer arithmetic**¬†[in file 'src/regexec.c' lines 3049](https://github.com/jakub-zwolakowski/oniguruma/blob/4336a573571dd2672df6d3dd396dbf0ba7f544dd/src/regexec.c#L3049), [3060](https://github.com/jakub-zwolakowski/oniguruma/blob/4336a573571dd2672df6d3dd396dbf0ba7f544dd/src/regexec.c#L3060), [3141](https://github.com/jakub-zwolakowski/oniguruma/blob/4336a573571dd2672df6d3dd396dbf0ba7f544dd/src/regexec.c#L3141), [3106](https://github.com/jakub-zwolakowski/oniguruma/blob/4336a573571dd2672df6d3dd396dbf0ba7f544dd/src/regexec.c#L3106). | [https://github.com/jakub-zwolakowski/oniguruma/commit/df87212aaa3cf07dd9dd6e33ee010691bb2c48c4](https://github.com/jakub-zwolakowski/oniguruma/commit/df87212aaa3cf07dd9dd6e33ee010691bb2c48c4) |\\r\\n| [UB#6](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/7?page=1&test=2) | **Invalid pointer arithmetic**¬†[in file 'src/regexec.c' line 4931](https://github.com/jakub-zwolakowski/oniguruma/blob/df87212aaa3cf07dd9dd6e33ee010691bb2c48c4/src/regexec.c#L4931). | [https://github.com/jakub-zwolakowski/oniguruma/commit/5a75113c5caa196fa15bde2cd06196387d742a9e](https://github.com/jakub-zwolakowski/oniguruma/commit/5a75113c5caa196fa15bde2cd06196387d742a9e) |\\r\\n| [UB#7](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/8?page=1&test=6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 5595](https://github.com/jakub-zwolakowski/oniguruma/blob/5a75113c5caa196fa15bde2cd06196387d742a9e/src/regexec.c#L5595). | [https://github.com/jakub-zwolakowski/oniguruma/commit/6d8fd67244ac42b0257696c27835e70f97021907](https://github.com/jakub-zwolakowski/oniguruma/commit/6d8fd67244ac42b0257696c27835e70f97021907) |\\r\\n| [UB#8](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/9?page=1&test=6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 4959](https://github.com/jakub-zwolakowski/oniguruma/blob/6d8fd67244ac42b0257696c27835e70f97021907/src/regexec.c#L4959). | [https://github.com/jakub-zwolakowski/oniguruma/commit/8ae2708ba0eff8f6d6623f02deb8b8e21403e14b](https://github.com/jakub-zwolakowski/oniguruma/commit/8ae2708ba0eff8f6d6623f02deb8b8e21403e14b) |\\r\\n| [UB#9](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/10?page=1&test=6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 5576](https://github.com/jakub-zwolakowski/oniguruma/blob/8ae2708ba0eff8f6d6623f02deb8b8e21403e14b/src/regexec.c#L5576). | [https://github.com/jakub-zwolakowski/oniguruma/commit/38847696065a7ed4eea4c7135eed3d2536a055d2](https://github.com/jakub-zwolakowski/oniguruma/commit/38847696065a7ed4eea4c7135eed3d2536a055d2) |\\r\\n| [UB#10](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/11?page=1&test=6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 5581](https://github.com/jakub-zwolakowski/oniguruma/blob/38847696065a7ed4eea4c7135eed3d2536a055d2/src/regexec.c#L5581). | [https://github.com/jakub-zwolakowski/oniguruma/commit/b4564204922e58cdbf725b89cdab9526a5cc1f08](https://github.com/jakub-zwolakowski/oniguruma/commit/b4564204922e58cdbf725b89cdab9526a5cc1f08) |\\r\\n| [UB#11](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/12?page=1&test=6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 4834](https://github.com/jakub-zwolakowski/oniguruma/blob/b4564204922e58cdbf725b89cdab9526a5cc1f08/src/regexec.c#L4834). | [https://github.com/jakub-zwolakowski/oniguruma/commit/e3b4de89df095734464dcb586a11947be9b6cab4](https://github.com/jakub-zwolakowski/oniguruma/commit/e3b4de89df095734464dcb586a11947be9b6cab4) |\\r\\n| [UB#12](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/13?page=1&test=1,4,5,3,6) | **Invalid pointer comparison**¬†[in file 'src/regexec.c' line 3684](https://github.com/jakub-zwolakowski/oniguruma/blob/e3b4de89df095734464dcb586a11947be9b6cab4/src/regexec.c#L3684). | NO FIX YET |\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for the validation.\\r\\n\\r\\nUB#1 - UB#5:\\r\\nApply these.\\r\\n\\r\\nUB#6:\\r\\nI don't want to add this check in the loop.\\r\\nIn the case of Sunday quick search, the value of reg->map[x] should be less than or equal to 32, so a change could be \\r\\nmade to check elsewhere that text_end + 32 does not overflow.\\r\\n\\r\\nUB#7 - UB#11:\\r\\nWhile it is a special case that s is a null value, I don't think it is necessary to do a separate address comparison check.\\r\\n(If I know that what I'm comparing is not null)\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_207", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"207\", \"title\": \"Issues found with Coverity\", \"author\": \"dodys\", \"labels\": [], \"description\": \"Hi,\\r\\n\\r\\nAs part of a [Main Inclusion Request](https://wiki.ubuntu.com/MainInclusionProcess) to support libonig in Ubuntu, we ran coverity on top of version 6.9.5 and it reported a total of 27 [errors](https://pastebin.ubuntu.com/p/k98gWQC6Xt/).\\r\\n\\r\\nCould you please take a look at them and let us know in case of any false positives.\\r\\n\\r\\nThanks,\\r\\nEduardo\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you for your report.\\r\\n                                         \\r\\n* src/regcomp.c:5267  Type: Branch past initialization (PW.BRANCH_PAST_INITIALIZATION)\\r\\n  I don't think this will cause any problems.\\r\\n\\r\\n* src/regexec.c:4414  Type: Uninitialized pointer read (UNINIT)\\r\\n* src/regexec.c:4461  Type: Uninitialized pointer read (UNINIT)\\r\\n  I don't think these things actually happen.\\r\\n  Condition (sr[i].state == SRS_DEAD) blocks execution.\\r\\n\\r\\n* src/regparse.c:7951  Type: Failure to restore non-local value (MISSING_RESTORE)\\r\\n* src/regparse.c:8343  Type: Failure to restore non-local value (MISSING_RESTORE)\\r\\n  It's true that I haven't put the value back in, but I don't think this will cause any problems, as it will eventually result in an error.\\r\\n\\r\\n* src/unicode_unfold_key.c:3304  Type: Out-of-bounds access (ARRAY_VS_SINGLETON)\\r\\n  I don't know what kind of problems this will cause.\\r\\n\\r\\n* test/test_regset.c:138  Type: Calling risky function (DC.WEAK_CRYPTO)\\r\\n  I'm not going to fix this.\\r\\n\"}, {\"author\": \"dodys\", \"body\": \"Thanks for your quick reply and analysis!\"}, {\"author\": \"setharnold\", \"body\": \"Thanks so much for the quick analysis.\\r\\n\\r\\nThe ARRAY_VS_SINGLETON issue that Coverity found is a false positive in this case. (It's a useful enough check, I've seen other programs do something similar, but fail to do the arithmetic to bound the access as has been done here, so I was pleased to see Coverity check for it.)\\r\\n\\r\\nThanks for checking the other issues, some felt plausible and were difficult to tell without indepth knowledge.\"}, {\"author\": \"kkos\", \"body\": \"I think I've fixed everything except what I said in my previous comment that there was no problem.\"}, {\"author\": \"setharnold\", \"body\": \"Excellent, thanks; does https://github.com/kkos/oniguruma/commit/cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0 represent a security issue or just a bug?\\r\\n\\r\\nThanks\"}, {\"author\": \"kkos\", \"body\": \"I don't know what to answer, but I wasn't doing anything wrong, just exceeding the buffer size, so it's probably a security issue.\"}, {\"author\": \"setharnold\", \"body\": \"I've asked MITRE to assign a CVE number for this issue; I've tried to summarize it as best I could, I'll write back if they assign one. Thanks!\"}, {\"author\": \"setharnold\", \"body\": \"Use CVE-2020-26159 for the buffer overwrite in https://github.com/kkos/oniguruma/commit/cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0 .\\r\\n\\r\\nThanks again, kkos.\"}, {\"author\": \"kkos\", \"body\": \"Thank you for letting me know.\"}, {\"author\": \"bukatlib\", \"body\": \"The following part of code in concat_opt_exact function seems to be affected by one-byte buffer overflow.\\r\\n\\r\\n`6232   for (i = to->len; p < end; ) {`\\r\\n`6233     len = enclen(enc, p);`\\r\\n`6234     if (i + len > OPT_EXACT_MAXLEN) {`\\r\\n`6235       r = 1; /* 1:full */`\\r\\n`6236       break;`\\r\\n`6237     }`\\r\\n`6238     for (j = 0; j < len && p < end; j++)`\\r\\n`6239       to->s[i++] = *p++;`\\r\\n`6240   }`\\r\\n\\r\\nCould someone look at it? Thanks.\"}, {\"author\": \"bukatlib\", \"body\": \"Thank you for the fix.\"}, {\"author\": \"carnil\", \"body\": \"> Use CVE-2020-26159 for the buffer overwrite in [cbe9f8b](https://github.com/kkos/oniguruma/commit/cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0) .\\r\\n> \\r\\n> Thanks again, kkos.\\r\\n\\r\\nNote the CVE has been rejected in meanwhile.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_208", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"208\", \"title\": \"Invalid pointer arithmetic / comparison\", \"author\": \"jakub-zwolakowski\", \"labels\": [], \"description\": \"I'm opening a new issue as a follow-up to [#206](https://github.com/kkos/oniguruma/issues/206) to bring more details to the¬†UBs 6 to¬†11. I hope it will help.\\r\\n\\r\\n#### [UB#6](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/7?page=1&test=2)\\r\\n\\r\\nYou are right: adding this additional check in the loop seems indeed suboptimal.¬†Sorry, I did not manage to come up with a smarter fix idea though...\\r\\n\\r\\nHowever, the problem is not with the `text_end`¬†variable. It's the `s`¬†variable that points out of bounds after the `s += reg->map[*(s + map_offset)];`¬†statement. Which is an UB.\\r\\n\\r\\n1.  In the last call to¬†`sunday_quick_search`, the formal argument¬†`text` points to the constant string equal `\\\" XXXX AAA 1223 012345678bbb\\\"`¬†(it's the fourth sub-case from `test_regset.c`). Its last index is 26.\\r\\n2.  The variable¬†`s` is initially pointing to the sixth element of this string (i.e.¬†`\\\" XXXX AAA 1223 012345678bbb\\\" + 5`), and then with each iteration of the loop it points further forward (+11, +17, +23).\\r\\n3.  In the last iteration, `s` points to the 24th element of the constant string and¬†`reg->map[*(s + map_offset)]` is equal 6. So after performing the compound assignment (`s += reg->map[*(s + map_offset)];`), variable `s`¬†points out of bounds: the new index would be `29`, which is beyond the last permitted value (as the last permitted value is one past the end of the constant string, so `27`). Hence the UB.\\r\\n\\r\\nHere's a screenshot of the Analyzer view of TrustInSoft CI, that shows the values of `reg->map[*(s + map_offset)]` and¬†`s` at each iteration of the loop:\\r\\n\\r\\n![IMG1 oniguruma UB#6 s going out of bounds marked](https://user-images.githubusercontent.com/1905935/93885169-2616e880-fce4-11ea-9ce3-2a9b38ccfe2b.png)\\r\\n\\r\\nThe Analyzer lets you see how the values of all the variables change during the program's execution.\\r\\nHere are all the steps (sorry that it is fast as I had to stick the animation to within 30s):\\r\\n\\r\\n![Oniguruma-UB6](https://user-images.githubusercontent.com/1905935/93885202-2fa05080-fce4-11ea-9075-499b083c00eb.gif)\\r\\n\\r\\n#### [UB#7](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/8?page=1&test=6)¬†- UB#11\\r\\n\\r\\nHere I must disagree with your assessment:\\r\\n\\r\\n1 ) In all these UBs,¬†`s` can be `NULL`¬†and TrustInSoft CI shows it.\\r\\n\\r\\nIn the Analyzer screenshot below, I picked **[UB#7](https://ci.trust-in-soft.com/projects/jakub-zwolakowski/oniguruma/8?page=1&test=6)**¬†and chose to view for each callstack the values of¬†`s`:\\r\\n\\r\\n1.  `s` takes its value from `prev`;\\r\\n2.  `prev` is set by the call to¬†`onigenc_get_prev_char_head`;\\r\\n3.  in the last callstack there are two execution paths, in the second path¬†`onigenc_get_prev_char_head` returns¬†`NULL`.\\r\\n\\r\\n![IMG2 image2020-9-18_10-36-7](https://user-images.githubusercontent.com/1905935/93885232-38912200-fce4-11ea-986a-5e35db4c38be.png)\\r\\n\\r\\n2 ) ANSI C does not permit a pointer comparison with¬†`NULL`¬†using the¬†`>=`¬†relational¬†operator ([6.5.8p5](https://port70.net/~nsz/c/c11/n1570.html#6.5.8p5)), so this is Undefined Behavior. In order to prevent it, one could add an extra check on¬†`s` before the comparison.\\r\\n\\r\\n#### Another thing\\r\\n\\r\\nAs TrustInSoft CI is already setup on my fork, it would be straightforward to port the installation to your upstream project, so the issues can be detected and fixed before they slip into production.\\r\\n\\r\\nThe tool relies on formal verification, so it detects all the undefined behaviors that most other tools such as sanitizers find, plus more subtle undefined behaviors that can be explained with the Analyzer view.\\r\\n\\r\\nThe only things that need to be added are these 3 files:\\r\\n\\r\\n*   [tis.config](https://github.com/jakub-zwolakowski/oniguruma/blob/fa1f93b2936e27e4b2cce0025dc4f99dfa8f765e/tis.config)¬†that describes the execution paths to analyze (your tests)\\r\\n*   [tis-ci/stub.c](https://github.com/jakub-zwolakowski/oniguruma/blob/fa1f93b2936e27e4b2cce0025dc4f99dfa8f765e/tis-ci/stub.c)\\r\\n*   [tis-ci/config.h](https://github.com/jakub-zwolakowski/oniguruma/blob/fa1f93b2936e27e4b2cce0025dc4f99dfa8f765e/tis-ci/config.h)\\r\\n\\r\\nCan you let me know if you would be interested? I can make a PR with these for you if you wish me to.\\r\\n\\r\\nThanks!\", \"comments\": [{\"author\": \"rofl0r\", \"body\": \"> 1 ) In all these UBs, s can be NULL and TrustInSoft CI shows it.\\r\\n> 2 ) ANSI C does not permit a pointer comparison with NULL using the >= relational operator (6.5.8p5), so this is Undefined Behavior. In order to prevent it, one could add an extra check on s before the comparison.\\r\\n\\r\\nwouldn't it be preferable to check on function entry/allocation site whether the pointer is NULL and refuse further execution? rather than making all pointer comparisons slower.\\r\\n\\r\\nalso if the pointers are supplied by the API caller, it would be sufficient to document that the pointer passed shall not be NULL, so it's actually the caller that invokes the UB when he does it anyway, and oniguruma can happily use fast comparisons.\"}, {\"author\": \"kkos\", \"body\": \"UB#6\\r\\nI didn't know that the pointer's address value would be a problem just because it was out of range of the object.\\r\\nI have found a fix that I am reasonably happy with.\\r\\n\\r\\nUB#7 - UB#11\\r\\nI didn't mean to write that s is not null, I meant to say that the object to be compared to s is not null.\\r\\nI didn't know that shouldn't compare them including in the case of NULL.\\r\\nFixed.\\r\\n\\r\\nI'm  interested in TrustInSoft CI.\\r\\nCould you send me the PR?\\r\\n\\r\\n@rofl0r \\r\\nThe return value of onigenc_get_prev_char_head() may be null, so checking outside the loop won't deal with it.\"}, {\"author\": \"kkos\", \"body\": \"I applied the Issue #206 UB#3 you showed, but the Undefined behavior did not go away. I also tried changing StackIndex type to ptrdiff_t and ssize_t and it didn't change.\\r\\nI have no idea how to get rid of Undefined behavior, and I don't know what the problem is in the first place.\\r\\n(Since both the left and right sides of the comparison formula are of StackIndex type.)\\r\\nI don't consider the TrustInSoft CI results, at least for this release, because I want to get a release candidate out soon.\\r\\n\\r\\nTwo additional points are noted below.\\r\\n(1) StackIndex is not a pointer, but an index value on the stack.\\r\\n(2) I've changed mem_start_stk[] and mem_end_stk[] to the union type, but that's because I'm setting a StackIndex value and a string pointer in some cases. I just rewrote it properly and it has nothing to do with the problem of Undefined behavior.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_209", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"209\", \"title\": \"OSS Fuzz fuzzing speed (execution per second, iterations/functions per second)\", \"author\": \"ghost\", \"labels\": [], \"description\": \"Hi\\r\\n\\r\\nWas playing with a snapshot supporting some coverage guided Ptrace fuzzer:\\r\\n\\r\\nhttps://github.com/marcinguy/fuzzer\\r\\n\\r\\nI tried to fuzz your library with it. Seems to work ok. Could still need some improvement.\\r\\n\\r\\nQuestion:\\r\\nWas wondering what execution speed do you get at OSS FUZZ projects? How many functions or exec per second do you achieve?\\r\\n\\r\\nSeems with my approach on Intel i5 I can do 15k exec per second per core.\\r\\n\\r\\nThanks,\\r\\n\\r\\n\\r\\n\", \"comments\": [{\"author\": \"ghost\", \"body\": \"@kkos Can you share the fuzzing stats? I would like to try new fuzzers and approaches, but would like to see the stats to see if there is any room for improvements and if yes, what were they. Thanks, \"}, {\"author\": \"kkos\", \"body\": \"The only information I can see is what the bug is and how long it takes to process before it is found.\\r\\nSorry about that.\\r\\n\"}, {\"author\": \"ghost\", \"body\": \"@kkos Thanks. Got also reply from OSS Fuzz:\\r\\n\\r\\nSeems like average across all fuzzers is 3k exec/s\\r\\n\\r\\nhttps://twitter.com/metzmanj/status/1310316154611732492?s=19\\r\\n\\r\\nYou can beat OSS Fuzz with fuzzing on more cores. Depending how many VMs are assigned to your project. \\r\\n\\r\\nJust curious, can you share statistics on how many bugs were found and after how long?\"}, {\"author\": \"kkos\", \"body\": \"I joined 5 months ago and found 21 bugs.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_210", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"210\", \"title\": \"POSIX API replacement\", \"author\": \"rofl0r\", \"labels\": [], \"description\": \"> POSIX API disabled by default for Unix (* Enabled by: configure --enable-posix-api=yes)\\r\\n\\r\\nhello, i assume POSIX API was disabled by default to prevent clashes with libc's regex.h.\\r\\n\\r\\nnow that the posix api switch has been introduced it's possible to encounter installed oniguruma with and without the functionality.\\r\\n\\r\\nhowever it would be interesting to use oniguruma over libc's version because according to this benchmark http://lh3lh3.users.sourceforge.net/reb.shtml it is up to 3x faster than GLIB.\\r\\n\\r\\ntherefore i would suggest that whether POSIX API is turned off or not, it should be made available using function names in the oniguruma namespace but with the POSIX signature, e.g.\\r\\n\\r\\n```c\\r\\n     int onig_posix_regcomp(onig_regex_t *restrict preg, const char *restrict pattern,\\r\\n         int cflags);\\r\\n```\\r\\n\\r\\nand likewise for regexec/regfree.\\r\\n\\r\\nthis would allow a package to have a configure test like\\r\\n`checking whether oniguruma has onig_posix_regcomp()... yes` and then set a CPP macro like HAVE_ONIG_REGCOMP and then the code could do something like\\r\\n\\r\\n```c\\r\\n#if HAVE_ONIG_REGCOMP \\r\\n#include <oniguruma.h>\\r\\n#define regcomp onig_posix_regcomp\\r\\n#define regex_t onig_regex_t\\r\\n#else\\r\\n#include <regex.h>\\r\\n#endif\\r\\n```\\r\\n\\r\\nand use regcomp and friends in the code without caring whether behind the scene work is done by libc or oniguruma.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"That's a good way to do it, so I thought I would.\\r\\nBut I realized that there was a problem.\\r\\nThis breaks binary compatibility with already compiled applications.\"}, {\"author\": \"rofl0r\", \"body\": \"> This breaks binary compatibility with already compiled applications.\\r\\n\\r\\nare you refering to applications linked to oniguruma but using the (previous) POSIX API?\\r\\nto keep those working, the symbols regcomp etc need to be available in the dynamic library (assuming the user/distro compiles oniguruma with --enable-posix-api=yes).\\r\\nbut those could be thin wrappers around the onig_ namespaced symbols, e.g.:\\r\\n\\r\\n```c\\r\\n#if POSIX_API_ENABLED\\r\\nint regcomp(regex_t *restrict preg, const char *restrict pattern,\\r\\n         int cflags) { return onig_posix_regcomp((void*)preg, pattern, cflags); }\\r\\n...\\r\\n#endif \\r\\n```\\r\\nthey could even be weak aliases, for that matter.\"}, {\"author\": \"kkos\", \"body\": \"Added --enable-binary-compatible-posix-api=[yes/no] to configure.\\r\\n\\r\\n./configure --enable-binary-compatible-posix-api=yes :  Binary level compatible POSIX API\\r\\n./configure --enable-posix-api=yes :  Source level compatible POSIX API\\r\\n./configure  :  No POSIX API (default)\\r\\n\\r\\nSorry, but I don't want to enable the POSIX API by default anymore.\"}, {\"author\": \"rofl0r\", \"body\": \"that's great, thanks!\\r\\n\\r\\nare the macros defined here https://github.com/kkos/oniguruma/commit/f7ca475035afd4178aebd67ad74ec48483e1210a#diff-e6b2ff26a208acb48af0b6ffb093e623R176 still needed though? now that the switch --enable-binary-compatible-posix-api=yes provides those as wrappers?\"}, {\"author\": \"rofl0r\", \"body\": \"> are the macros defined here f7ca475#diff-e6b2ff26a208acb48af0b6ffb093e623R176 still needed though? now that the switch --enable-binary-compatible-posix-api=yes provides those as wrappers?\\r\\n\\r\\nactually, scrap that. the macros you provide are handy and won't cause any issue as long as libc's regex.h isn't included. the only possible issue is that compiling the abi-compat wrapper funcs the macros get expanded (so one would end up with 2 onig_posix_regcomp in the lib), but i suppose you already checked that case.\\r\\n\\r\\nthe only minor issue i see that's still left is regoff_t being int instead of ssize_t, but you're probably aware of the issues it causes ( http://ewontfix.com/9/ ) and it probably can't be changed anyway due to ABI compat.\\r\\n\\r\\nthanks again!\"}, {\"author\": \"kkos\", \"body\": \"You're right about regoff_t, it can't be changed.\\r\\nThere will never be two onig_posix_regcomp() etc., because #undef in the beginning of regposix.c.\"}, {\"author\": \"spershin\", \"body\": \"@kkos \\r\\nHi!\\r\\nNot sure how to contact you in a better way.\\r\\nI'm having problems with posix symbols - they seem to be missing from the latest Release 6.9.9:\\r\\nI'm having these errors:\\r\\n```\\r\\nld.lld: error: undefined symbol: onig_posix_regcomp\\r\\nld.lld: error: undefined symbol: onig_posix_regexec\\r\\nld.lld: error: undefined symbol: onig_posix_regfree\\r\\nld.lld: error: undefined symbol: onig_posix_regerror\\r\\n```\\r\\n\\r\\nRunning\\r\\n`nm libonig.a`\\r\\ndoes now show any posix functions  - they are gone.\\r\\n\\r\\nCan you advice, please, how to go around this?\\r\\nDo I need to build libraries with some system variables, flags or something?\\r\\n\\r\\nAny help is appreciated, thanks!\\r\\n\\r\\nUpdate 1:\\r\\nI have added `--enable-posix-api=yes` to the configure command and trying that. I assume it would work, but haven't got the results yet as our build process is quite lengthy.\"}, {\"author\": \"mtasaka\", \"body\": \"@spershin You need `--enable-binary-compatible-posix-api=yes` as written on 6.9.9 README.md:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/README.md?plain=1#L33\"}, {\"author\": \"spershin\", \"body\": \"@mtasaka \\r\\n\\r\\nThank you for pointing this out.\\r\\nI was able to successfully build and link with just `--enable-posix-api=yes` flag.\\r\\nWhat is exactly \\\"application binary compatibility with the POSIX API\\\"?\\r\\nDoes this mean the unchanged 100% POSIX-compatible behavior or something else?\\r\\n\\r\\nAsking because with the new library I have one test failing - apparently it was expecting a failure, but now it actually returns a result:\\r\\n```\\r\\n021+ string(10) \\\"string_val\\\"\\r\\n022- Warning: mbregex compile err: invalid code point value in %s/mb_ereg_replace_variation1.php on line %d\\r\\n023- bool(false)\\r\\n024- \\r\\n```\\r\\n\\r\\nUpdate:\\r\\nApparently 6.5.0 was failing with patterns '\\\\xd7' and '\\\\xf6', but 6.9.9 is failing only with '\\\\xd7'.\\r\\nPattern '\\\\xf6' now passes.\\r\\nFailure message is \\\"too short multibyte code string\\\".\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_216", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"216\", \"title\": \"Cmake build fails on Windows \", \"author\": \"srg-kostyrko\", \"labels\": [], \"description\": \"Changes introduced in https://github.com/kkos/oniguruma/commit/09fbc66176b87f6851a385cbdbce77b495417ad5 cause cmake build to fail on Windows because of the missing definition of `ssize_t` type\\r\\n\\r\\nI get the following error on build\\r\\n```\\r\\nregexec.c(1103,17): error C2061: syntax error: identifier \\\"StackIndex\\\" \\r\\n```\\r\\n\\r\\nif I revert the change introduced in commit - build works.\\r\\n\\r\\nCommands used for the build\\r\\n```\\r\\n$ cmake -G \\\"Visual Studio 16 2019\\\" -A Win32 -DCMAKE_INSTALL_PREFIX=out ..\\r\\n$ cmake --build . --target install --config Release\\r\\n```\\r\\n\\r\\nconfiguration step output\\r\\n```\\r\\n-- Selecting Windows SDK version 10.0.18362.0 to target Windows 10.0.18363.\\r\\n-- The C compiler identification is MSVC 19.26.28806.0\\r\\n-- Detecting C compiler ABI info\\r\\n-- Detecting C compiler ABI info - done\\r\\n-- Check for working C compiler: C:/Program Files/VisualStudio/VC/Tools/MSVC/14.26.28801/bin/Hostx64/x86/cl.exe - skipped\\r\\n-- Detecting C compile features\\r\\n-- Detecting C compile features - done\\r\\n-- Looking for alloca\\r\\n-- Looking for alloca - not found\\r\\n-- Looking for include file alloca.h\\r\\n-- Looking for include file alloca.h - not found\\r\\n-- Looking for include file stdint.h\\r\\n-- Looking for include file stdint.h - found\\r\\n-- Looking for include file sys/times.h\\r\\n-- Looking for include file sys/times.h - not found\\r\\n-- Looking for include file sys/time.h\\r\\n-- Looking for include file sys/time.h - not found\\r\\n-- Looking for include file sys/types.h\\r\\n-- Looking for include file sys/types.h - found\\r\\n-- Looking for include file unistd.h\\r\\n-- Looking for include file unistd.h - not found\\r\\n-- Looking for include file inttypes.h\\r\\n-- Looking for include file inttypes.h - found\\r\\n-- Looking for stddef.h\\r\\n-- Looking for stddef.h - found\\r\\n-- Check size of int\\r\\n-- Check size of int - done\\r\\n-- Check size of long\\r\\n-- Check size of long - done\\r\\n-- Check size of long long\\r\\n-- Check size of long long - done\\r\\n-- Check size of void*\\r\\n-- Check size of void* - done\\r\\n-- Configuring done\\r\\n-- Generating done\\r\\n-- Build files have been written to: D:/projects/oniguruma/build\\r\\n```\\r\\n\\r\\nI'm willing to help with testing of this problem\\r\\nPlease let me know if you need any additional info\", \"comments\": [{\"author\": \"asottile\", \"body\": \"I am also seeing build errors for v6.9.6_rc1 on windows:\\r\\n\\r\\nhttps://asottile.visualstudio.com/asottile/_build/results?buildId=4632&view=logs&j=0268f1ee-3a30-5926-65c4-3bada40a45a5&t=4be81aa0-7a13-52ed-304b-c9e64249c2fd\\r\\n\\r\\nlog output in case azure pipelines goes stale:\\r\\n\\r\\n[71.txt](https://github.com/kkos/oniguruma/files/5351705/71.txt)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI am currently in an environment where Windows is unavailable due to COVID-19.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_217", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"217\", \"title\": \"Buffer overflow in utf16le_mbc_enc_len\", \"author\": \"lxxxxfdh\", \"labels\": [], \"description\": \"The test code:\\r\\n``` c\\r\\n#include <stdio.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\nstatic int\\r\\nscan_callback(int n, int r, OnigRegion* region, void* arg)\\r\\n{\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nscan(regex_t* reg, unsigned char* str, unsigned char* end)\\r\\n{\\r\\n  int r;\\r\\n  OnigRegion *region;\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  r = onig_scan(reg, str, end, region, ONIG_OPTION_NONE, scan_callback, NULL);\\r\\n  if (r >= 0) {\\r\\n    fprintf(stdout, \\\"total: %d match\\\\n\\\", r);\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((OnigUChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  return 0;\\r\\n}\\r\\n\\r\\nstatic int\\r\\nexec(OnigEncoding enc, OnigOptionType options,\\r\\n     char* apattern, char* astr,  int pattern_len,\\r\\n    unsigned char *end, OnigSyntaxType* sytax)\\r\\n{\\r\\n    int r;\\r\\n    regex_t* reg;\\r\\n    OnigErrorInfo einfo;\\r\\n    UChar* pattern = (UChar* )apattern;\\r\\n    UChar* str     = (UChar* )astr;\\r\\n\\r\\n    onig_initialize(&enc, 1);\\r\\n\\r\\n    r = onig_new(&reg, pattern,\\r\\n                 pattern + pattern_len,\\r\\n                 options, enc, sytax , &einfo);\\r\\n    if (r != ONIG_NORMAL) {\\r\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n        onig_error_code_to_str(s, r, &einfo);\\r\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n        return -1;\\r\\n    }\\r\\n\\r\\n    r = scan(reg, str, end);\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    return 0;\\r\\n}\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n    int r;\\r\\n\\r\\n    static unsigned char str[] = { 0xc7, 0xd6, 0xfe, 0xea, 0xe0, 0xe2, 0x00 };\\r\\n    char* pattern =\\\"\\\";\\r\\n    r = exec(ONIG_ENCODING_UTF16_LE,ONIG_OPTION_NONE,pattern,(char*) str,0, (char*) str + 7, ONIG_SYNTAX_DEFAULT);\\r\\n    return r;\\r\\n}\\r\\n```\\r\\n\\r\\nASAN error:\\r\\n\\r\\n```\\r\\n=================================================================\\r\\n==7214==ERROR: AddressSanitizer: global-buffer-overflow on address 0x56304483c027 at pc 0x5630445e10e4 bp 0x7ffdce4d0760 sp 0x7ffdce4d0750\\r\\nREAD of size 1 at 0x56304483c027 thread T0\\r\\n    #0 0x5630445e10e3 in utf16le_mbc_enc_len ../../oniguruma/src/utf16_le.c:112\\r\\n    #1 0x5630445acded in onig_scan ../../oniguruma/src/regexec.c:5713\\r\\n    #2 0x56304448be82 in scan ../../oniguruma/test/testc.c:17\\r\\n    #3 0x56304448be82 in exec ../../oniguruma/test/testc.c:55\\r\\n    #4 0x56304448be82 in main ../../oniguruma/test/testc.c:67\\r\\n    #5 0x7f47a6eeeb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\\r\\n    #6 0x56304448c809 in _start (/home/test/fuzz/oni/asan/test/testc+0x1e809)\\r\\n\\r\\n0x56304483c027 is located 0 bytes to the right of global variable 'str' defined in '../../oniguruma/test/testc.c:65:26' (0x56304483c020) of size 7\\r\\nSUMMARY: AddressSanitizer: global-buffer-overflow ../../oniguruma/src/utf16_le.c:112 in utf16le_mbc_enc_len\\r\\nShadow bytes around the buggy address:\\r\\n  0x0ac6888ff7b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff7c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff7d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff7e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff7f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n=>0x0ac6888ff800: 00 00 00 00[07]f9 f9 f9 f9 f9 f9 f9 00 00 00 00\\r\\n  0x0ac6888ff810: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff820: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0ac6888ff830: 04 f9 f9 f9 f9 f9 f9 f9 04 f9 f9 f9 f9 f9 f9 f9\\r\\n  0x0ac6888ff840: 00 00 00 00 00 f9 f9 f9 f9 f9 f9 f9 00 00 00 00\\r\\n  0x0ac6888ff850: 00 f9 f9 f9 f9 f9 f9 f9 00 00 00 00 00 00 00 00\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n  Left alloca redzone:     ca\\r\\n  Right alloca redzone:    cb\\r\\n==7214==ABORTING\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"str does not need to be NULL-terminated.\\r\\nAnd the NULL-terminations must not be included in the length of the string.\\r\\n\\r\\n```\\r\\nr = exec(ONIG_ENCODING_UTF16_LE,ONIG_OPTION_NONE,pattern,(char*) str,0, (char*) str + 7, ONIG_SYNTAX_DEFAULT);\\r\\n```\\r\\nI think this should be done as follows. (I haven't checked.)\\r\\n```\\r\\nr = exec(ONIG_ENCODING_UTF16_LE,ONIG_OPTION_NONE,pattern,(char*) str,0, (char*) str + 6, ONIG_SYNTAX_DEFAULT);\\r\\n```\\r\\n\"}, {\"author\": \"lxxxxfdh\", \"body\": \"Yes, it is ok after length 6 is used.\\r\\nThanks and I will close it.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_218", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"218\", \"title\": \"Regex compilation failure in scenarios with unicode ranges in a character class\", \"author\": \"gundermanc\", \"labels\": [], \"description\": \"During investigation of a bug in CSS TextMate grammar evaluation in Visual Studio and Visual Studio Code, I noticed that there is an inconsistent regex compilation failure that seem to depend on the 1) the version of the library being used 2) the encoding of the regex.\\r\\n\\r\\nCan you please help me determine if this is expected behavior?\\r\\n\\r\\n```\\r\\n(?x)\\r\\n(?=\\r\\n  (?:\\\\|)?                    # Possible anonymous namespace prefix\\r\\n  (?:\\r\\n    [-\\\\[:.*\\\\#a-zA-Z_]       # Valid selector character\\r\\n    |\\r\\n    [^\\\\x00-\\\\x7F]            # Which can include non-ASCII symbols\\r\\n    |\\r\\n    \\\\\\\\                      # Or an escape sequence\\r\\n    (?:[0-9a-fA-F]{1,6}|.)\\r\\n  )\\r\\n)\\r\\n```\\r\\n\\r\\nRemoving `[^\\\\x00-\\\\x7F]`, the compilation succeeds.\\r\\n\\r\\nIn v6.9.5_rev1:\\r\\n  - UTF-8: Compiles correctly and runs fine.\\r\\n  - UTF-16 LE: fails compilation with -206 ONIGERR_TOO_SHORT_MULTI_BYTE_STRING\\r\\n\\r\\nCode:\\r\\n\\r\\n```cpp\\r\\n        wchar_t* pattern = L\\\"(?x)\\\\n(?=\\\\n  (?:\\\\\\\\|)?                    # Possible anonymous namespace prefix\\\\n  (?:\\\\n    [-\\\\\\\\[:.*\\\\\\\\#a-zA-Z_]       # Valid selector character\\\\n    |\\\\n    [^\\\\\\\\x00-\\\\\\\\x7F]            # Which can include non-ASCII symbols\\\\n    |\\\\n    \\\\\\\\\\\\\\\\                      # Or an escape sequence\\\\n    (?:[0-9a-fA-F]{1,6}|.)\\\\n  )\\\\n)\\\";\\r\\n\\r\\n        size_t length = wcslen(pattern);\\r\\n\\r\\n        char* utf8Pattern = \\\"(?x)\\\\n(?=\\\\n  (?:\\\\\\\\|)?                    # Possible anonymous namespace prefix\\\\n  (?:\\\\n    [-\\\\\\\\[:.*\\\\\\\\#a-zA-Z_]       # Valid selector character\\\\n    |\\\\n    [^\\\\\\\\x00-\\\\\\\\x7F]            # Which can include non-ASCII symbols\\\\n    |\\\\n    \\\\\\\\\\\\\\\\                      # Or an escape sequence\\\\n    (?:[0-9a-fA-F]{1,6}|.)\\\\n  )\\\\n)\\\";\\r\\n\\r\\n        size_t utf8PatternLength = strlen(utf8Pattern);\\r\\n\\r\\n        *pResult = onig_new(&pRegEx, (const OnigUChar*)(&utf8Pattern[0]), (const OnigUChar*)(&utf8Pattern[utf8PatternLength]),\\r\\n            ONIG_OPTION_CAPTURE_GROUP, ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n\\r\\n        *pResult = onig_new(&pRegEx, (const OnigUChar*)(&pattern[0]), (const OnigUChar*)(&pattern[length]),\\r\\n            ONIG_OPTION_CAPTURE_GROUP, ONIG_ENCODING_UTF16_LE, ONIG_SYNTAX_DEFAULT, &einfo);\\r\\n\\r\\n\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I don't use wchar_t, and the byte representation of wchar_t varies from platform to platform, so I don't know if it's appropriate for UTF16-LE.\\r\\nBut even if that point is okay and fits, there are still the following problem.\\r\\n\\\\xHH represents a byte value. Therefore, to specify a character code in it, you have to write an \\\\xHH for the number of bytes.\\r\\nOr use an \\\\x{HHHH} to represent the character code.\\r\\n\"}, {\"author\": \"gundermanc\", \"body\": \"Thanks for your response, this has been very helpful.\\r\\n\\r\\n>I don't use wchar_t, and the byte representation of wchar_t varies from platform to platform, so I don't know if it's appropriate for UTF16-LE.\\r\\n\\r\\nMy understanding is that Windows native encoding is UCS-2, which is comparable to UTF16-LE for my purposes.\\r\\n\\r\\n>to specify a character code in it, you have to write an \\\\xHH for the number of bytes\\r\\n\\r\\nDoes this mean that there are encoding specific differences in the syntax? e.g:\\r\\n\\r\\n- UTF8:  Can use `[^\\\\x00-\\\\x7F]`\\r\\n- UTF16-LE: Should use the 4 character version of this notation, since we're identifying a 2 byte character.. perhaps something like ` [^\\\\x{0000}-\\\\x{007F}]` ?\\r\\n\\r\\nOur regex are known to be written for the UTF-8 encoding, so perhaps I can string-replace any instances of \\\\xAB with \\\\x00AB as a work-around.\"}, {\"author\": \"kkos\", \"body\": \"If you write using \\\\xHH, it specifies a encoded byte value, so you may have to write a different value for a different encoding.\\r\\nIf you're writing using \\\\x{7HHHHHHH}, you're specifying a code point value rather than a byte value, so you can specify the same value in a different encoding if it's Unicode.\\r\\n\\\\x{7HHHHHHH} is not a fixed four-digit number.\\r\\nIt can be written in any number of digits within the range of 31-bit integers.\"}, {\"author\": \"gundermanc\", \"body\": \"Thank you, I think I have the information I need to fix this.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_219", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"219\", \"title\": \"Binary incompatibilty between 6.9.5_rev1 -> 6.9.2_rc2: reg_number_of_names\", \"author\": \"mtasaka\", \"labels\": [], \"description\": \"When compiling with `--enable-posix-api` on 6.9.5_rev1, and `--enable-posix-api --enable-binary-compatible-posix-api`, the symbol `reg_number_of_names` is removed, so this is binary compatible, because binary depending on oniguruma with using `reg_number_of_names` symbol provided by 6.9.5_rev1 can no longer find the symbol, and it will cause missing symbol error on runtime.\\r\\n\\r\\n```\\r\\n@@ -69,2 +69,3 @@\\r\\n onig_copyright\\tT\\r\\n+onig_detect_can_be_slow_pattern\\tT\\r\\n onig_end\\tT\\r\\n@@ -122,2 +123,3 @@\\r\\n onig_get_string_end_by_callout_args\\tT\\r\\n+onig_get_subexp_call_limit_in_search\\tT\\r\\n onig_get_subexp_call_max_nest_level\\tT\\r\\n@@ -167,2 +169,10 @@\\r\\n onig_positive_int_multiply\\tT\\r\\n+onig_posix_reg_foreach_name\\tT\\r\\n+onig_posix_reg_name_to_group_numbers\\tT\\r\\n+onig_posix_reg_number_of_names\\tT\\r\\n+onig_posix_reg_set_encoding\\tT\\r\\n+onig_posix_regcomp\\tT\\r\\n+onig_posix_regerror\\tT\\r\\n+onig_posix_regexec\\tT\\r\\n+onig_posix_regfree\\tT\\r\\n onig_reduce_nested_quantifier\\tT\\r\\n@@ -212,2 +222,3 @@\\r\\n onig_set_retry_limit_in_search_of_match_param\\tT\\r\\n+onig_set_subexp_call_limit_in_search\\tT\\r\\n onig_set_subexp_call_max_nest_level\\tT\\r\\n@@ -313,3 +324,2 @@\\r\\n reg_name_to_group_numbers\\tT\\r\\n-reg_number_of_names\\tT\\r\\n reg_set_encoding\\tT\\r\\n\\r\\n\\t1 symbols removed\\r\\nT reg_number_of_names\\r\\n\\r\\n\\t11 symbols added\\r\\nT onig_detect_can_be_slow_pattern\\r\\nT onig_get_subexp_call_limit_in_search\\r\\nT onig_posix_reg_foreach_name\\r\\nT onig_posix_reg_name_to_group_numbers\\r\\nT onig_posix_reg_number_of_names\\r\\nT onig_posix_reg_set_encoding\\r\\nT onig_posix_regcomp\\r\\nT onig_posix_regerror\\r\\nT onig_posix_regexec\\r\\nT onig_posix_regfree\\r\\nT onig_set_subexp_call_limit_in_search\\r\\n```\\r\\n\\r\\n6.9.6_rc2 changed `reg_number_of_names` to `#define` , but this is not okay for keeping binary compatibitify (this type of error happened on vim, for example), the library must **export** the symbol actually.\", \"comments\": [{\"author\": \"mtasaka\", \"body\": \"Confirmed fixed, thank you!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_220", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"220\", \"title\": \"autotools not building DLL using msys2 and mingw64 on windows 10\", \"author\": \"jonforums\", \"labels\": [], \"description\": \"With the current `configure.ac` and `src/Makefile.am`, libtool fails to build `libonig-5.dll` when using a plain vanilla msys2 + mingw64 toolchain on windows 10 x64.\\r\\n\\r\\nTo build a usable oniguruma, I need to use `sed` , `autoreconf -fi`, `make src dll`, strip the libtool created dll, and finally copy the `libonig.def` file to the install `bin/` dir as in my build helper https://github.com/jonforums/buildlets/blob/master/build_oniguruma.ps1#L45-L72\\r\\n\\r\\nThe problem is that the `libonig_la_LDFLAGS` does not include `-no-undefined` when the `--build` triplet (`os` portion) contains `mingw*`.\\r\\n\\r\\nPCRE2 solves this problem with the following autotools config:\\r\\n\\r\\n~~~ shell\\r\\n### file: Makefile.am\\r\\nif WITH_PCRE2_8\\r\\nlibpcre2_8_la_LDFLAGS = $(EXTRA_LIBPCRE2_8_LDFLAGS)\\r\\nendif # WITH_PCRE2_8\\r\\n\\r\\n---\\r\\n\\r\\n### file: configure.ac\\r\\n# Platform specific issues\\r\\nNO_UNDEFINED=\\r\\nEXPORT_ALL_SYMBOLS=\\r\\ncase $host_os in\\r\\n  cygwin* | mingw* )\\r\\n    if test X\\\"$enable_shared\\\" = Xyes; then\\r\\n      NO_UNDEFINED=\\\"-no-undefined\\\"\\r\\n      EXPORT_ALL_SYMBOLS=\\\"-Wl,--export-all-symbols\\\"\\r\\n    fi\\r\\n    ;;\\r\\nesac\\r\\n...\\r\\nEXTRA_LIBPCRE2_8_LDFLAGS=\\\"$EXTRA_LIBPCRE2_8_LDFLAGS \\\\\\r\\n  $NO_UNDEFINED -version-info libpcre2_8_version\\\"\\r\\n~~~\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I'm not sure exactly what to do, but I made the change based on PCRE2 10.35.\\r\\nI'll create a release candidate 3 later if this is acceptable.\\r\\nI don't have a Windows environment, so I can't be sure.\"}, {\"author\": \"jonforums\", \"body\": \"Later tonight I will download the latest from the `master` branch, try a plain vanilla build, and reply with results.\"}, {\"author\": \"jonforums\", \"body\": \"No problems building `master` using the manual build shown below. A quick test of the dll seems to work.\\r\\n\\r\\n```bash\\r\\n$ cd staging/bin\\r\\n$ perl -m'FFI::Platypus' -e '$ffi=FFI::Platypus->new(lib => q(libonig-5.dll), api => 1); $ffi->attach(q(onig_version), [], q(string)); printf qq(Onig version: %s\\\\n), onig_version()'\\r\\nOnig version: 6.9.6\\r\\n```\\r\\nBut libtool is not building the `.def` when it does `libtool: link: gcc -shared ... -o .libs/libonig-5.dll`.\\r\\n\\r\\nI'm not sure if there is another var like `libonig_la_LDFLAGS` that libtool uses when building the final dll via `gcc -shared`. If so, you could have `configure.ac` create a `mingw*` guarded var with `-Wl,--output-def,libonig.def` similar to how you are handling `$(EXTRA_LIBONIG_LDFLAGS)` for this issue. \\r\\n\\r\\n## build summary\\r\\n```bash\\r\\n## EXPORT_ALL_SYMBOLS looks to be unused in PCRE2's autoconf files\\r\\n$ grep -nP EXPORT_ALL_SYMBOLS .\\\\configure.ac .\\\\Makefile.am\\r\\n.\\\\configure.ac:861:EXPORT_ALL_SYMBOLS=\\r\\n.\\\\configure.ac:866:      EXPORT_ALL_SYMBOLS=\\\"-Wl,--export-all-symbols\\\"\\r\\n\\r\\n---\\r\\n\\r\\n$ curl.exe -L -O https://github.com/kkos/oniguruma/archive/master.zip\\r\\n\\r\\n$ 7za x .\\\\master.zip && cd oniguruma-master\\r\\n\\r\\n$ gcc --version && make --version\\r\\ngcc.exe (Rev4, Built by MSYS2 project) 10.2.0\\r\\n...\\r\\nGNU Make 4.3\\r\\nBuilt for x86_64-pc-msys\\r\\n\\r\\n$ sh -c \\\"./config.sub $(sh -c './config.guess')\\\"\\r\\nx86_64-pc-msys\\r\\n\\r\\n$ sh -c 'autoreconf -fvi'\\r\\n\\r\\n$ sh -c './configure --prefix=R:/staging --build=x86_64-w64-mingw32' | tee build.log\\r\\n...\\r\\nchecking if libtool supports shared libraries... yes\\r\\nchecking whether to build shared libraries... yes\\r\\nchecking whether to build static libraries... yes\\r\\n...\\r\\nchecking that generated files are newer than configure... done\\r\\nconfigure: creating ./config.status\\r\\nconfig.status: creating Makefile\\r\\nconfig.status: creating src/Makefile\\r\\nconfig.status: creating test/Makefile\\r\\nconfig.status: creating sample/Makefile\\r\\nconfig.status: creating onig-config\\r\\nconfig.status: creating src/config.h\\r\\nconfig.status: executing depfiles commands\\r\\nconfig.status: executing libtool commands\\r\\nconfig.status: executing default commands\\r\\n\\r\\n$ sh -c 'make' | tee build.log -append\\r\\nMaking all in src\\r\\nmake[1]: Entering directory '/r/oniguruma-master/src'\\r\\nmake  all-am\\r\\nmake[2]: Entering directory '/r/oniguruma-master/src'\\r\\n...\\r\\n/bin/sh ../libtool  --tag=CC   --mode=link gcc -Wall   -g -O2 -no-undefined -version-info 6:0:1\\r\\n -o libonig.la -rpath R:/staging/lib regparse.lo regcomp.lo regexec.lo regenc.lo regerror.lo regext.lo regsyntax.lo regtrav.lo regversion.lo st.lo reggnu.lo  unicode.lo unicode_unfold_key.lo unicode_fold1_key.lo unicode_fold2_key.lo unicode_fold3_key.lo ascii.lo utf8.lo utf16_be.lo utf16_le.lo utf32_be.lo utf32_le.lo euc_jp.lo euc_jp_prop.lo sjis.lo sjis_prop.lo iso8859_1.lo iso8859_2.lo iso8859_3.lo iso8859_4.lo iso8859_5.lo iso8859_6.lo iso8859_7.lo iso8859_8.lo iso8859_9.lo iso8859_10.lo iso8859_11.lo iso8859_13.lo iso8859_14.lo iso8859_15.lo iso8859_16.lo euc_tw.lo\\r\\neuc_kr.lo big5.lo gb18030.lo koi8_r.lo cp1251.lo onig_init.lo\\r\\n\\r\\nlibtool: link: gcc -shared  .libs/regparse.o .libs/regcomp.o .libs/regexec.o .libs/regenc.o .libs/regerror.o .libs/regext.o .libs/regsyntax.o .libs/regtrav.o .libs/regversion.o .libs/st.o .libs/reggnu.o .libs/unicode.o .libs/unicode_unfold_key.o .libs/unicode_fold1_key.o .libs/unicode_fold2_key.o .libs/unicode_fold3_key.o .libs/ascii.o .libs/utf8.o .libs/utf16_be.o .libs/utf16_le.o .libs/utf32_be.o .libs/utf32_le.o .libs/euc_jp.o .libs/euc_jp_prop.o .libs/sjis.o .libs/sjis_prop.o .libs/iso8859_1.o .libs/iso8859_2.o .libs/iso8859_3.o .libs/iso8859_4.o .libs/iso8859_5.o .libs/iso8859_6.o .libs/iso8859_7.o .libs/iso8859_8.o .libs/iso8859_9.o .libs/iso8859_10.o .libs/iso8859_11.o .libs/iso8859_13.o .libs/iso8859_14.o .libs/iso8859_15.o .libs/iso8859_16.o .libs/euc_tw.o .libs/euc_kr.o .libs/big5.o .libs/gb18030.o .libs/koi8_r.o .libs/cp1251.o .libs/onig_init.o    -g -O2   -o .libs/libonig-5.dll -Wl,--enable-auto-image-base -Xlinker --out-implib -Xlinker .libs/libonig.dll.a\\r\\n\\r\\n\\r\\n$ sh -c \\\"make install\\\" | tee build.log -append\\r\\n\\r\\n$ ll ../staging/bin, ../staging/lib\\r\\n\\r\\n    Directory: R:\\\\staging\\\\bin\\r\\n\\r\\nMode                 LastWriteTime         Length Name\\r\\n----                 -------------         ------ ----\\r\\n-----          10/13/2020 11:19 PM        2058626 libonig-5.dll\\r\\n-----          10/13/2020 11:19 PM           1380 onig-config\\r\\n\\r\\n    Directory: R:\\\\staging\\\\lib\\r\\n\\r\\nMode                 LastWriteTime         Length Name\\r\\n----                 -------------         ------ ----\\r\\nd----          10/13/2020 11:19 PM                pkgconfig\\r\\n-a---          10/13/2020 11:19 PM        2307750 libonig.a\\r\\n-----          10/13/2020 11:19 PM         209568 libonig.dll.a\\r\\n-----          10/13/2020 11:19 PM            897 libonig.la\\r\\n```\"}, {\"author\": \"jonforums\", \"body\": \"The compile and link stage now looks good including libtool building the dll via\\r\\n\\r\\n```bash\\r\\nlibtool: link: gcc -shared  ...  -g -O2 -Wl,--output-def -Wl,libonig.def   -o .libs/libonig-5.dll -Wl,--enable-auto-image-base -Xlinker --out-implib -Xlinker .libs/libonig.dll.a\\r\\n```\\r\\n\\r\\nBut `make install` did not copy `libonig.def` to `${install_dir}/lib` or `${install_dir}/bin`.\\r\\n\\r\\nI thought the reason was because libtool built `libonig.def` in `src` while `libonig-5.dll`, `libonig.a`, `libonig.dll.a`, and `libonig.la` were built in `src/.libs/`. But when I hard coded `.libs` in `configure.ac` to\\r\\n\\r\\n```bash\\r\\nFIX_TO_LDFLAGS=\\\"-no-undefined -Wl,--output-def,.libs/libonig.def\\\"\\r\\n```\\r\\n\\r\\nlibtool built `libonig.def` in `src/.libs/` alongside `libonig-5.dll` but `make install` still did not copy `libonig.def` to the install dir.\\r\\n\\r\\nLibtool did not strip `ligonig-5.dll`.\\r\\n\\r\\nThe good news is that dll is usable\\r\\n\\r\\n```powershell\\r\\n$ .\\\\build\\\\onig.exe\\r\\n2020/10/14 18:46:33 Loading libonig-5.dll...\\r\\n2020/10/14 18:46:33 Oniguruma version: 6.9.6\\r\\n```\\r\\n\\r\\nfrom go using this \\r\\n\\r\\n```go\\r\\npackage main\\r\\n\\r\\nimport (\\r\\n\\t\\\"bytes\\\"\\r\\n\\t\\\"log\\\"\\r\\n\\t\\\"syscall\\\"\\r\\n\\t\\\"unsafe\\\"\\r\\n\\r\\n\\t\\\"golang.org/x/sys/windows\\\"\\r\\n)\\r\\n\\r\\nconst (\\r\\n\\tVERSION       = \\\"0.5.0\\\"\\r\\n\\tONIGURUMA_DLL = \\\"libonig-5.dll\\\"\\r\\n\\r\\n\\tLOAD_LIBRARY_SEARCH_APPLICATION_DIR = 0x00000200\\r\\n\\tLOAD_LIBRARY_SEARCH_SYSTEM32        = 0x00000800\\r\\n)\\r\\n\\r\\nfunc main() {\\r\\n\\tlog.Printf(\\\"Loading %s...\\\\n\\\", ONIGURUMA_DLL)\\r\\n\\th, err := windows.LoadLibraryEx(ONIGURUMA_DLL, 0,\\r\\n\\t\\tuintptr(LOAD_LIBRARY_SEARCH_APPLICATION_DIR))\\r\\n\\tif err != nil {\\r\\n\\t\\tlog.Fatalf(\\\"Unable to load `%s`: %s\\\\n\\\", ONIGURUMA_DLL, err)\\r\\n\\t}\\r\\n\\tdefer windows.FreeLibrary(h)\\r\\n\\r\\n\\tproc, err := windows.GetProcAddress(h, \\\"onig_version\\\")\\r\\n\\tif err != nil {\\r\\n\\t\\tlog.Fatal(\\\"Unable to find `onig_version`: \\\", err)\\r\\n\\t}\\r\\n\\r\\n\\tr, _, errno := syscall.Syscall(uintptr(proc), 0, 0, 0, 0)\\r\\n\\tif errno != 0 {\\r\\n\\t\\tlog.Fatal(\\\"Unable to call `onig_version`: \\\", error(errno))\\r\\n\\t}\\r\\n\\r\\n\\tb := (*[1 << 4]byte)(unsafe.Pointer(r))[:]\\r\\n\\tlog.Printf(\\\"Oniguruma version: %s\\\\n\\\", string(b[:bytes.IndexByte(b, 0)]))\\r\\n}\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Changed to install libonig.def in make install.\\r\\nIf you run \\\"make install-strip\\\", won't it be striped?\\r\\n\"}, {\"author\": \"jonforums\", \"body\": \"619ae35 works great.\\r\\n\\r\\nBoth `make install` and `make install-strip` work as expected. Both `bin/libonig-5.dll` and `lib/libonig.def` are created correctly for the stripped and non-stripped scenarios.\"}, {\"author\": \"kkos\", \"body\": \"Thank you for your help.\\r\\nI was able to get release candidate 3 out.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_221", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"221\", \"title\": \"Possible wrong fix to #207\", \"author\": \"voxik\", \"labels\": [], \"description\": \"I'm still trying to wrap my head around cbe9f8bd9cfc6c3c87. The question is whether `s` is NULL terminated string:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/cbdbdadd4e747994e00fdcee7e4b263cd32f9dd8/src/regcomp.c#L6030-L6036\\r\\n\\r\\nMy conclusion is that it is just array of characters, because it is accompanied by `len` field, and looking at the other places, nothing suggest it should be NULL terminated. The only place, where it could appear NULL terminated is:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/cbdbdadd4e747994e00fdcee7e4b263cd32f9dd8/src/regcomp.c#L6213-L6221\\r\\n\\r\\nbut that is just clearing the struct.\\r\\n\\r\\nSo given the `s` is just array of `OPT_EXACT_MAXLEN` characters, lets debug through `concat_opt_exact_str`:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/cbdbdadd4e747994e00fdcee7e4b263cd32f9dd8/src/regcomp.c#L6259-L6276\\r\\n\\r\\nand being on line 6267, I have following values:\\r\\n\\r\\n~~~\\r\\n(gdb) print s\\r\\n$15 = (OnigUChar *) 0x4054c0 \\\"a\\\"\\r\\n(gdb) print end\\r\\n$16 = (OnigUChar *) 0x4054c1 \\\"\\\"\\r\\n\\r\\n(gdb) print *(OptStr *)to\\r\\n$25 = {mmd = {min = 0, max = 0}, anc = {left_anchor = 0, right_anchor = 0}, reach_end = 0, len = 0, \\r\\n  s = \\\"\\\\000\\\\000\\\\000\\\\000H\\\\334\\\\377\\\\377\\\\377\\\\177\\\\000\\\\000T\\\\334\\\\377\\\\377\\\\377\\\\177\\\\000\\\\000\\\\000\\\\000\\\\000\\\"}\\r\\n\\r\\n(gdb) print len\\r\\n$29 = 1\\r\\n~~~\\r\\n\\r\\nThat in turn means that `i + len == 0 + 1 == 1`. If `OPT_EXACT_MAXLEN` was 1, then the condition `if (i + len >= OPT_EXACT_MAXLEN) break;` would turn into `if (1 >= 1) break;`, which would break, although there is certainly one byte available in the output string.\\r\\n\\r\\nThis tends me believe, that original condition, i.e. `if (i + len > OPT_EXACT_MAXLEN) break;` was the correct condition and the  cbe9f8bd9cfc6c3c87 should be reverted.\\r\\n\\r\\nThis possible applies also to 8155473a2ab783b91e9f5a2e308bb7b5c4fec344, but I have not checked the case.\", \"comments\": [{\"author\": \"voxik\", \"body\": \"BTW if my analysis is wrong, then I would appreciate, if there is added test case covering this function and documentation for the `OptStr` was extended a bit.\"}, {\"author\": \"rofl0r\", \"body\": \"> and the cbe9f8b should be reverted.\\r\\n\\r\\n> This possible applies also to cbe9f8b\\r\\n\\r\\ni suppose the second commit hash is a copy paste error ?\"}, {\"author\": \"voxik\", \"body\": \"> > and the [cbe9f8b](https://github.com/kkos/oniguruma/commit/cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0) should be reverted.\\r\\n> \\r\\n> > This possible applies also to [cbe9f8b](https://github.com/kkos/oniguruma/commit/cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0)\\r\\n> \\r\\n> i suppose the second commit hash is a copy paste error ?\\r\\n\\r\\nAh, right, 8155473a2ab783b91e9f5a2e308bb7b5c4fec344 is the right commit. I have fixed the original post. Tough day today, sorry :innocent: \"}, {\"author\": \"kkos\", \"body\": \"Yes, I think you're right.\\r\\nI'm not sure what Coverity's output means now.\\r\\nIt's impossible to write a test case where this changes the results because the content of the optimization information changes only slightly.\"}, {\"author\": \"voxik\", \"body\": \"> I'm not sure what Coverity's output means now.\\r\\n\\r\\nNeither am I, but I'll try to poke some Coverity experts.\\r\\n\"}, {\"author\": \"kdudka\", \"body\": \"As discussed with @voxik, this is indeed a false positive of Coverity.  The checker does not track non-trivial relations of integer variables.  It sees that an array bound is checked by the condition of the outer `for` loop.  Then it sees an increment of the index variable without subsequently checking the bound.  The condition `(i + len > OPT_EXACT_MAXLEN)` is below the resolution of this checker because the condition evaluates a pair of integer variables.\\r\\n\\r\\nCould we suppress the false positive with the following inline annotation in the source code?\\r\\n```diff\\r\\n--- a/src/regcomp.c\\r\\n+++ b/src/regcomp.c\\r\\n@@ -6260,18 +6260,19 @@ static void\\r\\n concat_opt_exact_str(OptStr* to, UChar* s, UChar* end, OnigEncoding enc)\\r\\n {\\r\\n   int i, j, len;\\r\\n   UChar *p;\\r\\n\\r\\n   for (i = to->len, p = s; p < end && i < OPT_EXACT_MAXLEN; ) {\\r\\n     len = enclen(enc, p);\\r\\n     if (i + len > OPT_EXACT_MAXLEN) break;\\r\\n     for (j = 0; j < len && p < end; j++)\\r\\n+      /* coverity[overrun-local] */\\r\\n       to->s[i++] = *p++;\\r\\n   }\\r\\n\\r\\n   to->len = i;\\r\\n\\r\\n   if (p >= end)\\r\\n     to->reach_end = 1;\\r\\n }\\r\\n\\r\\n```\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_222", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"222\", \"title\": \"Manual building doesnt work\", \"author\": \"TooManyDots\", \"labels\": [], \"description\": \"1. autoreconf -vfi (* case: configure script is not found.)\\r\\n2. ./configure\\r\\n\\r\\nWhen i execute step 2 it fails with\\r\\n\\r\\n```\\r\\nchecking that generated files are newer than configure... done\\r\\nconfigure: creating ./config.status\\r\\nconfig.status: creating Makefile\\r\\nconfig.status: error: cannot find input file: `src/Makefile.in'\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"If src/Makefile.in is not made, then autoreconf has failed.\\r\\nI don't know more than that because ./configure works fine in my environment.\\r\\n\\r\\n```\\r\\n$ git clone https://github.com/kkos/oniguruma.git\\r\\nCloning into 'oniguruma'...\\r\\nremote: Enumerating objects: 13182, done.\\r\\nremote: Total 13182 (delta 0), reused 0 (delta 0), pack-reused 13182\\r\\nReceiving objects: 100% (13182/13182), 5.27 MiB | 3.76 MiB/s, done.\\r\\nResolving deltas: 100% (9952/9952), done.\\r\\n$ cd oniguruma\\r\\n$ autoreconf -vfi\\r\\nautoreconf: Entering directory `.'\\r\\nautoreconf: configure.ac: not using Gettext\\r\\nautoreconf: running: aclocal --force -I m4\\r\\nautoreconf: configure.ac: tracing\\r\\nautoreconf: running: glibtoolize --copy --force\\r\\nglibtoolize: putting auxiliary files in '.'.\\r\\nglibtoolize: copying file './ltmain.sh'\\r\\nglibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.\\r\\nglibtoolize: copying file 'm4/libtool.m4'\\r\\nglibtoolize: copying file 'm4/ltoptions.m4'\\r\\nglibtoolize: copying file 'm4/ltsugar.m4'\\r\\nglibtoolize: copying file 'm4/ltversion.m4'\\r\\nglibtoolize: copying file 'm4/lt~obsolete.m4'\\r\\nautoreconf: running: /usr/local/Cellar/autoconf/2.69/bin/autoconf --force\\r\\nautoreconf: running: /usr/local/Cellar/autoconf/2.69/bin/autoheader --force\\r\\nautoreconf: running: automake --add-missing --copy --force-missing\\r\\nconfigure.ac:58: installing './compile'\\r\\nconfigure.ac:6: installing './missing'\\r\\nsample/Makefile.am: installing './depcomp'\\r\\nautoreconf: Leaving directory `.'\\r\\n$ \\r\\n```\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_223", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"223\", \"title\": \"Respect $(libdir) in test suite\", \"author\": \"Arfrever\", \"labels\": [], \"description\": \"When `configure` was called with `--libdir=...` (e.g. `--libdir=/usr/lib64`), test suite still uses hardcoded `$(prefix)/lib`.\\r\\n\\r\\nWhen `/usr/lib` contains 32-bit libraries and `/usr/lib64` contains 64-bit libraries and `-L/usr/lib` is used during building of 64-bit executables, then GNU linkers print only warnings, but LLD linker reports errors, as seen in:\\r\\nhttps://bugs.gentoo.org/737194\\r\\n\\r\\nFix:\\r\\n```\\r\\n--- sample/Makefile.am\\r\\n+++ sample/Makefile.am\\r\\n@@ -4,7 +4,7 @@\\r\\n LDADD  = $(lib_onig)\\r\\n \\r\\n AM_CFLAGS   = -Wall\\r\\n-AM_LDFLAGS  = -L$(prefix)/lib\\r\\n+AM_LDFLAGS  = -L$(libdir)\\r\\n AM_CPPFLAGS = -I$(top_srcdir)/src\\r\\n \\r\\n if ENABLE_POSIX_API\\r\\n--- test/Makefile.am\\r\\n+++ test/Makefile.am\\r\\n@@ -1,7 +1,7 @@\\r\\n ## Makefile.am for Oniguruma\\r\\n lib_onig = ../src/libonig.la\\r\\n \\r\\n-AM_LDFLAGS  = -L$(prefix)/lib\\r\\n+AM_LDFLAGS  = -L$(libdir)\\r\\n AM_CFLAGS = -Wall -Wno-invalid-source-encoding\\r\\n AM_CPPFLAGS = -I$(top_srcdir)/src\\r\\n \\r\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_226", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"226\", \"title\": \"TextMate Markdown.tmLanguage regex triggers \\\"very inefficient pattern in pattern\\\" error\", \"author\": \"ianh\", \"labels\": [], \"description\": \"The official TextMate Markdown syntax file (https://github.com/textmate/markdown.tmbundle/blob/master/Syntaxes/Markdown.tmLanguage) contains this regular expression (apparently for matching italic text):\\r\\n\\r\\n```\\r\\n(?x)\\r\\n(\\\\*|_)(?=\\\\S)                                # Open\\r\\n(?=\\r\\n    (\\r\\n        <[^>]*+>                            # HTML tags\\r\\n      | (?<raw>`+)([^`]|(?!(?<!`)\\\\k<raw>(?!`))`)*+\\\\k<raw>\\r\\n                                            # Raw\\r\\n      | \\\\\\\\[\\\\\\\\`*_{}\\\\[\\\\]()#.!+\\\\->]?+          # Escapes\\r\\n      | \\\\[\\r\\n        (               \\r\\n                (?<square>                  # Named group\\r\\n                    [^\\\\[\\\\]\\\\\\\\]               # Match most chars\\r\\n                  | \\\\\\\\.                     # Escaped chars\\r\\n                  | \\\\[ \\\\g<square>*+ \\\\]      # Nested brackets\\r\\n                )*+\\r\\n            \\\\]\\r\\n            (\\r\\n                (                           # Reference Link\\r\\n                    [ ]?                    # Optional space\\r\\n                    \\\\[[^\\\\]]*+\\\\]             # Ref name\\r\\n                )\\r\\n              | (                           # Inline Link\\r\\n                    \\\\(                      # Opening paren\\r\\n                        [ \\\\t]*+             # Optional whtiespace\\r\\n                        <?(.*?)>?           # URL\\r\\n                        [ \\\\t]*+             # Optional whtiespace\\r\\n                        (                   # Optional Title\\r\\n                            (?<title>['\\\"])\\r\\n                            (.*?)\\r\\n                            \\\\k<title>\\r\\n                        )?\\r\\n                    \\\\)\\r\\n                )\\r\\n            )\\r\\n        )\\r\\n      | \\\\1\\\\1                                # Must be bold closer\\r\\n      | (?!(?<=\\\\S)\\\\1).                      # Everything besides\\r\\n                                            # style closer\\r\\n    )++\\r\\n    (?<=\\\\S)\\\\1                               # Close\\r\\n)\\r\\n```\\r\\n\\r\\nPassing this regular expression to `onig_new()` causes the function to fail with a \\\"very inefficient pattern in pattern\\\" error.  I believe this is due to the changes in b4b5de38.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_227", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"227\", \"title\": \"Supporting python syntax\", \"author\": \"oronsh\", \"labels\": [], \"description\": \"Could be nice to add support for the python regex syntax, especially `(?P<name>)` for group names.\\r\\nIs there any plan on doing so? If not, why?\\r\\nThanks a lot\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I've been thinking about adding python syntax for a while.\\r\\nHowever, there is not much room left in the ONIG_SYN_OP2_XXX flag, so I had to put it on hold.\\r\\nIt may not be a very clean way to do it, but I will consider implementing ONIG_SYNTAX_PYTHON.\"}, {\"author\": \"oronsh\", \"body\": \"I'll be glad to help if you give me some general instructions :)\"}, {\"author\": \"oronsh\", \"body\": \"@kkos Just saw you did it all! that's amazing thank you so much, I am so happy :)\"}, {\"author\": \"kkos\", \"body\": \"Thanks for checking.\\r\\nOption (?a) does not work for ignorecase.\\r\\nIt would have been nice if I could have used the newly added option ONIG_OPTION_IGNORECASE_IS_ASCII for this purpose, but this option is only supposed to be applied to the whole regular expression, so I cannot assign it as a part of the pattern.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_228", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"228\", \"title\": \"Checksums?\", \"author\": \"muellert\", \"labels\": [], \"description\": \"Hello,\\r\\n\\r\\nit would be great if the releases could be signed, or at least checksum'ed.\\r\\nCan you please do it?\\r\\n\\r\\nThank you!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Okay.\\r\\nStarting with the next release, I will add a SHA-256 checksum file.\\r\\nI could add it to the current release, but I don't want to, since updating the release might automatically run some scripts for some people.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_229", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"229\", \"title\": \"Locale specific matching\", \"author\": \"stevensonmt\", \"labels\": [\"enhancement\"], \"description\": \"Does oniguruma follow the same locale-specific matching that PCRE2 does?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"No. Oniguruma does not have any locale dependent features.\\r\\nAnd I don't know anything about the locale related features of PCRE2.\"}, {\"author\": \"stevensonmt\", \"body\": \"See: http://www.pcre.org/current/doc/html/pcre2pattern.html#SEC10\\r\\n\\r\\n`By default, characters with values greater than 127 do not match any of the POSIX character classes, although this may be different for characters in the range 128-255 when locale-specific matching is happening.`\"}, {\"author\": \"kkos\", \"body\": \"Not only the POSIX bracket, but also the range specification in the character class seems to be affected by locale.\\r\\nIn any case, I'm not going to do anything about locale.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_230", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"230\", \"title\": \"Bug with `Syntax OPs` and `Python` syntax\", \"author\": \"oronsh\", \"labels\": [], \"description\": \"Hello, when I try to run find with this pattern (`Python` syntax with `ONIG_SYN_OP_ESC_X_BRACE_HEX8` operator or `SYNTAX_OPERATOR_VARIABLE_META_CHARACTERS` operator)\\r\\n```regex\\r\\n\\\"message\\\"\\\\s*:\\\\s*\\\"([0-9]{2,4}-[0-9]{1,2}-[0-9]{1,2} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})(?: (W[a-zA-Z0-9_\\\\-]+))?(?: ([a-zA-Z0-9_\\\\-]+))? ([0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}) ([a-zA-Z]+) ([^ ]+) ([^ ]+) ?([0-9]+) (\\\\-|[^ ]+) ([0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}) (?:(\\\\-|HTTP\\\\/[0-9]+\\\\.[0-9]+) )?(?:(\\\\-|[^ ]+) )?((?:\\\\\\\\\\\"|[^\\\"]+)+)\\\"\\r\\n```\\r\\non this text:\\r\\n```json\\r\\n{\\\"message\\\":\\\"2021-02-08 09:45:37 W3BBB ABC 10.100.20.34 GET /aaaaaaaa.aaaaaaaa - 80 - 10.100.20.8 HTTP/1.1 - - - aaaaaaaa.aaaaaaaa.com 200 0 0 408 95 139 -\\\",\\\"Site\\\":\\\"asdf\\\",\\\"ffdfoffset\\\":2353892,\\\"@version\\\":\\\"1\\\",\\\"tags\\\":[\\\"beats_input_codec_plain_applied\\\"],\\\"source\\\":\\\"L:\\\\\\\\LogFiles\\\\\\\\W3SVC5\\\\\\\\u_ex210208_x.log\\\",\\\"host\\\":\\\"NJ-App15-PRD\\\",\\\"beat\\\":{\\\"hostname\\\":\\\"asdfasdf\\\",\\\"name\\\":\\\"adfasdf\\\",\\\"version\\\":\\\"6.2.4\\\"},\\\"@timestamp\\\":\\\"2021-02-08T09:46:00.344Z\\\"}\\r\\n```\\r\\n\\r\\nIt cannot find anything, but if I don't use any syntax operators it does.\\r\\nI actually need `ONIG_SYN_OP_ESC_X_BRACE_HEX8`. \\r\\nIs this a bug?\\r\\n\\r\\nThanks a lot\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It worked as far as I tried.\\r\\n(encoding: ASCII/UTF8, syntax: DEFAULT/PYTHON, option: DEFAULT)\\r\\n\\r\\n```\\r\\nmatch at 1\\r\\n0: (1-155)\\r\\n1: (12-31)\\r\\n2: (32-37)\\r\\n3: (38-41)\\r\\n4: (42-54)\\r\\n5: (55-58)\\r\\n6: (59-77)\\r\\n7: (78-79)\\r\\n8: (80-82)\\r\\n9: (83-84)\\r\\n10: (85-96)\\r\\n11: (97-105)\\r\\n12: (106-107)\\r\\n13: (108-154)\\r\\n```\\r\\n\\r\\nI don't know how you are writing those pattern and target string on what language, so I can't say more than that.\\r\\nI wrote the pattern and string directly as literals on the C language, which required escaping with  backslashes, as shown below. (for the backslash itself and the double-quote character)\\r\\n\\r\\n```\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n#include \\\"oniguruma.h\\\"\\r\\n\\r\\nextern int main(int argc, char* argv[])\\r\\n{\\r\\n  int r;\\r\\n  unsigned char *start, *range, *end;\\r\\n  regex_t* reg;\\r\\n  OnigErrorInfo einfo;\\r\\n  OnigRegion *region;\\r\\n  OnigEncoding enc;\\r\\n  OnigEncoding use_encs[1];\\r\\n  OnigSyntaxType syntax;\\r\\n  int slen;\\r\\n\\r\\n  static UChar* pattern = (UChar* )\\\"\\\\\\\"message\\\\\\\"\\\\\\\\s*:\\\\\\\\s*\\\\\\\"([0-9]{2,4}-[0-9]{1,2}-[0-9]{1,2} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})(?: (W[a-zA-Z0-9_\\\\\\\\-]+))?(?: ([a-zA-Z0-9_\\\\\\\\-]+))? ([0-9]{1,3}\\\\\\\\.[0-9]{1,3}\\\\\\\\.[0-9]{1,3}\\\\\\\\.[0-9]{1,3}) ([a-zA-Z]+) ([^ ]+) ([^ ]+) ?([0-9]+) (\\\\\\\\-|[^ ]+) ([0-9]{1,3}\\\\\\\\.[0-9]{1,3}\\\\\\\\.[0-9]{1,3}\\\\\\\\.[0-9]{1,3}) (?:(\\\\\\\\-|HTTP\\\\\\\\/[0-9]+\\\\\\\\.[0-9]+) )?(?:(\\\\\\\\-|[^ ]+) )?((?:\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\"]+)+)\\\\\\\"\\\";\\r\\n\\r\\n  static UChar* str = (UChar* )\\\"{\\\\\\\"message\\\\\\\":\\\\\\\"2021-02-08 09:45:37 W3BBB ABC 10.100.20.34 GET /aaaaaaaa.aaaaaaaa - 80 - 10.100.20.8 HTTP/1.1 - - - aaaaaaaa.aaaaaaaa.com 200 0 0 408 95 139 -\\\\\\\",\\\\\\\"Site\\\\\\\":\\\\\\\"asdf\\\\\\\",\\\\\\\"ffdfoffset\\\\\\\":2353892,\\\\\\\"@version\\\\\\\":\\\\\\\"1\\\\\\\",\\\\\\\"tags\\\\\\\":[\\\\\\\"beats_input_codec_plain_applied\\\\\\\"],\\\\\\\"source\\\\\\\":\\\\\\\"L:\\\\\\\\\\\\\\\\LogFiles\\\\\\\\\\\\\\\\W3SVC5\\\\\\\\\\\\\\\\u_ex210208_x.log\\\\\\\",\\\\\\\"host\\\\\\\":\\\\\\\"NJ-App15-PRD\\\\\\\",\\\\\\\"beat\\\\\\\":{\\\\\\\"hostname\\\\\\\":\\\\\\\"asdfasdf\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"adfasdf\\\\\\\",\\\\\\\"version\\\\\\\":\\\\\\\"6.2.4\\\\\\\"},\\\\\\\"@timestamp\\\\\\\":\\\\\\\"2021-02-08T09:46:00.344Z\\\\\\\"}\\\";\\r\\n\\r\\n  slen = strlen((char* )str);\\r\\n\\r\\n  onig_copy_syntax(&syntax, ONIG_SYNTAX_PYTHON);\\r\\n  onig_set_syntax_op(&syntax, onig_get_syntax_op(&syntax) | ONIG_SYN_OP_ESC_X_BRACE_HEX8);\\r\\n\\r\\n  //enc = ONIG_ENCODING_ASCII;\\r\\n  enc = ONIG_ENCODING_UTF8;\\r\\n\\r\\n  use_encs[0] = enc;\\r\\n  onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n\\r\\n  r = onig_new(&reg, pattern, pattern + strlen((char* )pattern),\\r\\n        ONIG_OPTION_DEFAULT, enc, &syntax, &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  region = onig_region_new();\\r\\n\\r\\n  end   = str + slen;\\r\\n  start = end;\\r\\n  range = str;\\r\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    int i;\\r\\n\\r\\n    fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\r\\n    for (i = 0; i < region->num_regs; i++) {\\r\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\r\\n    }\\r\\n  }\\r\\n  else if (r == ONIG_MISMATCH) {\\r\\n    fprintf(stderr, \\\"search fail\\\\n\\\");\\r\\n  }\\r\\n  else { /* error */\\r\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\r\\n    onig_error_code_to_str((UChar* )s, r);\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\r\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n    onig_free(reg);\\r\\n    onig_end();\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\r\\n  onig_free(reg);\\r\\n  onig_end();\\r\\n  return 0;\\r\\n}\\r\\n```\\r\\n\"}, {\"author\": \"oronsh\", \"body\": \"Thank you so much for the detailed answer with example, it was my mistake, so very sorry for that.\\r\\nI'm using the `rust-onig` bindings and used `set_operators` which replaces `syntax->op` entirely instead of appending the bit to the existing bits.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_231", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"231\", \"title\": \"Oniguruma error: undefined group option (Python syntax with syntax op)\", \"author\": \"oronsh\", \"labels\": [], \"description\": \"Hello again.\\r\\nWhile using `Python` syntax and adding `Syntax Operator` (`ONIG_SYN_OP_ESC_X_BRACE_HEX8` but I think any of them) and using `(?P<name>...)` I'm getting the following error `Oniguruma error: undefined group option`.\\r\\nIt happens only when using the capital P syntax.\\r\\n\\r\\nMaybe I'm doing something wrong again?\\r\\nThank you!\", \"comments\": [{\"author\": \"oronsh\", \"body\": \"tried it with your example earlier, sorry for that I'm going to see what's wrong with the rust bindings.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_232", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"232\", \"title\": \"Where is a good place to ask questions? (and a little question)\", \"author\": \"oronsh\", \"labels\": [], \"description\": \"First of all thank you so much for all of your help.\\r\\nI'm working on a project to replace a service at my work from `go` to `rust` and this project relies heavily on regex.\\r\\nRust has `bindings` for `oniguruma` so I'm using that :)\\r\\nIt seems there are many differences between golang regexp to oniguruma's.\\r\\nSome things that just works out of the box in golang regexp won't in oniguruma so I guess I just need to configure the right syntax and options.\\r\\nI'm trying to debug and undertand the regexes in all of those regex debuggers online but can't find good answers.\\r\\nSo my best shot is trying here, so if you know a better place to reach for help I'd love that rather than keep asking for help in here and take your time.\\r\\nSo thank you so much, your time and help is super appreciated!\\r\\n\\r\\nI am using the `C` API (`oniguruma.h`) for testing.\\r\\nSo my current problem now is with the following pattern:\\r\\n```\\r\\n\\\"\\\\\\\"message\\\\\\\"\\\\\\\\s*:\\\\\\\\s*\\\\\\\"DT: ([^\\\\\\\\xA7]+) +\\\\\\\\xA7 *LV: ?([^\\\\\\\\xA7]+) +\\\\\\\\xA7 *(?:CID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:VSID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:SId: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:TKID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:Url: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:(?:REF|Ref): ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:IP: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:xFor: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:CSys: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:PID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:TID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:CHID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:THASH: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:REGID: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:SrcPM: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:TrgPM: ?([^\\\\\\\\xA7]+)? +\\\\\\\\xA7 *)? *(?:AHID: ?([^\\\\\\\\xA7]+)? *\\\\\\\\xA7 *)? *(?:SRC: ?([^\\\\\\\\xA7]+)? *\\\\\\\\xA7 *)? *(?:[0-9_]+ *\\\\\\\\| *)?(?:MSG|Msg): ?((?:\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"])+)? *(?:\\\\\\\\xA7 TypeIds: (\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"]+)?)? *(?:\\\\\\\\xA7 Index: (\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"]+)?)? *(?:\\\\\\\\xA7 accountHolder: (\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"]+)?)? *(?:\\\\\\\\xA7 Status Code: (\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"]+)?)? *(?:\\\\\\\\xA7 Response: (\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"]+)?)? *(?:\\\\\\\\xA7 Ex: ?((?:\\\\\\\\\\\\\\\\\\\\\\\"|[^\\\\\\\\xA7\\\\\\\"])+))?\\\\\\\"\\\"\\r\\n```\\r\\nused with the following options \\r\\n```c\\r\\n  onig_copy_syntax(&syntax, ONIG_SYNTAX_PYTHON);\\r\\n  onig_set_syntax_op(&syntax, onig_get_syntax_op(&syntax) | ONIG_SYN_OP_ESC_X_HEX2);\\r\\n```\\r\\ngetting `ERROR: invalid code point value` with `ONIG_ENCODING_UTF8` and finds nothing with `ONIG_ENCODING_ASCII`\\r\\n\\r\\nit seems like the problem is with ` +\\\\\\\\xA7`.\\r\\nIs there anything to do about it? or it something which oniguruma doesn't support?\\r\\nI can't even understand the problem.\\r\\n\\r\\nThank you so much for your help!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"\\\\xA7 does not represent a code point. It represents a single byte value.\\r\\n\\\\xA7 is clearly not correct for a UTF-8 encoding byte value of one byte length.\\r\\nIf you want to specify the code point U+00A7, you can do so by using \\\\x{A7} .\\r\\nIt is written in the documentation.\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/RE\"}, {\"author\": \"oronsh\", \"body\": \"Thank you for replying.\\r\\nNow I see that what I'm trying to do is to match pattern `\\\\xA7` to the `¬ß` char which is working fine but not working if I have a white space like: \\\" /xA7 to \\\"  ¬ß\\\".\\r\\nI could match with a white space with simple chars like \\\" ÷ø\\\\x41\\\" to \\\" A\\\"  so why a whitespace before a hex char is not working?\\r\\nI know I could use `\\\\s*\\\\xA7` but the original pattern just matches with a whitespace ` `.\\r\\nDo you know why is it working this way? Thank you!\"}, {\"author\": \"oronsh\", \"body\": \"Ok I think I got it, I just need to change all of the places with `\\\\xHH` to `\\\\x{HH}`.\\r\\nIs `\\\\x{HH}` a super set of `\\\\xHH`?\"}, {\"author\": \"kkos\", \"body\": \"When I tried, at least the following patterns resulted in errors. (UTF-8)\\r\\n(invalid code point value)\\r\\n```\\r\\n\\\"\\\\xA7\\\"\\r\\n\\\" \\\\xA7\\\"\\r\\n\\\" \\\\xA7 \\\"\\r\\n```\\r\\nCode points and encoded byte values are generally quite different.\\r\\nSince \\\\xHH is fixed to two digits, it cannot represent a code point value greater than 255, nor does it actually represent a code point value.\\r\\nThe encoded byte sequence of ¬ß is C2 A7 in UTF-8, so it must be written as \\\\xC2\\\\xA7.\\r\\nSince \\\\x{7HHHHHHH} can represent a sufficiently large value, it means a code point value.\\r\\n\\r\\nIf you have a question similar to this, wouldn't it be better to do it in Stack Overflow?\\r\\nI didn't register, though.\\r\\n\"}, {\"author\": \"oronsh\", \"body\": \"Thank you so much for the explanation, was super helpful.\\r\\nIt seems like `golang` regexp treats two digits hex value as `\\\\x{7HHHHHHH}`.\\r\\nI just converted any `\\\\xHH` into `\\\\x{HH}` in the end.\\r\\nYes it would better to ask in stack overflow. I'll ask their next time :)\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_233", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"233\", \"title\": \"Linking in Oniguruma (-lonig) breaks POSIX regex\", \"author\": \"SammyK\", \"labels\": [], \"description\": \"This issue relates to #210 and it has [been fixed](https://github.com/kkos/oniguruma/commit/f7ca475) since 6.9.5-rc1. But I'm a bit stuck on how to accommodate for older versions of Oniguruma from the perspective of shared libraries.\\r\\n\\r\\nThe core issue is that Oniguruma <= 6.9.4 will break POSIX regex when it is linked in (`-lonig`). For example:\\r\\n\\r\\n```c\\r\\n#include <regex.h>\\r\\n#include <stdio.h>\\r\\n\\r\\nint main(void)\\r\\n{\\r\\n    regex_t regex = {0};\\r\\n    regcomp(&regex, \\\"^[0-9]+:.*$\\\", REG_EXTENDED | REG_NOSUB);\\r\\n\\r\\n    const char str[] = \\\"1234:abcd\\\\n\\\";\\r\\n\\r\\n    if (regexec(&regex, str, 0, NULL, 0) == 0) {\\r\\n        fprintf(stdout, \\\"Matched.\\\\n\\\");\\r\\n    } else {\\r\\n        fprintf(stderr, \\\"Failed to match.\\\\n\\\");\\r\\n    }\\r\\n\\r\\n    regfree(&regex);\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\n```\\r\\n$ gcc test.c && ./a.out\\r\\nMatched.\\r\\n$ gcc test.c -lonig && ./a.out\\r\\nFailed to match.\\r\\n```\\r\\n\\r\\nThe bug does not seem to affect BRE, so if I change the syntax to BRE and remove `REG_EXTENDED`, the above code will work as expected when linking in Oniguruma. However, BRE returns unexpected results when using `pmatch`.\\r\\n\\r\\n```c\\r\\n#include <regex.h>\\r\\n#include <string.h>\\r\\n#include <stdio.h>\\r\\n\\r\\nint main(void)\\r\\n{\\r\\n    regex_t regex = {0};\\r\\n    regcomp(&regex, \\\"[0-9]\\\\\\\\{1,20\\\\\\\\}\\\", 0);\\r\\n\\r\\n    const char str[] = \\\"1234:abcd\\\\n\\\";\\r\\n\\r\\n    regmatch_t pmatch[1];\\r\\n    if (regexec(&regex, str, 1, pmatch, 0) == 0) {\\r\\n        char buf[64];\\r\\n\\r\\n        size_t len = (size_t)pmatch[0].rm_eo - pmatch[0].rm_so;\\r\\n        fprintf(stdout, \\\"Matched len: %zu.\\\\n\\\", len);\\r\\n        \\r\\n        memcpy(buf, str + pmatch[0].rm_so, len);\\r\\n        buf[len] = '\\\\0';\\r\\n        fprintf(stdout, \\\"Matched str: '%s'.\\\\n\\\", buf);\\r\\n    } else {\\r\\n        fprintf(stderr, \\\"Failed to match.\\\\n\\\");\\r\\n    }\\r\\n\\r\\n    regfree(&regex);\\r\\n    return 0;\\r\\n}\\r\\n```\\r\\n\\r\\n```\\r\\n$ gcc -g test_match.c && ./a.out\\r\\nMatched len: 4.\\r\\nMatched str: '1234'.\\r\\n$ gcc -g test_match.c -lonig && ./a.out\\r\\nMatched len: 18446744056529682432.\\r\\nIllegal instruction: 4\\r\\n```\\r\\n\\r\\nIn my case, I maintain a PHP extension that is always built as a shared library and is dynamically linked into a build of PHP that is often built with `-lonig` since it was [unbundled from ext/mbstring in PHP 7.4](https://www.php.net/manual/en/mbstring.installation.php). The part of the extension I'm working on is decoupled from the Zend Engine so there is no way to detect if Oniguruma has been loaded or not. I can still detect \\\"broken regex behavior\\\", but I don't know what the workaround for this issue would be.\\r\\n\\r\\nDo you have any advice for shared libraries to get POSIX regex working when they are dynamically loaded into a build with `-lonig`?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I am sorry for any inconvenience this may cause.\\r\\nHowever, since it is impossible to fix something that has been released in the past, it is difficult to deal with.\\r\\nI was able to get it working on MacOS X using the following method.\\r\\n```C\\r\\n#include <regex.h>\\r\\n#include <string.h>\\r\\n#include <stdio.h>\\r\\n#include <dlfcn.h>\\r\\n\\r\\n/* MacOS X */\\r\\n#define POSIX_REGEX_PATH   \\\"libSystem.B.dylib\\\"\\r\\n\\r\\ntypedef int regcomp_type(regex_t* preg, const char* pattern, int cflags);\\r\\ntypedef int regexec_type(const regex_t* preg, const char* string,\\r\\n                         size_t nmatch, regmatch_t pmatch[], int eflags);\\r\\ntypedef void regfree_type(regex_t *preg);\\r\\n\\r\\nint main(void)\\r\\n{\\r\\n  void* handle;\\r\\n  regcomp_type* regcomp_func;\\r\\n  regexec_type* regexec_func;\\r\\n  regfree_type* regfree_func;\\r\\n\\r\\n  regmatch_t pmatch[1];\\r\\n  regex_t regex = {0};\\r\\n  const char str[] = \\\"1234:abcd\\\\n\\\";\\r\\n\\r\\n  if ((handle = (void* )dlopen(POSIX_REGEX_PATH, RTLD_NOLOAD)) == NULL) {\\r\\n    char* e = dlerror();\\r\\n    fprintf(stderr, \\\"ERROR: dlopen: %s\\\\n\\\", e);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  regcomp_func = dlsym(handle, \\\"regcomp\\\");\\r\\n  if (regcomp_func == NULL) {\\r\\n    char* e = dlerror();\\r\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", e);\\r\\n    return -1;\\r\\n  }\\r\\n\\r\\n  if (regcomp_func == regcomp) {\\r\\n    fprintf(stdout, \\\"Use POSIX regex as is.\\\\n\\\");\\r\\n\\r\\n    regexec_func = regexec;\\r\\n    regfree_func = regfree;\\r\\n  }\\r\\n  else {\\r\\n    fprintf(stdout, \\\"Escape Oniguruma regex.\\\\n\\\");\\r\\n\\r\\n    regexec_func = dlsym(handle, \\\"regexec\\\");\\r\\n    if (regexec_func == NULL) {\\r\\n      char* e = dlerror();\\r\\n      fprintf(stderr, \\\"ERROR: %s\\\\n\\\", e);\\r\\n      return -1;\\r\\n    }\\r\\n    regfree_func = dlsym(handle, \\\"regfree\\\");\\r\\n    if (regfree_func == NULL) {\\r\\n      char* e = dlerror();\\r\\n      fprintf(stderr, \\\"ERROR: %s\\\\n\\\", e);\\r\\n      return -1;\\r\\n    }\\r\\n  }\\r\\n\\r\\n  regcomp_func(&regex, \\\"[0-9]\\\\\\\\{1,20\\\\\\\\}\\\", 0);\\r\\n\\r\\n  if (regexec_func(&regex, str, 1, pmatch, 0) == 0) {\\r\\n    char buf[64];\\r\\n\\r\\n    size_t len = (size_t)pmatch[0].rm_eo - pmatch[0].rm_so;\\r\\n    fprintf(stdout, \\\"Matched len: %zu.\\\\n\\\", len);\\r\\n        \\r\\n    memcpy(buf, str + pmatch[0].rm_so, len);\\r\\n    buf[len] = '\\\\0';\\r\\n    fprintf(stdout, \\\"Matched str: '%s'.\\\\n\\\", buf);\\r\\n  } else {\\r\\n    fprintf(stderr, \\\"Failed to match.\\\\n\\\");\\r\\n  }\\r\\n\\r\\n  regfree_func(&regex);\\r\\n  return 0;\\r\\n}\\r\\n```\\r\\n\"}, {\"author\": \"rofl0r\", \"body\": \"> Illegal instruction: 4\\r\\n\\r\\nlooks like the regmatch_t/regoff_t types you got the libc's definition of dont match the ones ONIG is using, therefore accessing the pmatch member invokes UB.\\r\\n\\r\\ni'd suggest to use the pmatch-less test you developed to check whether old onig is loaded and then do one of the following 2 things:\\r\\n\\r\\n- print an error message that onig needs to be updated to latest and abort\\r\\n- copy the definition of onig's regmatch_t and regoff_t into your code and use those from then on. that should make even old onig behave as expected. you basically need 2 different codepaths, one using the libc types and one the custom types you defined.\\r\\n\\r\\nanother alternative is to always use the onig_ prefixed version and types (using the onig header rather than regex.h) and make onig a hard dependency.\\r\\n\"}, {\"author\": \"SammyK\", \"body\": \"Thank you both for the advice and suggestions.\\r\\n\\r\\nIn our case, since we're doing some pretty basic pattern matching on small strings, the workaround we ended up going with is to match using BRE and `REG_NOSUB`. Once we have a match we can use `sscanf` or traverse the string character by character to extract the pattern.\\r\\n\\r\\nSo just to summarize for anyone else who maintains a shared lib running into this issue, some workaround options are:\\r\\n\\r\\n1. Use `dlsym` to resolve the symbols at runtime. (See @kkos's example above.)\\r\\n2. Detect broken regex behavior and fall back to copied versions of Oniguruma's `regmatch_t` and `regoff_t`; assuming you can detect that regex is broken because of Oniguruma and not some other reason. (As @rofl0r suggested.)\\r\\n3. Vendor in/have a hard dependency on Oniguruma for regex. (As @rofl0r also suggested.)\\r\\n4. Use basic regular expression (BRE) syntax with no position matching (`REG_NOSUB`) and manually extract the desired pattern from the matched string with `sscanf` or something similar.\\r\\n\\r\\nThanks again for the help!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_234", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"234\", \"title\": \"The results of a Google search for \\\"oniguruma\\\" are crazy! (in Japan)\", \"author\": \"kkos\", \"labels\": [\"status\"], \"description\": \"If you do a Google search for the keyword \\\"oniguruma\\\" you'll see some very strange results. The first few links that appear on the first page are related to the keyword oniguruma, but the rest of the pages are mostly made up of completely unrelated links. I noticed this last August. However, this may be the case only in Japan. I don't know what is going on in other parts of the world.\\r\\n\\r\\nThe rest of this article is written below.\\r\\nhttps://kkos.fc2.net/blog-entry-1.html\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The attack on Google search is still going on.\\r\\nI still don't know what it looks like outside of Japan.\\r\\nWhen I registered this Issue, the behavior changed a little, so I think the criminal is looking at this page.\"}, {\"author\": \"dbqpdb\", \"body\": \"From San Francisco:\\r\\n![Screen Shot 2021-06-03 at 19 23 22](https://user-images.githubusercontent.com/17172396/120736505-3ac99400-c4a1-11eb-919b-17f6806574d9.png)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nFor the first time, I was able to learn how things look outside of Japan.\\r\\nAt least there doesn't seem to be anything weird in the first page.\\r\\nIn my environment, a dozen or so pages of mostly irrelevant stuff are displayed.\"}, {\"author\": \"ruigazio\", \"body\": \"Portugal. Page count is under 100k instead of 1.14M\\r\\n![oniguruma](https://user-images.githubusercontent.com/13511976/120819873-e7605000-c54b-11eb-8fc9-16870c54edc9.png)\\r\\n\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"The number of searches in Japan is close to that.\\r\\nIt turns out that there will be little impact outside of Japan.\"}, {\"author\": \"andreseduardop\", \"body\": \"This is how it looks today in Colombia.\\r\\n\\r\\n![oniguruma - Google Search_P√°gina_1](https://user-images.githubusercontent.com/59033733/121084308-1d007580-c7a6-11eb-92c7-a39e0834645e.png)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Most of the unrelated pages I see here are in Japanese, so it seems to be fine for non-Japanese areas.\\r\\nIf you don't see any unfamiliar or unusual characters (Japanese characters: kanji, hiragana, etc.) within the first few pages, you should be fine.\\r\\nThis may be due to the fact that the culprits are in Japan, where they are mechanically manipulating clicks to increase their rankings.\"}, {\"author\": \"SergioInToronto\", \"body\": \"In Canada the results on Google and DuckDuckGo are similar to those posted above. Looks fine to me.\\r\\n![image](https://user-images.githubusercontent.com/66286679/121216370-d3b83080-c84e-11eb-8d4f-4de0cfcd1175.png)\\r\\n\"}, {\"author\": \"Gerst20051\", \"body\": \"The search results also look fine for me in Los Angeles, CA üëç \"}, {\"author\": \"SamuelMarks\", \"body\": \"Works fine in Sydney, Australia\"}, {\"author\": \"kanevbg\", \"body\": \"From Bulgaria:\\r\\n![image](https://user-images.githubusercontent.com/11477130/128674128-19766a7f-036e-4a6c-91ff-3e65be14aea3.png)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"I don't think so.\\r\\nEven here, the first six or seven of the first page will be the relevant pages. But after that, it's mostly filled with irrelevant pages for more than ten pages.\\r\\nIn other words, most of what comes up in a search is irrelevant links.\\r\\nIn your image, \\\"„Åô„Çã„Åì„Å®„ÄÇ7 Ë®òËºâÂÆπÈáèÔºñ„ÅØ„ÄÅÂñ∂Ê•≠Â§ñÂèéÁõä„ÅÆ„Äå„Åù„ÅÆ‰ªñ„Äç\\\" and \\\"70 Ëä±Á≤âÁô∫ÁîüÊ∫êÂØæÁ≠ñÊé®ÈÄ≤‰∫ãÊ•≠\\\" probably have nothing to do with Oniguruma.\"}, {\"author\": \"HeveraletLaidCenx\", \"body\": \"![image](https://user-images.githubusercontent.com/34192286/134486319-c44c9787-f6d3-4808-9b0c-91e2a98c781e.png)\\r\\n\\r\\n\\r\\nHi there~ Here's the result for me, seems fine? I from China and use a global network _(:3 \\r\\n\\r\\nI'm not sure if you've tried changing Google's search settingsÔºü There're sth about the **region** and  **languages for the search result** ...\\r\\n\\r\\nbtw, I used Singapore as the **region setting** (for some sorry reason what I won't to entangled in), and I set the **languages for the search result** to ÁÆÄ‰Ωì‰∏≠Êñá„ÄÅÁπÅÈ´î‰∏≠Êñá„ÄÅEnglish and Êó•Êú¨Ë™û„ÄÇ\"}, {\"author\": \"kkos\", \"body\": \"Thank you.\\r\\nI am convinced that the Japanese search results are abnormal and that the non-Japanese search results are normal.\\r\\nI just checked the contents of the two links in the previous example by @mmizutani.\\r\\n* https://www.pref.kochi.lg.jp/soshiki/170201/files/2020090400267/2013031500317_www_pref_kochi_lg_jp_uploaded_attachment_89201.pdf\\r\\n* https://www.maff.go.jp/j/budget/attach/pdf/171222_2-65.pdf\\r\\n\\r\\nNeither of them contains the strings \\\"Oniguruma\\\" or \\\"È¨ºËªä\\\", and neither of them has anything to do with Oniguruma.\\r\\nMoreover, this is the result of the first page, and the next pages are full of irrelevant links.\\r\\nAlthough @mmizutani hasn't produced a second page, I'm convinced of that from my own results.\\r\\nI have no idea about the impact of where you search.\"}, {\"author\": \"HeveraletLaidCenx\", \"body\": \"Confirmed, After I tried changing the **region** to Japan, the search results showed these ***completely unrelated*** items ... Trying to find the reason\"}, {\"author\": \"HeveraletLaidCenx\", \"body\": \"![image](https://user-images.githubusercontent.com/34192286/134498226-83e44e21-50e0-41dc-af21-962064e0fec5.png)\\r\\n\\r\\nseems changed the search options to **ÂÆåÂÖ®‰∏ÄËá¥** from  **tools** would helpÔºåand notice that most those things are **PDF Doc**Ôºü\"}, {\"author\": \"HeveraletLaidCenx\", \"body\": \"I have a guess about it... Weather is it possible that Google parsed all that content into romanization and then split it to match and lead to this...\"}, {\"author\": \"kkos\", \"body\": \"You're right, most of the irrelevant links are PDFs.\\r\\nBut not all of them, maybe 60%.\\r\\nWhen I set it to exact match, the irrelevant links disappeared.\\r\\nThat doesn't mean that the cause isn't an attack.\"}, {\"author\": \"kocoten1992\", \"body\": \"It fine from Vietnam.\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/7130705/159128261-575d5a35-7bfe-43d1-b3b1-2845bc04c04d.png)\\r\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"Zip file of screenshots ( canada, france, indonesia, Taiwan ) 9.47MB\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/234ver3.zip\"}, {\"author\": \"kkos\", \"body\": \"I looked at your search results.\\r\\nI used to think that the results only depended on the language, but now I know that it depends on the language and the location.\\r\\nIn other words, the results are terrible when you search in Japan specifying Japanese, and not so terrible otherwise.\\r\\nHowever, your search also showed that the effects of this attack are not entirely absent outside of Japan.\\r\\nSome examples are shown below.\\r\\nThese have nothing to do with Oniguruma.\\r\\nAnd these are links that I have seen many times.\\r\\n```\\r\\nfrance_ja_p6, indonesia_ja_p7, Taiwan_ja_p6\\r\\nÂÜÜË°åÊù±Ëá™Ê≤ª‰ºö - FC2\\r\\nhttps://engyouhigashi.web.fc2.com/inout-hiritu.html\\r\\n\\r\\ncanada_ja_p6, france_ja_p4, indonesia_ja_p4, Taiwan_ja_p3\\r\\nÊåÅ Á∂ö ÂèØ ËÉΩ „Å™ Âåª ÁôÇ ‰øù Èô∫ Âà∂ Â∫¶ „Çí Êßã ÁØâ „Åô „Çã „Åü „ÇÅ „ÅÆ ÂõΩ Ê∞ë ÂÅ•\\r\\nhttps://www.sangiin.go.jp/japanese/gianjoho/ketsugi/189/f069_052601.pdf\\r\\n\\r\\nfrance_ja_p6, indonesia_ja_p5, Taiwan_ja_p4\\r\\nÈ£üÂìÅÊµÅÈÄöÂêàÁêÜÂåñ‰øÉÈÄ≤‰∫ãÊ•≠\\r\\nhttps://www.maff.go.jp/j/shokusan/sijyo/info/attach/attach/pdf/sijyou_yosan2-9.pdf\\r\\n\\r\\ncanada_ja_p7, france_ja_p7, indonesia_ja_p6\\r\\n„Åä Âõ∞ „Çä „ÅÆ Êñπ „Å∏ È®í Èü≥ „ÇÑ ÊÇ™ Ëá≠ „Å™ „Å© „Åß\\r\\nhttps://www.city.tochigi-sakura.lg.jp/manage/contents/upload/61bb4ab4dbec7.pdf\\r\\n```\\r\\nIn canada_ja, p7 is more of irrelevant links.\\r\\nindonesia_ja is more of irrelevant links from p6.\\r\\nTaiwan_ja is more of irrelevant links from p4.\\r\\n\\r\\n@tonco-miyazawa,\\r\\nI would like to know what happens to the \\\"other keywords\\\" that appear below the results when I search for oniguruma and specify a time period of 24 hours or less.\\r\\nHere are the results I just ran (in Japan, in Japanese)\\r\\n<img width=\\\"673\\\" alt=\\\"Screen shot 2022-04-09 22 43 13\\\" src=\\\"https://user-images.githubusercontent.com/884169/162577103-95fa5b74-0607-4359-ae4e-e2bf494e5eb8.png\\\">\\r\\nThese bullshit words have been showing up at a high rate for nearly two years.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \" 24 hours \\\"other keywords\\\" SS\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/24hOnlyJP_20220409at23h58m.png\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/24hOnlyJP_20220410at11h17m.png\\r\\n\\r\\n-------------------------------------------------\\r\\nSS zip part2 (2.39MB)  Main: Thailand_CN\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/onig_SS2.zip\"}, {\"author\": \"kkos\", \"body\": \"@tonco-miyazawa \\r\\nI did not notice the April 15 addendum until today.\\r\\n\\r\\nI wrote a rebuttal on my blog. (In both English and Japanese.).\\r\\nhttps://kkos.fc2.net/blog-entry-2.html\\r\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"After a re-investigation, I found that my idea was wrong.\\r\\nÂÜçË™øÊüª„Çí„Åó„Åü„Å®„Åì„Çç„ÄÅÁßÅ„ÅÆËÄÉ„Åà„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åü„Åì„Å®„ÅåÂàÜ„Åã„Çä„Åæ„Åó„Åü\\r\\n\\r\\nI deleted the previous remarks.\\r\\nÁßÅ„ÅØ‰ª•Ââç„ÅÆÁô∫Ë®Ä„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü\\r\\n\\r\\nI'm sorry about that remark.\\r\\n„ÅîËø∑ÊÉë„Çí„Åä„Åã„Åë„Åó„Å¶„Åô„Åø„Åæ„Åõ„Çì„Åß„Åó„Åü\"}, {\"author\": \"Befzz\", \"body\": \"google is trying to show you most relevant information **in your language** based on your **ip / location**  or preferences(if you are signed-in)\\r\\n\\r\\nYou can ask google to show results found in other language or _multiple languages_:  \\r\\n\\r\\nhttps://www.google.com/search?q=Oniguruma&lr=lang_ja|lang_en  \\r\\n<details><summary><b>Ëã±Ë™û „Å® Êó•Êú¨Ë™û„ÅÆ„Éö„Éº„Ç∏„ÇíÊ§úÁ¥¢</b> ( „Éó„É©„Ç§„Éê„Ç∑„Éº„É¢„Éº„Éâ ) (click me)</summary>\\r\\n   \\r\\n  \\r\\n<br/>\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/1160036/204048591-47e93800-52ea-42c4-b775-f20dba98366a.png)\\r\\n</details>  \\r\\n\\r\\n```\\r\\njapanese + english:\\r\\nlr=lang_ja|lang_en \\r\\n\\r\\nenglish:\\r\\nlr=lang_en\\r\\n```\\r\\n\\r\\n?) `lang_XX`  (Ë®ÄË™ûÔºàlrÔºâ„ÅÆÂèéÈõÜÂÄ§)  \\r\\nhttps://developers.google.com/custom-search/docs/xml_results_appendices#languageCollections  \\r\\n\\r\\n?) `lr` **L**anguage **R**estriction ÔºàË®ÄË™ûÂà∂ÈôêÔºâ    \\r\\nhttps://developers.google.com/custom-search/docs/xml_results#lrsp  \\r\\n\\r\\n?) `hl` („Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπË®ÄË™û )    \\r\\nhttps://developers.google.com/custom-search/docs/xml_results#hlsp\\r\\n\\r\\n\\r\\nIMHO It is not that you \\\"attacked\\\", it is simply that keyword is less popular/cited than it's japanese counterpart.  \\r\\n\\r\\nIt is ofthen desireable to search for english results only, especially in programming...  \\r\\n\\r\\n<details><summary>You can add new search engine and make it Default (click me)  \\r\\n</summary><br/>  \\r\\n\\r\\n![image](https://user-images.githubusercontent.com/1160036/204052857-6635a3a3-8046-488e-851c-7b3877403fa9.png)  \\r\\n\\r\\n</details>\"}, {\"author\": \"kkos\", \"body\": \"@Befzz \\r\\nIf you read and understand the following two, I don't think you would make such a claim.\\r\\nhttps://kkos.fc2.net/blog-entry-1.html\\r\\nhttps://kkos.fc2.net/blog-entry-2.html\\r\\n\\r\\nI didn't want to write the same thing twice, so I wrote another article.\\r\\nhttps://kkos.fc2.net/blog-entry-3.html\"}, {\"author\": \"Adirelle\", \"body\": \"Have you taken into account the effect of the [personalized search](https://en.wikipedia.org/wiki/Personalized_search) algorithms used by Google?\"}, {\"author\": \"kkos\", \"body\": \"Did you not read my first entry?\\r\\nhttps://kkos.fc2.net/blog-entry-1.html\\r\\n> I don't think this is because Google is displaying customized results for users. The reason is that searching in Chrome's incognito mode did not make any difference. \\r\\n\\r\\nI've heard that in incognito mode (or secret mode?), the search results will not be personalized.\\r\\n\\r\\nAnd by @tonco-miyazawa \\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/onig_SS2.zip\\r\\nThe following two files in this archive show the same strange related keywords I saw.\\r\\n> Japan_aichi_JP_24h.png\\r\\n> Japan_hokkaido_JP_24h.png\\r\\n\\r\\n(* But since it is in Japanese, I don't think you would know what it is when you see it.)\"}, {\"author\": \"anuraaga\", \"body\": \"I randomly found this issue when looking up regex engines from Wikipedia. Guess advertising on front page works :)\\n\\nI was able to reproduce in Japan. More importantly my friend at Google could too. It looks like a search bug so hope it gets fixed.\\n\\nMy hypothesis is the romaji gets converted to kanji È¨ºËªä, but maybe split into two tokens È¨º and Ëªä. Especially the latter will retrieve a lot of unrelated pages, just need something like Ëªä„Åß„ÅäË∂ä„Åó„ÅÆÊñπ somewhere.\\n\\nThe issue doesn't reproduce outside Japanese because the conversion from romaji to kanji is probably disabled elsewhere.\\n\\nI suspect the attacker is a software bug and hope it gets squashed! I think we all know how hard CJK can be to get right ;)\"}, {\"author\": \"kkos\", \"body\": \"I don't think so.\\r\\nI just searched for \\\"Oniguruma\\\" and downloaded the first unrelated link (11th of all) and looked at the contents, but neither \\\"È¨º\\\" nor \\\"Ëªä\\\" existed. \\r\\nhttp://kitakyuminibas.g2.xrea.com/yamagata2018-1.pdf\\r\\n(Acrobat Reader has a search function.)\\r\\n\\r\\nBefore, I looked at the contents of some of the links in my previous response to @mmizutani's comment, but again, those letters were not there as well.\\r\\nhttps://github.com/kkos/oniguruma/issues/234#issuecomment-917637909\\r\\n\\r\\nBesides, it is not only \\\"È¨ºËªä\\\" that is troublesome to locate the word separator in Japanese, but I believe this is true for all words composed of multiple characters.\\r\\nI don't know if Google's search engine uses a morphological analyzer for Japanese, but this is irrelevant since the problem I am having is specific to the keyword \\\"Oniguruma\\\".\"}, {\"author\": \"Adirelle\", \"body\": \"Beside the how or the what, who would have an interest in such an attack and to achieve what ?\"}, {\"author\": \"kkos\", \"body\": \"I guess the goal would be to harass me.\\r\\nI have no control over this, so Google should identify and prosecute this culprit.\"}, {\"author\": \"zzak\", \"body\": \"![Screenshot 2023-01-30 at 8 17 12](https://user-images.githubusercontent.com/277819/215361290-47df081a-cdb8-4798-8578-a92616b816c2.png)\\r\\n\\r\\nHello Kosako-san, the issue seems fixed for me (from Akita). Sorry if you were impacted by this!\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"It's not fixed yet. Please see the second and subsequent pages of the search results.\\r\\nThe first page often looks normal.\\r\\nI have suggested to google several times to fix this issue but no response from google.\"}, {\"author\": \"pseudoClone\", \"body\": \"Nepal seems fine too! I assumed it was targeted for Asian countries only.\\r\\n\\r\\n![screenshot-2023-02-21_18:28:48](https://user-images.githubusercontent.com/121501193/220348079-f2e180c1-3f39-4bc5-8639-5354537c3e13.png)\\r\\n\"}, {\"author\": \"aj3423\", \"body\": \"Hi, just happened to see this, I know a little about Japanese. In Japanese, \\r\\nÈ¨º == oni == ghost (in English)\\r\\nËªä == guruma == vehicle\\r\\nI would say this name is very \\\"Japanese\\\", and I actually assumed you are Japanese in the first place just by the plugin name, I think that's why google shows different results for different countries.\"}, {\"author\": \"larouxn\", \"body\": \"Searching Google here in Japan, search results seem fine.\\r\\n![Screenshot from 2024-01-03 17-46-29](https://github.com/kkos/oniguruma/assets/1557529/e76a897e-67a7-492f-8b1a-8c2e8d98fbf7)\"}, {\"author\": \"kkos\", \"body\": \"I am aware that I have not seen any attacks since last June.\\r\\nHowever, I am not inclined to close this issue now, as I have been under attack for over three years and attacks can resume at any time.\"}, {\"author\": \"rubyFeedback\", \"body\": \"Although this issue here is about an attack on/at/via Google search, I would like to add that Google search, for\\r\\nvarious reasons - including Google internal ones - has become significantly worse in the last years.\\r\\n\\r\\nWe may have to go back to the days before Google Search in regards of adding links to e. g. oniguruma\\r\\nand other sites that should realistically be the first google search result.\\r\\n\\r\\nOn a tiny side note, I always found \\\"onig\\\" versus \\\"oniguruma\\\" a slight annoyance.\\r\\n\\r\\nE. g.:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/releases/download/v6.9.9/onig-6.9.9.tar.gz\\r\\n\\r\\nIMO it is better to use one, same name - be it onig or oniguruma I have no preference,\\r\\nbut it is weird that the project is called oniguruma, but the download then tells you\\r\\nthat the name is onig.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_235", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"235\", \"title\": \"6.9.7 can't compile with Visual Studio 2005\", \"author\": \"nmaya\", \"labels\": [], \"description\": \"https://github.com/kkos/oniguruma/blob/master/src/regparse.c#L5429\\r\\nPFETCH_READY is written at middle of block. But Visual Studio 2005 doesn't support this style.\\r\\nCould you please move it to top of block, such as line 5424?\\r\\n\\r\\nThanks,\", \"comments\": [{\"author\": \"nmaya\", \"body\": \"I confirmed https://github.com/kkos/oniguruma/commit/5adee14d43128abe8170e0e5de66c43f89df5295 fixed the error.\\r\\nThank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_236", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"236\", \"title\": \"request using tar archive dir and version numbers consistently\", \"author\": \"jonforums\", \"labels\": [], \"description\": \"The inconsistent use of version numbers complicates automated builds of oniguruma. For example, the latest source release is contained in the `onig-6.9.7.1.tar.gz` archive, but the tar's base dir is named `onig-6.9.7`.\\r\\n\\r\\nI [automate building oniguruma](https://github.com/jonforums/buildlets/blob/master/build_oniguruma.ps1) on windows using a build helper written in powershell. Oniguruma's current inconsistency [was easy to fix](https://github.com/jonforums/buildlets/commit/6209007dd3b38e25cb8a76df60c8137f778c5eca#diff-add2705c5b43facbbb28500a32461342491b11fd8d6b503f712000fed24b33eeR21-R28), but it would be nicer if the version number and the tar's base dir name were consistent. A similar issue exists for the interm `onig-?.?.?-rc?` versions.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I can't do it the hard way, so here's what I'd like to do.\\r\\n\\r\\n1. The revised version will not be released in the future.\\r\\n    No matter how small the change, always increase the version number.\\r\\n2. Change the file name of the release candidate from onig-X.Y.Z-rcN to onig-X.Y.Z.rcN.\\r\\n    Match the directory name to the file name onig-X.Y.Z.rcN. (By hand)\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"If there are no problems, the release candidate will be released with only the file name changed, so the directory name will remain onig-X.Y.Z.\"}, {\"author\": \"jonforums\", \"body\": \"I like (1) and always increasing the version number for releases instead of adding a separate \\\"revised version\\\".\\r\\n\\r\\nFor (2), what about [semver prerelease naming](https://semver.org/#spec-item-9) aka `onig-X.Y.Z-rc.N` and how [versions can be compared](https://semver.org/#spec-item-11) when using the semver scheme?\\r\\n\\r\\nWhatever change you decide to make, if any, I hope it doesn't cause you more \\\"by hand\\\" manual work.\"}, {\"author\": \"kkos\", \"body\": \"Understood.\\r\\nThe file name of the release candidate should be onig-X.Y.Z-rc.N. The directory name is the same as before, onig-X.Y.Z.\"}, {\"author\": \"jonforums\", \"body\": \"Thanks üò∏ \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_237", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"237\", \"title\": \"Variable length lookbehinds\", \"author\": \"ghost\", \"labels\": [], \"description\": \"What if variable length lookbehinds were supported through some kind of hack?\\r\\n\\r\\nHere is a possible tactic:\\r\\n* Run regex pattern tests on input text until reaching lookbehind\\r\\n* Take a substring of entire buffer until current offset position\\r\\n* Insert \\\"\\\\z\\\" into end of lookbehind assertion\\r\\n* Test that substring using lookbehind pattern with \\\\z suffix.\\r\\n* Profit!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It is already possible since version 6.9.5.\\r\\nSince it is a naive implementation, I do not recommend its use from a speed perspective.\\r\\nIf the length of the string is short, though, it won't be a big problem.\\r\\n\\r\\n\"}, {\"author\": \"ghost\", \"body\": \"Nice! It appears atom's `node-oniguruma` and microsoft's `vscode-oniguruma` supports it.\\r\\nI understand that it's not ideal, just thinking out loud in all honesty\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_238", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"238\", \"title\": \"Question: Can oniguruma load and save pre-compiled Regex objects from/to disk?\", \"author\": \"aeurielesn\", \"labels\": [], \"description\": \"I am curious if there's a cross-platform way to allow pre-compiled Regex objects to be loaded and saved to disk - that is, assuming there will be an advantage on loading time.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Unfortunately, such a feature does not exist.\\r\\nI have no plans to do so.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_239", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"239\", \"title\": \"CMake build fails to detect alloca on some platforms such as FreeBSD\", \"author\": \"diizzyy\", \"labels\": [], \"description\": \"From what I can tell this seems the \\\"proper way\\\"\\r\\nhttps://gitlab.xiph.org/xiph/opus/-/blob/master/cmake/OpusConfig.cmake#L27\\r\\n\\r\\n```\\r\\n-- Looking for alloca.h\\r\\n-- Looking for alloca.h - not found\\r\\n-- Looking for alloca\\r\\n-- Looking for alloca - found\\r\\n```\\r\\n\\r\\n...compared to\\r\\n```\\r\\n-- Looking for alloca\\r\\n-- Looking for alloca - not found\\r\\n-- Looking for include file alloca.h\\r\\n-- Looking for include file alloca.h - not found\\r\\n```\", \"comments\": [{\"author\": \"diizzyy\", \"body\": \"Awesome, thanks! Confirmed working on FreeBSD 13-STABLE\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_240", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"240\", \"title\": \"CMake build doesn't install onig-config\", \"author\": \"diizzyy\", \"labels\": [], \"description\": \"Seems to be relatively easily fixed by using configure_file in CMake\\r\\nhttps://cmake.org/cmake/help/latest/command/configure_file.html\", \"comments\": [{\"author\": \"diizzyy\", \"body\": \"Thanks for fixing this promptly!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_242", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"242\", \"title\": \"Trying to get in touch regarding a security issue\", \"author\": \"zidingz\", \"labels\": [], \"description\": \"Hey there!\\n\\nI'd like to report a security issue but cannot find contact instructions on your repository.\\n\\nIf not a hassle, might you kindly add a `SECURITY.md` file with an email, or another contact method? GitHub [recommends](https://docs.github.com/en/code-security/getting-started/adding-a-security-policy-to-your-repository) this best practice to ensure security issues are responsibly disclosed, and it would serve as a simple instruction for security researchers in the future.\\n\\nThank you for your consideration, and I look forward to hearing from you!\\n\\n(cc @huntr-helper)\", \"comments\": [{\"author\": \"kkos\", \"body\": \"SECURITY.md has been added.\"}, {\"author\": \"zidingz\", \"body\": \"Thanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_247", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"247\", \"title\": \"update Fedora install instructions?\", \"author\": \"andydna\", \"labels\": [], \"description\": \"Hi,\\r\\nI think the Fedora installation instructions need an update\\r\\nfrom\\r\\nFedora: dnf install oniguruma\\r\\nto\\r\\nFedora: dnf install oniguruma-devel\\r\\n, unless I'm misinterpreting their intent.\\r\\nThanks,\\r\\nAndy.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_249", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"249\", \"title\": \"App crashes with \\\"A heap has been corrupted\\\"\", \"author\": \"danipen\", \"labels\": [], \"description\": \"Hi dear Onuguruma creator,\\r\\n\\r\\nWhat I'm writing here is maybe a little bit out-of-topic, so sorry for that. I'd just like to kindly ask for some tip/help/advise ...\\r\\n\\r\\nI'm creating a [wrapper](https://github.com/danipen/TextMateSharp/blob/master/onigwrap/src/onigwrap.c) around your fantastic library to build [TextMateSharp](https://github.com/danipen/TextMateSharp), a grammar interpreter for C#.\\r\\n\\r\\nI'm asking you because you may help me to find or debug the issue. The problem is that we only reproduce it really very sporadically and in production environments, and that is killing us since we don't have a controlled environment to reproduce and fix. \\r\\n\\r\\n### The exception we get\\r\\n\\r\\nWhat we're seeing **only sometimes**, is the following crash:\\r\\n\\r\\n`Unhandled exception at 0x00007FFE1ABCBE99 (ntdll.dll) in winplasticx.exe.31276.dmp: 0xC0000374: A heap has been corrupted (parameters: 0x00007FFE1AC36780).`\\r\\n\\r\\nThis is the mixed stack trace:\\r\\n\\r\\n```\\r\\n \\tntdll.dll!RtlReportFatalFailure()\\r\\n \\tntdll.dll!RtlReportCriticalFailure()\\r\\n \\tntdll.dll!RtlpHeapHandleError()\\r\\n \\tntdll.dll!RtlpHpHeapHandleError()\\r\\n \\tntdll.dll!RtlpLogHeapFailure()\\r\\n \\tntdll.dll!RtlpFreeHeapInternal()\\r\\n \\tntdll.dll!RtlFreeHeap()\\r\\n \\tntdll.dll!RtlpReAllocateHeap()\\r\\n \\tntdll.dll!RtlpReAllocateHeapInternal()\\r\\n \\tntdll.dll!RtlReAllocateHeap()\\r\\n\\tonigwrap.dll!00007ffde0ebd03f()\\r\\n \\tonigwrap.dll!00007ffde0eadf62()\\r\\n \\tonigwrap.dll!00007ffde0ea4919()\\r\\n \\tonigwrap.dll!00007ffde0eb35d1()\\r\\n \\tonigwrap.dll!00007ffde0e9744c()\\r\\n \\tonigwrap.dll!00007ffde0e971da()\\r\\n \\tonigwrap.dll!00007ffde0e910af()\\r\\n \\t[Managed to Native Transition]\\t\\r\\n \\tTextMateSharp!TextMateSharp.Internal.Oniguruma.ORegex.ORegex(string pattern, bool ignoreCase, bool multiline)\\r\\n```\\r\\n\\r\\n### Some useful information\\r\\n\\r\\nWe reproduce the issue in both Windows 10 x64 and macOS platforms. Not sure if it's reproduced in Linux, but probably.\\r\\n\\r\\nThe onig-wrapper is [compiled ](https://github.com/danipen/TextMateSharp/tree/master/onigwrap)including the static version of the oniguruma library.\\r\\n\\r\\nWe have a [minidump file](https://drive.google.com/file/d/1MUeWD81E5sluYISoYUL4u3iUb9OpCLAN/view?usp=sharing) for the issue.\\r\\n\\r\\nCan you take a look at the wrapper to see if you see everything correct? I think we're getting that \\\"heap has been corrupted when doing `onig_new`: https://github.com/danipen/TextMateSharp/blob/49631c692556169a833cfccfc46c96576655d4f6/onigwrap/src/onigwrap.c#L20\\r\\n\\r\\nAnd this is how we use the wrapper from C# code:\\r\\nhttps://github.com/danipen/TextMateSharp/blob/5315ab80d6f1233ec28057d2788a5d32b7408435/src/TextMateSharp/Internal/Oniguruma/ORegex.cs\\r\\n\\r\\nThanks in advance!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"No problems were found in onigwrap.c.\\r\\nI think it's useless to generate region every time in onigwrap_search(), but it has nothing to do with the current problem.\\r\\nThis library has been tested by OSS-Fuzz for one year and nine months, so I don't think the problem will happen so easily.\\r\\nI think you need to narrow down the conditions under which the problem occurs from various perspectives, such as whether the problem occurs in single-threaded mode or only in multi-threaded mode.\"}, {\"author\": \"danipen\", \"body\": \"Thank you very much for pointing it out, I'll try to rework the region part in `onigwrap_search()`.\\r\\n\\r\\nYes! the library works perfectly. We have been extensively using it for a long time and 99.9% of the time we run without issues, but under some machine load or other circumstances, it crashes the program.\\r\\n\\r\\nI noticed that **the crash is much easier to reproduce when I launch many instances of my program at the same time** (for example 6 instances). When I do that I reproduce the issue 100% of the time.\\r\\n\\r\\nI compiled oniguruma and onigwrap libs in debug mode, and it unveiled that the last call is executed before the heap reallocation is `onig_set_callout_of_name()`. Then, the heap reallocation happens, the heap corruption is detected and the program crashes.\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/501613/154641089-abc5c778-2408-41c9-aa89-de425aa1c737.png)\\r\\n\"}, {\"author\": \"danipen\", \"body\": \"This is the log from the application verifier:\\r\\n\\r\\n```xml\\r\\n<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" standalone=\\\"no\\\"?>\\r\\n<avrf:logfile xmlns:avrf=\\\"Application Verifier\\\">\\r\\n\\t<avrf:logSession TimeStarted=\\\"2022-02-18 : 09:08:39\\\" PID=\\\"26512\\\" Version=\\\"2\\\">\\r\\n\\t\\t<avrf:logEntry Time=\\\"2022-02-18 : 09:08:56\\\" LayerName=\\\"Heaps\\\" StopCode=\\\"0x10\\\" Severity=\\\"Error\\\">\\r\\n\\t\\t\\t<avrf:message>Corrupted start stamp for heap block.</avrf:message>\\r\\n\\t\\t\\t<avrf:parameter1>1fc5cce1000 - Heap handle used in the call.</avrf:parameter1>\\r\\n\\t\\t\\t<avrf:parameter2>1fc2f968b50 - Heap block involved in the operation.</avrf:parameter2>\\r\\n\\t\\t\\t<avrf:parameter3>4b0 - Size of the heap block.</avrf:parameter3>\\r\\n\\t\\t\\t<avrf:parameter4>abcdbbbb - Corrupted stamp value.</avrf:parameter4>\\r\\n\\t\\t\\t<avrf:stackTrace>\\r\\n\\t\\t\\t\\t<avrf:trace>vrfcore!VerifierDisableVerifier+7a7 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>verifier!VerifierStopMessage+b9 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>verifier!VerifierDisableFaultInjectionExclusionRange+3730 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>verifier!VerifierDisableFaultInjectionExclusionRange+3a9a ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>verifier!VerifierCheckPageHeapAllocation+77 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>vfbasics!+7ffa89d6397e ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!_realloc_base+73 (minkernel\\\\crts\\\\ucrt\\\\src\\\\appcrt\\\\heap\\\\realloc_base.cpp @ 46)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!onig_set_callout_of_name+2a2 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!sprintf_s+859 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!onig_initialize_encoding+b1 ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!onig_reg_init+5e ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!onig_new+5a ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>onigwrap!onigwrap_create+af ( @ 0)</avrf:trace>\\r\\n\\t\\t\\t\\t<avrf:trace>????????+00007FF9A824BE85</avrf:trace>\\r\\n\\t\\t\\t</avrf:stackTrace>\\r\\n\\t\\t</avrf:logEntry>\\r\\n\\t</avrf:logSession>\\r\\n</avrf:logfile>\\r\\n```\"}, {\"author\": \"danipen\", \"body\": \"More findings: It seems to be a **multi-threading issue**. I'm able to avoid the issue if I statically lock every access to `onig_new` so **only one thread at a time calls to it.**\"}, {\"author\": \"danipen\", \"body\": \"For the moment I will workaround the issue in my code it by synchronizing the threads when creating new oniguruma regexs:\\r\\nhttps://github.com/danipen/TextMateSharp/blob/bd074b790ec58beda39a96a8b04908a0b861a578/src/TextMateSharp/Internal/Oniguruma/ORegex.cs#L33\\r\\n\\r\\nBut please, let me if you want to take a deeper dive into the issue, and/or if you need my help from my side.\"}, {\"author\": \"jkotas\", \"body\": \"> It seems to be a multi-threading issue.\\r\\n\\r\\nThe problem seems to be that `onig_set_callout_of_name` is growing `GlobalCalloutNameList` without taking any locks. Two threads trying to grow the list at the same time will lead to this heap corruption.\"}, {\"author\": \"kkos\", \"body\": \"It is true that onig_set_callout_of_name() does not support multi-threading. However, it is intended to affect all threads, so if you are in a multi-threaded environment, it is assumed that you will call it only as needed from one thread first and not use it after that, so there is no exclusive control.\\r\\nAnd onig_set_callout_of_name() is not used in onigwrap.c, so it cannot be called directly.\\r\\nHowever, I remembered that there is a place where it is called indirectly.\\r\\n\\r\\nIf the onig_initialize() function has never been called by the application, we have no choice but to call onig_initialize() in onig_new(). (I would like to stop this if possible).\\r\\nIn onig_initialize(), for a character encoding specified by an argument, the initialization function for that encoding is called, and onig_set_callout_of_name() may be executed from within it.\\r\\n\\r\\nI'm not sure if this is the cause yet, but if it is, adding the following initialization function to onigwrap.c and calling it only once from the application first (not from multiple threads at the same time) may help.\\r\\n```C\\r\\nextern int\\r\\nonigwrap_initialize()\\r\\n{\\r\\n  OnigEncoding use_encs[1];\\r\\n\\r\\n  use_encs[0] = ONIG_ENCODING_UTF16_LE;\\r\\n  return onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n}\\r\\n```\\r\\n\\r\\nEven if this is not the cause of the problem, it should be done that way. (We also call onig_initialize() in sample/simple.c etc..)\"}, {\"author\": \"danipen\", \"body\": \"@kkos thank you for the detailed information. I'll call onig_initialize() one at app level as you suggest.\\r\\n\\r\\nAdditionally, I would like to improve this ...\\r\\n> I think it's useless to generate region every time in onigwrap_search(), but it has nothing to do with the current problem.\\r\\n\\r\\nUnfortunately I didn't catch you. Could you please clarify what you exactly mean and elaborate a little bit more?\"}, {\"author\": \"kkos\", \"body\": \"You don't have to create a region for each search, you can use one region for all searches.\\r\\nIn a multi-threaded environment, one region for each thread that performs the search is sufficient.\\r\\nI don't know about C#, but there are probably thread-local variables/storage.\\r\\nBut it just means that you can reduce the number of calls to heap allocation by at most two in each search call, so if you don't mind that, you can leave it as it is.\\r\\n\\r\\n```C\\r\\n#include \\\"onigwrap.h\\\"\\r\\n\\r\\nextern int\\r\\nonigwrap_initialize()\\r\\n{\\r\\n  OnigEncoding use_encs[1];\\r\\n\\r\\n  use_encs[0] = ONIG_ENCODING_UTF16_LE;\\r\\n  return onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\r\\n}\\r\\n\\r\\nregex_t *onigwrap_create(char *pattern, int len, int ignoreCase, int multiline)\\r\\n{\\r\\n\\tregex_t *reg;\\r\\n\\r\\n\\tOnigErrorInfo einfo;\\r\\n\\r\\n\\tOnigOptionType onigOptions = ONIG_OPTION_NONE | ONIG_OPTION_CAPTURE_GROUP;\\r\\n\\r\\n\\tif (ignoreCase == 1)\\r\\n\\t\\tonigOptions |= ONIG_OPTION_IGNORECASE;\\r\\n\\r\\n\\tif (multiline == 1)\\r\\n\\t\\tonigOptions |= ONIG_OPTION_MULTILINE;\\r\\n\\r\\n\\tOnigUChar *stringStart = (OnigUChar*) pattern;\\r\\n\\tOnigUChar *stringEnd   = (OnigUChar*) pattern + len;\\r\\n\\t\\r\\n    int res = onig_new(\\r\\n        &reg,\\r\\n        stringStart,\\r\\n        stringEnd,\\r\\n        onigOptions,\\r\\n        ONIG_ENCODING_UTF16_LE,\\r\\n        ONIG_SYNTAX_DEFAULT,\\r\\n        &einfo);\\r\\n\\r\\n\\treturn reg;\\r\\n}\\r\\n\\r\\nvoid onigwrap_region_free(OnigRegion *region)\\t\\r\\n{\\r\\n\\tonig_region_free(region, 1);\\r\\n}\\r\\n\\r\\nvoid onigwrap_free(regex_t *reg)\\r\\n{\\r\\n\\tonig_free(reg);\\r\\n}\\r\\n\\r\\nint onigwrap_index_in(regex_t *reg, char *charPtr, int offset, int length, OnigRegion *region)\\r\\n{\\r\\n\\tOnigUChar *stringStart  = (OnigUChar*) charPtr;\\r\\n\\tOnigUChar *stringEnd    = (OnigUChar*) (charPtr + length);\\r\\n\\tOnigUChar *stringOffset = (OnigUChar*) (charPtr + offset);\\r\\n\\tOnigUChar *stringRange  = (OnigUChar*) stringEnd;\\r\\n\\r\\n\\tint result = onig_search(\\r\\n        reg,\\r\\n        stringStart,\\r\\n        stringEnd,\\r\\n        stringOffset,\\r\\n        stringRange,\\r\\n        region,\\r\\n        ONIG_OPTION_NONE);\\r\\n\\r\\n\\tif (result >= 0)\\r\\n\\t\\treturn result >> 1;\\r\\n\\tif (result == ONIG_MISMATCH)\\r\\n\\t\\treturn -1;\\r\\n\\treturn -2;\\r\\n}\\r\\n\\r\\nint onigwrap_search(regex_t *reg, char *charPtr, int offset, int length, OnigRegion *region)\\r\\n{\\r\\n\\tOnigUChar *stringStart  = (OnigUChar*) charPtr;\\r\\n\\tOnigUChar *stringEnd    = (OnigUChar*) (charPtr + length);\\r\\n\\tOnigUChar *stringOffset = (OnigUChar*) (charPtr + offset);\\r\\n\\tOnigUChar *stringRange  = (OnigUChar*) stringEnd;\\r\\n\\r\\n\\tint result = onig_search(reg, stringStart, stringEnd, stringOffset, stringRange, region, ONIG_OPTION_NONE);\\r\\n\\treturn result;\\r\\n}\\r\\n\\r\\nOnigRegion* onigwrap_region_new()\\r\\n{\\r\\n\\treturn onig_region_new();\\r\\n}\\r\\n\\r\\nint onigwrap_num_regs(OnigRegion *region)\\r\\n{\\r\\n\\treturn region->num_regs;\\r\\n}\\r\\n\\r\\nint onigwrap_pos(OnigRegion *region, int nth)\\r\\n{\\r\\n\\tif (nth < region->num_regs)\\r\\n\\t{\\r\\n\\t\\tint result = region->beg[nth];\\r\\n\\t\\tif (result < 0)\\r\\n\\t\\t\\treturn result;\\r\\n\\t\\treturn result >> 1;\\r\\n\\t}\\r\\n\\treturn -3;\\r\\n}\\r\\n\\r\\nint onigwrap_len(OnigRegion *region, int nth)\\r\\n{\\r\\n\\tif (nth < region->num_regs)\\r\\n\\t{\\r\\n\\t\\tint result = region->end[nth] - region->beg[nth];\\r\\n\\t\\treturn result >> 1;\\r\\n\\t}\\r\\n\\treturn -4;\\r\\n}\\r\\n```\"}, {\"author\": \"danipen\", \"body\": \"@kkos are any other library parts that are not thread-safe?\\r\\n\\r\\nIn other words... If I call `onigwrap_initialize()` at program level, do you consider safe then to remove this lock?\\r\\n\\r\\nhttps://github.com/danipen/TextMateSharp/blob/bd074b790ec58beda39a96a8b04908a0b861a578/src/TextMateSharp/Internal/Oniguruma/ORegex.cs#L33\"}, {\"author\": \"kkos\", \"body\": \"I think so.\\r\\nExcept for some initialization/setting functions and functions that manipulate regset elements, I think I've made it thread-safe.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_250", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"250\", \"title\": \"ONIG_ESCAPE_REGEX_T_COLLISION doesn't work\", \"author\": \"tavianator\", \"labels\": [], \"description\": \"I tried to `#include <oniguruma.h>` with `ONIG_ESCAPE_REGEX_T_COLLISION` defined, but it seems some prototypes still use `regex_t`:\\r\\n\\r\\n```\\r\\nIn file included from regex.c:25:\\r\\n/usr/include/oniguruma.h:834:21: error: unknown type name ‚Äòregex_t‚Äô\\r\\n  834 | int onig_regset_new P_((OnigRegSet** rset, int n, regex_t* regs[]));\\r\\n      |                     ^~\\r\\n/usr/include/oniguruma.h:836:21: error: unknown type name ‚Äòregex_t‚Äô\\r\\n  836 | int onig_regset_add P_((OnigRegSet* set, regex_t* reg));\\r\\n      |                     ^~\\r\\n/usr/include/oniguruma.h:838:25: error: unknown type name ‚Äòregex_t‚Äô\\r\\n  838 | int onig_regset_replace P_((OnigRegSet* set, int at, regex_t* reg));\\r\\n      |                         ^~\\r\\nIn file included from regex.c:25:\\r\\n/usr/include/oniguruma.h:844:1: error: unknown type name ‚Äòregex_t‚Äô\\r\\n  844 | regex_t* onig_regset_get_regex P_((OnigRegSet* set, int at));\\r\\n      | ^~~~~~~\\r\\nIn file included from regex.c:25:\\r\\n/usr/include/oniguruma.h:1003:49: error: unknown type name ‚Äòregex_t‚Äô\\r\\n 1003 | int onig_get_callout_data_by_tag_dont_clear_old P_((regex_t* reg, OnigMatchParam* mp, const OnigUChar* tag, const OnigUChar* tag_end, int slot, OnigType* type, OnigValue* val));\\r\\n      |                                                 ^~\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you very much.\\r\\nI'll fix it later today.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_251", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"251\", \"title\": \"Missing malloc failure check\", \"author\": \"tavianator\", \"labels\": [], \"description\": \"If the allocation fails here, the next line immediately dereferences a NULL pointer:\\r\\nhttps://github.com/kkos/oniguruma/blob/2b46b839c2981100a4f23513f7e767196a2324bd/src/regparse.c#L9024-L9025\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_252", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"252\", \"title\": \"question: backreference matching for the same name groups\", \"author\": \"tonco-miyazawa\", \"labels\": [], \"description\": \"add test cases\\r\\nhttps://github.com/kkos/oniguruma/commit/c8985114e0d4b5f785dca961109c00b39f259d82\\r\\n\\r\\nI added this test code.\\r\\n` x2(\\\"(?<x>x)(?<x>xx)\\\\\\\\k<x>x\\\", \\\"xxxxx\\\", 0, 5);`\\r\\n\\r\\nresult\\r\\n`FAIL: /(?<x>x)(?<x>xx)\\\\k<x>x/ 'xxxxx'  #704`\\r\\n\\r\\nIs this result  your specifications?\\r\\n\\r\\nSame question in Japanese. ( I do not understand English, sorry. )\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/blob/master/MEMO_onig/Issues/252.txt\", \"comments\": [{\"author\": \"kkos\", \"body\": \"This is inevitable because backreferences to duplicate names are achieved by a different process than the usual alternations(|). Therefore, it is a specification.\\r\\nConsider that once one of these matches is made, the other options are cut.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \">it is a specification.\\r\\n\\r\\nI understand, Thank you for answering. \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_253", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"253\", \"title\": \"Posix classes are not strict enough `[:upper:]`\", \"author\": \"RedCMD\", \"labels\": [\"specification\"], \"description\": \"Multiple posix classes can be opened at once with many left brackets `[:` and then can all be closed on the same right bracket `:]`\\r\\n\\r\\nThe below regex runs and will match all upper case letters aswell as `a`, `b`, `c` and `:`.\\r\\n![image](https://user-images.githubusercontent.com/33529441/163953290-41bab031-47f6-40ed-a91a-187119939821.png)\\r\\nNote how there are many opening brackets, but only 2 closing.\\r\\n\\r\\nAnd if posix a value is inputted in the middle, the engine breaks:\\r\\n![image](https://user-images.githubusercontent.com/33529441/163953225-08c3a4f5-2450-4e58-bf43-d4c15bac85e4.png)\\r\\nEngine also breaks if any one of the `:` gets removed\\r\\n\\r\\nInitial report from: https://github.com/microsoft/vscode-textmate/issues/165\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Aren't you going to do a little research before you make three posts?\\r\\n1) The ability to nest itself does not exist in POSIX Brackets.\\r\\n2) However, character classes can be nested.\\r\\n3) With a few exceptions (POSIX Bracket is one of them), any characters can be written in any order in the character classes.\\r\\n\\r\\nThe only thing that could be debatable would be which case would be an error when an incomplete POSIX Bracket appears.\\r\\nBut that would not be of interest to most people.\\r\\nIt is possible to change it so that it does not error at all for incomplete POSIX Brackets (i.e., it is considered just writing characters in the character class), but most people would not even notice if I did so.\"}, {\"author\": \"RedCMD\", \"body\": \"Sorry that I wasn't clear\\r\\nWhat Im trying to get at; is that certain arrangements of certain characters in and around POSIX Brackets causes them to run in unexpected ways\\r\\nI know you can nest character classes (and have multiple next to each other) `[ [] [ [] [] ] ]`\\r\\nand that POSIX Brackets do not nest (and require to be inside a character class `[ [:upper:] ]`\\r\\n\\r\\nLike for instance; I would expect the outcome of this regex to be an error `[[:::]`\\r\\nSince because the first character class has no ending bracket `]`, the POSIX class has a invalid value `:` and square brackets `[]` require backslashing to be a literal `\\\\[\\\\]`\\r\\nBut instead it unexpectly matches `[` and `:`\\r\\nRegex101.com: ![image](https://user-images.githubusercontent.com/33529441/165000627-fd124053-e1a3-4448-846e-e90e2259a5ba.png)\\r\\n\\r\\nand this rather confusing one\\r\\n`[[:\\\\]:]` matches `[`, `]` and `:`\\r\\nBut `[[:\\\\[:]` fails\\r\\nand `[[:\\\\]]` also fails\\r\\n\\r\\nBut as you said, fixing it would affect almost no one\\r\\n\\r\\nOnly reason I'm complaining about it; is so I can know if I'm able to rely on this behaviour or not\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"https://github.com/kkos/oniguruma/blob/08d36110c5670c815ad6d6f969e578049d209080/doc/RE#L214-L215\\r\\n\\r\\nIf you want to make it clear that it is not Posix class, you can use `[\\\\:` .\\r\\n\\r\\n\\r\\nThe following behavior may be a trap for anyone who does not intend to use the Posix class:\\r\\n[oniguruma/sample/callout.c](https://github.com/kkos/oniguruma/blob/master/sample/callout.c)\\r\\n`test(enc, mp, \\\"[[:]]\\\", \\\":]\\\");`\\r\\nmatch at 0\\r\\n0: (0-1)\\r\\n\\r\\n`test(enc, mp, \\\"[[::]]\\\", \\\":]\\\");`\\r\\nCOMPILE ERROR: -121: invalid POSIX bracket type\\r\\n\\r\\n`test(enc, mp, \\\"[[:::]]\\\", \\\":]\\\");`\\r\\nmatch at 0\\r\\n0: (0-2)\\r\\n\\r\\n\\r\\nEscape is effective to avoid the above behavior.\\r\\n\\r\\n`test(enc, mp, \\\"[[\\\\\\\\:]]\\\", \\\":]\\\");`\\r\\n`test(enc, mp, \\\"[[\\\\\\\\::]]\\\", \\\":]\\\");`\\r\\n`test(enc, mp, \\\"[[\\\\\\\\:::]]\\\", \\\":]\\\");`\\r\\n\\r\\nThese will have the same result.\\r\\n\\r\\nmatch at 0\\r\\n0: (0-1)\\r\\n\\r\\n---------------------------------\\r\\n\\r\\nRemarks:  Perl 5\\r\\nhttps://metacpan.org/dist/perl/view/pod/perlrecharclass.pod\\r\\n> A [ is not special inside a character class, unless it's the start of a POSIX character class (see [\\\"POSIX Character Classes\\\"](https://metacpan.org/dist/perl/view/pod/perlrecharclass.pod#POSIX-Character-Classes) below). It normally does not need escaping.\"}, {\"author\": \"kkos\", \"body\": \"There was a problem with the processing after \\\"[:\\\", so a corrected version was added as issue_253 branch.\\r\\nThe next release will not include this change, but I will include it in the release after that.\\r\\nThis change breaks compatibility, but only if the character classes contain \\\"[:\\\" and \\\":]\\\" and they do not constitute a POSIX Bracket, which is not a problem in a practical sense. I think.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"<details  open>\\n<summary>translation by google translate (August 24, 2023)</summary>\\n\\n###  Background on this issue\\n\\n1. Unlike Perl, oniguruma allows nesting of normal character classes other than Posix brackets.\\n\\n2. Posix bracket format can be interpreted as a normal character class.\\n     As a result, the boundaries in interpretation tend to be ambiguous, and they tend to be a source of confusion.\\n\\n### Proposal 1\\n\\nI think that the misspelling of the Posix class name should be treated as an error.\\n(e.g. `[[:alnun:]]` should be an error)\\n\\nIf the user is unaware of their spelling mistake, it will be interpreted character by character,\\nI feel anxious when using because unexpected matches without warning.\\n\\nBy the way, spelling mistakes in \\\\p{property-name} are errors.\\n\\nIf I use sample/callout.c and try the below code with misspelling inside `\\\\p{ }` ..\\n`test(enc, mp, \\\"\\\\\\\\p{Alnun}\\\", \\\"a\\\");`\\n\\nI get an error like:\\n`COMPILE ERROR: -223: invalid character property name {Alnun}`\\n\\nA misspelling within `\\\\p{ }` is an error, so a misspelling within Posix bracket is also an error.\\nThere is a risk that the user will be mistaken. Therefore, I think it is desirable to unify both errors.\\n\\nRedCMD did not clearly write \\\"what is the problem and how to fix it\\\".\\nFor that reason, it was difficult for Kosako(Owner) to understand his intentions.\\n\\nRedCMD didn't think \\\"Incomplete Posix bracket is an error\\\" was the problem.\\nPerhaps he was concerned about \\\"what should be an error is not an error\\\".\\n\\n(I'm reading through Google Translate, so I'm sorry if I'm wrong)\\n\\n### Proposal 2 (Postscript: This proposal was scrapped. )\\n\\nPerl plans to introduce `[= =]` and `[. .]` in the future.\\nIf these are introduced to oniguruma in the future, oniguruma will need further specification changes.\\n\\nWhile fixing issue253, If `[= =]` and `[. .]` become reserved words,\\nIt might be one less hassle in the future.\\n\\nPerl5: `[= =]` and `[. .]`\\nhttps://metacpan.org/pod/perlrecharclass#%5B=-=%5D-and-%5B.-.%5D\\n\\n>Perl recognizes the POSIX character classes `[=class=]` and `[.class.]`,\\n>but does not (yet?) support them. Any attempt to use either construct raises an exception.\\n\\nHowever, I think that it will be a long time before these are implemented in Perl.\\nEven if you keep these as reserved words in oniguruma, they will never be used and may be useless.\\nSo you don't need to do this if you don't feel the need.\\n\\n### Investigation result of boundary of Posix bracket using Perl 5.35.11\\n\\nI don't know if it will be a reference for oniguruma production, but I will put it on.\\n\\n<details>\\n<summary>(Click to view) The boundary between Posix bracket and not</summary>\\n\\nMay 13, 2022 (English translation : August 26, 2023 )\\n\\nI used the Perl 5.35.11 Development release for this research.\\nIf I got the \\\"POSIX class [: :] unknown in regex;\\\" error,\\nI decided that it was \\\"recognized as a Posix bracket\\\".\\n\\n\\n### Recognized as a normal character class\\n\\n```\\n[[:aa:]]               #  Name part is 2 characters or less\\n[[:aabbccddeeffggh:]]  #  Name part has more than 15 characters\\n[[:UPPER:]]            #  Name part is upper case\\n(?i)[[:UPPER:]]\\n[[!:upper:]]\\n[[:upper:!]]\\n[[:up!!!per:]]         #  3 or more symbols\\n[[:up!p!e!r:]]\\n[[:___upper:]]         #  3 or more underscores\\n\\n[[:aa\\\\\\\\\\\\\\\\a:]]          #  \\\"\\\\\\\" for escaping also counts as one character\\n[[:aa\\\\\\\\\\\\a:]]\\n[[:aa\\\\\\\\!a:]]\\n[[:aa]]a:]]            #  There is a ‚Äú]‚Äù and the symbol is more than 2 characters\\n[[:aa\\\\]a:]]\\n\\n[[:aa\\\\]]a:]]\\n[[:aa\\\\]\\\\]a:]]\\n[[:aa[[a:]]            #  There is a ‚Äú[‚Äù and the symbol is more than 2 characters\\n[[:aa\\\\[[a:]]\\n[[:aa\\\\[\\\\[a:]]\\n[[:upper]]             #  If you forget the trailing \\\":\\\"\\n\\n[[:aa„ÅÇ„ÅÑ„ÅÜ„Åàa:]]       #  there are 4 multibyte characters   (UTF-8)\\n[[:„ÅÇ„ÅÑ„ÅÜ„Åà„Åä:]]\\n[[::]]\\n\\n[[.abc!!!de.]]\\n[[.abc!!de.]]\\n[[.abc!de.]]\\n[[.aa\\\\_aa.]]\\n[[.aa[aa.]]\\n[[.aa\\\\[aa.]]\\n[[.aa]aa.]]\\n[[.aa\\\\]aa.]]\\n```\\n### Recognized as Posix bracket\\n\\n```\\n[[:aab:]]              #  3 to 14 characters for the name part\\n[[:upper:]]            #  Correct Posix class name\\n[[:uper:]]             #  Misspelled Posix class name\\n[[:up!per:]]           #  1 symbol\\n[[:up!!per:]]          #  2 symbol\\n[[:!upper:]]           #  symbol at the beginning of the name\\n[[:8upper:]]\\n[[:__upper:]]          #  2 underscores or less\\n[[:upper!:]]           #  symbol at the end of the name\\n[[:aa\\\\\\\\a:]]\\n[[:aa]a:]]\\n[[:aa[a:]]\\n[[:aa\\\\[a:]]\\n\\n[:aa„ÅÇa:]\\n[:aa„ÅÇ„ÅÑa:]\\n[:aa„ÅÇ„ÅÑ„ÅÜa:]\\n[:„ÅÇ„ÅÑ„ÅÜ:]\\n[:„ÅÇ„ÅÑ„ÅÜ„Åà:]\\n\\n[[.abcde.]]\\n[[._______________________________.]]       #  lots of underscores\\n[[.8888888888888888888888888888888.]]       #  lots of numbers\\n[[.BBBBBBBBBBBBBBBBBBBBBBBBBB.]]            #  lots of capital letters\\n(?i)[[.BBBBBBBBBBBBBBBBBBBBBBBBBB.]]\\n[[=abcde=]]\\n[[..]]\\n[[==]]\\n[[.aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz.]]\\n[[=aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz=]]\\n```\\n\\n###   regular expressions on Issue 253\\n\\n Unlike oniguruma, Perl does not allow normal character class nesting.\\nSo there is no point in examining how it works in Perl.\\nThe following are not worth reading.\\n\\n\\n### Recognized as a normal character class\\n\\n```\\n[[:::]                    ==  [\\\\[:::]\\n[[:::]]                   ==  [\\\\[:::]\\\\]\\n[[:\\\\]:]                   ==  [\\\\[:\\\\]:]\\n[[:\\\\[:]                   ==  [\\\\[:\\\\[:]\\n[[:upp\\\\]er:]]             ==  [\\\\[:upp\\\\]er:]\\\\]\\n[[:a[:b[:c[:upper:]]      ==  [\\\\[:a\\\\[:b\\\\[:c[:upper:]]       * Excluding [:upper:]\\n[[:a[:upper[:c[:upper:]]  ==  [\\\\[:a\\\\[:upper\\\\[:c[:upper:]]   * Excluding [:upper:]\\n```\\n\\n### Recognized as Posix bracket\\n\\n`[[:upp]er:]]           #  POSIX class [:upp]er:] unknown in regex;`\\n\\n\\n\\n* \\\"`[[:::]`\\\" was an error on the operation confirmation site \\\"Regex101.com (PCRE2?)\\\"\\n shown by RedCMD.  However, Perl 5.35.11 does not give an error.\\n\\nend.\\n-----------------------------------------------------------------------------------------\\n</details>\\n\\n* This is not the purpose of wanting the behavior of oniguruma to be exactly the same as that of Perl.\\nPerl specs change all the time, so that's pointless.\\n-------------\\nSorry for #234, I apologize again.\\n</details>\\n\\n<details>\\n<summary>Original text (written in Japanese)</summary>\\n\\n‚óè „Åì„ÅÆÂïèÈ°å„Å´„ÅÇ„ÇãËÉåÊôØ\\n\\n  1.  oniguruma „Åß„ÅØ Perl „Å®„ÅØÈÅï„ÅÑ„ÄÅ Posix bracket ‰ª•Â§ñ„ÅÆÊôÆÈÄö„ÅÆÊñáÂ≠ó„ÇØ„É©„Çπ„ÅÆÂÖ•„ÇåÂ≠ê„ÇÇË®±ÂèØ„Åï„Çå„Çã„ÄÇ\\n\\n  2.  Posix bracket „ÅÆÊõ∏Âºè„ÅØÊôÆÈÄö„ÅÆÊñáÂ≠ó„ÇØ„É©„Çπ„Å®„Åó„Å¶Ëß£Èáà„Åó„Çà„ÅÜ„Å®ÊÄù„Åà„Å∞Âá∫Êù•„Å¶„Åó„Åæ„ÅÜ„ÄÇ\\n      „Åù„ÅÆ„Åü„ÇÅËß£Èáà„Åô„Çã‰∏ä„Åß„ÅÆÂ¢ÉÁõÆ„ÅåÊõñÊòß„Å´„Å™„Çä„ÇÑ„Åô„Åè„ÄÅÊ∑∑‰π±„ÅÆÂÖÉ„Å´„Å™„Çä„ÇÑ„Åô„ÅÑ„ÄÇ\\n\\n\\n\\n\\n‚óè ÊèêÊ°à Ôºë\\n\\n  Posix class Âêç„ÅÆ„Çπ„Éö„É´„Éü„Çπ„ÅØ„Ç®„É©„Éº„Å´„Åó„Åü„Åª„ÅÜ„ÅåËâØ„ÅÑ„Å®ÊÄù„ÅÜ„ÄÇ\\n (  ‰æã„ÄÅ [[:alnun:]]   „ÅØ„Ç®„É©„Éº„Å´„Å™„Çã„Åπ„Åç )\\n\\n„É¶„Éº„Ç∂„Éº„ÅåËá™ÂàÜ„ÅÆ„Çπ„Éö„É´„Éü„Çπ„Å´Ê∞ó‰ªò„Åã„Å™„Åã„Å£„ÅüÂ†¥Âêà„ÄÅ1ÊñáÂ≠ó„Åö„Å§„Å´ÂàÜËß£„Åï„Çå„Å¶Ëß£Èáà„Åï„Çå„ÄÅ\\nË≠¶Âëä„Åô„ÇâÂá∫„Åö„Å´ÊÑèÂõ≥„Åó„Å™„ÅÑ„Éû„ÉÉ„ÉÅ„Çí„Åô„Çã„ÅÆ„ÅØÂÆüÁî®„Åô„Çã‰∏ä„ÅßÂ∞ë„Åó‰∏çÂÆâ„Å´ÊÄù„ÅÜ„ÄÇ\\n\\n\\n„Å°„Å™„Åø„Å´„ÄÅ  \\\\p{property-name}   „ÅÆ„Åª„ÅÜ„Åß„ÅØ„Çπ„Éö„É´„Éü„Çπ„ÅØ„Ç®„É©„Éº„Å´„Å™„Çã„ÄÇ\\n\\nsample/callout.c  „Çí‰Ωø„Å£„Å¶  \\\\p{ }  ÂÜÖ„Å´„Çπ„Éö„É´„Éü„Çπ„Åå„ÅÇ„Çã‰ª•‰∏ã„ÅÆ„Ç≥„Éº„Éâ„ÇíË©¶„Åô„Å®..\\n`test(enc, mp, \\\"\\\\\\\\p{Alnun}\\\", \\\"a\\\");`\\n\\n‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™„Ç®„É©„Éº„ÅåÂá∫„Çã„ÄÇ\\n`COMPILE ERROR: -223: invalid character property name {Alnun}`\\n\\n \\\\p{ }  ÂÜÖ„Åß„ÅÆ„Çπ„Éö„É´„Éü„Çπ„Åå„Ç®„É©„Éº„Å´„Å™„Çã„Åì„Å®„Å´„Çà„Çä„ÄÅ Posix bracket ÂÜÖ„Åß„ÅÆ„Çπ„Éö„É´„Éü„Çπ„ÇÇ„Ç®„É©„Éº„Å´„Å™„Çã„Å®\\n„É¶„Éº„Ç∂„Éº„ÅåÊÄù„ÅÑËæº„Çì„Åß„Åó„Åæ„ÅÜ„É™„Çπ„ÇØ„Åå„ÅÇ„Çã„ÄÇ „Å™„ÅÆ„Åß‰∏°Êñπ„Ç®„É©„Éº„ÅßÁµ±‰∏Ä„Åô„Çã„ÅÆ„ÅåÊúõ„Åæ„Åó„ÅÑ„Å®ÊÄù„ÅÜ„ÄÇ\\n\\n\\n\\nissue 253‰∏ª„Åß„ÅÇ„Çã RedCMDÊ∞è„ÅÆÊõ∏„ÅçËæº„Åø„ÅØ \\\"‰Ωï„ÅåÂïèÈ°å„Åß„Å©„ÅÜÁõ¥„Åô„Åπ„Åç„Åã\\\" „Çí„ÅØ„Å£„Åç„Çä„Å®\\nÊõ∏„ÅÑ„Å¶„Åä„Çâ„Åö„ÄÅ KosakoÊ∞è„Å´Êõ∏„ÅçËæº„Åø„ÅÆÊÑèÂõ≥„Åå‰∏äÊâã„Åè‰ºù„Çè„Å£„Å¶„ÅÑ„Å™„Åã„Å£„Åü„Çà„ÅÜ„Å´ÊÄù„ÅÜ„ÄÇ\\n\\nRedCMDÊ∞è „ÅØ  \\\"‰∏çÂÆåÂÖ®„Å™ Posix bracket „Åå„Ç®„É©„Éº„Å´„Å™„Çã\\\"  „Åì„Å®„ÇíÂïèÈ°åË¶ñ„Åó„Å¶„ÅÑ„Åü„Å®„ÅÑ„ÅÜ„Çà„Çä„ÅØ\\n  \\\"„Ç®„É©„Éº„Å´„Å™„Çã„Åπ„Åç„ÇÇ„ÅÆ„Åå„Ç®„É©„Éº„Å´„Å™„Çâ„Å™„ÅÑ\\\"  „Åì„Å®„ÇíÂïèÈ°åË¶ñ„Åó„Å¶„ÅÑ„Åü„ÅÆ„Åß„ÅØ„Å™„ÅÑ„Å†„Çç„ÅÜ„Åã„ÄÇ\\n\\n( Ëá™ÂàÜ„ÅØGoogleÁøªË®≥„ÇíÈÄö„Åó„Å¶Ë™≠„Çì„Åß„ÅÑ„Çã„ÅÆ„ÅßÈñìÈÅï„Å£„Å¶„ÅÑ„Åü„Çâ„Åî„ÇÅ„Çì„Å™„Åï„ÅÑ )\\n\\n\\n\\n\\n\\n‚óè ÊèêÊ°à Ôºí\\n\\nPerl „Åß„ÅØÂ∞ÜÊù•„ÄÅ [= ÔΩû =]  „ÇÑ  [. ÔΩû .]  „ÅÆÂ∞éÂÖ•„Åå‰∫àÂÆö„Åï„Çå„Å¶„Åä„Çä„ÄÅÂ∞ÜÊù• oniguruma „ÇÇ„Åì„Çå„Çí\\nÊé°Áî®„Åô„Çã„Å™„Çâ„Å∞Êõ¥„Å´‰ªïÊßò„ÅÆÂ§âÊõ¥„ÅåÂøÖË¶Å„Å´„Å™„Çã„ÄÇ\\n\\nissue 253 „ÅÆ‰øÆÊ≠£„ÅÆ„Å§„ÅÑ„Åß„Å´  [= ÔΩû =]  „ÇÑ  [. ÔΩû .]   „Çí‰∫àÁ¥ÑË™û„Å®„Åó„Å¶„Ç≠„Éº„Éó„Åó„Å¶„Åä„Åë„Å∞\\nÂ∞ÜÊù•„ÅÆÈù¢ÂÄí‰∫ã„ÅåÔºë„Å§Ê∏õ„Çã„Åã„ÇÇÁü•„Çå„Å™„ÅÑ„ÄÇ\\n\\n\\nPerl5:   [= =] and [. .]\\nhttps://metacpan.org/pod/perlrecharclass#%5B=-=%5D-and-%5B.-.%5D\\n\\n> Perl recognizes the POSIX character classes [=class=] and [.class.], \\n> but does not (yet?) support them. Any attempt to use either construct raises an exception.\\n\\n\\n„Åü„Å†„Åó Perl „Å´„Åì„Çå„Çâ„ÅåÂÆüË£Ö„Åï„Çå„Çã„ÅÆ„ÅØÁõ∏ÂΩìÂÖà„ÅÆË©±„Å†„Å®ÊÄù„ÅÜ„ÅÆ„Åß\\noniguruma „Å´„Åì„Çå„Çâ„Çí‰∫àÁ¥ÑË™û„Å®„Åó„Å¶„Ç≠„Éº„Éó„Åó„Å¶„ÇÇÊ∞∏ÈÅ†„Å´‰Ωø„Çè„Çå„Åö„ÄÅÁÑ°ÈßÑ„Å´„Å™„Çã„Åã„ÇÇÁü•„Çå„Åæ„Åõ„Çì„ÄÇ\\n„Å™„ÅÆ„Åß KosakoÊ∞è„ÅåÂøÖË¶ÅÊÄß„ÇíÊÑü„Åò„Å™„ÅÑ„Å™„Çâ„Å∞„Åì„Çå„ÇíÂÆüË°å„Åô„ÇãÂøÖË¶Å„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ\\n\\n\\n\\n‚óè Perl 5.35.11 „Çí‰Ωø„Å£„ÅüPosix bracket „ÅÆÂ¢ÉÁõÆ„ÅÆË™øÊüªÁµêÊûú\\n\\noniguruma Âà∂‰Ωú„ÅÆÂèÇËÄÉ„Å´„Å™„Çã„Åã„Å©„ÅÜ„ÅãÂàÜ„Åã„Çä„Åæ„Åõ„Çì„Åå‰∏ÄÂøúË≤º„Å£„Å¶„Åä„Åç„Åæ„Åô„ÄÇ\\n\\n[DOC]  oniguruma_253.doc\\nhttps://github.com/tonco-miyazawa/regex_etc/raw/master/MEMO_onig/Issues/oniguruma_253.doc\\n\\n‚Äª „Åì„Çå„ÅØ oniguruma „ÅÆÂãï‰Ωú„Çí Perl „ÅÆÊåôÂãï„Å®„Åæ„Å£„Åü„ÅèÂêå„Åò„Å´„Åó„Å¶Ê¨≤„Åó„ÅÑ„Å®„ÅÑ„ÅÜ‰∏ªÊó®„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ\\n  Perl „ÅÆ‰ªïÊßò„ÅØ„Ç≥„É≠„Ç≥„É≠Â§â„Çè„Çã„Åü„ÇÅ„Åù„Çå„ÅØÁÑ°ÊÑèÂë≥„Åß„Åô„ÄÇ\\n\\n-------------------------------------------------------------\\n#234 „Åß„ÅØ„Åô„Åø„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÅÈáç„Å≠„Å¶„ÅäË©´„Å≥„Åó„Åæ„Åô„ÄÇ\\n</details>\"}, {\"author\": \"kkos\", \"body\": \"It would be nice to make spelling errors an error.\\r\\nThe question is, however, to what extent is POSIX bracket misspelled.\\r\\n(1) All cases where \\\"[:\\\" and \\\":]\\\" pairs appear.\\r\\n    ex.  \\\"[:a%bc2:]\\\"\\r\\n(2) When there is one or more letters between a pair of \\\"[:\\\" and \\\":]\\\", all of which are alphabetic.\\r\\n    ex. \\\"[:abdc:]\\\"\\r\\n\\r\\nFor my part, I would like to misspell only 2),  and  1) is not a POSIX bracket.\\r\\n\\r\\nIt would be good to reserve [= =] and [. .].\\r\\nHowever, I also would like this to only make sense if all the letters in between are alphabetic, is that ok?\\r\\nAnd I have no plans to implement [= =] and [. .] features.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"<details open>\\r\\n<summary>translation by google translate (August 23, 2023)</summary>\\r\\n\\r\\n>(1) or (2)\\r\\n\\r\\n(2) is OK.\\r\\nI think either (1) or (2) is fine.\\r\\nI think it would be nice to prevent simple spelling mistakes.\\r\\n\\r\\n>`[= =]` and `[. .]`\\r\\n\\r\\nIf you don't plan to implement these, I don't think you need a reservation, but\\r\\nIf you think you should make a reservation, please do so.\\r\\nI think it doesn't matter which one is chosen.\\r\\n\\r\\n>all the letters in between are alphabetic\\r\\n\\r\\nThis is OK. I will leave it to you to decide whether to make a reservation or not.\\r\\n\\r\\n----------------------- Added on June 2, 2022 -----------------------------\\r\\nI confirmed the operation after the correction of the `[: :]`.\\r\\nAfter the fix, the behavior was ideal. thank you very much.\\r\\n</details>\\r\\n\\r\\n<details>\\r\\n<summary>Original text (written in Japanese)</summary>\\r\\n\\r\\n> (1) or (2)\\r\\n\\r\\n (2) „Åß OK „Åß„Åô„ÄÇ\\r\\nÁßÅ„ÅØ (1) „Åß„ÇÇ (2) „Åß„ÇÇ„Å©„Å°„Çâ„Åß„ÇÇËâØ„ÅÑ„Å®ÊÄù„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ\\r\\nÂçòÁ¥î„Å™„Çπ„Éö„É´„Éü„Çπ„ÇíÈò≤„Åí„Çå„Å∞ËâØ„ÅÑ„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ\\r\\n\\r\\n> [= =] and [. .]\\r\\n\\r\\n„Åì„Çå„Çâ„ÇíÂÆüË£Ö„Åô„Çã‰∫àÂÆö„ÅåÁÑ°„ÅÑ„ÅÆ„Å™„ÇâÁßÅ„ÅØ‰∫àÁ¥Ñ„ÅåÂøÖË¶Å„Å†„Å®„ÅØÊÄù„ÅÑ„Åæ„Åõ„Çì„Åå„ÄÅ\\r\\nKosakoÊ∞è„Åå‰∫àÁ¥Ñ„Çí„Åô„Åπ„Åç„Å†„Å®ÊÄù„Çè„Çå„ÇãÂ†¥Âêà„ÅØ‰∫àÁ¥Ñ„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ\\r\\nÁßÅ„ÅØ„Å©„Å°„Çâ„ÅåÈÅ∏„Å∞„Çå„Å¶„ÇÇËâØ„ÅÑ„Å®ËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇ\\r\\n\\r\\n> all the letters in between are alphabetic\\r\\n\\r\\n„Åì„Çå„Åß OK „Åß„Åô„ÄÇ ‰∫àÁ¥Ñ„Åô„Çã„Åã„Å©„ÅÜ„Åã„ÅÆÂà§Êñ≠„ÅØ KosakoÊ∞è„Å´„Åä„Åæ„Åã„ÅõËá¥„Åó„Åæ„Åô„ÄÇ\\r\\n------------------------------------ 2022/06/02 pm8 added ------------------------------------\\r\\n`[: :]` „ÅÆ‰øÆÊ≠£Âæå„ÅÆÂãï‰Ωú„ÇíÁ¢∫Ë™çËá¥„Åó„Åæ„Åó„Åü„ÄÇ\\r\\n‰øÆÊ≠£Âæå„ÅÆÂãï‰Ωú„ÅØÁêÜÊÉ≥ÁöÑ„Å™Âãï‰Ωú„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇ„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„ÄÇ\\r\\n</details>\\r\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"<details>\\n<summary>Negative form has the same result as positive form.  (Fixed)</summary>\\n\\n`test(enc, mp, \\\"[[:upper:]]\\\", \\\"a\\\");    // search fail`\\n`test(enc, mp, \\\"[[:^upper:]]\\\", \\\"a\\\");   // search fail`\\n\\n------------------ Added on June 16, 2022 ------------------\\n\\nThis bug has been fixed. Thank you for fixing.\\n`\\\\p{^ }` and` \\\\P{ }` and `\\\\P{^ }` are fine, too.\\n</details>\\n\\n------------------------------------\\n\\n### (Summary of this issue) [Added on Jan 31, 2025]\\n\\nThere was an issue with the function that determines whether a Pattern is POSIX bracket. The incorrect determination resulted in the following behavior:\\n\\n`[[:::]` is treated as `[\\\\[:::]` .\\n\\n`[[:[:[:[:upper:]]` is treated as `[\\\\[:\\\\[:\\\\[:[:upper:]]` .     /*   `[:upper:]` is a valid POSIX bracket.  */\\n\\nThese `[:` should be interpreted as the start of nesting, but due to the bug these were interpreted as 'literal string' instead.\\nThis bug was fixed just before the 6.9.8 release, but the fix was not included in 6.9.8 and was included in 6.9.9.\\n\\nThe Patterns affected by this issue are extremely rare. Below is the comment from K.Kosako (Oniguruma owner: @kkos) :\\nhttps://github.com/kkos/oniguruma/issues/253#issuecomment-1112237415\\n>This change breaks compatibility, but only if the character classes contain \\\"[:\\\" and \\\":]\\\" and they do not constitute a POSIX Bracket, which is not a problem in a practical sense. I think.\\n\\n-----------------\\nThis fix changed the boundary between invalid POSIX bracket errors and standard nested classes. (Since Oniguruma 6.9.9)\\nNested character class that do not match the following regular expressions act as a standard nested class.\\n\\n`(?x) \\\\[: \\\\^? [[:alpha:]]+ :\\\\] | \\\\[: \\\\^ :\\\\]`\\n\\n(Note) This is the current implementation, **not the specification**.\\nFor example, the following Patterns are all standard nested classes:\\n```\\n[[::]]\\n[[:::]]\\n[[:\\\\[:]]\\n[[:\\\\]:]]\\n[[:a%bc2:]]\\n[[:upper1:]]\\n(?x)[[: upper :]]             /*  Note: Equivalent to (?x)[\\\\x20:epru] .  */\\n```\\nAlso, if it matches, it is either a correct POSIX bracket or an invalid POSIX bracket error.\\nFor example, the following Patterns are all invalid POSIX bracket errors.\\n```\\n[[:^:]]\\n[[:^u:]]\\n[[:^uppers:]]\\n[[:u:]]\\n[[:uppers:]]\\n[[:upperssssssssssssssssssssssssssssssssss:]]     /*  There is no character limit.  */\\n```\\nRemarks:  `[[:alpha:]]` matches differently depending on the regex character encoding used.\\n```\\n Not Unicode Case : alphabet\\n Unicode Case     : Alphabetic (Includes U+212A etc.)\\n```\\nex. `[[:\\\\u212A:]]`\\nIn the case of `ONIG_ENCODING_UTF8` : `COMPILE ERROR: -121: invalid POSIX bracket type`\\nIn the case of `ONIG_ENCODING_ASCII` : This is a standard nested class. Equivalent to `[[\\\\:\\\\u212A\\\\:]]`\\n\\n-----------\\n\\nAbout `[. .]` and `[= =]`, There are no changes in this issue.\\nIn 6.9.10, these are still standard nested classes. These are not expected to change.\\n\\n-----------\\n\\n### About the source code\\n\\nOniguruma determines whether a nested character class enclosed by `[:` and `:]` is a POSIX bracket. Until v6.9.8, this determination was made using a function called `str_exist_check_with_esc()`. This function was a general-purpose function. This function was not dedicated to determining whether it is a POSIX bracket. Therefore, this function was not able to make a strict determination. The Patterns that caused this bug was unexpected for `str_exist_check_with_esc()`. This function could not handle Patterns in which `[:` exists between `[:` and `:]`. Therefore, it returned an incorrect result, causing  this bug in which `[:` was interpreted as a literal string.\\n\\nIn v6.9.9 and later, a dedicated function `is_posix_bracket_start()` is used to make this determination. On the other hand, `str_exist_check_with_esc()` was removed in v6.9.9 because it was not used anywhere else.\\n\\n<details>\\n<summary>(In Japanese)</summary>\\n\\nOniguruma „ÅØ `[:` „Å® `:]` „ÅßÂõ≤„Åæ„Çå„Åü„Éç„Çπ„Éà„Åï„Çå„ÅüÊñáÂ≠ó„ÇØ„É©„Çπ„ÅåPOSIX bracket„Åã„Å©„ÅÜ„Åã„ÇíÂà§Âà•„Åó„Åæ„Åô„ÄÇv6.9.8 „Åæ„Åß„ÅØ `str_exist_check_with_esc()` „Å®„ÅÑ„ÅÜÈñ¢Êï∞„Åß„Åì„ÅÆÂà§Âà•„ÇíË°å„Å£„Å¶„ÅÑ„Åæ„Åó„Åü„ÄÇ„Åì„ÅÆÈñ¢Êï∞„ÅØÊ±éÁî®ÁöÑ„Å™Èñ¢Êï∞„Åß„Åó„Åü„ÄÇ„Åì„ÅÆÈñ¢Êï∞„ÅØPOSIX bracket„Åã„Å©„ÅÜ„Åã„ÇíÂà§Âà•„Åô„Çã„Åü„ÇÅ„ÅÆÂ∞ÇÁî®„ÅÆÈñ¢Êï∞„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„Åù„ÅÆ„Åü„ÇÅ„ÄÅ„Åì„ÅÆÈñ¢Êï∞„Å´„ÅØÂé≥ÂØÜ„Å™Âà§ÂÆö„ÅåÂá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„Åì„ÅÆ„Éê„Ç∞„ÇíÁô∫Áîü„Åï„Åõ„Çã„Éë„Çø„Éº„É≥„ÅØ `str_exist_check_with_esc()` „Å´„Å®„Å£„Å¶ÊÉ≥ÂÆöÂ§ñ„ÅÆ„ÇÇ„ÅÆ„Åß„Åó„Åü„ÄÇ„Åì„ÅÆÈñ¢Êï∞„ÅØ `[:` „Å® `:]` „ÅÆÈñì„Å´ `[:` „ÅåÂ≠òÂú®„Åô„Çã„Éë„Çø„Éº„É≥„Å´ÂØæÂá¶Âá∫Êù•„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„Åù„ÅÆ„Åü„ÇÅË™§„Å£„ÅüÂà§ÂÆöÁµêÊûú„ÇíËøî„Åó„ÄÅ `[:` „Çí„É™„ÉÜ„É©„É´„Å®„Åó„Å¶Ëß£Èáà„Åô„Çã„Éê„Ç∞„ÇíÁô∫Áîü„Åï„Åõ„Åæ„Åó„Åü„ÄÇ\\n\\nv6.9.9„Åã„Çâ„ÅØ„Åì„ÅÆÂà§ÂÆö„Çí„Åô„Çã„Åü„ÇÅ„ÅÆÂ∞ÇÁî®„ÅÆÈñ¢Êï∞„ÅåÁî®ÊÑè„Åï„Çå„Åæ„Åó„Åü„ÄÇ„Åù„Çå„Åå `is_posix_bracket_start()` „Åß„Åô„ÄÇ‰∏ÄÊñπ„ÄÅ`str_exist_check_with_esc()` „ÅØ‰ªñ„ÅÆÂ†¥ÊâÄ„Åß„ÅØ‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„Å™„Åã„Å£„Åü„Åü„ÇÅ„ÄÅv6.9.9 „ÅßÂâäÈô§„Åï„Çå„Åæ„Åó„Åü„ÄÇ\\n\\n</details>\\n\\nThe bug occurs when the following conditional expression incorrectly returns `true` when it should return `false`:\\nhttps://github.com/kkos/oniguruma/blob/v6.9.8/src/regparse.c#L5398\\n\\nDue to the above incorrect judgment, '`[`' becomes a 'literal string' in the following code:\\nhttps://github.com/kkos/oniguruma/blob/v6.9.8/src/regparse.c#L6955\\n\\nBy changing the `is_posix_bracket_start()` function you can change the boundary between\\ninvalid POSIX bracket errors and standard nested classes.\\n`is_posix_bracket_start()`\\nhttps://github.com/kkos/oniguruma/blob/v6.9.9/src/regparse.c#L5170-L5204\\n\\n`str_exist_check_with_esc()`\\nhttps://github.com/kkos/oniguruma/blob/v6.9.8/src/regparse.c#L5106\\n\\nThere is one more function related to the POSIX bracket.\\n`prs_posix_bracket()`\\nhttps://github.com/kkos/oniguruma/blob/v6.9.9/src/regparse.c#L6641\\nhttps://github.com/kkos/oniguruma/blob/v6.9.8/src/regparse.c#L6561\"}, {\"author\": \"kkos\", \"body\": \"Assume the current master head is accepted.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_254", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"254\", \"title\": \"Missing file in 6.9.8 release tarball\", \"author\": \"diizzyy\", \"labels\": [], \"description\": \"sample/crnl.c is missing for some reason\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I just intentionally did not include it because it would not work correctly without changing the settings.\\r\\nI have been doing so for quite some time now and I forget the details.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_255", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"255\", \"title\": \"Test suite is not connected to CMake build\", \"author\": \"diizzyy\", \"labels\": [], \"description\": \"It would be nice if test target would work if using CMake\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I am not familiar with cmake and do not know how to do it.\"}, {\"author\": \"rofl0r\", \"body\": \"maybe the readme/documentation should state that CMake is a bonus and not officially supported.\"}, {\"author\": \"kkos\", \"body\": \"Added to generate test programs in cmake.\\r\\nIt seems that cmake's add_test() is preventing the test program from outputting stdout, and this does not suit the test programs, so I have not included add_test().\\r\\nTherefore, run the test yourself, as in the following example.\\r\\n```\\r\\n$ cmake ../onig-6.9.8\\r\\n$ make\\r\\n$ ../onig-6.9.8/test/test.sh\\r\\n```\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_256", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"256\", \"title\": \"Statistics option not available in CMake build\", \"author\": \"diizzyy\", \"labels\": [], \"description\": \"Equivalent to --with-statistics isn't  available as far as I can tell. If I read the code correctly you can also just add -DONIG_DEBUG_STATISTICS to CFLAGS to enable it? I'm also not sure if this works as expected using Autotools.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I haven't run statistics function in over a decade, so I just ran it and got a compile error.\\r\\nconfigure's -with-statistics isn't working either.\\r\\nI think these two points can be fixed, but I don't want to make changes to the master branch right now, since it is just after release.\\r\\nAs for cmake, it does not seem too difficult.\\r\\nMore importantly, I have changed the instruction code quite a bit and I wonder if this feature is outputting useful information.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_258", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"258\", \"title\": \"heap-buffer-overflow in onig_st_copy API\", \"author\": \"GHTHYS\", \"labels\": [], \"description\": \"If the old_table struct passed to the onig_st_copy API is corrupt, heap-buffer-overflow may be triggered in line 2. The reason is that `old_table->bins`'s size less than `num_bins`.\\r\\n\\r\\n```c++\\r\\n1for(i = 0; i < num_bins; i++) {\\r\\n2    new_table->bins[i] = 0;\\r\\n3    ptr = old_table->bins[i];\\r\\n4   ...\\r\\n5 }\\r\\n```\\r\\n\\r\\nThe poc file is as follows, and I use **llvm-10** and **AddressSanitizer** to build poc.\\r\\n\\r\\n```c++\\r\\n#include <stdint.h>\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include \\\"st.c\\\"\\r\\n\\r\\n/* Structure definition needed by the fuzz driver */\\r\\n\\r\\nvoid* CA_alloc_list[8] = { NULL };\\r\\nint CA_alloc_cnt = 0;\\r\\nFILE* CA_fopen_list[1] = { NULL };\\r\\nint CA_fopen_cnt = 0;\\r\\n\\r\\nint CA_func(struct st_table* old_table)\\r\\n{\\r\\n\\tonig_st_copy(old_table); \\r\\n\\treturn 0;\\r\\n}\\r\\n\\r\\n#ifdef __cplusplus\\r\\nextern \\\"C\\\" \\r\\n#endif\\r\\nint LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) \\r\\n{\\r\\n\\tsize_t CA_offset = 0, minimum_size = sizeof(struct st_table)*1+sizeof(struct st_hash_type)*1+sizeof(struct st_table_entry)*5;\\r\\n\\tif(Size <= minimum_size) {\\r\\n\\t\\tprintf(\\\"[Error]: Cannot pass size check %ld < %ld\\\\n\\\", Size, minimum_size);\\r\\n\\t\\treturn 0;\\r\\n\\t}\\r\\n\\tsize_t pt_size = (Size - minimum_size) / 7;\\r\\n\\t\\r\\n\\tstruct st_table * old_table;\\r\\n\\told_table = (struct st_table*)malloc(sizeof(struct st_table));\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) old_table;\\r\\n\\t\\tmemcpy((void *)&old_table->num_bins, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&old_table->num_entries, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\told_table->type = (struct st_hash_type*)malloc(sizeof(struct st_hash_type));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) old_table->type;\\r\\n\\t\\tmemcpy((void *)old_table->type, Data+CA_offset, sizeof(struct st_hash_type));\\r\\n\\t\\tCA_offset+=sizeof(struct st_hash_type);\\r\\n\\t\\told_table->bins=(struct st_table_entry**)malloc(sizeof(struct st_table_entry*)*5);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++]=old_table->bins;\\r\\n\\t\\tfor(int temp_CA_2 = 0; temp_CA_2 < 5; temp_CA_2++) {\\r\\n\\t\\told_table->bins[temp_CA_2] = (struct st_table_entry*)malloc(sizeof(struct st_table_entry));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) old_table->bins[temp_CA_2];\\r\\n\\t\\t\\told_table->bins[temp_CA_2]->next = NULL;\\r\\n\\t\\t\\tmemcpy((void *)&old_table->bins[temp_CA_2]->hash, Data+CA_offset, sizeof(unsigned int));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned int);\\r\\n\\t\\t\\tmemcpy((void *)&old_table->bins[temp_CA_2]->key, Data+CA_offset, sizeof(unsigned long));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned long);\\r\\n\\t\\t\\tmemcpy((void *)&old_table->bins[temp_CA_2]->record, Data+CA_offset, sizeof(unsigned long));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned long);\\r\\n\\t\\t}\\r\\n\\r\\n\\tCA_func(old_table);\\r\\n\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_alloc_cnt; CA_free_i++)\\r\\n\\t\\tfree(CA_alloc_list[CA_free_i]);\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_fopen_cnt; CA_free_i++)\\r\\n\\t\\tfclose(CA_fopen_list[CA_free_i]);\\r\\n\\tCA_alloc_cnt = 0;\\r\\n\\tCA_fopen_cnt = 0;\\r\\n\\r\\n\\treturn 0;\\r\\n}\\r\\n```\\r\\n\\r\\nThe ASAN information:\\r\\n\\r\\n```=================================================================\\r\\n=================================================================\\r\\n==3424==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6040000126b8 at pc 0x000000550759 bp 0x7ffe090d3970 sp 0x7ffe090d3968\\r\\nREAD of size 8 at 0x6040000126b8 thread T0\\r\\n    #0 0x550758 in onig_st_copy /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/st.c:373:11\\r\\n    #1 0x5528e4 in CA_func /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy.c:17:2\\r\\n    #2 0x553177 in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy.c:58:2\\r\\n    #3 0x458671 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x458671)\\r\\n    #4 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x457db5)\\r\\n    #5 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x45a057)\\r\\n    #6 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x45ad55)\\r\\n    #7 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x44970e)\\r\\n    #8 0x472552 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x472552)\\r\\n    #9 0x7fe5d20e20b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n    #10 0x41e4ad in _start (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x41e4ad)\\r\\n\\r\\n0x6040000126b8 is located 0 bytes to the right of 40-byte region [0x604000012690,0x6040000126b8)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x51e1dd in malloc (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x51e1dd)\\r\\n    #1 0x552c20 in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy.c:44:44\\r\\n    #2 0x458671 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x458671)\\r\\n    #3 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x457db5)\\r\\n    #4 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x45a057)\\r\\n    #5 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x45ad55)\\r\\n    #6 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x44970e)\\r\\n    #7 0x472552 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_copy/CA_test-CA_default-onig_st_copy+0x472552)\\r\\n    #8 0x7fe5d20e20b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/st.c:373:11 in onig_st_copy\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c087fffa480: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fd\\r\\n  0x0c087fffa490: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd\\r\\n  0x0c087fffa4a0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd\\r\\n  0x0c087fffa4b0: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fa\\r\\n  0x0c087fffa4c0: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fd\\r\\n=>0x0c087fffa4d0: fa fa 00 00 00 00 00[fa]fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa4e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa4f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa500: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa510: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa520: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n  Left alloca redzone:     ca\\r\\n  Right alloca redzone:    cb\\r\\n  Shadow gap:              cc\\r\\n==3424==ABORTING\\r\\nMS: 1 CrossOver-; base unit: adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\\r\\n0xbe,0x3,0xa,0x0,0x0,0x0,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0x8a,0xa,0x8a,0xa,0xa,0xa,0x8a,0xa,0x8a,0xa,0xa,0x8a,0x8a,0x8a,0xa,0x8a,0xa,0x0,0x0,0xa,0x0,0x0,0x0,0xa,0x0,0x0,0xa,0x0,0x0,0x0,0x0,0xa,0x0,0xa,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,0x0,0xa,0x0,0x0,0x0,0x0,0xa,0x0,0x0,0x0,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x8a,0xa,0xa,0xa,0x8a,0x8a,0x8a,0xa,0xa,0xa,0xa,0x8a,0x8a,0xa,0x8a,0xa,0xa,0xa,0x8a,0xa,0x8a,0xa,0xa,0x8a,0x8a,0x8a,0x8a,0xa,0x8a,0xa,0xa,0x8a,0xa,0xa,0x3b,0xa,0x3b,0xa,0xa,0xa,0x3b,0xa,0x3b,0x3b,0x3b,0xa,0xa,0xa,0x3b,0xa,0x8a,0x8a,0x8a,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0xff,0xf5,0xa,0x0,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0x0,0xa,0x0,0x0,0x0,0xa,0x0,0xa,0x0,0xa,0x0,0xa,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,\\r\\n\\\\xbe\\\\x03\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x8a\\\\x8a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x8a\\\\x8a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x0a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x8a\\\\x8a\\\\x8a\\\\x8a\\\\x0a\\\\x8a\\\\x0a\\\\x0a\\\\x8a\\\\x0a\\\\x0a;\\\\x0a;\\\\x0a\\\\x0a\\\\x0a;\\\\x0a;;;\\\\x0a\\\\x0a\\\\x0a;\\\\x0a\\\\x8a\\\\x8a\\\\x8a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\xff\\\\xf5\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\r\\nartifact_prefix='./'; Test unit written to ./crash-fc9cbd4cd551d4921ee37045d720d19f63de3ca2\\r\\nBase64: vgMKAAAACgoACgoKCooKigoKCooKigoKioqKCooKAAAKAAAACgAACgAAAAAKAAoAAAAAAAAAAAAAAAAACgAKAAAAAAoAAAAACgoKCgoKCgoKCooKCgqKiooKCgoKiooKigoKCooKigoKioqKigqKCgqKCgo7CjsKCgo7Cjs7OwoKCjsKioqKCgoKCgoKCgoKCgoKCgoKCgoKCgoKAAoKCgoK//UKAAoKCgoACgoACgoKCgAKCgAKAAAACgAKAAoACgAAAAAAAAAAAAAAAA==\\r\\n```\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"t->num_bins, t->num_entries, and t->type are given random values.\\r\\nRegardless of those values, t->bins has 5 fixed memory allocations.\\r\\nThis cannot possibly work correctly.\\r\\nt->num_bins must be the number of pieces allocated to t->bins, and t->num_entries must be the number of data registered in t->bins.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_259", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"259\", \"title\": \"heap-buffer-overflow in onig_region_copy API\", \"author\": \"GHTHYS\", \"labels\": [], \"description\": \"If the `from` struct passed to the onig_region_copy API is corrupt, heap-buffer-overflow may be triggered in line 2 and line 3. The reason is that `to->beg` or `to->end`s size is less than `from->num_regs`.\\r\\n\\r\\n```c++\\r\\n  for (i = 0; i < from->num_regs; i++) {\\r\\n    to->beg[i] = from->beg[i];\\r\\n    to->end[i] = from->end[i];\\r\\n  }\\r\\n```\\r\\n\\r\\nThe poc file is as follows, and I use **llvm-10** and **AddressSanitizer** to build poc.\\r\\n\\r\\n```c++\\r\\n#include <stdint.h>\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include \\\"regint.h\\\"\\r\\n#include \\\"st.h\\\"\\r\\n#include \\\"oniguruma.h\\\"\\r\\n#include \\\"regexec.c\\\"\\r\\n\\r\\n/* Structure definition needed by the fuzz driver */\\r\\n\\r\\nvoid* CA_alloc_list[9] = { NULL };\\r\\nint CA_alloc_cnt = 0;\\r\\nFILE* CA_fopen_list[1] = { NULL };\\r\\nint CA_fopen_cnt = 0;\\r\\n\\r\\nint CA_func(struct re_registers* to,struct re_registers* from)\\r\\n{\\r\\n\\tonig_region_copy(to, from); \\r\\n\\treturn 0;\\r\\n}\\r\\n\\r\\n#ifdef __cplusplus\\r\\nextern \\\"C\\\" \\r\\n#endif\\r\\nint LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) \\r\\n{\\r\\n\\tsize_t CA_offset = 0, minimum_size = sizeof(struct re_registers)*2+sizeof(struct OnigCaptureTreeNodeStruct)*2;\\r\\n\\tif(Size <= minimum_size) {\\r\\n\\t\\tprintf(\\\"[Error]: Cannot pass size check %ld < %ld\\\\n\\\", Size, minimum_size);\\r\\n\\t\\treturn 0;\\r\\n\\t}\\r\\n\\tsize_t pt_size = (Size - minimum_size) / 8;\\r\\n\\tif (pt_size < sizeof(int) ) { return 0; }\\r\\n\\tstruct re_registers * to;\\r\\n\\tto = (struct re_registers*)malloc(sizeof(struct re_registers));\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) to;\\r\\n\\t\\tto->beg = (int *)malloc(pt_size);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) to->beg;\\r\\n\\t\\tmemcpy((void *)to->beg, Data+CA_offset, pt_size);\\r\\n\\t\\tCA_offset+=pt_size;\\r\\n\\t\\tto->end = (int *)malloc(pt_size);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) to->end;\\r\\n\\t\\tmemcpy((void *)to->end, Data+CA_offset, pt_size);\\r\\n\\t\\tCA_offset+=pt_size;\\r\\n\\t\\tmemcpy((void *)&to->allocated, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&to->num_regs, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tto->history_root = (struct OnigCaptureTreeNodeStruct*)malloc(sizeof(struct OnigCaptureTreeNodeStruct));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) to->history_root;\\r\\n\\t\\t\\tmemcpy((void *)&to->history_root->allocated, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&to->history_root->beg, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&to->history_root->end, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&to->history_root->group, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&to->history_root->num_childs, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tto->history_root->childs = NULL;\\r\\n\\tstruct re_registers * from;\\r\\n\\tfrom = (struct re_registers*)malloc(sizeof(struct re_registers));\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) from;\\r\\n\\t\\tfrom->beg = (int *)malloc(pt_size);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) from->beg;\\r\\n\\t\\tmemcpy((void *)from->beg, Data+CA_offset, pt_size);\\r\\n\\t\\tCA_offset+=pt_size;\\r\\n\\t\\tfrom->end = (int *)malloc(pt_size);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) from->end;\\r\\n\\t\\tmemcpy((void *)from->end, Data+CA_offset, pt_size);\\r\\n\\t\\tCA_offset+=pt_size;\\r\\n\\t\\tmemcpy((void *)&from->allocated, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&from->num_regs, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tfrom->history_root = (struct OnigCaptureTreeNodeStruct*)malloc(sizeof(struct OnigCaptureTreeNodeStruct));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) from->history_root;\\r\\n\\t\\t\\tmemcpy((void *)&from->history_root->allocated, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&from->history_root->beg, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&from->history_root->end, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&from->history_root->group, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tmemcpy((void *)&from->history_root->num_childs, Data+CA_offset, sizeof(int));\\r\\n\\t\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\t\\tfrom->history_root->childs = NULL;\\r\\n\\r\\n\\tCA_func(to, from);\\r\\n\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_alloc_cnt; CA_free_i++)\\r\\n\\t\\tfree(CA_alloc_list[CA_free_i]);\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_fopen_cnt; CA_free_i++)\\r\\n\\t\\tfclose(CA_fopen_list[CA_free_i]);\\r\\n\\tCA_alloc_cnt = 0;\\r\\n\\tCA_fopen_cnt = 0;\\r\\n\\r\\n\\treturn 0;\\r\\n}\\r\\n```\\r\\n\\r\\nThe ASAN information:\\r\\n\\r\\n```\\r\\nINFO: Seed: 1134923345\\r\\nINFO: Loaded 1 modules   (1623 inline 8-bit counters): 1623 [0x65c948, 0x65cf9f), \\r\\nINFO: Loaded 1 PC tables (1623 PCs): 1623 [0x60f8e0,0x615e50), \\r\\n./CA_test-CA_default-onig_region_copy: Running 1 inputs 1 time(s) each.\\r\\nRunning: crash-34b405318a88454c6fa772ccaceb54b019e1cdd3\\r\\n=================================================================\\r\\n==3820==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000000d4 at pc 0x00000054f8ff bp 0x7fff425b1290 sp 0x7fff425b1288\\r\\nREAD of size 4 at 0x6020000000d4 thread T0\\r\\n    #0 0x54f8fe in onig_region_copy /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/regexec.c:1029:18\\r\\n    #1 0x5898f4 in CA_func /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy.c:20:2\\r\\n    #2 0x58a88e in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy.c:93:2\\r\\n    #3 0x4586f1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x4586f1)\\r\\n    #4 0x443e62 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x443e62)\\r\\n    #5 0x449916 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x449916)\\r\\n    #6 0x4725d2 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x4725d2)\\r\\n    #7 0x7fb0ce83c0b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n    #8 0x41e52d in _start (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x41e52d)\\r\\n\\r\\n0x6020000000d4 is located 0 bytes to the right of 4-byte region [0x6020000000d0,0x6020000000d4)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x51e25d in malloc (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x51e25d)\\r\\n    #1 0x58a1d4 in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy.c:67:22\\r\\n    #2 0x4586f1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x4586f1)\\r\\n    #3 0x443e62 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x443e62)\\r\\n    #4 0x449916 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x449916)\\r\\n    #5 0x4725d2 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_region_copy/CA_test-CA_default-onig_region_copy+0x4725d2)\\r\\n    #6 0x7fb0ce83c0b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/regexec.c:1029:18 in onig_region_copy\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\r\\n  0x0c047fff8000: fa fa 00 00 fa fa 00 fa fa fa 00 fa fa fa 00 fa\\r\\n=>0x0c047fff8010: fa fa fd fa fa fa fd fa fa fa[04]fa fa fa 04 fa\\r\\n  0x0c047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n  Left alloca redzone:     ca\\r\\n  Right alloca redzone:    cb\\r\\n  Shadow gap:              cc\\r\\n==3820==ABORTING\\r\\n\\r\\n```\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"It's not surprising that it doesn't work correctly, since you set random values for from/to->allocated and from/to->num_regs, which have nothing to do with the actual size of the allocated from/to->beg and from/to->end.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_260", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"260\", \"title\": \"heap-buffer-overflow in onigenc_strlen_null API\", \"author\": \"GHTHYS\", \"labels\": [], \"description\": \"The API : onigenc_strlen_null missing check for pointer `p` at line 20, after execution`p += ONIGENC_MBC_ENC_LEN(enc, p);`, there may be an out-of-bounds access to the `s` array at line 7.\\r\\n\\r\\n```c++\\r\\nonigenc_strlen_null(OnigEncoding enc, const UChar* s)\\r\\n{\\r\\n  int n = 0;\\r\\n  UChar* p = (UChar* )s;\\r\\n\\r\\n  while (1) {\\r\\n  if (*p == '\\\\0') {\\r\\n      UChar* q;\\r\\n      int len = ONIGENC_MBC_MINLEN(enc);\\r\\n\\r\\n      if (len == 1) return n;\\r\\n      q = p + 1;\\r\\n      while (len > 1) {\\r\\n        if (*q != '\\\\0') break;\\r\\n        q++;\\r\\n        len--;\\r\\n      }\\r\\n      if (len == 1) return n;\\r\\n    }\\r\\n    p += ONIGENC_MBC_ENC_LEN(enc, p);\\r\\n    n++;\\r\\n  }\\r\\n```\\r\\n\\r\\nThe poc file is as follows, and I use **llvm-10** and **AddressSanitizer** to build poc.\\r\\n\\r\\n```c++\\r\\n#include <stdint.h>\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include \\\"ascii.c\\\"\\r\\n#include \\\"regenc.c\\\"\\r\\n\\r\\n/* Structure definition needed by the fuzz driver */\\r\\n\\r\\nvoid* CA_alloc_list[4] = { NULL };\\r\\nint CA_alloc_cnt = 0;\\r\\nFILE* CA_fopen_list[1] = { NULL };\\r\\nint CA_fopen_cnt = 0;\\r\\n\\r\\nint CA_func(struct OnigEncodingTypeST* enc,unsigned char* s)\\r\\n{\\r\\n\\tonigenc_strlen_null(enc, s); \\r\\n\\treturn 0;\\r\\n}\\r\\n\\r\\n#ifdef __cplusplus\\r\\nextern \\\"C\\\" \\r\\n#endif\\r\\nint LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) \\r\\n{\\r\\n\\tsize_t CA_offset = 0, minimum_size = sizeof(unsigned char)*1+sizeof(struct OnigEncodingTypeST)*1;\\r\\n\\tif(Size <= minimum_size) {\\r\\n\\t\\tprintf(\\\"[Error]: Cannot pass size check %ld < %ld\\\\n\\\", Size, minimum_size);\\r\\n\\t\\treturn 0;\\r\\n\\t}\\r\\n\\tsize_t pt_size = (Size - minimum_size) / 3;\\r\\n\\tif (pt_size < sizeof(unsigned char) || pt_size < sizeof(char) ) { return 0; }\\r\\n\\tstruct OnigEncodingTypeST * enc;\\r\\n\\tenc = (struct OnigEncodingTypeST*)malloc(sizeof(struct OnigEncodingTypeST));\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) enc;\\r\\n\\t\\tenc->name = (char *)malloc(pt_size);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) enc->name;\\r\\n\\t\\tmemcpy((void *)enc->name, Data+CA_offset, pt_size);\\r\\n\\t\\tCA_offset+=pt_size;\\r\\n\\t\\tenc->mbc_enc_len = NULL;\\r\\n\\t\\tenc->is_allowed_reverse_match = NULL;\\r\\n\\t\\tenc->is_mbc_newline = NULL;\\r\\n\\t\\tenc->is_valid_mbc_string = NULL;\\r\\n\\t\\tenc->property_name_to_ctype = NULL;\\r\\n\\t\\tenc->code_to_mbclen = NULL;\\r\\n\\t\\tenc->mbc_case_fold = NULL;\\r\\n\\t\\tenc->get_case_fold_codes_by_str = NULL;\\r\\n\\t\\tenc->apply_all_case_fold = NULL;\\r\\n\\t\\tenc->code_to_mbc = NULL;\\r\\n\\t\\tenc->get_ctype_code_range = NULL;\\r\\n\\t\\tenc->is_code_ctype = NULL;\\r\\n\\t\\tenc->init = NULL;\\r\\n\\t\\tenc->is_initialized = NULL;\\r\\n\\t\\tmemcpy((void *)&enc->index, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&enc->max_enc_len, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&enc->min_enc_len, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tenc->left_adjust_char_head = NULL;\\r\\n\\t\\tenc->mbc_to_code = NULL;\\r\\n\\t\\tmemcpy((void *)&enc->flag, Data+CA_offset, sizeof(unsigned int));\\r\\n\\t\\tCA_offset+=sizeof(unsigned int);\\r\\n\\t\\tmemcpy((void *)&enc->sb_range, Data+CA_offset, sizeof(unsigned int));\\r\\n\\t\\tCA_offset+=sizeof(unsigned int);\\r\\n\\tunsigned char * s;\\r\\n\\ts = (unsigned char *)malloc(pt_size);\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) s;\\r\\n\\tmemcpy((void *)s, Data+CA_offset, pt_size);\\r\\n\\tCA_offset+=pt_size;\\r\\n\\r\\n\\tCA_func(&OnigEncodingASCII, s);\\r\\n\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_alloc_cnt; CA_free_i++)\\r\\n\\t\\tfree(CA_alloc_list[CA_free_i]);\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_fopen_cnt; CA_free_i++)\\r\\n\\t\\tfclose(CA_fopen_list[CA_free_i]);\\r\\n\\tCA_alloc_cnt = 0;\\r\\n\\tCA_fopen_cnt = 0;\\r\\n\\r\\n\\treturn 0;\\r\\n}\\r\\n```\\r\\n\\r\\nThe ASAN information:\\r\\n\\r\\n```strlen_null crash-8383e405efc12ea92c2a7ba6d9182456e9dc4a4e \\r\\n=================================================================\\r\\n==4052==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200004ca72 at pc 0x0000005512de bp 0x7ffca1cac130 sp 0x7ffca1cac128\\r\\nREAD of size 1 at 0x60200004ca72 thread T0\\r\\n    #0 0x5512dd in onigenc_strlen_null /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/regenc.c:245:9\\r\\n    #1 0x555e34 in CA_func /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null.c:17:2\\r\\n    #2 0x55675d in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null.c:72:2\\r\\n    #3 0x458701 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x458701)\\r\\n    #4 0x457e45 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x457e45)\\r\\n    #5 0x45a0e7 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x45a0e7)\\r\\n    #6 0x45ade5 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x45ade5)\\r\\n    #7 0x44979e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x44979e)\\r\\n    #8 0x4725e2 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x4725e2)\\r\\n    #9 0x7f7a8be2c0b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n    #10 0x41e53d in _start (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x41e53d)\\r\\n\\r\\n0x60200004ca72 is located 0 bytes to the right of 2-byte region [0x60200004ca70,0x60200004ca72)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x51e26d in malloc (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x51e26d)\\r\\n    #1 0x55669c in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null.c:67:23\\r\\n    #2 0x458701 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x458701)\\r\\n    #3 0x457e45 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x457e45)\\r\\n    #4 0x45a0e7 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x45a0e7)\\r\\n    #5 0x45ade5 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x45ade5)\\r\\n    #6 0x44979e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x44979e)\\r\\n    #7 0x4725e2 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onigenc_strlen_null/CA_test-CA_default-onigenc_strlen_null+0x4725e2)\\r\\n    #8 0x7f7a8be2c0b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/regenc.c:245:9 in onigenc_strlen_null\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c04800018f0: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\\r\\n  0x0c0480001900: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\\r\\n  0x0c0480001910: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\\r\\n  0x0c0480001920: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\\r\\n  0x0c0480001930: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\\r\\n=>0x0c0480001940: fa fa fd fa fa fa fd fa fa fa 02 fa fa fa[02]fa\\r\\n  0x0c0480001950: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c0480001960: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c0480001970: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c0480001980: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c0480001990: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n  Left alloca redzone:     ca\\r\\n  Right alloca redzone:    cb\\r\\n  Shadow gap:              cc\\r\\n==4052==ABORTING\\r\\nMS: 5 CopyPart-ChangeByte-EraseBytes-CopyPart-CopyPart-; base unit: b33cf41668f62ba8193c88a70bdf3f64e6d7d325\\r\\n0x0,0x0,0x0,0xa,0xa,0xa,0xa,0xed,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0x0,0xa,0x0,0xa,0xa,0xa,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xa,0xa,0x79,0xa,0xa,0x26,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xb3,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xed,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0x0,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0x0,0xa,0x0,0x0,0xa,0x0,0x0,0x0,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0x0,0xa,0x0,0x0,0xa,0x0,0x0,0x0,0x0,0x0,\\r\\n\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\xed\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x0ay\\\\x0a\\\\x0a&\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\xb3\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\xed\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\r\\nartifact_prefix='./'; Test unit written to ./crash-2a7df39c229f289a4ad0de736223ef86fb88c3e6\\r\\nBase64: AAAACgoKCu0KCgoKCgoKCgoKCgoKCgoKCgAKCgoKCgoKCgoKCgAKAAoACgoKAAAAAAAAAAAKCnkKCiYKCgoKCgoKCgoKCgoKCgoKCgoKswoKCgoKCgoKCgoKCgrtCgoKCgoKCgoKCgoKCgoKCgoACgoKCgoKCgoKCgoACgAKAAoKCgoKCgoKCgAKCgoKCgoAAAoAAAoAAAAKCgoKCgoAAAoAAAoAAAAAAA==\\r\\n```\\r\\n\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"onigenc_strlen_null() assumes that the correct character encoding structure and the correct string in that encoding (and NULL byte sequence of min_enc_len bytes at the end) are passed.\\r\\nYour character encoding structure has NULL member functions and random values such as min_enc_len. This cannot possibly work correctly.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_261", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"261\", \"title\": \"heap-buffer-overflow in onig_st_foreach API\", \"author\": \"GHTHYS\", \"labels\": [], \"description\": \"If the `table` structure passed to the `onig_st_foreach` API is corrupt, heap-buffer-overflow may be triggered in line 3. The reason is that `table->bins`'s size is less than `table->num_bins`.If \\r\\n\\r\\n```\\r\\n1  for(i = 0; i < table->num_bins; i++) {\\r\\n2    last = 0;\\r\\n3    for(ptr = table->bins[i]; ptr != 0;) {\\r\\n4\\t\\t\\t...\\r\\n```\\r\\n\\r\\nThe poc file is as follows, and I use **llvm-10** and **AddressSanitizer** to build poc.\\r\\n\\r\\n```c++\\r\\n#include <stdint.h>\\r\\n#include <stdlib.h>\\r\\n#include <stdio.h>\\r\\n#include \\\"st.c\\\"\\r\\n\\r\\n/* Structure definition needed by the fuzz driver */\\r\\n\\r\\nvoid* CA_alloc_list[8] = { NULL };\\r\\nint CA_alloc_cnt = 0;\\r\\nFILE* CA_fopen_list[1] = { NULL };\\r\\nint CA_fopen_cnt = 0;\\r\\n\\r\\nint CA_func(struct st_table* table,unsigned long never)\\r\\n{\\r\\n\\tonig_st_cleanup_safe(table, never); \\r\\n\\treturn 0;\\r\\n}\\r\\n\\r\\n#ifdef __cplusplus\\r\\nextern \\\"C\\\" \\r\\n#endif\\r\\nint LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) \\r\\n{\\r\\n\\tsize_t CA_offset = 0, minimum_size = sizeof(unsigned long)*1+sizeof(struct st_table)*1+sizeof(struct st_hash_type)*1+sizeof(struct st_table_entry)*5;\\r\\n\\tif(Size <= minimum_size) {\\r\\n\\t\\tprintf(\\\"[Error]: Cannot pass size check %ld < %ld\\\\n\\\", Size, minimum_size);\\r\\n\\t\\treturn 0;\\r\\n\\t}\\r\\n\\tsize_t pt_size = (Size - minimum_size) / 7;\\r\\n\\t\\r\\n\\tstruct st_table * table;\\r\\n\\ttable = (struct st_table*)malloc(sizeof(struct st_table));\\r\\n\\tCA_alloc_list[CA_alloc_cnt++] = (void*) table;\\r\\n\\t\\tmemcpy((void *)&table->num_bins, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\tmemcpy((void *)&table->num_entries, Data+CA_offset, sizeof(int));\\r\\n\\t\\tCA_offset+=sizeof(int);\\r\\n\\t\\ttable->type = (struct st_hash_type*)malloc(sizeof(struct st_hash_type));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) table->type;\\r\\n\\t\\tmemcpy((void *)table->type, Data+CA_offset, sizeof(struct st_hash_type));\\r\\n\\t\\tCA_offset+=sizeof(struct st_hash_type);\\r\\n\\t\\ttable->bins=(struct st_table_entry**)malloc(sizeof(struct st_table_entry*)*5);\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++]=table->bins;\\r\\n\\t\\tfor(int temp_CA_2 = 0; temp_CA_2 < 5; temp_CA_2++) {\\r\\n\\t\\ttable->bins[temp_CA_2] = (struct st_table_entry*)malloc(sizeof(struct st_table_entry));\\r\\n\\t\\tCA_alloc_list[CA_alloc_cnt++] = (void*) table->bins[temp_CA_2];\\r\\n\\t\\t\\ttable->bins[temp_CA_2]->next = NULL;\\r\\n\\t\\t\\tmemcpy((void *)&table->bins[temp_CA_2]->hash, Data+CA_offset, sizeof(unsigned int));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned int);\\r\\n\\t\\t\\tmemcpy((void *)&table->bins[temp_CA_2]->key, Data+CA_offset, sizeof(unsigned long));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned long);\\r\\n\\t\\t\\tmemcpy((void *)&table->bins[temp_CA_2]->record, Data+CA_offset, sizeof(unsigned long));\\r\\n\\t\\t\\tCA_offset+=sizeof(unsigned long);\\r\\n\\t\\t}\\r\\n\\tunsigned long  never;\\r\\n\\tmemcpy((void *)&never, Data+CA_offset, sizeof(unsigned long));\\r\\n\\tCA_offset+=sizeof(unsigned long);\\r\\n\\r\\n\\tCA_func(table, never);\\r\\n\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_alloc_cnt; CA_free_i++)\\r\\n\\t\\tfree(CA_alloc_list[CA_free_i]);\\r\\n\\tfor(int CA_free_i = 0; CA_free_i < CA_fopen_cnt; CA_free_i++)\\r\\n\\t\\tfclose(CA_fopen_list[CA_free_i]);\\r\\n\\tCA_alloc_cnt = 0;\\r\\n\\tCA_fopen_cnt = 0;\\r\\n\\r\\n\\treturn 0;\\r\\n}\\r\\n```\\r\\n\\r\\nThe ASAN information:\\r\\n\\r\\n```\\r\\n=================================================================\\r\\n==4147==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x604000013b38 at pc 0x0000005521a9 bp 0x7ffdd6b76d90 sp 0x7ffdd6b76d88\\r\\nREAD of size 8 at 0x604000013b38 thread T0\\r\\n    #0 0x5521a8 in onig_st_foreach /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/st.c:499:15\\r\\n    #1 0x551fe9 in onig_st_cleanup_safe /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/st.c:483:3\\r\\n    #2 0x5528f4 in CA_func /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe.c:16:2\\r\\n    #3 0x55335e in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe.c:60:2\\r\\n    #4 0x458671 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x458671)\\r\\n    #5 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x457db5)\\r\\n    #6 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x45a057)\\r\\n    #7 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x45ad55)\\r\\n    #8 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x44970e)\\r\\n    #9 0x472552 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x472552)\\r\\n    #10 0x7fa08a8c90b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n    #11 0x41e4ad in _start (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x41e4ad)\\r\\n\\r\\n0x604000013b38 is located 0 bytes to the right of 40-byte region [0x604000013b10,0x604000013b38)\\r\\nallocated by thread T0 here:\\r\\n    #0 0x51e1dd in malloc (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x51e1dd)\\r\\n    #1 0x552d74 in LLVMFuzzerTestOneInput /home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe.c:43:40\\r\\n    #2 0x458671 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x458671)\\r\\n    #3 0x457db5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x457db5)\\r\\n    #4 0x45a057 in fuzzer::Fuzzer::MutateAndTestOne() (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x45a057)\\r\\n    #5 0x45ad55 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x45ad55)\\r\\n    #6 0x44970e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x44970e)\\r\\n    #7 0x472552 in main (/home/zhangzheng/Desktop/cve-libf/cve-libf/out/build_ori/API/heap-buffer-overflow/onig_st_cleanup_safe/CA_test-CA_default-onig_st_cleanup_safe+0x472552)\\r\\n    #8 0x7fa08a8c90b2 in __libc_start_main /build/glibc-sMfBJT/glibc-2.31/csu/../csu/libc-start.c:308:16\\r\\n\\r\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/zhangzheng/Desktop/cve-libf/cve-libf/build_normal/src/st.c:499:15 in onig_st_foreach\\r\\nShadow bytes around the buggy address:\\r\\n  0x0c087fffa710: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fa\\r\\n  0x0c087fffa720: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fa\\r\\n  0x0c087fffa730: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fd\\r\\n  0x0c087fffa740: fa fa fd fd fd fd fd fd fa fa fd fd fd fd fd fa\\r\\n  0x0c087fffa750: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fa\\r\\n=>0x0c087fffa760: fa fa 00 00 00 00 00[fa]fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa770: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa780: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa790: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa7a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\n  0x0c087fffa7b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\r\\nShadow byte legend (one shadow byte represents 8 application bytes):\\r\\n  Addressable:           00\\r\\n  Partially addressable: 01 02 03 04 05 06 07 \\r\\n  Heap left redzone:       fa\\r\\n  Freed heap region:       fd\\r\\n  Stack left redzone:      f1\\r\\n  Stack mid redzone:       f2\\r\\n  Stack right redzone:     f3\\r\\n  Stack after return:      f5\\r\\n  Stack use after scope:   f8\\r\\n  Global redzone:          f9\\r\\n  Global init order:       f6\\r\\n  Poisoned by user:        f7\\r\\n  Container overflow:      fc\\r\\n  Array cookie:            ac\\r\\n  Intra object redzone:    bb\\r\\n  ASan internal:           fe\\r\\n  Left alloca redzone:     ca\\r\\n  Right alloca redzone:    cb\\r\\n  Shadow gap:              cc\\r\\n==4147==ABORTING\\r\\nMS: 1 CrossOver-; base unit: adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\\r\\n0xff,0xff,0x24,0xa,0x13,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0xa,0x92,0x92,0x92,0x92,0x92,0x92,0x92,0xa,0x0,0x0,0x0,0x0,0xa,0x0,0x0,0x0,0xa,0x0,0x0,0x0,0x0,0x0,0x0,0xff,0xff,0xff,0xff,0xff,0xff,0xb,0x5,0xa0,0xa0,0xa0,0xa,0xa,0x45,0xa,0xa,0x45,0xb2,0xa,0xb5,0xf5,0xba,0xba,0xba,0xba,0xf5,0xf5,0x45,0xa,0x45,0x45,0x45,0xa,0xa,0xa,0xa,0x45,0xa,0xa,0x45,0xa,0xa,0xa,0x45,0x45,0x45,0x45,0xa,0x45,0xa,0xa,0x45,0xa,0x45,0x45,0xa,0x24,0x45,0x45,0x45,0x45,0x45,0xa,0xa,0x45,0x45,0x45,0xa,0xa,0xa,0x45,0x45,0x45,0xa,0x45,0x45,0x45,0x45,0xa,0xa,0x45,0x45,0x45,0x45,0xa,0x45,0xa,0x45,0x45,0xa,0xa,0x45,0x45,0x45,0xa,0x45,0xa,0x45,0xa,0xa,0xa,0xa,0xa,0xa,0x45,0x45,0x45,0x45,0x55,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0xfd,0xa,0xa,0xa,0xa,0xa,0xa,0xa,0x0,0x0,0xa,0xa,0x0,0xa,0xa,0x0,0xa,0x0,0xa,0x0,0xa,0xa,0xa,0xa,0xa,0x0,0x0,0x0,0xa,0x0,0xa,0xa,0xa,0xa,0x0,0xa,0xa,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,\\r\\n\\\\xff\\\\xff$\\\\x0a\\\\x13\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x0a\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x92\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\x0b\\\\x05\\\\xa0\\\\xa0\\\\xa0\\\\x0a\\\\x0aE\\\\x0a\\\\x0aE\\\\xb2\\\\x0a\\\\xb5\\\\xf5\\\\xba\\\\xba\\\\xba\\\\xba\\\\xf5\\\\xf5E\\\\x0aEEE\\\\x0a\\\\x0a\\\\x0a\\\\x0aE\\\\x0a\\\\x0aE\\\\x0a\\\\x0a\\\\x0aEEEE\\\\x0aE\\\\x0a\\\\x0aE\\\\x0aEE\\\\x0a$EEEEE\\\\x0a\\\\x0aEEE\\\\x0a\\\\x0a\\\\x0aEEE\\\\x0aEEEE\\\\x0a\\\\x0aEEEE\\\\x0aE\\\\x0aEE\\\\x0a\\\\x0aEEE\\\\x0aE\\\\x0aE\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0aEEEEU\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\xfd\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x0a\\\\x0a\\\\x00\\\\x0a\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\r\\nartifact_prefix='./'; Test unit written to ./crash-1c702ef4ba1fcdd365a838e1c337a6fde9d4cad8\\r\\nBase64: //8kChOSkpKSkpKSCpKSkpKSkpIKAAAAAAoAAAAKAAAAAAAA////////CwWgoKAKCkUKCkWyCrX1urq6uvX1RQpFRUUKCgoKRQoKRQoKCkVFRUUKRQoKRQpFRQokRUVFRUUKCkVFRQoKCkVFRQpFRUVFCgpFRUVFCkUKRUUKCkVFRQpFCkUKCgoKCgpFRUVFVQoKCgoKCgoKCgoKCgoKCgoKCgr9CgoKCgoKCgAACgoACgoACgAKAAoKCgoKAAAACgAKCgoKAAoKAAAAAAAAAAAAAAA=\\r\\n\\r\\n```\\r\\n\\r\\n```\\r\\n\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"In onig_st_foreach(), we don't know the true size of t->bins[], so we can't even check if it is correct or not.\\r\\n\\r\\nI don't think there is any obligation that all exposed APIs must check all of the input.\\r\\nWe can assume that the normal data structures created through the API will be input.\\r\\nIt does not work properly with t->bins[] allocated unrelated size with random t->num_bins and t->num_entries values.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_264", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"264\", \"title\": \"ASCII only word , ignore case , Character class\", \"author\": \"tonco-miyazawa\", \"labels\": [\"bug\", \"specification\"], \"description\": \"This is Applied commit 50cdc3e2ac45289fcfaa2fb8ca313fb8295cbb50 .\\r\\n\\r\\n--------  /test/test_utf8.c  -------\\r\\n```\\r\\n  // Issue #264\\r\\n  n(\\\"(?iI)s\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?iI)[s]\\\", \\\"\\\\xc5\\\\xbf\\\");    // FAIL\\r\\n\\r\\n  n(\\\"(?iI:s)\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?iI:[s])\\\", \\\"\\\\xc5\\\\xbf\\\");    // FAIL\\r\\n\\r\\n  x2(\\\"(?iI)(?:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n  n(\\\"(?iI)(?W:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\");     // FAIL\\r\\n\\r\\n  n(\\\"(?iI)(?W:\\\\\\\\w)\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?iI)(?W:[\\\\\\\\w])\\\", \\\"\\\\xc5\\\\xbf\\\");     // FAIL\\r\\n\\r\\n  n(\\\"(?iI)(?W:\\\\\\\\p{Word})\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?iI)(?W:[\\\\\\\\p{Word}])\\\", \\\"\\\\xc5\\\\xbf\\\");     // FAIL\\r\\n\\r\\n  /* Are these specifications? or bugs? All these results are \\\"OK\\\". */\\r\\n  x2(\\\"(?i)(?W:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n  n(\\\"(?i)(?W:\\\\\\\\p{Word})\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?i)(?W:\\\\\\\\w)\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  x2(\\\"(?i)(?W:[\\\\\\\\w])\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n\\r\\n  /* These are Works fine. */\\r\\n  n(\\\"(?I)(?W:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  n(\\\"(?W:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\n  x2(\\\"(?i)s\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n  x2(\\\"(?i)[s]\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n```\\r\\nI think these are bugs, but I'm sorry if they are different.\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Thank you for the fix. I will check the operation later.\"}, {\"author\": \"kkos\", \"body\": \"```\\r\\nx2(\\\"(?i)(?W:[[:word:]])\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\nn(\\\"(?i)(?W:\\\\\\\\p{Word})\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\nn(\\\"(?i)(?W:\\\\\\\\w)\\\", \\\"\\\\xc5\\\\xbf\\\");\\r\\nx2(\\\"(?i)(?W:[\\\\\\\\w])\\\", \\\"\\\\xc5\\\\xbf\\\", 0, 2);\\r\\n```\\r\\nI was not aware of any new problems with (?W) and (?i).\\r\\nSince \\\\w is implemented in different ways, it is difficult to make them behave exactly the same.\\r\\nI decided to summarize by saying that the behavior differs depending on whether it is in a character class or not.\\r\\nIGNORECASE has no effect on word character type if it is not in a character class. (But it has no effect when (?W) is not specified.)\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"> (?W) and (?i)\\r\\n\\r\\nSorry for the lack of explanation.\\r\\nÂ∞ë„ÅóË™¨Êòé„ÅåË∂≥„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÅ„Åô„Åø„Åæ„Åõ„Çì„ÄÇ\\r\\n\\r\\n> behavior differs depending on whether it is in a character class or not.\\r\\n\\r\\nI understand.  I don't know the detailed specifications yet, so I will verify it at a later date. Thank you for the fix.\\r\\n‰∫ÜËß£„Åó„Åæ„Åó„Åü„ÄÇ Ë©≥„Åó„ÅÑ‰ªïÊßò„ÅØ„Åæ„Å†ÊääÊè°„Åó„Å¶„ÅÑ„Å™„ÅÑ„ÅÆ„ÅßÂæåÊó•Ê§úË®º„Åó„Çà„ÅÜ„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÅ„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„ÄÇ\"}, {\"author\": \"kkos\", \"body\": \"My English is not right and I don't think you got the message, so I will write it again.\\r\\n\\r\\nI agree that it is odd that these four results do not match.\\r\\nHowever, for word type, it is difficult to have exactly the same behavior because of the particular implementation method.\\r\\nTherefore, only word type has a special specification for IGNORECASE. But if you are not using the (?W) option, you probably don't need to worry about it.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"Sorry for the inconvenience.\\r\\n\\r\\n> it is difficult to have exactly the same behavior\\r\\n\\r\\nThis isn't desirable because it's a non-intuitive behavior, but I think\\r\\n it can't be helped because of the complex limitations.\\r\\n„Åì„Çå„ÅØÁõ¥ÊÑüÁöÑ„Åß„Å™„ÅÑÂãï‰Ωú„Å´„Å™„Çã„ÅÆ„Åß„ÅÇ„Åæ„ÇäÂ•Ω„Åæ„Åó„Åè„ÅØ„Å™„ÅÑ„Åß„Åô„Åå„ÄÅË§áÈõë„Å™Âà∂Á¥Ñ„Åå„ÅÇ„Çã„Åü„ÇÅ‰ªïÊñπ„ÅÆ„Å™„ÅÑ„Åì„Å®„Å†„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ\\r\\n\\r\\nThose who use the `(?W)` option will read /doc/RE carefully, so if there is a note,\\r\\n I think that there is not much problem.\\r\\n `(?W)`  „Ç™„Éó„Ç∑„Éß„É≥„Çí‰ΩøÁî®„Åô„Çã‰∫∫„ÅØ /doc/RE.ja „ÇíÁÜüË™≠„Åô„Çã„ÅÆ„ÅßÊ≥®ÊÑèÊõ∏„Åç„Åå„ÅÇ„Çå„Å∞„ÅÇ„Åæ„ÇäÂïèÈ°å„ÅØÁÑ°„ÅÑ„Å®ÁßÅ„ÅØÊÄù„ÅÑ„Åæ„Åô„ÄÇ\\r\\n\\r\\n---------------------------------------------------------------------------------------------\\r\\n\\r\\nAbout behavior of `\\\\p{Word}` are different from `\\\\w` and `[[:word:]]`\\r\\n\\r\\nperlre.pod\\r\\nhttps://metacpan.org/dist/perl/view/pod/perlre.pod#/a-(and-/aa)\\r\\n>With `/a`, one can write `\\\\d` with confidence that it will only match ASCII characters, and should the need arise to match beyond ASCII, you can instead use `\\\\p{Digit}` (or `\\\\p{Word}` for `\\\\w`).\\r\\n\\r\\nperlreref.pod\\r\\nhttps://metacpan.org/dist/perl/view/pod/perlreref.pod#OPERATORS\\r\\n> `a`  restrict `\\\\d`, `\\\\s`, `\\\\w` and `[:posix:]` to match ASCII only\\r\\n> `aa` (two a's) also `/i` matches exclude ASCII/non-ASCII\\r\\n\\r\\nIn other words, it will be as follows.\\r\\n\\r\\n`\\\\w and [[:word:]]   :  \\\"/a\\\" , \\\"/aa\\\"  apply to these.`\\r\\n\\r\\n`\\\\p{Word}            :   Not affected by \\\"/a\\\" and \\\"/aa\\\".`\\r\\n\\r\\nI have one question. Unlike perl, oniguruma also applies the `(?W)` option to `\\\\p{Word}`.\\r\\nIs the difference from this perl the intended change?\\r\\nperl „Å®„ÅØÈÅï„ÅÑ„ÄÅoniguruma „ÅØ `(?W)` „Ç™„Éó„Ç∑„Éß„É≥„Åå `\\\\p{Word}` „Å´„ÇÇÈÅ©Áî®„Åï„Çå„Åæ„Åô„ÄÇ\\r\\n„Åì„ÅÆ oniguruma „Å® perl „Å®„ÅÆÈÅï„ÅÑ„ÅØÊÑèÂõ≥„Åó„ÅüÂ§âÊõ¥„Åß„Åô„ÅãÔºü\\r\\n\\r\\n/doc/RE - oniguruma\\r\\n> `W: ASCII only word (\\\\w, \\\\p{Word}, [[:word:]])`\\r\\nhttps://github.com/kkos/oniguruma/blob/cbfdf3b860a13ee9c077c892cc5d89a53d73a2ac/doc/RE#L270\\r\\n----------------------------------------------------------------------------------\\r\\nThe following is a test to see if it matches \\\"≈ø\\\" in Perl 5.35.11. ( \\\"≈ø\\\" = `\\\\xc5\\\\xbf` )\\r\\n\\r\\n```\\r\\n/s/i        # match:  (≈ø)\\r\\n/s/ia       # match:  (≈ø)\\r\\n/s/iaa      # --search fail--\\r\\n\\r\\n/[s]/i      # match:  (≈ø)\\r\\n/[s]/ia     # match:  (≈ø)\\r\\n/[s]/iaa    # --search fail--\\r\\n\\r\\n/\\\\w/i      # match:  (≈ø)\\r\\n/\\\\w/ia     # --search fail--\\r\\n/\\\\w/iaa    # --search fail--\\r\\n\\r\\n/[\\\\w]/i      # match:  (≈ø)\\r\\n/[\\\\w]/ia     # --search fail--\\r\\n/[\\\\w]/iaa    # --search fail--\\r\\n\\r\\n/[[:word:]]/i       # match:  (≈ø)\\r\\n/[[:word:]]/ia      # --search fail--\\r\\n/[[:word:]]/iaa     # --search fail--\\r\\n\\r\\n/\\\\p{Word}/i      # match:  (≈ø)\\r\\n/\\\\p{Word}/ia     # match:  (≈ø)\\r\\n/\\\\p{Word}/iaa    # match:  (≈ø)\\r\\n\\r\\n/[\\\\p{Word}]/i      # match:  (≈ø)\\r\\n/[\\\\p{Word}]/ia     # match:  (≈ø)\\r\\n/[\\\\p{Word}]/iaa    # match:  (≈ø)\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Documentation will be written when the specifications are finalized.\\r\\nThanks for the explanation of the /a, /aa options in Perl.\\r\\nOn that point, I am not intentional about the differences between Oniguruma and Perl.\\r\\nWhen I thought about that option, I had little interest in Perl's /a, /aa options.\\r\\nI might change it so that it only gets close when ONIG_SYNTAX_PERL.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \">  I had little interest in Perl's `/a`, `/aa` options.\\r\\n\\r\\nI see, that seems to be an original specification of oniguruma.\\r\\n„Å™„Çã„Åª„Å©„ÄÅ„Å®„ÅÑ„ÅÜ„Åì„Å®„ÅØ oniguruma „ÅÆÁã¨Ëá™‰ªïÊßò„Å®Ë®Ä„Åà„Åù„ÅÜ„Åß„Åô„Å≠„ÄÇ\\r\\n\\r\\n> I might change it so that it only gets close when ONIG_SYNTAX_PERL.\\r\\n\\r\\nIt's an annoying problem when considering backward compatibility.\\r\\nÂæåÊñπ‰∫íÊèõÊÄß„ÇíËÄÉ„Åà„Çã„Å®ÊÇ©„Åæ„Åó„ÅÑÂïèÈ°å„Åß„Åô„Å≠„ÄÇ\\r\\n\\r\\n> Documentation will be written when the specifications are finalized.\\r\\n\\r\\nI understand. Thank you for your answer.\\r\\n\\r\\n--------------------------------------------------------\\r\\n\\r\\n<details>\\r\\n<summary>* I omitted it because I proposed measures that have already been applied. (Click to view)</summary>\\r\\n\\r\\nUsing `(?-i)` has been a Temporary workaround, in Onigmo's past issue(92).\\r\\nIt would be nice if applying (?-i) internally would be the solution, but I'm not sure if this would be the solution.\\r\\nThe following is a test to see if it matches \\\"≈ø\\\" in Perl 5.35.11. ( \\\"≈ø\\\" = `\\\\xc5\\\\xbf` )\\r\\n\\r\\nOnigmo „ÅÆÈÅéÂéª„ÅÆ issue(92) „Åß `(?-i)` „Çí‰Ωø„ÅÜ„Åì„Å®„Åå‰∏ÄÊôÇÁöÑ„Å™ÂõûÈÅøÁ≠ñ„Å´„Å™„Å£„Åü„Åì„Å®„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ\\r\\nÂÜÖÈÉ®ÁöÑ„Å´ `(?-i)` „ÇíÈÅ©Áî®„Åô„Çã„Åì„Å®„ÅåËß£Ê±∫Á≠ñ„Å´„Å™„Çå„Å∞ËâØ„ÅÑ„ÅÆ„Åß„Åô„Åå„ÄÅ„Åì„Çå„ÅåËß£Ê±∫Á≠ñ„Å´„Å™„Çã„Åã„Å©„ÅÜ„Åã„ÅØÁßÅ„Å´„ÅØÂàÜ„Åã„Çä„Åæ„Åõ„Çì„ÄÇ\\r\\n‰ª•‰∏ã„ÅÆ„ÉÜ„Çπ„Éà„ÅØ \\\"≈ø\\\" ( \\\"≈ø\\\" =` \\\\xc5\\\\xbf` ) „Åå„Éû„ÉÉ„ÉÅ„Åô„Çã„Åã„Å©„ÅÜ„Åã„Çí Perl 5.35.11 „ÅßË©¶„Åó„Åü„ÉÜ„Çπ„Éà„Åß„Åô„ÄÇ\\r\\n\\r\\n‚óè `(?-i)` Results\\r\\n\\r\\n```\\r\\n/s/        #  ** search fail **\\r\\n/s/a       #  ** search fail **\\r\\n/s/aa      #  ** search fail **\\r\\n\\r\\n/[s]/      #  ** search fail **\\r\\n/[s]/a     #  ** search fail **\\r\\n/[s]/aa    #  ** search fail **\\r\\n\\r\\n/\\\\w/      #  match: (≈ø)\\r\\n/\\\\w/a     #  ** search fail **\\r\\n/\\\\w/aa    #  ** search fail **\\r\\n\\r\\n/[\\\\w]/      #  match: (≈ø)\\r\\n/[\\\\w]/a     #  ** search fail **\\r\\n/[\\\\w]/aa    #  ** search fail **\\r\\n\\r\\n/[[:word:]]/       #  match: (≈ø)\\r\\n/[[:word:]]/a      #  ** search fail **\\r\\n/[[:word:]]/aa     #  ** search fail **\\r\\n\\r\\n/\\\\p{Word}/      #  match: (≈ø)\\r\\n/\\\\p{Word}/a     #  match: (≈ø)\\r\\n/\\\\p{Word}/aa    #  match: (≈ø)\\r\\n\\r\\n/[\\\\p{Word}]/      #  match: (≈ø)\\r\\n/[\\\\p{Word}]/a     #  match: (≈ø)\\r\\n/[\\\\p{Word}]/aa    #  match: (≈ø)\\r\\n```\\r\\n</details>\\r\\n\\r\\n\\r\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I'm sorry, I overlooked some of the replies from you.\\r\\n\\r\\n> IGNORECASE has no effect on word character type if it is not in a character class.\\r\\n\\r\\nUntil now, I didn't understand that this was synonymous with applying `(?-i)`, sorry.\\r\\nI'm always amazed at how fast your fix is, thank you for the fix.\\r\\n\\r\\n---\\r\\n[ Added: Aug 28, 2023 ] This thread was hard to read so I edited it to make it easier to read.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_265", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"265\", \"title\": \"potential Use-after-Free in regparse.c\", \"author\": \"huntcve\", \"labels\": [], \"description\": \"Hi,\\r\\n  The code (https://github.com/kkos/oniguruma/blob/master/src/regparse.c#L9155) seems forget to set \\\"*top=NULL_NODE;\\\" which makes \\\"*top\\\" becomes a dangling pointer when return error. While there are multiple use cases in caller side to free it again which leads to double free or use-after-free issue since onig_node_free only validates NULL.\\r\\n  Here are some use cases identified:\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L7817\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L7995\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L8039\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L8313\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L8362\\r\\nhttps://github.com/kkos/oniguruma/blob/master/src/regparse.c#L8716\\r\\n On some older version like v6.3.0 there are more use cases. Since this code is used by edk2 for some bootloaders, it is better to fix them.\\r\\n\\r\\n-lingtong\\r\\n\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_266", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"266\", \"title\": \"pkgconfig/oniguruma.pc: Incorrect `libdir` path when built with prefix\", \"author\": \"paulmenzel\", \"labels\": [], \"description\": \"Configuring Oniguruma 6.9.8 with\\r\\n\\r\\n    cmake -DCMAKE_INSTALL_PREFIX=/project/bratwurst/20220720 -DCMAKE_INSTALL_LIBDIR=/project/bratwurst/20220720/lib -DCMAKE_COLOR_MAKEFILE=OFF -DCMAKE_VERBOSE_MAKEFILE=ON /scratch/local/bee-wwwuser/onig/onig-6.9.8-20220720/source\\r\\n\\r\\nthen building with `make -j32`, and installing it with\\r\\n\\r\\n    make -j32 install DESTDIR=/scratch/local/bee-wwwuser/onig/onig-6.9.8-20220720/image\\r\\n\\r\\nthe resulting pkg-config file contains the prefix twice in `libdir`:\\r\\n\\r\\n```\\r\\nmore /project/bratwurst/20220720/lib/pkgconfig/oniguruma.pc\\r\\nprefix=/project/bratwurst/20220720\\r\\nexec_prefix=${prefix}\\r\\nlibdir=${exec_prefix}//project/bratwurst/20220720/lib\\r\\nincludedir=${prefix}/include\\r\\ndatarootdir=${prefix}/share\\r\\ndatadir=${prefix}/share\\r\\n\\r\\nName: oniguruma\\r\\nDescription: Regular expression library\\r\\nVersion: 6.9.8\\r\\nRequires:\\r\\nLibs: -L${libdir} -lonig\\r\\nCflags: -I${includedir}\\r\\n```\", \"comments\": [{\"author\": \"paulmenzel\", \"body\": \"I would expect it to be `${exec_prefix}/lib`.\"}, {\"author\": \"paulmenzel\", \"body\": \"    $ PKG_CONFIG_PATH=/project/bratwurst/20220720/lib/pkgconfig/ pkg-config --libs oniguruma\\r\\n    -L/project/bratwurst/20220720//project/bratwurst/20220720/lib -lonig\\r\\n    $ PKG_CONFIG_PATH=/project/bratwurst/20220720/lib/pkgconfig/ pkg-config --cflags oniguruma\\r\\n    -I/project/bratwurst/20220720/include\"}, {\"author\": \"kkos\", \"body\": \"I don't know much about cmake, but I assume that CMAKE_INSTALL_LIBDIR does not include a prefix?\"}, {\"author\": \"paulmenzel\", \"body\": \"From [*[CMake] CMAKE_INSTALL_LIBDIR - full path or relative?*](https://cmake.org/pipermail/cmake/2012-February/049206.html):\\r\\n\\r\\n> Whenever an installation directory is not an absolute path, CMake prefixes it with the value of CMAKE_INSTALL_PREFIX. This is for convenience and make it easier to be consistent. AFAIK this behaviour is similar to what autoconf does.\\r\\n\\r\\nAs we pass an absolute path, it should use that, and not prepend anything.\"}, {\"author\": \"paulmenzel\", \"body\": \"Also see libexpat issue https://github.com/libexpat/libexpat/issues/458.\\r\\n\\r\\nI‚Äôd just remove exec_prefix from Oniguruma‚Äôs pkg-config file template.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_267", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"267\", \"title\": \"Potential null pointer dereference in regparse.c\", \"author\": \"shugaley\", \"labels\": [], \"description\": \"I have built with `gcc-11.2` with:\\r\\n```shell\\r\\n-Werror=array-bounds -fno-delete-null-pointer-checks -O2\\r\\n```\\r\\n\\r\\nand got an error:\\r\\n```shell\\r\\nIn function 'node_new_str_crude_char',\\r\\n    inlined from 'prs_exp' at regparse.c:8767:13:\\r\\nregparse.c:3498:24: error: '__builtin_memset' offset [0, 22] is out of the bounds [0, 0] [-Werror=array-bounds]\\r\\n 3498 |     STR_(node)->buf[i] = '\\\\0';\\r\\ncc1: some warnings being treated as errors\\r\\n```\\r\\n\\r\\nSee code:\\r\\nhttps://github.com/kkos/oniguruma/blob/f91466d2e620724afeaaa2e1666495a0ab0b1e5e/src/regparse.c#L3494-L3498\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/f91466d2e620724afeaaa2e1666495a0ab0b1e5e/src/regparse.c#L3471-L3478\\r\\n\\r\\nSo you can see that `node_new_str_crude` can return NULL by `CHECK_NULL_RETURN`. I think that you should check `node` again in `node_new_str_crude_char` before dereference.      \", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_268", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"268\", \"title\": \"[[:punct:]] isn't matching all expected symbols\", \"author\": \"david-waterworth\", \"labels\": [], \"description\": \"It appears that the [[:punct:]] class does not match the following characters $+<>=^`|~ which is different behaviour from other regex libraries I've used (including the online regex101 tool).\\r\\n\\r\\nAccording to https://en.wikibooks.org/wiki/Regular_Expressions/POSIX_Basic_Regular_Expressions :punct: should be all \\\"all graphic characters except letters and digits\\\"\\r\\n\\r\\nI'm using the rust `onig` bindings, the code below produces no matches using onigruma but works with the alternative `regex` crate. Are you using a different definition of the POSIX character classes? If so I cannot find a reference in the documentation.\", \"comments\": [{\"author\": \"iwillspeak\", \"body\": \"I've managed to reproduce this. It appears to be down to the encoding uses. The `onig` crate defaults to UTF8 as the encoding as Rust strings are encoded with UTF8. If the search is performed with ASCII encoding instead then those characters are considered POSIX `:punct:`:\\r\\n\\r\\n```rust\\r\\nuse onig::*;\\r\\n\\r\\nfn main() {\\r\\n    {\\r\\n        let regex = Regex::with_options(\\r\\n            \\\"[[:punct:]]+\\\",\\r\\n            RegexOptions::REGEX_OPTION_NONE,\\r\\n            Syntax::posix_extended(),\\r\\n        )\\r\\n        .unwrap();\\r\\n    \\r\\n        match regex.find(\\\"$+<>=^`|~\\\") {\\r\\n            Some(mat) => println!(\\\"{:?}\\\", &mat),\\r\\n            None => println!(\\\"NO match\\\"),\\r\\n        }\\r\\n    }\\r\\n\\r\\n    {\\r\\n        let regex = Regex::with_options_and_encoding(\\r\\n            EncodedBytes::ascii(b\\\"[[:punct:]]+\\\"),\\r\\n            RegexOptions::REGEX_OPTION_NONE,\\r\\n            Syntax::posix_extended(),\\r\\n        )\\r\\n        .unwrap();\\r\\n    \\r\\n        match regex.find_with_encoding(EncodedBytes::ascii(b\\\"$+<>=^`|~\\\")) {\\r\\n            Some(mat) => println!(\\\"{:?}\\\", &mat),\\r\\n            None => println!(\\\"NO match\\\"),\\r\\n        }\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\nIn this eaxample `find*` boils down to an `onig_search_with_param` with an empty param and  `SEARCH_OPTION_NONE`:\\r\\n\\r\\n https://github.com/rust-onig/rust-onig/blob/36dd97a8db49c8f089449f0605da627fcfc6d74b/onig/src/lib.rs#L782-L784\\r\\n\\r\\n https://github.com/rust-onig/rust-onig/blob/36dd97a8db49c8f089449f0605da627fcfc6d74b/onig/src/lib.rs#L723-L735\\r\\n\\r\\nI'm not sure if this is an issue with the way that `onig` uses encodings, or with the way that the UTF8 encoding treats those characters.\"}, {\"author\": \"iwillspeak\", \"body\": \"I can reproduce this without `onig` just by setting the encoding in `samples/simple.c` to `ONIG_ENCODING_UTF8` and using the same pattern and search text.\"}, {\"author\": \"kkos\", \"body\": \"The current punct data can be found below.\\r\\nCR_Punct in oniguruma/src/unicode_property_data.c\\r\\nThis is made from Unicode data.\\r\\nhttps://www.unicode.org/Public/14.0.0/ucd/UnicodeData.txt\\r\\nI will now see if I can change the value of [[:punct:]] as you said.\"}, {\"author\": \"iwillspeak\", \"body\": \"I've been doing some digging on Unicode Explorer. It seems that this is because those characters _aren't_ punctuation as far as Unicode is concerned. E.g. Unicode Explorer indicates that `~` (tilde) is a Symbol, not a punctuation character:\\r\\n\\r\\nhttps://unicode-explorer.com/c/007E\\r\\n\\r\\nFor comparison here's full stop, which is matched by `[:punct:]` in UTF8:\\r\\n\\r\\nhttps://unicode-explorer.com/c/002E\\r\\n\\r\\nI guess the question here is should Oniguruma consider `Symbol` characters as `[:punct:]`? \"}, {\"author\": \"david-waterworth\", \"body\": \"So it looks to me that it depends if you define punctuation as \\\"Standard\\\" or \\\"POSIX Compatible\\\" using the table from Annex C of [UTS#18](https://unicode.org/reports/tr18/)\\r\\n\\r\\n> The following table shows recommended assignments for compatibility property names, for use in Regular Expressions. The standard recommendation is shown in the column labeled \\\"Standard\\\"; applications should use this definition wherever possible. If populated with a different value, the column labeled \\\"POSIX Compatible\\\" shows modifications to the standard recommendation required to meet the formal requirements of [[POSIX](https://unicode.org/reports/tr18/#POSIX)], and also to maintain (as much as possible) compatibility with the POSIX usage in practice. That modification involves some compromises, because POSIX does not have as fine-grained a set of character properties as in the Unicode Standard, and also has some additional constraints. So, for example, POSIX does not allow more than 20 characters to be categorized as digits, whereas there are many more than 20 digit characters in Unicode.\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/5028974/187050331-696b5782-0227-4e27-a10a-857152718857.png)\\r\\n\\r\\n(I've only copied part of the table)\\r\\n\\r\\nAs you mention the difference is that UTF defines symbols and POSIX doesn't make a distinction between punctuation and symbols.\\r\\n\\r\\nSo which is correct I couldn't say - it does say prefer `Standard`, but it does seem most engines I've used follow the POSIX definition. I suspect that's historical and tends to work less well for non-english text?\\r\\n\\r\\nIn  my case I think using `\\\\p{P}` and `\\\\p{S}` rather than [[:punct]] is the better option as it's clearer what it contains.\"}, {\"author\": \"kkos\", \"body\": \"Changed the definition of [:punct:] in Unicode encodings from \\\\p{P} to \\\\p{PosixPunct} = \\\\p{P} + \\\\p{S}.\\r\\n(PosixPunct is a new addition.)\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_269", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"269\", \"title\": \"Checking for Whole Text Matches\", \"author\": \"iwillspeak\", \"labels\": [], \"description\": \"An issue rust-onig/rust-onig#171 has been raised on the `onig` crate to do with the behaviour of our `is_match` function. I don't\\r\\nknow if there's a better way to do what we're trying to do here or if there's a bug in Oniguruma's longest\\r\\nmatching support.\\r\\n\\r\\nThe `is_match` function is used to check if the whole input text matches the given pattern. It's implemented\\r\\nby calling `onig_match_with_param` passing in `SEARCH_OPTION_NONE` and no region or match param.\\r\\n\\r\\nThis works fine when the pattern can only match in one way. When there are alternations in the pattern\\r\\nhowever we can end up with problems due to the order of the alternations. e.g. given the pattern `a|abc`\\r\\nand the search text `abc` the `is_match` check fails. Oniguruma finds the first match of the pattern in\\r\\nthe text which is just the initial `a`.\\r\\n\\r\\nI've tried using the `(?L)` flag, along with `ONIG_OPTION_FIND_LONGEST` but can't seem to work out\\r\\na combination of parameters that will make the pattern match the full text. Switching the order of the\\r\\npattern to `abc|a` makes the match work. It seems that Oniguruma is performing a depth-first match and\\r\\nreturning as soon as some match is found. is there a way of getting the longer match here?  \", \"comments\": [{\"author\": \"kkos\", \"body\": \"It is normal behavior for the default option to match only the leftmost choice.\\r\\nONIG_OPTION_FIND_LONGEST is for onion_search() and does not work for other choices for the same match position.\\r\\nThis may change in the future, if I get more time.\\r\\n\\r\\nCouldn't you solve your current problem by adding another new option?\\r\\nAn option at search time that if the end position of the matched string does not match the end position of the string specified in the argument, then another option is looked up.\\r\\nIt is like a dynamic \\\\z . \\r\\nIf this seems to solve the problem, I will add it. (ONIG_OPTION_MATCH_END_OF_STRING)\"}, {\"author\": \"iwillspeak\", \"body\": \"A search time option to force a match to the end of the string sounds like exactly what we want here. I‚Äôd be happy to try and implement it and open a PR. \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_271", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"271\", \"title\": \"[6.9.4] build failure on armhf\", \"author\": \"okias\", \"labels\": [], \"description\": \"oniguruma got pulled as one of dependecies of `jq`\\r\\n```\\r\\nBuilding wheel for jq (PEP 517): started\\r\\n  Building wheel for jq (PEP 517): finished with status 'error'\\r\\n  ERROR: Command errored out with exit status 1:\\r\\n   command: /usr/bin/python3 /tmp/tmplvjua9t2_in_process.py build_wheel /tmp/tmp39jn0_a_\\r\\n       cwd: /tmp/pip-install-4ne82x7p/jq_cc98b2b8128442f8b75e1fb59da3f498\\r\\n  Complete output (67 lines):\\r\\n  running bdist_wheel\\r\\n  running build\\r\\n  running build_ext\\r\\n  checking for a BSD-compatible install... /usr/bin/install -c\\r\\n  checking whether build environment is sane... yes\\r\\n  checking for a thread-safe mkdir -p... /usr/bin/mkdir -p\\r\\n  checking for gawk... no\\r\\n  checking for mawk... mawk\\r\\n  checking whether make sets $(MAKE)... no\\r\\n  checking whether make supports nested variables... no\\r\\n  checking for gcc... /usr/lib/ccache/gcc\\r\\n  checking whether the C compiler works... no\\r\\n  configure: error: in `/tmp/pip-install-4ne82x7p/jq_cc98b2b8128442f8b75e1fb59da3f498/_deps/onig-6.9.4':\\r\\n  configure: error: C compiler cannot create executables\\r\\n  See `config.log' for more details\\r\\n  Downloading https://github.com/kkos/oniguruma/releases/download/v6.9.4/onig-6.9.4.tar.gz\\r\\n  Downloaded https://github.com/kkos/oniguruma/releases/download/v6.9.4/onig-6.9.4.tar.gz\\r\\n  Executing: ./configure CFLAGS=-fPIC --prefix=/tmp/pip-install-4ne82x7p/jq_cc98b2b8128442f8b75e1fb59da3f498/_deps/onig-install-6.9.4\\r\\n  Traceback (most recent call last):\\r\\n    File \\\"/tmp/tmplvjua9t2_in_process.py\\\", line 280, in <module>\\r\\n      main()\\r\\n    File \\\"/tmp/tmplvjua9t2_in_process.py\\\", line 263, in main\\r\\n      json_out['return_val'] = hook(**hook_input['kwargs'])\\r\\n    File \\\"/tmp/tmplvjua9t2_in_process.py\\\", line 204, in build_wheel\\r\\n      return _build_backend().build_wheel(wheel_directory, config_settings,\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/build_meta.py\\\", line 412, in build_wheel\\r\\n      return self._build_with_temp_dir(['bdist_wheel'], '.whl',\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/build_meta.py\\\", line 397, in _build_with_temp_dir\\r\\n      self.run_setup()\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/build_meta.py\\\", line 335, in run_setup\\r\\n      exec(code, locals())\\r\\n    File \\\"<string>\\\", line 113, in <module>\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/__init__.py\\\", line 87, in setup\\r\\n      return distutils.core.setup(**attrs)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/core.py\\\", line 185, in setup\\r\\n      return run_commands(dist)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/core.py\\\", line 201, in run_commands\\r\\n      dist.run_commands()\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/dist.py\\\", line 973, in run_commands\\r\\n      self.run_command(cmd)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/dist.py\\\", line 1217, in run_command\\r\\n      super().run_command(command)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/dist.py\\\", line 992, in run_command\\r\\n      cmd_obj.run()\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/wheel/bdist_wheel.py\\\", line 299, in run\\r\\n      self.run_command('build')\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/cmd.py\\\", line 319, in run_command\\r\\n      self.distribution.run_command(command)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/dist.py\\\", line 1217, in run_command\\r\\n      super().run_command(command)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/dist.py\\\", line 992, in run_command\\r\\n      cmd_obj.run()\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/command/build.py\\\", line 132, in run\\r\\n      self.run_command(cmd_name)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/cmd.py\\\", line 319, in run_command\\r\\n      self.distribution.run_command(command)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/dist.py\\\", line 1217, in run_command\\r\\n      super().run_command(command)\\r\\n    File \\\"/tmp/pip-build-env-x3335f4w/overlay/lib/python3.9/site-packages/setuptools/_distutils/dist.py\\\", line 992, in run_command\\r\\n      cmd_obj.run()\\r\\n    File \\\"<string>\\\", line 46, in run\\r\\n    File \\\"<string>\\\", line 51, in _build_oniguruma\\r\\n    File \\\"<string>\\\", line 88, in _build_lib\\r\\n    File \\\"<string>\\\", line 85, in run_command\\r\\n    File \\\"/usr/lib/python3.9/subprocess.py\\\", line 373, in check_call\\r\\n      raise CalledProcessError(retcode, cmd)\\r\\n  subprocess.CalledProcessError: Command '['./configure', 'CFLAGS=-fPIC', '--prefix=/tmp/pip-install-4ne82x7p/jq_cc98b2b8128442f8b75e1fb59da3f498/_deps/onig-install-6.9.4']' returned non-zero exit status 77.\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I am not responsible for the absence of C Compiler in your environment.\\r\\nNor am I responsible for pip's attempts to compile Oniguruma from source on that platform.\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_273", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"273\", \"title\": \"Documentation of onig_name_to_group_numbers is incorrect\", \"author\": \"alan-j-hu\", \"labels\": [], \"description\": \"The documentation for `onig_name_to_group_numbers` claims that the function returns -1 when the name is not found: https://github.com/kkos/oniguruma/blob/78ffad3ebf3a875d83c7380c8733f5430c7cba72/doc/API#L635-L644\\r\\n\\r\\nHowever, it does not return -1:\\r\\n\\r\\n- https://github.com/kkos/oniguruma/blob/0517315c19f7a5b13f430bfc9d31936c14b0b567/src/regparse.c#L1170-L1175\\r\\n- https://github.com/kkos/oniguruma/blob/78ffad3ebf3a875d83c7380c8733f5430c7cba72/src/oniguruma.h#L626\\r\\n\\r\\nI would make a PR to fix this, but I don't know Japanese and wouldn't be able to fix the Japanese docs...\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you. I will fix it.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_277", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"277\", \"title\": \"( /sample/callout.c ) Callouts of contents in if-then-else\", \"author\": \"tonco-miyazawa\", \"labels\": [], \"description\": \"This issue arose from my misunderstanding. **There is no need to read this issue.**\\nI didn't understand the meaning of '`fail`' below.\\n\\nhttps://github.com/kkos/oniguruma/blob/1713dfaed25f9ef680ba998e83767487f80cf5ae/doc/CALLOUTS.API#L27\\n\\nThis means the same behavior as `(*FAIL)` . This does not mean 'making the condition expression `false`'.\\nI misunderstood this and asked the following question. I'm sorry.\\n\\n-----------------------------------------------\\n\\nhttps://github.com/kkos/oniguruma/blob/eda49dd1a14e94e2bc707a1e14e808cc3bb8bee9/sample/callout.c#L57\\n\\n// (1)   line 57 = return ONIG_CALLOUT_SUCCESS;\\n`test(enc, mp, \\\"a+(?(?{foo bar baz...}X)2|1)$\\\", \\\"aaa1\\\");`\\n\\n// (2)   line 57 = return ONIG_CALLOUT_FAIL;\\n`test(enc, mp, \\\"a+(?(?{foo bar baz...}X)1|2)$\\\", \\\"aaa1\\\");`\\n\\n\\n(1)  output \\\"PROGRESS\\\" and \\\"RETRACTION\\\". \\nBut, (2) output  \\\"PROGRESS\\\"  only.\\n\\nI thought (1) and (2) would have the same behavior. But it was different.\\nI don't know if this is normal behavior or not.\\n\\n<details>\\n<summary>Original text (written in Japanese)</summary>\\n\\nÈÅïÂíåÊÑü„ÇíÊÑü„Åò„ÅüÂãï‰Ωú„Åå„ÅÇ„Çã„ÅÆ„Åß‰∏ÄÂøú„ÅäÁü•„Çâ„Åõ„Åó„Å¶„Åä„Åç„Åæ„Åô„ÄÇ ÊÉ≥ÂÆöÈÄö„Çä„ÅÆÂãï‰Ωú„Åß„Åó„Åü„Çâ„Åô„Åø„Åæ„Åõ„Çì„ÄÇ\\n\\n// (1)\\n`test(enc, mp, \\\"a+(?(?{foo bar baz...}X)2|1)$\\\", \\\"aaa1\\\");`\\n\\n// (2)\\n`test(enc, mp, \\\"a+(?(?{foo bar baz...}X)1|2)$\\\", \\\"aaa1\\\");`\\n\\n\\ncallout.c „ÅÆ callout_body() Èñ¢Êï∞„ÅÆÊàª„ÇäÂÄ§„ÇíË®≠ÂÆö„Åó„Å¶„ÅÑ„Çã 57 Ë°åÁõÆ„Çí‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´Êõ∏„ÅçÊèõ„Åà„Å¶„Åã„ÇâÂÆüË°å„Åó„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\\n\\n(1) „ÅÆÂ†¥Âêà„ÅØ\\n\\n  return ONIG_CALLOUT_SUCCESS;\\n\\n(2) „ÅÆÂ†¥Âêà„ÅØ\\n\\n  return ONIG_CALLOUT_FAIL;\\n\\n\\nhttps://github.com/kkos/oniguruma/blob/eda49dd1a14e94e2bc707a1e14e808cc3bb8bee9/sample/callout.c#L57\\n\\n(1) „Å® (2) „ÅÆÈÅï„ÅÑ„ÅØ \\\"2|1\\\" „Åå \\\"1|2\\\" „Å´ÂÖ•„ÇåÊõø„Çè„Å£„Å¶„ÅÑ„Çã„Å†„Åë„Åß„Åô„ÄÇ\\n\\n\\n\\nÊàêÂäüÂºè „Å® Â§±ÊïóÂºè „ÇíÂÖ•„ÇåÊõø„Åà„ÄÅ 57 Ë°åÁõÆ„ÅÆÊàª„ÇäÂÄ§„ÇíÊõ∏„ÅçÊèõ„Åà„Çã„Åì„Å®„Åß (1) „Å® (2) „ÅÆÂá∫ÂäõÁµêÊûú„Åå\\nÂêå„Åò„Å´„Å™„Çã„ÅÆ„Åß„ÅØ„Å™„ÅÑ„Åã„Å®ÊÄù„Å£„Åü„ÅÆ„Åß„Åô„Åå„Åù„ÅÜ„ÅØ„Å™„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ\\n\\n(1) „ÅÆÂ†¥Âêà„ÅØÂâçÈÄ≤‰∏≠„ÄÅÂæåÈÄÄ‰∏≠„ÅÆ‰∏°Êñπ„Å®„ÇÇÂÜÖÂÆπÂëº„Å≥Âá∫„Åó„ÅÆÂÜÖÂÆπ„ÅåÂá∫Âäõ„Åï„Çå„Åæ„Åô„Åå„ÄÅ\\n(2) „ÅÆÂ†¥Âêà„ÅØÂâçÈÄ≤‰∏≠„ÅÆ„ÅøÂá∫Âäõ„Åï„Çå„ÄÅÂæåÈÄÄ‰∏≠„Å´„ÅØÂá∫Âäõ„Åï„Çå„Åæ„Åõ„Çì„ÄÇ\\n\\n„Åì„ÅÆÈÅï„ÅÑ„Åå„ÅÇ„Çã„Åì„Å®„Å´ÈÅïÂíåÊÑü„ÇíÊÑü„Åò„Åæ„Åó„Åü„ÄÇ\\n\\n\\nÁßÅ„Å´„ÅØ„Åì„ÅÆÈÅï„ÅÑ„ÅÆÂéüÂõ†„ÅåonigurumaÊú¨‰ΩìÂÅ¥„Å´„ÅÇ„Çã„ÅÆ„Åã„ÄÅ callout.c „ÅÆÊõ∏„ÅçÊñπ„ÅÆÂïèÈ°å„Å™„ÅÆ„Åã„ÄÅ\\n„Åù„ÇÇ„Åù„ÇÇÂïèÈ°å„Åß„Åô„Çâ„Å™„ÅÑ„ÅÆ„Åã„ÅØÂàÜ„Åã„Çä„Åæ„Åõ„Çì„ÄÇ\\n\\nÁèæÁä∂„ÅÆÂãï‰Ωú„ÅÆ„Åæ„Åæ„Åß„ÇÇÂõ∞„ÇãÊñπ„ÅØ„ÅÑ„Å™„ÅÑ„Å®ÊÄù„ÅÑ„Åæ„Åô„Åå‰∏ÄÂøú„ÅäÁü•„Çâ„Åõ„Åó„Å¶„Åä„Åì„ÅÜ„Å®ÊÄù„ÅÑ„Åæ„Åó„Åü„ÄÇ\\n( „ÅäÂøô„Åó„ÅÑÊôÇÊúü„Åß„Åô„Åó„ÄÅ „Åó„Å∞„Çâ„ÅèÊîæÁΩÆ„Åß„ÇÇÊßã„ÅÑ„Åæ„Åõ„Çì )\\n</details>\\n\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The forward (PROGRESS) callout function is called, but the return value of that function is ONIG_CALLOUT_FAIL, which means that the entire callout execution (? {...}) is considered to have failed.\\r\\nSince it has failed, there is no call to the backward callout function because there is nothing to retract.\\r\\n\\r\\nÂâçÈÄ≤(PROGRESS)„ÅÆcalloutÈñ¢Êï∞„ÅØÂëº„Å≥Âá∫„Åï„Çå„Åæ„Åô„Åå„ÄÅ„Åù„ÅÆÈñ¢Êï∞„ÅÆÊàª„ÇäÂÄ§„ÅåONIG_CALLOUT_FAIL„Åß„ÅÇ„Çã„Å®„ÅÑ„ÅÜ„Åì„Å®„ÅØ„ÄÅcallout„ÅÆÂÆüË°åÂÖ®‰Ωì(?{...})„ÅÆÈÉ®ÂàÜ„ÅØÂ§±Êïó„Åó„Åü„Å®ÁúãÂÅö„Åï„Çå„Åæ„Åô„ÄÇÂ§±Êïó„Åó„Åü‰ª•‰∏ä„ÄÅcalloutÈÉ®ÂàÜ„ÅÆÂÖà„Åã„ÇâÂæåÈÄÄ(RETRACTION)„Åô„Çã„ÇÇ„ÅÆ„ÅåÂ≠òÂú®„Åó„Å™„ÅÑ„ÅÆ„Åß„ÄÅÂæåÈÄÄ„ÅÆcalloutÈñ¢Êï∞„ÅÆÂëº„Å≥Âá∫„Åó„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I‚Äôm sorry to bother you.\\r\\nThanks to you I found that (1) and (2) are doing the right behavior.\\r\\nThank you for the easy-to-understand explanation.\\r\\n\\r\\nÂàÜ„Åã„Çä„ÇÑ„Åô„ÅÑË™¨Êòé„Çí„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„ÄÇ\\r\\nÊÉ≥ÂÆöÈÄö„Çä„ÅÆÂãï‰Ωú„Å†„Å£„Åü„Å®„ÅÑ„ÅÜ„Åì„Å®„Åß„Åô„Å≠„ÄÅ„ÅäÊâãÊï∞„Çí„ÅäÊéõ„Åë„Åó„Å¶„Åó„Åæ„ÅÑÁî≥„ÅóË®≥„ÅÇ„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_278", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"278\", \"title\": \"0-infinite quantifier inside lookbehind causes catastrophic backtracking\", \"author\": \"RedCMD\", \"labels\": [\"question\"], \"description\": \"original issue: https://github.com/microsoft/vscode-textmate/issues/166\\r\\n\\r\\nthe regex `(?<=ab*)c` runs into catastrophic backtracking when matching against a long line of `c`'s\\r\\nhowever `(?<=ab+|a)c` does not have this issue\", \"comments\": [{\"author\": \"kkos\", \"body\": \"(?<=ab+|a)c is transformed into (?:(?<=ab+)|(?<=a))c.\\r\\n/ab+/ and /a/ have very good properties for look-behind.\\r\\n/ab+/ has the property that it always ends with a 'b', and /a/ is a pattern with a fixed number of characters.\\r\\nI think I should fix it so that (?<=ab*)c is converted to (?<=ab+|a)c.\\r\\nBut I don't know when it can be done as I don't have time.\"}, {\"author\": \"RedCMD\", \"body\": \"sadly `(?<=ab+|a)c` runs into the same problem but with a long line of `bc`'s instead\\r\\n\\r\\nhow does lookbehind work?\\r\\ndoes it start at every character in the string and go forward?\\r\\nor does it match the `c` first and go backwards?\\r\\nhow well can it handle multi-length regexs?\\r\\n\\r\\nI noticed limiting the possible length of `b*` to like `b{0,100}` reduces lag quite a bit\\r\\n\\r\\nthe initial regex I had problems with was `(?<={\\\\d*)\\\\\\\\\\\\\\\\(?=,\\\\d*})`\\r\\nthe first half was causing heaps of lag on every single double `\\\\\\\\` it found. \"}, {\"author\": \"kkos\", \"body\": \"Look-behind is made as a type of anchor.\\r\\nFirst find the location of c, then perform look-behind matching backward from that location.\\r\\nSince ab* and  ab+ have infinite length, if they do not match, they go back one character at a time to the beginning of the string.\\r\\nIf ab{0,100}, it will only go back a maximum of 101 characters.\\r\\n\\r\\nOriginally, it did not support variable length look-behind.\\r\\nI recall that before making modifications to accommodate variable length, I considered whether to give special treatment only to cases where there is an look-behind at the beginning of the pattern.\\r\\n```\\r\\n/(?<=p1)p2/ ---> /p1\\\\Kp2/ \\r\\n```\\r\\nBut I can't remember why I stopped this.\\r\\nEither there is something wrong with this conversion and I have given up, or I have decided that it is not worth implementing so much because it only corresponds to cases where there is an look-behind at the beginning of the pattern.\\r\\nI'll think again.\"}, {\"author\": \"RedCMD\", \"body\": \"I assume you stopped because using `\\\\K` still captures the text `p1` in that regex\\r\\nwhich is different to the 0width lookbehind\\r\\n\\r\\nwhat optimizations are there around detecting `a` or `b` as being the only possible last characters in the lookbehind `(?<=ab*)`?\\r\\nand thus checking if `x` is `b` or `a` in `xc` and stopping early\\r\\ntho I would assume it to get very complex\\r\\n\\r\\nI just tested with `(?:(?<=ab+)|(?<=a))c` instead of `(?<=ab*)c`\\r\\nand there was no lag on a long line of `a`'s, `b`'s or `c`'s. But there was still lag with `bc`'s \\r\\n`ac` and `dc` didn't lag either\\r\\nIm testing this through vscodes textmate syntax highlighting\\r\\n\\r\\nIs it possible to physically reverse the execution direction of the regex?\\r\\nso `(?<=abcdef)` would check `f` first, then `e` etc with `a` last\"}, {\"author\": \"kkos\", \"body\": \"No optimization exists for (?<=ab*).\\r\\nFor (?:(?<=ab+)|(?<=a))c , there is a minimal optimization that checks that b is immediately before c for the part of (?<=ab+).\\r\\nI knew there was a way to match in the reverse direction even before I had to deal with variable length look-behind, and it would be possible.\\r\\nIt is just that I have no intention of implementing it.\"}, {\"author\": \"RedCMD\", \"body\": \"I just ran into a similar problem again\\r\\n\\r\\nhere's a simplified regex `a++b`\\r\\nit is very slow when attempting to match against a very long line of `a`'s\\r\\n\\r\\nhowever the regex `ca++b` does not have an issue\\r\\neven against a long line of `ca`'s or even `caaaaaaaa`...`aaaaaaaa` is fine\\r\\n\\r\\nsurprisingly the regex `(?~|x|a+)b` does not lag either\\r\\nhowever on a long line `aaaaaa`...`aaaaaxb`, it lags tremendously\\r\\n\\r\\nthe original regex I had a problem with ``(?=[\\\\x85[^-?:,\\\\[\\\\]{}#&*!|>'\\\"%@` \\\\p{Cntrl}\\\\p{Surrogate}\\\\x{FEFF FFFE FFFF}]]|[?:-](?![\\\\r\\\\n\\\\t ,\\\\[\\\\]{}]))(?=(?>[^:#,\\\\[\\\\]{}]++|(?<! |\\\\t)#++|:(?=[^\\\\r\\\\n\\\\t ,\\\\[\\\\]{}]))++:[\\\\r\\\\n\\\\t ,\\\\[\\\\]{}])``\\r\\nTesting this in the context of VSCode's TextMate engine\"}, {\"author\": \"RedCMD\", \"body\": \"I just found an interesting work around\\r\\nsimply append `|(*ERROR)` to the end of the regex\\r\\n\\r\\nhowever it does mean, the regex **must** match at the start of the string\\r\\nbut depending on your application, that may be desirable\\r\\n\\r\\npossibly a more performant _version_ of `\\\\G`\\r\\n\\r\\nEDIT:\\r\\nDue to how VSCode TextMate caches its regex's\\r\\n`(*ERROR)` won't work for me\"}, {\"author\": \"kkos\", \"body\": \"I could not reproduce this slowing down.\\r\\n`/a++b/  and \\\"aaa.....\\\" (length 3000)   ==> 32msec.`\\r\\nIs ++ not a greedy operator?\"}, {\"author\": \"RedCMD\", \"body\": \"sorry\\r\\nI didn't specify that it wasn't catastrophic backtracking\\r\\nfor me `a++b` (possessive greedy) on 3000 `a`'s is about `38ms`\\r\\nbut if I place a single `b` at the end, it drops down to about `0.1ms`; a 380x speed up\\r\\n\\r\\nIf I double the `a`'s to 6000, the time increases to 155ms\\r\\n12000 `a`'s is 624ms\\r\\n\\r\\nso it's `N^2` time complexity\\r\\n\\r\\n`a+?b` (reluctant), takes about 10% more time\\r\\n\\r\\nI guess this doesn't matter too much; as it isn't catastrophic backtracking\\r\\n(and it seems there's already some good optimizations working)\\r\\n\\r\\nI'm just being a bit nitpicky \\r\\nseeing a single regex take longer to scan a 12k char long file \\r\\nthan a complex grammar tokenizing a 200k char file in less than 500ms\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_279", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"279\", \"title\": \"Internal `^` and `$` don't match as characters for GREP and POSIX_BASIC syntax\", \"author\": \"rivy\", \"labels\": [\"specification\"], \"description\": \"Per the [specification](https://pubs.opengroup.org/onlinepubs/009696899/basedefs/xbd_chap09.html#tag_09_03_08) (and [GNU `grep`](https://www.gnu.org/software/grep/manual/html_node/Basic-vs-Extended.html)), basic regular expressions (aka, default `grep`) should only treat `^` and `$` as anchors when they start or end (respectively) an expression or sub-expression. When used as internal characters, `^` and `$` should be treated as regular characters, but this isn't happening correctly.\\r\\n\\r\\n```clang\\r\\n// added to *test/test_syntax.c*\\r\\nSyntax = ONIG_SYNTAX_GREP;\\r\\nx2(\\\"a\\\\\\\\^b\\\", \\\"a^b\\\", 0, 3);\\r\\nx2(\\\"a^b\\\", \\\"a^b\\\", 0, 3);  // FAILS, but shouldn't\\r\\nx2(\\\"a\\\\\\\\$b\\\", \\\"a$b\\\", 0, 3);\\r\\nx2(\\\"a$b\\\", \\\"a$b\\\", 0, 3);  // FAILS, but shouldn't\\r\\n\\r\\nSyntax = ONIG_SYNTAX_POSIX_BASIC;\\r\\nx2(\\\"a\\\\\\\\^b\\\", \\\"a^b\\\", 0, 3);\\r\\nx2(\\\"a^b\\\", \\\"a^b\\\", 0, 3);  // FAILS, but shouldn't\\r\\nx2(\\\"a\\\\\\\\$b\\\", \\\"a$b\\\", 0, 3);\\r\\nx2(\\\"a$b\\\", \\\"a$b\\\", 0, 3);  // FAILS, but shouldn't\\r\\n```\\r\\n\\r\\nGNU/POSIX `grep` confirms the expected behavior...\\r\\n\\r\\n```shell\\r\\n$ echo \\\"a^b\\\" | grep \\\"a\\\\\\\\^b\\\"\\r\\na^b\\r\\n$ echo \\\"a^b\\\" | grep \\\"a^b\\\"\\r\\na^b\\r\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Thank you. I will fix it.\\r\\nHowever, in grep, I don't understand why Alternation is the start boundary of a sub-expression but not the end boundary.\\r\\n```\\r\\n$ echo \\\"ab\\\" | grep \\\"zz\\\\|^ab\\\"\\r\\nab\\r\\n$ echo \\\"ab\\\\$\\\" | grep \\\"ab\\\\$\\\\|zz\\\"\\r\\nab$\\r\\n```\"}, {\"author\": \"rivy\", \"body\": \"ü§∑üèª\\r\\nMy reading was that `^` was treated as an anchor at the start of a basic regexp (BRE) or BRE subexpression and just a character otherwise; `$` is an anchor at the end of a BRE or BRE subexpression, otherwise just a character. And BRE == `grep` default == `grep -G`.\\r\\n\\r\\nThere may be some interaction with shell expansion when testing.\\r\\n\\r\\n```shell\\r\\n$ # using single quotes to avoid shell expansion of `$...`\\r\\n$ echo \\\"ab\\\" | grep -G 'ab$'\\r\\nab\\r\\n$ echo \\\"ab\\\" | grep -G 'ab$x'\\r\\n*($?=1)*\\r\\n$ echo \\\"ab\\\\$x\\\" | grep -G 'ab$x'\\r\\nab$x\\r\\n$ echo \\\"ab\\\\$x\\\" | grep -G 'ab$'\\r\\n*($?=1)*\\r\\n$ echo \\\"ab\\\" | grep -G 'aa\\\\|ab$x'\\r\\n*($?=1)*\\r\\n$ echo \\\"ab\\\" | grep -G 'aa\\\\|ab$\\\\|zz'\\r\\nab\\r\\n```\\r\\n\\r\\nThank you for looking at this... I've got enough knowledge to poke at the problem, but not enough to fix it.\\r\\nüòÑ \"}, {\"author\": \"kkos\", \"body\": \"My grep does not match the following combination of $ and \\\\\\\\|.\\r\\n```\\r\\n$ echo \\\"ab\\\" | grep -G 'ab$\\\\|zz'; echo $?\\r\\n1\\r\\n$ grep -V\\r\\ngrep (BSD grep) 2.5.1-FreeBSD\\r\\n```\\r\\nBut as it is anyway, I have corrected it as noted.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"// Comparison of  `'ab$\\\\|zz'`  and  `'ab$|zz'` .\\r\\n\\r\\n< Live CD: FreeBSD-13.1-RELEASE-amd64-bootonly.iso >\\r\\n\\r\\n```\\r\\nroot@:~ # `grep -V`\\r\\ngrep (BSD grep, GNU compatible) 2.6.0-FreeBSD\\r\\n```\\r\\n\\r\\n\\r\\n------\\r\\n// no option\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep 'ab$\\\\|zz' ; echo $?\\r\\nab\\r\\n0\\r\\n```\\r\\n\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep 'ab$|zz' ; echo $?\\r\\n1\\r\\n```\\r\\n------ \\r\\n// -G \\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -G 'ab$\\\\|zz' ; echo $?\\r\\nab\\r\\n0\\r\\n```\\r\\n\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -G 'ab$|zz' ; echo $?\\r\\n1\\r\\n```\\r\\n------\\r\\n// -E\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -E 'ab$\\\\|zz' ; echo $?\\r\\n1\\r\\n```\\r\\n\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -E 'ab$|zz' ; echo $?\\r\\nab\\r\\n0\\r\\n```\\r\\n------\\r\\n// -E -G\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -E -G 'ab$\\\\|zz' ; echo $?\\r\\nab\\r\\n0\\r\\n```\\r\\n\\r\\n```\\r\\nroot@:~ # echo \\\"ab\\\" | grep -E -G 'ab$|zz' ; echo $?\\r\\n1\\r\\n```\\r\\n------\\r\\n\\r\\nHave a happy New Year‚Äôs Eve. \"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_280", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"280\", \"title\": \"add oniguruma-devel to centos8.0+\", \"author\": \"AliceSync\", \"labels\": [], \"description\": \"Hi, dear developer, when I try to compile a software on my centos8, it prompts me that I need \\\"oniguruma\\\", I installed it with \\\"dnf install oniguruma\\\", but it still can't compile, I found that I need a \\\"oniguruma-devel\\\", but it does not exist in the \\\"appstream\\\" of centos8, can you add it to the software source, I don't want to download and compile from github, because it will reduce my automation efficiency.\\r\\n\\r\\nThanks for your effort :)\\r\\n\", \"comments\": [{\"author\": \"AliceSync\", \"body\": \"Forgot to say, \\\"oniguruma-devel\\\" exists in centos7, in redhat8+, I can't find \\\"oniguruma-devel\\\", even rocky8+\"}, {\"author\": \"AliceSync\", \"body\": \"I found it available in \\\"PowerTools\\\" at \\\"https://pkgs.org/\\\", but I haven't used \\\"PowerTools\\\" and I'm not sure if it's trustworthy or provided by you ,please help me!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_282", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"282\", \"title\": \"Dynamic library generated failed to support \\\"(?-i)\\\"\", \"author\": \"hansonchar\", \"labels\": [], \"description\": \"Background: https://github.com/stedolan/jq/issues/2558\\r\\n\\r\\nThe gist of this issue is that somewhere after the commit `6fa38f4084b448592888ed9ee43c6e90a46b5f5c`,  the use of the generated dynamic library such as `libonig.5.dylib` on OSX or `libonig.5.so` on Ubuntu by `jq`  would fail to support the regex `(?-i)`.  \\r\\n\\r\\nFor example: \\r\\n\\r\\n```\\r\\njq -n '(\\\"test\\\", \\\"TEst\\\", \\\"teST\\\", \\\"TEST\\\") | test( \\\"(?i)te(?-i)st\\\" )'\\r\\njq: error (at <unknown>): Regex failure: invalid group name <>\\r\\n```\\r\\n\\r\\nThe problem went away if I manually replaced the shared library `libonig.5.dylib` by `libonig.4.dylib` built with the earlier commit:\\r\\n\\r\\n```\\r\\njq -n '(\\\"test\\\", \\\"TEst\\\", \\\"teST\\\", \\\"TEST\\\") | test( \\\"(?i)te(?-i)st\\\" )'\\r\\ntrue\\r\\ntrue\\r\\nfalse\\r\\nfalse\\r\\n```\\r\\n\", \"comments\": [{\"author\": \"hansonchar\", \"body\": \"Using `git bisect`, the first bad commit related to this issue is located:\\r\\n\\r\\n```\\r\\n$ git bisect good\\r\\n574722cce940f77b19163c2cf50d155989be675b is the first bad commit\\r\\ncommit 574722cce940f77b19163c2cf50d155989be675b\\r\\nAuthor: K.Kosako <kosako@sofnec.co.jp>\\r\\nDate:   Mon Nov 13 17:45:26 2017 +0900\\r\\n\\r\\n    add ONIG_SYN_OP2_QMARK_PERL_SUBEXP_CALL into OnigSyntaxPerl_NG\\r\\n\\r\\n src/regsyntax.c | 3 ++-\\r\\n 1 file changed, 2 insertions(+), 1 deletion(-)\\r\\n```\\r\\n\\r\\nIn other words, the last good commit was:\\r\\n\\r\\n```\\r\\ncommit 474e5dd6a245faf5f75922bc83f077e55881fa5b (HEAD -> 474e5dd)\\r\\nAuthor: K.Kosako <kosako@sofnec.co.jp>\\r\\nDate:   Mon Nov 13 17:44:22 2017 +0900\\r\\n\\r\\n    implement subexp calls (?R), (?&name), (?-n), (?+n) for Perl syntax\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"Thank you very much.\\r\\nIt has been reproduced.\\r\\nI will try to correct it.\"}, {\"author\": \"hansonchar\", \"body\": \"I've verified on OSX (ie my laptop) that this indeed fixes the issue.  Super!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_283", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"283\", \"title\": \"oniguruma not able to installed on PPC64le architecture \", \"author\": \"shreyakajbaje\", \"labels\": [], \"description\": \"trying to install oniguruma on power architecture\\r\\n\\r\\ncommand used - pip3 install onigurumacffi\\r\\n\\r\\npython version - Python 3.9.13\\r\\n\\r\\n### logs - \\r\\n<sub>Collecting onigurumacffi\\r\\n  Using cached onigurumacffi-1.2.0.tar.gz (5.7 kB)\\r\\nRequirement already satisfied: cffi>=1 in /usr/local/lib64/python3.9/site-packages (from onigurumacffi) (1.15.1)\\r\\nRequirement already satisfied: pycparser in /usr/local/lib/python3.9/site-packages (from cffi>=1->onigurumacffi) (2.21)\\r\\nBuilding wheels for collected packages: onigurumacffi\\r\\n  Building wheel for onigurumacffi (setup.py) ... error\\r\\n  ERROR: Command errored out with exit status 1:\\r\\n   command: /usr/bin/python3.9 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"'; __file__='\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"';f=getattr(tokenize, '\\\"'\\\"'open'\\\"'\\\"', open)(__file__);code=f.read().replace('\\\"'\\\"'\\\\r\\\\n'\\\"'\\\"', '\\\"'\\\"'\\\\n'\\\"'\\\"');f.close();exec(compile(code, __file__, '\\\"'\\\"'exec'\\\"'\\\"'))' bdist_wheel -d /tmp/pip-wheel-6mt2ws43\\r\\n       cwd: /tmp/pip-install-u7ipuggp/onigurumacffi/\\r\\n  Complete output (109 lines):\\r\\n  running bdist_wheel\\r\\n  running build\\r\\n  running build_py\\r\\n  creating build\\r\\n  creating build/lib.linux-ppc64le-3.9\\r\\n  copying onigurumacffi.py -> build/lib.linux-ppc64le-3.9\\r\\n  running build_ext\\r\\n  generating cffi module 'build/temp.linux-ppc64le-3.9/_onigurumacffi.c'\\r\\n  creating build/temp.linux-ppc64le-3.9\\r\\n  building '_onigurumacffi' extension\\r\\n  creating build/temp.linux-ppc64le-3.9/build\\r\\n  creating build/temp.linux-ppc64le-3.9/build/temp.linux-ppc64le-3.9\\r\\n  gcc -pthread -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python3.9 -c build/temp.linux-ppc64le-3.9/_onigurumacffi.c -o build/temp.linux-ppc64le-3.9/build/temp.linux-ppc64le-3.9/_onigurumacffi.o\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:624:5: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       OnigRegSet* set,\\r\\n       ^~~~~~~~~~\\r\\n       OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:821:38: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n   static void _cffi_d_onig_regset_free(OnigRegSet * x0)\\r\\n                                        ^~~~~~~~~~\\r\\n                                        OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onig_regset_free‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:829:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     OnigRegSet * x0;\\r\\n     ^~~~~~~~~~\\r\\n     OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                         ^~~~~~~~~~\\r\\n                                         OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:39: note: each undeclared identifier is reported only once for each function it appears in\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:51: error: expected expression before ‚Äò)‚Äô token\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                                     ^\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:844:5: warning: implicit declaration of function ‚Äòonig_regset_free‚Äô; did you mean ‚Äòonig_region_free‚Äô? [-Wimplicit-function-declaration]\\r\\n     { onig_regset_free(x0); }\\r\\n       ^~~~~~~~~~~~~~~~\\r\\n       onig_region_free\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:857:36: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n   static int _cffi_d_onig_regset_new(OnigRegSet * * x0, int x1, regex_t * * x2)\\r\\n                                      ^~~~~~~~~~\\r\\n                                      OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onig_regset_new‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:865:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     OnigRegSet * * x0;\\r\\n     ^~~~~~~~~~\\r\\n     OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:882:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet * *)alloca((size_t)datasize) : NULL;\\r\\n                                         ^~~~~~~~~~\\r\\n                                         OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:882:53: error: expected expression before ‚Äò)‚Äô token\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet * *)alloca((size_t)datasize) : NULL;\\r\\n                                                       ^\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:903:14: warning: implicit declaration of function ‚Äòonig_regset_new‚Äô; did you mean ‚Äòonig_region_new‚Äô? [-Wimplicit-function-declaration]\\r\\n     { result = onig_regset_new(x0, x1, x2); }\\r\\n                ^~~~~~~~~~~~~~~\\r\\n                onig_region_new\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1156:43: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n   static int _cffi_d_onigcffi_regset_search(OnigRegSet * x0, unsigned char const * x1, size_t x2, size_t x3, OnigRegion * * x4, unsigned int x5)\\r\\n                                             ^~~~~~~~~~\\r\\n                                             OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onigcffi_regset_search‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1164:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     OnigRegSet * x0;\\r\\n     ^~~~~~~~~~\\r\\n     OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1187:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                         ^~~~~~~~~~\\r\\n                                         OnigRegex\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1187:51: error: expected expression before ‚Äò)‚Äô token\\r\\n       x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                                     ^\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1225:14: warning: implicit declaration of function ‚Äòonigcffi_regset_search‚Äô; did you mean ‚Äòonigcffi_search‚Äô? [-Wimplicit-function-declaration]\\r\\n     { result = onigcffi_regset_search(x0, x1, x2, x3, x4, x5); }\\r\\n                ^~~~~~~~~~~~~~~~~~~~~~\\r\\n                onigcffi_search\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1364:12: error: ‚ÄòONIG_OPTION_NOT_BEGIN_POSITION‚Äô undeclared (first use in this function); did you mean ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION‚Äô?\\r\\n     int n = (ONIG_OPTION_NOT_BEGIN_POSITION) <= 0;\\r\\n              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n              _cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_STRING‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1371:12: error: ‚ÄòONIG_OPTION_NOT_BEGIN_STRING‚Äô undeclared (first use in this function); did you mean ‚ÄòONIG_OPTION_NEGATE_SINGLELINE‚Äô?\\r\\n     int n = (ONIG_OPTION_NOT_BEGIN_STRING) <= 0;\\r\\n              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n              ONIG_OPTION_NEGATE_SINGLELINE\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_END_STRING‚Äô:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1378:12: error: ‚ÄòONIG_OPTION_NOT_END_STRING‚Äô undeclared (first use in this function); did you mean ‚ÄòONIG_OPTION_EXTEND‚Äô?\\r\\n     int n = (ONIG_OPTION_NOT_END_STRING) <= 0;\\r\\n              ^~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n              ONIG_OPTION_EXTEND\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1417:106: error: ‚Äò_cffi_d_onig_regset_free‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onig_regset_free‚Äô?\\r\\n     { \\\"onig_regset_free\\\", (void *)_cffi_f_onig_regset_free, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_O, 40), (void *)_cffi_d_onig_regset_free },\\r\\n                                                                                                            ^~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                            _cffi_f_onig_regset_free\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1418:103: error: ‚Äò_cffi_d_onig_regset_new‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onig_regset_new‚Äô?\\r\\n     { \\\"onig_regset_new\\\", (void *)_cffi_f_onig_regset_new, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_V, 4), (void *)_cffi_d_onig_regset_new },\\r\\n                                                                                                         ^~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                         _cffi_f_onig_regset_new\\r\\n  build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1424:117: error: ‚Äò_cffi_d_onigcffi_regset_search‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onigcffi_regset_search‚Äô?\\r\\n     { \\\"onigcffi_regset_search\\\", (void *)_cffi_f_onigcffi_regset_search, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_V, 9), (void *)_cffi_d_onigcffi_regset_search },\\r\\n                                                                                                                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                                       _cffi_f_onigcffi_regset_search\\r\\n  error: command '/usr/bin/gcc' failed with exit code 1\\r\\n  ----------------------------------------\\r\\n  ERROR: Failed building wheel for onigurumacffi\\r\\n  Running setup.py clean for onigurumacffi\\r\\nFailed to build onigurumacffi\\r\\nInstalling collected packages: onigurumacffi\\r\\n    Running setup.py install for onigurumacffi ... error\\r\\n    ERROR: Command errored out with exit status 1:\\r\\n     command: /usr/bin/python3.9 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"'; __file__='\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"';f=getattr(tokenize, '\\\"'\\\"'open'\\\"'\\\"', open)(__file__);code=f.read().replace('\\\"'\\\"'\\\\r\\\\n'\\\"'\\\"', '\\\"'\\\"'\\\\n'\\\"'\\\"');f.close();exec(compile(code, __file__, '\\\"'\\\"'exec'\\\"'\\\"'))' install --record /tmp/pip-record-nh_vjpax/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/include/python3.9/onigurumacffi\\r\\n         cwd: /tmp/pip-install-u7ipuggp/onigurumacffi/\\r\\n    Complete output (109 lines):\\r\\n    running install\\r\\n    running build\\r\\n    running build_py\\r\\n    creating build\\r\\n    creating build/lib.linux-ppc64le-3.9\\r\\n    copying onigurumacffi.py -> build/lib.linux-ppc64le-3.9\\r\\n    running build_ext\\r\\n    generating cffi module 'build/temp.linux-ppc64le-3.9/_onigurumacffi.c'\\r\\n    creating build/temp.linux-ppc64le-3.9\\r\\n    building '_onigurumacffi' extension\\r\\n    creating build/temp.linux-ppc64le-3.9/build\\r\\n    creating build/temp.linux-ppc64le-3.9/build/temp.linux-ppc64le-3.9\\r\\n    gcc -pthread -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fexceptions -fstack-protector-strong -grecord-gcc-switches -m64 -mcpu=power8 -mtune=power8 -funwind-tables -fstack-clash-protection -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python3.9 -c build/temp.linux-ppc64le-3.9/_onigurumacffi.c -o build/temp.linux-ppc64le-3.9/build/temp.linux-ppc64le-3.9/_onigurumacffi.o\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:624:5: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n         OnigRegSet* set,\\r\\n         ^~~~~~~~~~\\r\\n         OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:821:38: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     static void _cffi_d_onig_regset_free(OnigRegSet * x0)\\r\\n                                          ^~~~~~~~~~\\r\\n                                          OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onig_regset_free‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:829:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       OnigRegSet * x0;\\r\\n       ^~~~~~~~~~\\r\\n       OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                           ^~~~~~~~~~\\r\\n                                           OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:39: note: each undeclared identifier is reported only once for each function it appears in\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:836:51: error: expected expression before ‚Äò)‚Äô token\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                                       ^\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:844:5: warning: implicit declaration of function ‚Äòonig_regset_free‚Äô; did you mean ‚Äòonig_region_free‚Äô? [-Wimplicit-function-declaration]\\r\\n       { onig_regset_free(x0); }\\r\\n         ^~~~~~~~~~~~~~~~\\r\\n         onig_region_free\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:857:36: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     static int _cffi_d_onig_regset_new(OnigRegSet * * x0, int x1, regex_t * * x2)\\r\\n                                        ^~~~~~~~~~\\r\\n                                        OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onig_regset_new‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:865:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       OnigRegSet * * x0;\\r\\n       ^~~~~~~~~~\\r\\n       OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:882:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet * *)alloca((size_t)datasize) : NULL;\\r\\n                                           ^~~~~~~~~~\\r\\n                                           OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:882:53: error: expected expression before ‚Äò)‚Äô token\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet * *)alloca((size_t)datasize) : NULL;\\r\\n                                                         ^\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:903:14: warning: implicit declaration of function ‚Äòonig_regset_new‚Äô; did you mean ‚Äòonig_region_new‚Äô? [-Wimplicit-function-declaration]\\r\\n       { result = onig_regset_new(x0, x1, x2); }\\r\\n                  ^~~~~~~~~~~~~~~\\r\\n                  onig_region_new\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1156:43: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n     static int _cffi_d_onigcffi_regset_search(OnigRegSet * x0, unsigned char const * x1, size_t x2, size_t x3, OnigRegion * * x4, unsigned int x5)\\r\\n                                               ^~~~~~~~~~\\r\\n                                               OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_f_onigcffi_regset_search‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1164:3: error: unknown type name ‚ÄòOnigRegSet‚Äô; did you mean ‚ÄòOnigRegex‚Äô?\\r\\n       OnigRegSet * x0;\\r\\n       ^~~~~~~~~~\\r\\n       OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1187:39: error: ‚ÄòOnigRegSet‚Äô undeclared (first use in this function); did you mean ‚ÄòOnigRegex‚Äô?\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                           ^~~~~~~~~~\\r\\n                                           OnigRegex\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1187:51: error: expected expression before ‚Äò)‚Äô token\\r\\n         x0 = ((size_t)datasize) <= 640 ? (OnigRegSet *)alloca((size_t)datasize) : NULL;\\r\\n                                                       ^\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1225:14: warning: implicit declaration of function ‚Äòonigcffi_regset_search‚Äô; did you mean ‚Äòonigcffi_search‚Äô? [-Wimplicit-function-declaration]\\r\\n       { result = onigcffi_regset_search(x0, x1, x2, x3, x4, x5); }\\r\\n                  ^~~~~~~~~~~~~~~~~~~~~~\\r\\n                  onigcffi_search\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1364:12: error: ‚ÄòONIG_OPTION_NOT_BEGIN_POSITION‚Äô undeclared (first use in this function); did you mean ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION‚Äô?\\r\\n       int n = (ONIG_OPTION_NOT_BEGIN_POSITION) <= 0;\\r\\n                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                _cffi_const_ONIG_OPTION_NOT_BEGIN_POSITION\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_BEGIN_STRING‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1371:12: error: ‚ÄòONIG_OPTION_NOT_BEGIN_STRING‚Äô undeclared (first use in this function); did you mean ‚ÄòONIG_OPTION_NEGATE_SINGLELINE‚Äô?\\r\\n       int n = (ONIG_OPTION_NOT_BEGIN_STRING) <= 0;\\r\\n                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                ONIG_OPTION_NEGATE_SINGLELINE\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: In function ‚Äò_cffi_const_ONIG_OPTION_NOT_END_STRING‚Äô:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1378:12: error: ‚ÄòONIG_OPTION_NOT_END_STRING‚Äô undeclared (first use in this function); did you mean ‚ÄòONIG_OPTION_EXTEND‚Äô?\\r\\n       int n = (ONIG_OPTION_NOT_END_STRING) <= 0;\\r\\n                ^~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                ONIG_OPTION_EXTEND\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c: At top level:\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1417:106: error: ‚Äò_cffi_d_onig_regset_free‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onig_regset_free‚Äô?\\r\\n       { \\\"onig_regset_free\\\", (void *)_cffi_f_onig_regset_free, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_O, 40), (void *)_cffi_d_onig_regset_free },\\r\\n                                                                                                              ^~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                              _cffi_f_onig_regset_free\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1418:103: error: ‚Äò_cffi_d_onig_regset_new‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onig_regset_new‚Äô?\\r\\n       { \\\"onig_regset_new\\\", (void *)_cffi_f_onig_regset_new, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_V, 4), (void *)_cffi_d_onig_regset_new },\\r\\n                                                                                                           ^~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                           _cffi_f_onig_regset_new\\r\\n    build/temp.linux-ppc64le-3.9/_onigurumacffi.c:1424:117: error: ‚Äò_cffi_d_onigcffi_regset_search‚Äô undeclared here (not in a function); did you mean ‚Äò_cffi_f_onigcffi_regset_search‚Äô?\\r\\n       { \\\"onigcffi_regset_search\\\", (void *)_cffi_f_onigcffi_regset_search, _CFFI_OP(_CFFI_OP_CPYTHON_BLTN_V, 9), (void *)_cffi_d_onigcffi_regset_search },\\r\\n                                                                                                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n                                                                                                                         _cffi_f_onigcffi_regset_search\\r\\n    error: command '/usr/bin/gcc' failed with exit code 1\\r\\n    ----------------------------------------\\r\\nERROR: Command errored out with exit status 1: /usr/bin/python3.9 -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"'; __file__='\\\"'\\\"'/tmp/pip-install-u7ipuggp/onigurumacffi/setup.py'\\\"'\\\"';f=getattr(tokenize, '\\\"'\\\"'open'\\\"'\\\"', open)(__file__);code=f.read().replace('\\\"'\\\"'\\\\r\\\\n'\\\"'\\\"', '\\\"'\\\"'\\\\n'\\\"'\\\"');f.close();exec(compile(code, __file__, '\\\"'\\\"'exec'\\\"'\\\"'))' install --record /tmp/pip-record-nh_vjpax/install-record.txt --single-version-externally-managed --compile --install-headers /usr/local/include/python3.9/onigurumacffi Check the logs for full command output. </sub>\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think OnigRegSet does not exist in oniguruma.h?\\r\\nOnigRegSet has existed since version 6.9.4 (29/11/2019).\\r\\nIs the version of Oniguruma (or libonig-dev) installed older than that?\\r\\nCheck the version in oniguruma.h.\\r\\nI don't know what range of versions of Oniguruma are supported by onigurumacffi, but looking at the following files, 6.9.8 should be fine.\\r\\n\\r\\nhttps://github.com/asottile/onigurumacffi/blob/main/bin/clone-oniguruma\"}, {\"author\": \"shreyakajbaje\", \"body\": \"Hi @kkos, oniguruma-6.8.2-2.el8.ppc64le  and oniguruma-devel-6.8.2-2.el8.ppc64le is installed\"}, {\"author\": \"mtasaka\", \"body\": \"As kkos said, `OnigRegSet` struct definition is added with this commit: https://github.com/kkos/oniguruma/commit/fb7f5403b08701adb86a2b49010f29f476abf983 , available on [v6.9.4_mark1](https://github.com/kkos/oniguruma/releases/tag/v6.9.4_mark1) and above.\\r\\n\\r\\nI guess EL8 `oniguruma-6.8.2-2.el8` is based on oniguruma 6.8.2, so I don't expect `OnigRegSet` definition is available. This means you have to compile new oniguruma by yourself first.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_284", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"284\", \"title\": \"`.{0,99}` and `.*` behave differently on short input\", \"author\": \"jorendorff\", \"labels\": [], \"description\": \"Add these lines to `test/test_syntax.c`:\\r\\n\\r\\n```C\\r\\n  x2(\\\"^\\\\\\\\s*B\\\\\\\\n\\\\\\\\s*M\\\\\\\\s*.{0,99}\\\\\\\\R\\\", \\\"B\\\\n  M;\\\\n\\\", 0, 7);\\r\\n  x2(\\\"^\\\\\\\\s*B\\\\\\\\n\\\\\\\\s*M\\\\\\\\s*.*\\\\\\\\R\\\", \\\"B\\\\n  M;\\\\n\\\", 0, 7);\\r\\n```\\r\\n\\r\\nThe output is:\\r\\n\\r\\n```console\\r\\nOK: /^\\\\s*B\\\\n\\\\s*M\\\\s*.{0,99}\\\\R/ 'B\\r\\n  M;\\r\\n'\\r\\nFAIL: /^\\\\s*B\\\\n\\\\s*M\\\\s*.*\\\\R/ 'B\\r\\n  M;\\r\\n'\\r\\n\\r\\nRESULT   SUCC:  172,  FAIL: 1,  ERROR: 0      (by Oniguruma 6.9.8)\\r\\n```\\r\\n\\r\\nI think both regexes should match.\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Below is another sample code.\\r\\n\\r\\n```\\r\\n  // issue 284\\r\\n  x2(\\\"\\\\\\\\A.*\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);       // .*   FAIL\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\O*\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);     //      FAIL\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\n*\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);     //      FAIL\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\R*\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n  x2(\\\"\\\\\\\\At*\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n\\r\\n  x2(\\\"\\\\\\\\A.{0,99}\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);   // {0,99}\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\O{0,99}\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\n{0,99}\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n  x2(\\\"\\\\\\\\A\\\\\\\\R{0,99}\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n  x2(\\\"\\\\\\\\At{0,99}\\\\\\\\R\\\", \\\"\\\\n\\\", 0, 1);\\r\\n\\r\\n  x2(\\\"\\\\\\\\A.*\\\\\\\\n\\\", \\\"\\\\n\\\", 0, 1);       //  \\\\n\\r\\n  x2(\\\"\\\\\\\\A.{0,99}\\\\\\\\n\\\", \\\"\\\\n\\\", 0, 1);\\r\\n\\r\\n  x2(\\\"\\\\\\\\A.*\\\\\\\\O\\\", \\\"\\\\n\\\", 0, 1);       //  \\\\O \\r\\n  x2(\\\"\\\\\\\\A.{0,99}\\\\\\\\O\\\", \\\"\\\\n\\\", 0, 1);\\r\\n\\r\\n  x2(\\\"\\\\\\\\A.*\\\\\\\\s\\\", \\\"\\\\n\\\", 0, 1);       //  \\\\s\\r\\n  x2(\\\"\\\\\\\\A.{0,99}\\\\\\\\s\\\", \\\"\\\\n\\\", 0, 1);\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"It did indeed FAIL in the first three cases.\\r\\nI will look into the cause.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_286", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"286\", \"title\": \"mbc_enc_len(const UChar* p) to be improved\", \"author\": \"pengfei-su\", \"labels\": [], \"description\": \"[mbc_enc_len(const UChar* p)](https://github.com/kkos/oniguruma/blob/a279b13bd2d49b51a6a58fb8217f9bfb4514699f/src/utf8.c#L71) can be improved by saving unnecessary memory accesses to EncLen_UTF8[*p]. Because array EncLen_UTF8[] is constant, of which adjacent elements share the same values. \\r\\n\\r\\nThe proposed optimization:\\r\\n\\r\\nstatic int\\r\\nmbc_enc_len(const UChar* p)\\r\\n{\\r\\n    if (*p < 192) return 1;\\r\\n    else if (*p < 223) return 2;\\r\\n    else if (*p < 239) return 3;\\r\\n    return EncLen_UTF8[*p];\\r\\n}\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The results of running a simple code I wrote did not change.\\r\\nWould a more realistic code change the results?\\r\\n\\r\\n```c\\r\\n#include <stdio.h>\\r\\n#include <string.h>\\r\\n\\r\\n#define FALSE   0\\r\\n#define TRUE    1\\r\\n\\r\\n#define utf8_islead(c)     ((UChar )((c) & 0xc0) != 0x80)\\r\\n#define utf8_istail(c)     ((UChar )((c) & 0xc0) == 0x80)\\r\\n\\r\\ntypedef unsigned char UChar;\\r\\n\\r\\nstatic const int EncLen_UTF8[] = {\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\\r\\n  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\\r\\n  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\\r\\n  3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,\\r\\n  4, 4, 4, 4, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\\r\\n};\\r\\n\\r\\n#define CHANGE\\r\\n\\r\\nstatic int\\r\\nmbc_enc_len(const UChar* p)\\r\\n{\\r\\n#ifdef CHANGE\\r\\n  if (*p < 192) return 1;\\r\\n  else {\\r\\n    if (*p < 224) return 2;\\r\\n    else if (*p < 240) return 3;\\r\\n  }\\r\\n#endif\\r\\n  return EncLen_UTF8[*p];\\r\\n}\\r\\n\\r\\n#define N 10000000\\r\\n\\r\\nextern int\\r\\nmain(int argc, char* argv[])\\r\\n{\\r\\n  static UChar* s = (UChar* )\\\"abcdefghijklmnopqrstuvwxyz1234567890-=^~|@[{]}:*/.>\\\";\\r\\n  UChar* end;\\r\\n  UChar* p;\\r\\n  int i, r;\\r\\n\\r\\n  end = s + strlen((char* )s);\\r\\n\\r\\n  for (i = 0; i < N; i++) {\\r\\n    for (p = s; p < end; p++) {\\r\\n      r = mbc_enc_len(p);\\r\\n    }\\r\\n  }\\r\\n\\r\\n  return 0;\\r\\n}\\r\\n```\"}, {\"author\": \"pengfei-su\", \"body\": \"No, it wouldn't so long as EncLen_UTF8[] is constant.\"}, {\"author\": \"pengfei-su\", \"body\": \"Any follow-up? @kkos \"}, {\"author\": \"kkos\", \"body\": \"If there is no evidence that the change will improve speed, there is nothing that can be done.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_288", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"288\", \"title\": \"Does Oniguruma support POSIX collating symbols or equivalence classes?\", \"author\": \"tavianator\", \"labels\": [], \"description\": \"From https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html#tag_09_03_05, in addition to things like `[[:punct:]]`, POSIX regular expressions support\\r\\n\\r\\n- Collating symbols, e.g. `[[.ch.]]`\\r\\n\\r\\n- Equivalence classes, e.g. `[[=o=]]`\\r\\n\\r\\nAre these supported?  I see no mention of the syntax in https://github.com/kkos/oniguruma/blob/master/doc/SYNTAX.md, and I couldn't get `[[=o=]]` to work in local testing.\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"`[[. .]]` and `[[= =]]` are not supported at this time. K.Kosako (Oniguruma owner) wrote the following.\\nhttps://github.com/kkos/oniguruma/issues/253#issuecomment-1130067754\\n> I have no plans to implement `[= =]` and `[. .]` features. \\n\\n[Added: Feb 1st 2025] Now Oniguruma 6.9.10, There are no plans to implement these yet.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_289", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"289\", \"title\": \"New version?ü§î\", \"author\": \"kloczek\", \"labels\": [], \"description\": \"https://github.com/kkos/oniguruma/compare/v6.9.8...master shows ~100 commits since last release which was almost 1.5 years ago.\\r\\n\\r\\nIs it any plan to release new version soon? ü§î\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I will release within two weeks.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_290", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"290\", \"title\": \"Does \\\"retry-limit-in-match over\\\" mean NOT MATCH?\", \"author\": \"jliu-siteimprove\", \"labels\": [], \"description\": \"Hi here, I get explanation of `retry-limit-in-match over` from [here](https://github.com/kkos/oniguruma/issues/143). I am wondering does this error mean the regex doesn't match the text? Or it could be succeeded if we increase the limit?\\r\\nIs it possible to turn retry off?\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Sorry if this answer is off-topic. Are you having trouble with that error?\\r\\nIf so, please check the regular expression you created.\\r\\nRegular expressions like below will greatly increase the number of retries.\\r\\n`a*a*`\\r\\n`(b*)*`\\r\\n`(a+|b+|c+|d+|e+)*`\\r\\n`(?:)*`\\r\\n\\r\\n-----------\\r\\n### About counting retries\\r\\n\\r\\nUse the following regular expression as an example.\\r\\n`\\\"aaaab\\\" =~ /^a*$/`\\r\\n\\r\\n1. `^a*` matches up to `\\\"aaaa\\\"` .\\r\\n\\r\\n2. But since `\\\"$\\\"` is not found, `\\\"a*\\\"` lets go of the last `\\\"a\\\"` of `\\\"aaaa\\\"` .\\r\\n   At this time, the count increases by 1 .\\r\\n\\r\\n3. Similarly, each time it decrease `\\\"a\\\"` by 1, the count increases by 1.\\r\\n\\r\\n```\\r\\n   \\\"aaaa\\\"\\r\\n   \\\"aaa\\\"   # count1\\r\\n   \\\"aa\\\"    # count2\\r\\n   \\\"a\\\"     # count3\\r\\n   \\\"\\\"      # count4\\r\\n```\\r\\n\\r\\nIf you set the limit to \\\"2\\\" , an error will occur and the search will end\\r\\nas soon as the count reaches \\\"3\\\" .\\r\\n\\r\\nThe default value of this limit is \\\"10000000\\\" .\\r\\nYou can check the operation by changing this number to a smaller number.\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/src/regint.h#L97\\r\\n\\r\\nHowever, the number of retries may not be counted due to optimization.\\r\\nExample, `\\\"aaaa\\\" =~ /^a*b/`\\r\\nIt is probably detecting that there is no \\\"b\\\" in the text.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I will show you how to suppress retries in regular expressions.\\r\\n\\r\\n`(?>a*)`\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/doc/RE#L318-L319\\r\\n\\r\\n`a*+`\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/doc/RE#L159-L169\\r\\n\\r\\nPerl's explanation is also helpful.\\r\\nhttps://perldoc.perl.org/perlre#%28%3F%3Epattern%29\\r\\nhttps://perldoc.perl.org/perlre#Quantifiers\\r\\n\\r\\nAs perl explains, `/a++a/` does not match `'aaaa' `.\\r\\nTherefore, please note that there are situations where you should not use it.\\r\\n\\r\\n--------------\\r\\n\\r\\n### CALLOUTS.BUILTIN\\r\\n\\r\\nAlthough this is not easy to understand.\\r\\nLearning how to use it will help you optimize regular expressions.\\r\\n\\r\\nCALLOUTS.BUILTIN  ( Available from version 6.8.0 ? )\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/CALLOUTS.BUILTIN\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/CALLOUTS.BUILTIN.ja (in Japanese)\\r\\n\\r\\nThis is a sample of CALLOUTS.BUILTIN.\\r\\nhttps://github.com/kkos/oniguruma/blob/master/sample/callout.c\\r\\n\\r\\nPerl5 also has a similar function, so it may be helpful.\\r\\n\\r\\nperl5: Special Backtracking Control Verbs\\r\\nhttps://perldoc.perl.org/perlre#Special-Backtracking-Control-Verbs\\r\\n\\r\\nThis is a note I wrote about \\\"callout.c\\\". (in Japanese)\\r\\nhttps://github.com/tonco-miyazawa/regex_etc/tree/master/MEMO_onig/callout\"}, {\"author\": \"jliu-siteimprove\", \"body\": \"Thanks for the reply.\\r\\n\\r\\nMy regex is `https:\\\\/\\\\/[\\\\s\\\\S]+?\\\\.testsite\\\\.com\\\\/` which tries to match urls\\r\\n\\r\\n`https://testsite.com/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa` - Not match but succeeded\\r\\n\\r\\n`https://testsite.com/testandtest1testandtest2test2test3test3test4test4test5test5test6` - throw `retry-limit-in-match over` exception\\r\\n\\r\\nI was using `\\\\s\\\\S` to match everything which is not true in this case for matching a url, we have changed it to `https:\\\\/\\\\/.+?\\\\.testsite\\\\.com\\\\/` and it works. \\r\\nI just want to understand why the second one can hit the limit but the first one doesn't when two urls have the same length? Should they retry exactly the same times?\\r\\n \\r\\nI also want to ask the \\\"another choice\\\" mentioned in another [thread](https://github.com/kkos/oniguruma/issues/143#issuecomment-497945886). Does the retry happen because `\\\\s\\\\S` has \\\"another choice\\\" but `.` doesn't?\\r\\n\\r\\nOne more thing, if we get this exception, can we catch it and just say it doesn't match?\\r\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"Thanks, I also tried the same test as you. However, no error occurred.\\r\\nAdditionally, I increased the length of the URL, but the error did not occur.\\r\\n  -------  /sample/callout.c  ------\\r\\n  ```\\r\\n// search fail\\r\\n  test(enc, mp, \\\"https:\\\\\\\\/\\\\\\\\/[\\\\\\\\s\\\\\\\\S]+?\\\\\\\\.testsite\\\\\\\\.com\\\\\\\\/\\\", \\\"https://testsite.com/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\\");\\r\\n\\r\\n  // search fail\\r\\n  test(enc, mp, \\\"https:\\\\\\\\/\\\\\\\\/[\\\\\\\\s\\\\\\\\S]+?\\\\\\\\.testsite\\\\\\\\.com\\\\\\\\/\\\", \\\"https://testsite.com/testandtest1testandtest2test2test3test3test4test4test5test5test6\\\");\\r\\n\\r\\n  // search fail  \\r\\n  test(enc, mp, \\\"https:\\\\\\\\/\\\\\\\\/.+?\\\\\\\\.testsite\\\\\\\\.com\\\\\\\\/\\\", \\\"https://testsite.com/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\\");\\r\\n\\r\\n  // search fail  \\r\\n  test(enc, mp, \\\"https:\\\\\\\\/\\\\\\\\/.+?\\\\\\\\.testsite\\\\\\\\.com\\\\\\\\/\\\", \\\"https://testsite.com/testandtest1testandtest2test2test3test3test4test4test5test5test6\\\");\\r\\n```\\r\\n  --------------------------------\\r\\nMay I ask what version of Oniguruma you are using? I want to test with the same version as you.\\r\\n( My environment: oniguruma6.9.9[UTF-8,ONIG_SYNTAX_ONIGURUMA] , ubuntu22.04 LTS , gcc11.4.0 )\\r\\n\\r\\nTerminal command: onig-config --version\\r\\nor\\r\\nPlease have a look at \\\"oniguruma/src/oniguruma.h\\\".\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/src/oniguruma.h#L37-L39\\r\\n\\r\\n> I also want to ask the \\\"another choice\\\" mentioned in another thread.\\r\\n> Does the retry happen because \\\\s\\\\S has \\\"another choice\\\" but . doesn't?\\r\\n>\\r\\n>One more thing, if we get this exception, can we catch it and just say it doesn't match?\\r\\n\\r\\nSorry, I don't have the knowledge to answer these questions. Is there anyone who can answer?\"}, {\"author\": \"kkos\", \"body\": \"@jliu-siteimprove \\r\\nAre you writing about the case where the character encoding is utf-8 and the option is ignore-case?\\r\\nIt is not written that way.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@kkos (Owner)\\r\\nThank you very much, thanks to you I was able to see the retry limit error.\\r\\nI will investigate the conditions under which this phenomenon occurs.\\r\\n\\r\\n@jliu-siteimprove\\r\\nI think this is probably caused by the inclusion of \\\"`s`\\\" in \\\"`\\\\S`\\\".\\r\\n\\\"`s`\\\" matches multibyte characters if ignore-case is in effect.\\r\\nThe combination of \\\"`s`\\\" and ignore-case has caused various problems until now.\\r\\n\\r\\nTherefore, this problem can be prevented by simply applying `(?-i)`.\\r\\nOr you can also use the `(?I)` option. This option prevents matching multibyte characters.\\r\\nhttps://github.com/kkos/oniguruma/blob/e62a8e5ec123bb91651d297e6f72c84d53e3cff8/doc/RE#L292-L299\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"The problem occurs with the combination of \\\"`[\\\\S]+`\\\" and ignore-case.\\r\\n\\\"`\\\\S+`\\\" and \\\"`[s]+`\\\" and \\\"`s+`\\\" do not cause problems. However, I've only just started looking into it.\\r\\n----------- oniguruma/test/test_utf8.c --------------\\r\\n```\\r\\n   /* All of the following test results are \\\"success\\\". */\\r\\n\\r\\n   // This will be the basis for the following tests.\\r\\n   e(\\\"1(?i)[\\\\\\\\S]+?2\\\", \\\"12sssssssssssssssss\\\", ONIGERR_RETRY_LIMIT_IN_MATCH_OVER); // \\\"s\\\" x 17\\r\\n\\r\\n   // One \\\"s\\\" has been removed from text.\\r\\n   n(\\\"1(?i)[\\\\\\\\S]+?2\\\", \\\"12ssssssssssssssss\\\");   // No error. \\\"s\\\" x 16\\r\\n\\r\\n   // changed \\\"1\\\" to \\\"\\\\A\\\"\\r\\n   n(\\\"\\\\\\\\A(?i)[\\\\\\\\S]+?2\\\", \\\"2sssssssssssssssss\\\"); // No error. Probably due to optimization.\\r\\n                                               // \\\"Success\\\" also when \\\"s\\\" is 100,000 pieces.\\r\\n   // changed \\\"[\\\\S]\\\" to \\\"\\\\S\\\"\\r\\n   n(\\\"1(?i)\\\\\\\\S+?2\\\", \\\"12sssssssssssssssss\\\");   // No error. This error requires a character class.\\r\\n                                              // \\\"Success\\\" also when \\\"s\\\" is 100,000 pieces.\\r\\n   // changed \\\"+?\\\" to \\\"+\\\"\\r\\n   e(\\\"1(?i)[\\\\\\\\S]+2\\\", \\\"12sssssssssssssssss\\\", ONIGERR_RETRY_LIMIT_IN_MATCH_OVER);\\r\\n\\r\\n   // changed \\\"[\\\\\\\\S]\\\" to \\\"[s2]\\\"\\r\\n   n(\\\"1(?i)[s2]+?2\\\", \\\"12sssssssssssssssss\\\");  // No error. \\\"Success\\\" also when \\\"s\\\" is 100,000 pieces.\\r\\n\\r\\n   // changed \\\"[\\\\\\\\S]+?\\\" to \\\"2?s+?\\\"\\r\\n   n(\\\"1(?i)2?s+?2\\\", \\\"12sssssssssssssssss\\\");   // No error. \\\"Success\\\" also when \\\"s\\\" is 100,000 pieces.\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \".(dot) and [\\\\s\\\\S] are different for Unicode IGNORE-CASE.\\r\\n(?i:[\\\\S])  cannot be contained within a character class because some characters are case-converted to multiple characters in Unicode. Therefore, choices for elements other than the character class are generated after the character class.\\r\\nIn fact, it would be correct to do the same for .(dot), but this is not done because of the high cost.\\r\\nSince \\\\S is also implemented internally with [\\\\S], it should be the same, but it was not done. I think I simply forgot to do this. It may be best not to change it now.\\r\\n\\r\\nThe reason it works correctly for https://testsite.com/aaa..... is probably because there are no or few matches for 'a' among the choices generated.\"}, {\"author\": \"jliu-siteimprove\", \"body\": \"Thanks @kkos @tonco-miyazawa Yes, we are using IGNORE-CASE and `\\\\S` which cause the problem\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"  This problem needs to be addressed by the user, so I'll add an explanation.\\r\\n  The reason for the error is the same as the code below. Please note that ignore-case is disabled.\\r\\n\\r\\n`e(\\\"1(?>2?)(?-i)(?:s|t|st|ss)+?2\\\",\\\"12stststststststststststststststststststst\\\", ONIGERR_RETRY_LIMIT_IN_MATCH_OVER);`\\r\\n\\r\\n  For the following reasons, `/(?i)[\\\\S]/` contains behavior similar to `/(?-i)(?:s|t|st|ss)/` .\\r\\n\\r\\n```\\r\\n  // [\\\\S] contains the following 4 characters.\\r\\n  x2(\\\"[\\\\\\\\S]\\\"  , \\\"s\\\", 0, 1);            // [\\\\S] match \\\"s\\\" .\\r\\n  x2(\\\"[\\\\\\\\S]\\\"  , \\\"t\\\", 0, 1);            // [\\\\S] match \\\"t\\\" .\\r\\n  x2(\\\"[\\\\\\\\S]\\\"  , \\\"\\\\u00DF\\\", 0, 2);       // [\\\\S] match \\\"U+00DF\\\" .\\r\\n  x2(\\\"[\\\\\\\\S]\\\"  , \\\"\\\\uFB05\\\", 0, 3);       // [\\\\S] match \\\"U+FB05\\\" .\\r\\n\\r\\n  // If ignore-case is in effect, these match two characters.\\r\\n  x2(\\\"(?i)\\\\\\\\x{00DF}\\\"  , \\\"ss\\\", 0, 2);   // (?i)\\\"U+00DF\\\" match \\\"ss\\\" .\\r\\n  x2(\\\"(?i)\\\\\\\\x{FB05}\\\"  , \\\"st\\\", 0, 2);   // (?i)\\\"U+FB05\\\" match \\\"st\\\" .\\r\\n```\\r\\n\\r\\n  So `[\\\\S]` is just one of the things that causes problems.  Example,  `[\\\\D]` , `[\\\\H]` , `[\\\\p{^Space}]` , `[[:^space:]]`   etc..\\r\\n\\r\\n  If the text contains \\\"`st`\\\" or \\\"`ss`\\\", Significantly increases the number of retries when backtracking.\\r\\n  The text below contains a lot of \\\"`st`\\\". These \\\"`st`\\\" cause problems.\\r\\n  \\\"`https://testsite.com/testandtest1testandtest2test2test3test3test4test4test5test5test6`\\\"\\r\\n\\r\\n  The text \\\"`_s_s_s_s_s_s_s_`\\\" does not contain \\\"`st`\\\", \\\"`ss`\\\", etc., so no retry-explosion occurs.\\r\\n\\r\\n  There are other strings besides \\\"`st`\\\" and \\\"`ss`\\\" that can cause problems. (Example, \\\"`ff`\\\")\\r\\n  https://www.unicode.org/charts/PDF/UFB00.pdf\\r\\n\\r\\n----------------------------------------------------------------------------------\\r\\n\\r\\n  The solution to this problem is to use `(?-i:[\\\\S])`.\\r\\n  However, please note that `(?i:[\\\\S])` and `(?-i:[\\\\S])` behave differently.\\r\\n  `/^(?-i:[\\\\S])$/` does not match things like \\\"`st`\\\", \\\"`ss`\\\", or \\\"`ff`\\\" .\\r\\n\\r\\n  Another workaround is to use `(?>[\\\\S])` . This is the same principle as why `/^(?>s|ss)$/` does not match \\\"`ss`\\\".\\r\\n However, this depends on the order of internal processing.\\r\\n\\r\\n  I recommend that you enable ignore-case only for parts that require it.\\r\\n  Also consider using  atomic-group`(?> )`, possessive\\\"`?+`, `*+`, `++`\\\", and ONIG_OPTION_IGNORECASE_IS_ASCII`(?I)`.\\r\\n\\r\\n----------------------------------------------------------------------------------\\r\\n\\r\\n  In perl5.34.0, `/[\\\\S]/i` does not match multiple characters.\\r\\n\\r\\n```\\r\\n  ##   st   #########################\\r\\n  \\\"st\\\" =~ m/^\\\\N{U+FB05}$/i   # true\\r\\n  \\\"st\\\" =~ m/^\\\\N{U+FB06}$/i   # true\\r\\n  \\\"st\\\" =~ m/^.$/i            # false\\r\\n  \\\"st\\\" =~ m/^\\\\D$/i           # false\\r\\n  \\\"st\\\" =~ m/^\\\\S$/i           # false\\r\\n  \\\"st\\\" =~ m/^[\\\\D]$/i         # false\\r\\n  \\\"st\\\" =~ m/^[\\\\S]$/i         # false\\r\\n  \\\"st\\\" =~ m/^[^\\\\s]$/i        # false\\r\\n  \\\"st\\\" =~ m/^[[:^space:]]$/i # false\\r\\n  \\\"st\\\" =~ m/^\\\\P{Space}$/i    # false\\r\\n\\r\\n  ##   ss   #########################\\r\\n  \\\"ss\\\" =~ m/^\\\\N{U+00DF}$/i   # true\\r\\n  \\\"ss\\\" =~ m/^.$/i            # false\\r\\n  \\\"ss\\\" =~ m/^\\\\S$/i           # false\\r\\n  \\\"ss\\\" =~ m/^[\\\\S]$/i         # false\\r\\n\\r\\n  ##   ff   #########################\\r\\n  \\\"ff\\\" =~ m/^\\\\N{U+FB00}$/i   # true\\r\\n  \\\"ff\\\" =~ m/^.$/i            # false\\r\\n  \\\"ff\\\" =~ m/^\\\\S$/i           # false\\r\\n  \\\"ff\\\" =~ m/^[\\\\S]$/i         # false\\r\\n```\\r\\n\\r\\n  About \\\"`(?-i)(?:s|t|st|ss)+`\\\" in perl5.34.0 .\\r\\n  When I avoided perl5 optimization, a retry-explosion occurred.\\r\\n  The retry-limit didn't work and I had to type `Ctrl+C` to stop it.\"}, {\"author\": \"RedCMD\", \"body\": \"From my testing this also seems to be the cause of https://github.com/microsoft/vscode/issues/40279 and https://github.com/microsoft/vscode-textmate/issues/59\\r\\n`[\\\\x{0}-\\\\x{7fffffff}]` seems to act very similar to `[\\\\S]`\\r\\n\\r\\ntho apparently it works in atom just fine\\r\\nhttps://github.com/microsoft/vscode/issues/40279#issuecomment-361225223\\r\\n> Interstingly it works in Atom, so maybe there is some trick we miss in vscode-textmate.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@RedCMD\\r\\n> vscode-textmate/issues/59\\r\\n\\r\\nThat \\\"test.php\\\" contains \\\"`SSSSSSSSSSSSSSSSSS`\\\". ( '`S`'x 18 )\\r\\nThere are also many \\\"`ff`\\\" and several \\\"`st`\\\". These are enough to cause a retry-explosion.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@RedCMD\\r\\nI looked into Atom. However, I could not confirm any unique behavior in Atom.\\r\\nIn other words, Atom behaves the same as the original oniguruma.\\r\\nThe issue where VSCode freezes is a VSCode-only issue.\\r\\n\\r\\n> https://github.com/microsoft/vscode/issues/40279#issuecomment-361322160\\r\\n\\r\\nThis is an effect of oniguruma's optimization process.\\r\\n\\r\\nIf you want to check whether the optimization process is working, please test as follows.\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/master/sample/callout.c\\r\\n```\\r\\ntest(enc, mp, \\\"::(?{XXXXXXXXXXXX})\\\\\\\\(\\\"     , \\\"::abc\\\");\\r\\ntest(enc, mp, \\\"::(?{YYYYYYYYYYYY})(?=\\\\\\\\()\\\" , \\\"::abc\\\");\\r\\n```\\r\\n\\r\\n`/(?{XXXXXXXXXXXX})/` can be used like `/(?{print(\\\"XXXXXXXXXXXX\\\");})/` of perl5.\\r\\nIn this case, `\\\"XXXXXXXXXXXX\\\"` will not be output.\\r\\nThis is because the optimization process found the `\\\"search fail\\\"` first.\\r\\n\\r\\nIf possible, use regular expressions that can be optimized.\\r\\n\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa , @kkos \\r\\nGuys, sorry to post in a closed issue, but we've just hit this problem in one of our queries.\\r\\nReproducible with:\\r\\n```\\r\\nregexp_like(\\r\\n\\\"CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>AFE>KLZ>DYU>CLOSE_EDITOR_DRAWER>SELECT_CAMPAIGN_TAB>AD_ACCOUNT_MENU_CAMPAIGN_PAGE>XKV>SELECT_CAMPAIGN_TAB>NAV_TO_BILLING_AND_PAYMENTS>SELECT_CAMPAIGN>DDN>DELETE>VIEW_INSIGHTS>TOGGLE_CAMPAIGN_STATUS>TOGGLE_CAMPAIGN_STATUS>TOGGLE_CAMPAIGN_STATUS>TOGGLE_CAMPAIGN_STATUS>TOGGLE_CAMPAIGN_STATUS>XYR>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>AFE>KLZ>DYU>CLOSE_EDITOR_DRAWER>IDU>KIY>DISCARD>FPQ>SELECT_CAMPAIGN_TAB>AD_ACCOUNT_MENU_CAMPAIGN_PAGE>XKV>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>AFE>KLZ>DYU>RWA>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>SELECT_CURRENCY>SELECT_CURRENCY>SELECT_CURRENCY>EDIT_ADSET_TARGETING>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR_FEMALE>EDIT_ADSET_TARGETING>SET_TARGETING_GENDER>ADSET_EDIT_TARGETING_AGE_SELECTOR_FEMALE>ADSET_EDIT_TARGETING_AGE_SELECTOR>EDIT_ADSET_PLACEMENT>QLQ>EDIT_ADSET_PLACEMENT>GVM>ZNF>QLQ>ADSET_PLACEMENT_MANUAL_SELECTOR>AZT>HBO>EPT>OQF>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>EDIT_AD_MESSAGE>EPR>EPR>EPR>EDIT_AD_HEADLINE>LEARN_MORE_CALL_TO_ACTION>LLC>PLG>JQR>KHJ>PLG>PLG>VXT>KHJ>PUBLISH_AD>CLOSE_AD_EDITOR>SELECT_CAMPAIGN_TAB>XYR>VQU>IVB>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>AFE>KLZ>SELECT_PIXEL_CONVERSION_GOAL>RWA>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>EDIT_ADSET_TARGETING>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR>QAK>EDIT_ADSET_TARGETING>SET_TARGETING_GENDER>EDIT_ADSET_PLACEMENT>QLQ>NAV_ADSET_LEVEL_TO_AD_LEVEL>HBO>HBO>BSK>USE_EXISTING_POST>NRN>NRN>CCD>NRN>NRN>NRN>NRN>NRN>NRN>NRN>SELECT_POST_AD>GIS>CONTINUE>TEY>HBG>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>LEARN_MORE_CALL_TO_ACTION>LLC>PUBLISH_AD>CLOSE_AD_EDITOR>SELECT_CAMPAIGN_TAB>REFRESH_PAGE>SELECT_CAMPAIGN>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>AFE>KLZ>PXU>SELECT_PIXEL_CONVERSION_GOAL>RWA>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>EDIT_ADSET_TARGETING>EDIT_ADSET_TARGETING>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR>EDIT_ADSET_PLACEMENT>QLQ>EDIT_ADSET_PLACEMENT>GVM>ZNF>JYI>JYI>ZNF>AZT>HBO>HBO>LEARN_MORE_CALL_TO_ACTION>LLC>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>EDIT_AD_MESSAGE>EDIT_AD_HEADLINE>EDIT_AD_HEADLINE>EDIT_AD_HEADLINE>EDIT_AD_HEADLINE>EDIT_AD_HEADLINE>EDIT_AD_HEADLINE>CHJ>VXT>KHJ>PUBLISH_AD>FFX>TWE>SELECT_CAMPAIGN>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>ZWN>DUPLICATE_CAMPAIGN>IHD>CLOSE_CREATION_PACKAGE>OCS>ZMF>DISCARD>MLH>REFRESH_PAGE>TDB>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>AFE>KLZ>DYU>RWA>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>EDIT_ADSET_TARGETING>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR>EDIT_ADSET_TARGETING>SET_TARGETING_GENDER>EDIT_ADSET_PLACEMENT>QLQ>GVM>ZNF>AZT>HBO>HBO>BSK>USE_EXISTING_POST>SELECT_POST_AD>DEC>TEY>HBG>OQF>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>PLG>EDIT_AD_MESSAGE>EDIT_AD_HEADLINE>LEARN_MORE_CALL_TO_ACTION>LLC>FFX>AFE>AZT>PUBLISH_AD>CLOSE_AD_EDITOR>SELECT_CAMPAIGN_TAB>REFRESH_PAGE>VIEW_INSIGHTS>XYR>VQU>IVB>DUPLICATE_CAMPAIGN>EQJ>CONTINUE_CAMPAIGN_DUPLICATION>CONFIRM_DUPLICATE_CAMPAIGN>DUPLICATION_DIALOG_GENERIC>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>AFE>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR>JYI>FRO>AZT>WPL>JTU>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>EPR>PUBLISH_AD>CLOSE_AD_EDITOR>SELECT_CAMPAIGN_TAB>REFRESH_PAGE>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>AFE>KLZ>SELECT_PIXEL_CONVERSION_GOAL>RWA>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>EDIT_ADSET_TARGETING>LIB>CLOSE_ADSET_TARGETING>EDIT_ADSET_TARGETING>SET_TARGETING_GENDER>EDIT_ADSET_TARGETING>ADSET_EDIT_TARGETING_AGE_SELECTOR>ADSET_EDIT_TARGETING_AGE_SELECTOR>EDIT_ADSET_PLACEMENT>QLQ>GVM>ZNF>AZT>HBO>HBO>OQF>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>EDIT_AD_MESSAGE>EDIT_AD_HEADLINE>LEARN_MORE_CALL_TO_ACTION>LLC>ELS>AZT>PUBLISH_AD>FFX>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>PUBLISH>AFE>CLOSE_EDITOR_DRAWER>SELECT_CAMPAIGN_TAB>REFRESH_PAGE>SELECT_CAMPAIGN>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_ENGAGEMENT>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>AFE>KLZ>SELECT_PIXEL_CONVERSION_GOAL>SELECT_PIXEL_CONVERSION_GOAL>SELECT_PIXEL_CONVERSION_GOAL>SELECT_PIXEL_CONVERSION_GOAL>SELECT_PIXEL_CONVERSION_GOAL>SELECT_PIXEL_CONVERSION_GOAL>YCX>EDIT_CAMPAIGN_NAME>EDIT_CAMPAIGN_NAME>AFE>PXU>SELECT_PURCHASE_CONVERSION_GOAL>SUGGEST_AN_AUDIENCE>USE_ORIGINAL_AUDIENCE>EDIT_ADSET_TARGETING>EDIT_ADSET_TARGETING>LIB>CLOSE_ADSET_TARGETING>EDIT_ADSET_TARGETING>SET_TARGETING_GENDER>EDIT_ADSET_TARGETING>YDE>YDE>EDIT_ADSET_PLACEMENT>AZT>HBO>HBO>HBO>OQF>ADD_MEDIA_AD>ADD_IMAGE_AD_EDITOR>UPLOAD_AD_MEDIA>NEXT_MEDIA_PICKER_AD>NEXT_MEDIA_PICKER_AD>DONE_MEDIA_PICKER>LEARN_MORE_CALL_TO_ACTION>PQN>TVO>LLC>PUBLISH_AD>CLOSE_AD_EDITOR>SELECT_CAMPAIGN_TAB>XYR>VQU>IVB>KJY>AFE>EDIT_ADSET_TARGETING>YDE>PUBLISH_ADSET>CLOSE_EDITOR_DRAWER>SELECT_CAMPAIGN_TAB>LEFT_NAV>LEFT_NAV>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>AFE>KLZ>DYU>SELECT_PIXEL_CONVERSION_GOAL>DYU>QFK>DIN>DYU>CLOSE_EDITOR_DRAWER>IDU>KIY>DISCARD>FPQ>SELECT_CAMPAIGN_TAB>REFRESH_PAGE>REFRESH_PAGE>LEFT_NAV>LEFT_NAV>CREATE_CAMPAIGN_FROM_TABLE>SET_CAMPAIGN_OBJECTIVE_SALES>CONTINUE_QUICK_CREATE_CAMPAIGN>ORG>SELECT_MANUAL_SALES_CAMPAIGN>CONTINUE_CAMPAIGN_PACKAGE_SELECTION>AFE>KLZ>DYU>SELECT_PIXEL_CONVERSION_GOAL>CLOSE_EDITOR_DRAWER>IDU>KIY>DISCARD>FPQ>FPQ>SELECT_CAMPAIGN_TAB>ZMF>DISCARD>MLH>REFRESH_PAGE>VIEW_INSIGHTS>DUPLICATE_CAMPAIGN>IHD>JIE>QPD>EOW>RDO>UPLOAD_ASSET_CREATION_PACKAGE>NEXT>NEXT>UTU>PUBLISH_CREATION_PACKAGE>GZD>SELECT_CAMPAIGN_TAB>IVB>VQU>XYR>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>DUPLICATE>EDIT>GNR>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_CAMPAIGN>SELECT_ALL_ROWS>EDIT>LCB>SELECT_CAMPAIGN_TAB>EDIT>GNR>REFRESH_PAGE>SELECT_ALL_ROWS>SELECT_ALL_ROWS>GZD>SELECT_CAMPAIGN_TAB>SELECT_CAMPAIGN>KJY>TURN_ADVANTAGE_BUDGET_ON>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>SELECT_BUDGET_CURRENCY>PUBLISH>TWE>SELECT_CAMPAIGN>FWC>SELECT_CURRENCY>SELECT_CURRENCY>SELECT_CURRENCY>PUBLISH>SELECT_CAMPAIGN>FWC>SELECT_CURRENCY>SELECT_CURRENCY>SELECT_CURRENCY>PUBLISH>FWC>SELECT_CURRENCY>SELECT_CURRENCY>SELECT_CURRENCY>PUBLISH>SELECT_CAMPAIGN>SEARCH_TABLE>REFRESH_PAGE>REFRESH_PAGE>REFRESH_PAGE>REFRESH_PAGE>LEFT_NAV>LEFT_NAV\\\",\\r\\n\\\"(CREATE_CAMPAIGN_FROM_TABLE(>[A-Z_]+){0,200}?>SET_CAMPAIGN_OBJECTIVE_SALES(>[A-Z_]+){0,200}?>CONTINUE_QUICK_CREATE_CAMPAIGN(>[A-Z_]+){0,200}?>SELECT_MANUAL_SALES_CAMPAIGN(>[A-Z_]+){0,200}?>CONTINUE_CAMPAIGN_PACKAGE_SELECTION(>[A-Z_]+){0,200}?>TURN_ADVANTAGE_BUDGET_ON(>[A-Z_]+){0,200}?>SELECT_BUDGET_CURRENCY(>[A-Z_]+){0,200}?>NEXT_CAMPAIGN_EDITOR(>[A-Z_]+){0,200}?>BUDGET_SCHEDULE_ADSET)\\\"\\r\\n);\\r\\n```\\r\\nSmaller pattern works for the whole query, as well as this pattern works for many rows.\\r\\nHowever, on some rows (like above) it fails with \\\"retry-limit-in-match over\\\" error.\\r\\n\\r\\nI don't see that the reason is similar to what is discussed in this issue.\\r\\n\\r\\nWas wondering if you can recommend either pattern rewrite or maybe some Oni config/settings change for such queries to pass.\\r\\n\\r\\nThank you!\"}, {\"author\": \"RedCMD\", \"body\": \"that regex doesn't match cause `NEXT_CAMPAIGN_EDITOR` and `BUDGET_SCHEDULE_ADSET` doesn't exist in the string\\r\\n\\r\\n@spershin you could possibly upgrade all the `+` greedy quantifiers to [possessive](https://github.com/kkos/oniguruma/blob/master/doc/RE#L159) greedy `(>[A-Z_]++)`\\r\\nand/or change the `(>[A-Z_]+)` groups to [atomic](https://github.com/kkos/oniguruma/blob/master/doc/RE#L318) groups `(?>>[A-Z_]+)`\\r\\nand/or put an atomic group around each group and following keyword `(?>(>[A-Z_]+){0,200}?>SET_CAMPAIGN_OBJECTIVE_SALES)`\\r\\n\\r\\nall combined\\r\\n```\\r\\n(CREATE_CAMPAIGN_FROM_TABLE(?>(?>>[A-Z_]++){0,2000}?>SET_CAMPAIGN_OBJECTIVE_SALES)(?>(?>>[A-Z_]++){0,2000}?>CONTINUE_QUICK_CREATE_CAMPAIGN)(?>(?>>[A-Z_]++){0,2000}?>SELECT_MANUAL_SALES_CAMPAIGN)(?>(?>>[A-Z_]++){0,2000}?>CONTINUE_CAMPAIGN_PACKAGE_SELECTION)(?>(?>>[A-Z_]++){0,2000}?>TURN_ADVANTAGE_BUDGET_ON)(?>(?>>[A-Z_]++){0,2000}?>SELECT_BUDGET_CURRENCY)(?>(?>>[A-Z_]++){0,2000}?>NEXT_CAMPAIGN_EDITOR)(?>(?>>[A-Z_]++){0,2000}?>BUDGET_SCHEDULE_ADSET))\\r\\n```\\r\\n(I had to increase the max in-between `keywords` to `2000`. could even change the `{0,200}?` to `*?`)\\r\\noriginal regex was taking `~300ms` for me (`3ms` on successful match)\\r\\nnew regex is `1.3ms` (`0.4ms` on successful match)\\r\\n\\r\\n~~tho this may only improve match time performance rather than fix the error~~\"}, {\"author\": \"spershin\", \"body\": \"@kkos , @tonco-miyazawa \\r\\nSeems like @simulified needs to be banned from GH, not sure how to do it.\"}, {\"author\": \"spershin\", \"body\": \"@RedCMD \\r\\nThe \\\"greedy quantifiers to [possessive](https://github.com/kkos/oniguruma/blob/master/doc/RE#L159) greedy\\\" idea `((>[A-Z_]+)` -> `(>[A-Z_]++))` worked really well.\\r\\nNo errors for that query!\\r\\n\\r\\nSo, I did more tests...\\r\\n\\r\\nOn a single (one particular) day data (2293850 rows):\\r\\n`(>[A-Z_]+){0,200}?` - fails with the error.\\r\\n`(>[A-Z_]++){0,200}?` - succeeds.\\r\\n`(?>>[A-Z_]++){0,200}?` - succeeds.\\r\\n`(?>>[A-Z_]++){0,2000}?` - fails with the error.\\r\\n`(?>>[A-Z_]++)*?` - fails with the error.\\r\\n\\r\\nHowever, even the succeeding options fail on data from other days.\\r\\nOne particular input string is 15646 characters!\\r\\nFunny that I haven't seen any one string that matches the pattern.\\r\\n\\r\\nIs there a setting/option that can be modified to increase this limit?\\r\\nI also lack context in the implementation and don't know what kind of limit this input+pattern are triggering (`retry-limit-in-match over`).\\r\\n\\r\\nIs it because the query is matching too many blocks?\\r\\nThe pattern itself has what, 16 blocks: tag + (greater + AZ_) - this is 8 times.\\r\\nAnd we have (greater + AZ_) can repeat 200 times.\\r\\nSo, we can potentially have 201 * 8 = 1608 matches parts. That's not too much or is it?\\r\\n\\r\\nI ran the query using JONI and RE2 - they both succeed on the original query.\\r\\nWondering if Oni has some kind on inefficiency triggered in this case?\\r\\n\\r\\nAlso, should I create a new issue for this?\\r\\n\\r\\nUpdate:\\r\\nDid more tests: removed the last two parts (they aren't found in any input) and the query succeeded with `(>[A-Z_]++){0,200}?`. Likely because on very long  strings it actually found a match.\\r\\nBut with `(>[A-Z_]+){0,200}?` the query still failed.\\r\\n\\r\\nUpdate:\\r\\nI'm seeing these contants:\\r\\n```\\r\\n#define DEFAULT_PARSE_DEPTH_LIMIT           4096\\r\\n#define INIT_MATCH_STACK_SIZE                160\\r\\n#define DEFAULT_MATCH_STACK_LIMIT_SIZE         0 /* unlimited */\\r\\n#define DEFAULT_RETRY_LIMIT_IN_MATCH    10000000\\r\\n#define DEFAULT_RETRY_LIMIT_IN_SEARCH          0 /* unlimited */\\r\\n#define DEFAULT_SUBEXP_CALL_LIMIT_IN_SEARCH    0 /* unlimited */\\r\\n#define DEFAULT_SUBEXP_CALL_MAX_NEST_LEVEL    20\\r\\n```\\r\\nWhat is interesting is that MATCH has 10M retries limit and SEARCH is unlimited.\\r\\nI'm calling onig_search(), how come the retry is not unlimited?\\r\\nOr maybe some other constant is being used? I find it hard to believe that we reach 10M retries.\\r\\n\\r\\nAlso, where could I read about difference between `onig_scan`, `onig_search`, `onig_search_with_param`, `onig_match`, `onig_match_with_param`?\"}, {\"author\": \"RedCMD\", \"body\": \"> 201 * 8 = 1608\\r\\n\\r\\nit's more like `200^8 = 2.56e18`\\r\\n\\r\\nbut definitely wrap each block in its own atomic group\\r\\nit should limit it to `8`\\r\\n```regex\\r\\n(CREATE_CAMPAIGN_FROM_TABLE(?>(?>>[A-Z_]++)*?>SET_CAMPAIGN_OBJECTIVE_SALES)(?>(?>>[A-Z_]++)*?>CONTINUE_QUICK_CREATE_CAMPAIGN)(?>(?>>[A-Z_]++)*?>SELECT_MANUAL_SALES_CAMPAIGN)(?>(?>>[A-Z_]++)*?>CONTINUE_CAMPAIGN_PACKAGE_SELECTION)(?>(?>>[A-Z_]++)*?>TURN_ADVANTAGE_BUDGET_ON)(?>(?>>[A-Z_]++)*?>SELECT_BUDGET_CURRENCY)(?>(?>>[A-Z_]++)*?>NEXT_CAMPAIGN_EDITOR)(?>(?>>[A-Z_]++)*?>BUDGET_SCHEDULE_ADSET))\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"onig_scan searches the entire string and calls a callback function for each match.\\r\\nonig_search performs matching within the specified range and returns the first successful match position.\\r\\nThose with _with_param have no other differences except that OnigMatchParam* can be passed as an argument. (Usually not used.)\\r\\n\\r\\nRetry limits are applied to both a single match and the entire search.\\r\\nUnlimited\\r\\nonig_set_retry_limit_in_match(0);\\r\\nonig_set_retry_limit_in_search(0);\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nI think I can fix your regex. Which syntax do you want to use?\\r\\nsyntax-oniguruma? syntax-java? syntax-your-own-JONI?\\r\\nI need to change the regex depending on which syntax you use.\\r\\nYour regex has a similar problem to this:\\r\\n\\r\\n`a.*b.*c.*d.*e`\\r\\n\\r\\nThe number of backtracks grows exponentially if no match is found.\\r\\nI would fix this as follows:\\r\\n\\r\\n`a.*+b.*+c.*+d.*+e`\\r\\n\\r\\npossessive (greedy and does not backtrack once match)\\r\\nhttps://github.com/kkos/oniguruma/blob/00ad92b7f4c3c414feeeafe3170c0f553aa2faf1/doc/RE#L159-L169\\r\\n\\r\\n\\\"negative look-ahead\\\" is useful for this fix.\\r\\nnegative look-ahead\\r\\nhttps://github.com/kkos/oniguruma/blob/00ad92b7f4c3c414feeeafe3170c0f553aa2faf1/doc/RE#L304\\r\\n\\r\\nModifying `a.*?b` to `a(?:(?!b).)*+b` gives us \\\"possessive\\\".\\r\\nIn this case, we are promised that \\\"`.`\\\" is not \\\"`b`\\\".\\r\\nThis is difficult, so don't worry about figuring it out right now.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nThis is the regular expression for \\\"`ONIG_SYNTAX_ONIGURUMA`\\\" .\\r\\nThis regular expression greatly reduces backtracking.\\r\\n\\r\\n`(?<tag0>CREATE_CAMPAIGN_FROM_TABLE){0}(?<tag1>SET_CAMPAIGN_OBJECTIVE_SALES){0}(?<tag2>CONTINUE_QUICK_CREATE_CAMPAIGN){0}(?<tag3>SELECT_MANUAL_SALES_CAMPAIGN){0}(?<tag4>CONTINUE_CAMPAIGN_PACKAGE_SELECTION){0}(?<tag5>TURN_ADVANTAGE_BUDGET_ON){0}(?<tag6>SELECT_BUDGET_CURRENCY){0}(?<tag7>NEXT_CAMPAIGN_EDITOR){0}(?<tag8>BUDGET_SCHEDULE_ADSET){0}(?<tag_char>[A-Z_]){0}(?<tag_end>(?=[>\\\\\\\\s]|$)){0}\\\\\\\\g<tag0>(?>(?~|>\\\\\\\\g<tag1>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag1>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag2>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag2>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag3>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag3>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag4>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag4>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag5>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag5>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag6>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag6>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag7>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag7>\\\\\\\\g<tag_end>(?>(?~|>\\\\\\\\g<tag8>\\\\\\\\g<tag_end>|(?:>\\\\\\\\g<tag_char>++){0,200}))>\\\\\\\\g<tag8>\\\\\\\\g<tag_end>`\\r\\n\\r\\nThe above regular expression uses \\\"Absent expression\\\".\\r\\nhttps://github.com/kkos/oniguruma/blob/2640194c73ef4853a7e7c74132b847133813cdaa/doc/RE#L369-L371\\r\\n\\r\\nThis feature allows you to write `/a(?:(?!b).)*+b/` concisely.\\r\\n\\r\\n`/a(?:(?!b).)*+b/` == `/a(?>(?~|b|.*))b/`\\r\\n\\r\\nThere is no need to rush to reply because I understand you are busy.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nBelow is the test code for \\\"`/test/test_syntax.c`\\\".\\r\\nPlease rewrite the contents from `<tag0>` to `<tag8>` and use them.\\r\\n\\r\\n```\\r\\n  // for oniguruma6.9.9 #290\\r\\n  Syntax = ONIG_SYNTAX_ONIGURUMA;\\r\\n  x2(\\r\\n   \\\"(?<tag0>AAA){0}\\\"\\r\\n   \\\"(?<tag1>BBB){0}\\\"\\r\\n   \\\"(?<tag2>CCC){0}\\\"\\r\\n   \\\"(?<tag3>DDD){0}\\\"\\r\\n   \\\"(?<tag4>EEE){0}\\\"\\r\\n   \\\"(?<tag5>FFF){0}\\\"\\r\\n   \\\"(?<tag6>GGG){0}\\\"\\r\\n   \\\"(?<tag7>HHH){0}\\\"\\r\\n   \\\"(?<tag8>III){0}\\\"\\r\\n   \\\"(?<tag_char>[A-Z_]){0}\\\"\\r\\n   \\\"(?<tag_end>(?=[>\\\\\\\\s]|$)){0}\\\"\\r\\n\\r\\n   ////////// 0 ////////////\\r\\n   \\\"\\\\\\\\g<tag0>\\\"\\r\\n\\r\\n   ////////// 1 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag1>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag1>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 2 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag2>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag2>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 3 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag3>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag3>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 4 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag4>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag4>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 5 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag5>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag5>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 6 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag6>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag6>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 7 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag7>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag7>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n   ////////// 8 ////////////\\r\\n   \\\"(?>\\\"\\r\\n      \\\"(?~|\\\"\\r\\n              \\\">\\\\\\\\g<tag8>\\\\\\\\g<tag_end>\\\"\\r\\n          \\\"|\\\"\\r\\n              \\\"(?:\\\"\\r\\n                  \\\">\\\\\\\\g<tag_char>++\\\"\\r\\n              \\\"){0,200}\\\"\\r\\n          \\\")\\\"\\r\\n   \\\")\\\"\\r\\n   \\\">\\\\\\\\g<tag8>\\\\\\\\g<tag_end>\\\"\\r\\n\\r\\n  , \\\"AAA>CCC>BBB>CCC>DDD>EEE>AAA>FFF>GGG>HHH>III>JJJ>III>JJJ\\\", 0, 43);\\r\\n\\r\\n  // Start of the matched position ==  0\\r\\n  // End of the matched position   == 43\\r\\n```\\r\\n\\r\\n--------------------------------\\r\\nBelow is the command for testing above.\\r\\nPlease copy \\\"`/test/test_syntax.c`\\\" to \\\"`Documents`\\\" folder.\\r\\n\\r\\n```\\r\\n$ gcc ~/Documents/test_syntax.c  -L/usr/local/lib -lonig\\r\\n$ ./a.out\\r\\n```\"}, {\"author\": \"spershin\", \"body\": \"> Unlimited\\r\\n> onig_set_retry_limit_in_match(0);\\r\\n> onig_set_retry_limit_in_search(0);\\r\\n\\r\\n@kkos \\r\\n\\r\\nCalled these two functions and still getting \\\"retry-limit-in-match over\\\" error on the example I [posted above](https://github.com/kkos/oniguruma/issues/290#issuecomment-2155675440).\\r\\n\\r\\nEdit:\\r\\nExtra interesting detail:\\r\\nWhen called these two functions right after onig_initialize() Iget the following test failing with the \\\"retry-limit-in-match over\\\" error:\\r\\n`regexp_like(\\\"123RMA\\\", \\\"(?<!RMA)$\\\");`\\r\\nDid calling them with zero set the limit to actual zero?\\r\\n\\r\\nEdit2:\\r\\nCalling these fixes the example.\\r\\nWill run more tests soon to see if any query still hits the error or any other bad effects with such limits.\\r\\n```\\r\\n  onig_set_retry_limit_in_match(std::numeric_limits<unsigned long>::max());\\r\\n  onig_set_retry_limit_in_search(std::numeric_limits<unsigned long>::max());\\r\\n```\\r\\n\\r\\n\\r\\n@tonco-miyazawa \\r\\nThank you for the ideas. I don't understand them at the moment, but they might come in handy when we start the migration for real.\\r\\nI haven't decided yet on the final syntax we want to use. Probably ONIG_SYNTAX_ONIGURUMA if I can figure out how to support '(?s)' in it.\\r\\n\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_292", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"292\", \"title\": \"ONIG_SYN_CONTEXT_INDEP_REPEAT_OPS not working for ^* pattern\", \"author\": \"sargas\", \"labels\": [\"bug\"], \"description\": \"`docs/SYNTAX.md` has this to say about ONIG_SYN_CONTEXT_INDEP_REPEAT_OPS: \\r\\n\\r\\n> ### ONIG_SYN_CONTEXT_INDEP_REPEAT_OPS (independent `?`, `*`, `+`, `{n,m}`)\\r\\n> \\r\\n> _Set in: Oniguruma, PosixExtended, GnuRegex, Java, Perl, Perl_NG, Ruby_\\r\\n> \\r\\n> This flag specifies how to handle operators like `?` and `*` when they aren't\\r\\n> directly attached to an operand, as in `^*` or `(*)`:  Are they an error, are\\r\\n> they discarded, or are they taken as literals?  If this flag is clear, they\\r\\n> are taken as literals; otherwise, the ONIG_SYN_CONTEXT_INVALID_REPEAT_OPS flag\\r\\n> determines if they are errors or if they are discarded.\\r\\n\\r\\nSince this flag isn't set for \\\"grep\\\", I used the [sample.c](https://github.com/kkos/oniguruma/blob/master/sample/simple.c) example changing the syntax to `ONIG_SYNTAX_GREP` and the `str` to `(UChar* )\\\"*zzzzaffffffffb\\\"` (note the initial asterisk).\\r\\n\\r\\nFor a pattern of `*` or `\\\\\\\\(*\\\\\\\\)`, the first character matches (as expected).\\r\\nFor a pattern of `^*`, I get \\\"ERROR: target of repeat operator is invalid\\\", despite this being exactly the example regular expression in the documentation saying the asterisk should be treated as a literal.\", \"comments\": [{\"author\": \"sargas\", \"body\": \"Thanks for the fast response!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_293", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"293\", \"title\": \"Literal escaped braces\", \"author\": \"sargas\", \"labels\": [\"specification\"], \"description\": \"I'm tracking down failures in the GNU coreutils tests when run with [uutils](https://github.com/uutils/coreutils/)'s `expr`. uutils is using oniguruma (specifically with the \\\"grep\\\" syntax) for expr's pattern matching, and there are a few failures coming from what looks like differences between oniguruma and GNU grep. I think some are happening in the c-rust binding, but one issue is reproducible in C:\\r\\n\\r\\n#### Treating escaped braces as literals when in an invalid place\\r\\nSimilar to `ONIG_SYN_CONTEXT_INDEP_REPEAT_OPS`, it appears that escaped braces are treated like literal braces if in an invalid place. All of the following arguments match `{1}` completely when ran through `echo '{1}' | grep <pattern>` (although with a warning):\\r\\n1. \\\"^\\\\\\\\{1\\\\\\\\}\\\"\\r\\n2. \\\"\\\\\\\\{1\\\\\\\\}\\\"\\r\\n3. \\\"^{1}\\\"\\r\\n4. \\\"^\\\\(\\\\\\\\{1\\\\\\\\}\\\\)\\\"\\r\\n5. \\\"\\\\(\\\\\\\\{1\\\\\\\\}\\\\)\\\"\\r\\n\\r\\nTesting with variations of the simple example, only the third pattern above does not result in \\\"search failed\\\".\", \"comments\": [{\"author\": \"kkos\", \"body\": \"1,2 will be changed as there is a difference between my implementation and grep.\\r\\n4, 5 is correct, no match.   ' (', ')' does not mean grouping unless escaped.\\r\\n```\\r\\n4. \\\"^\\\\(\\\\{1\\\\}\\\\)\\\"\\r\\n5. \\\"\\\\(\\\\{1\\\\}\\\\)\\\"\\r\\n```\"}, {\"author\": \"sargas\", \"body\": \"Thank you, sorry for my incorrect examples!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_294", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"294\", \"title\": \"what is escape code for `.` (literal dot)?\", \"author\": \"goyalyashpal\", \"labels\": [], \"description\": \"i tried `\\\\.` in `jq` which uses oniguruma regex, and it said:\\r\\n\\r\\n```\\r\\njq: error: Invalid escape at line 1, column 4 (while parsing '\\\"\\\\.\\\"') at <top-level>, line 1:\\r\\n```\\r\\n\\r\\nfilter used:\\r\\n```jq\\r\\n[.] | map_values( select(. | test(\\\"android\\\\.m*\\\")) )\\r\\n#                                         ^~~~~\\r\\n```\\r\\n\\r\\ndata:\\r\\n```\\r\\n\\\"androidsm\\\"\\r\\n\\\"android.man\\\"\\r\\n```\", \"comments\": [{\"author\": \"goyalyashpal\", \"body\": \"sorry i messed up, it _is_ working fine...\\r\\n\\r\\n```jq\\r\\n[.] | map_values( select(. | test(\\\"android\\\\\\\\.m*\\\")) )\\r\\n#                                          ^~~~~\\r\\n```\\r\\n\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_295", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"295\", \"title\": \"onig_match() can return wrong results with lookbehind at the end of the string\", \"author\": \"spershin\", \"labels\": [], \"description\": \"We are looking at a possibility of using  Oni in [Velox](https://github.com/facebookincubator/velox).\\r\\nUsing Oni 6.9.9\\r\\n\\r\\nThese tests are good:\\r\\nEXPECT_EQ(false, regexSearch(\\\"123RMAX\\\", \\\"(?<!RMA)X\\\"));\\r\\nEXPECT_EQ(true, regexSearch(\\\"123RMAX\\\", \\\"(?<=RMA)X\\\"));\\r\\n\\r\\nBut these two return opposite results:\\r\\nEXPECT_EQ(false, regexSearch(\\\"123RMA\\\", \\\"(?<!RMA)$\\\"));\\r\\nEXPECT_EQ(true, regexSearch(\\\"123RMA\\\", \\\"(?<=RMA)$\\\"));\\r\\n\\r\\nThe error output:\\r\\n```\\r\\nExpected equality of these values:\\r\\n  false\\r\\n  regexSearch(\\\"123RMA\\\", \\\"(?<!RMA)$\\\")\\r\\n    Which is: (true)\\r\\n\\r\\nExpected equality of these values:\\r\\n  true\\r\\n  regexSearch(\\\"123RMA\\\", \\\"(?<=RMA)$\\\")\\r\\n    Which is: (false)\\r\\n```\\r\\n\\r\\nNote, that these tests are good as well:\\r\\nEXPECT_EQ(true, regexSearch(\\\"123RMB\\\", \\\"(?<!RMA)$\\\"));\\r\\nEXPECT_EQ(false, regexSearch(\\\"123RMB\\\", \\\"(?<=RMA)$\\\"));\\r\\n\\r\\n\\r\\nThe way we use Oni (not the whole code, but should be enough to spot any issue, hopefully):\\r\\n\\r\\n1. Initializing Oni:\\r\\n```\\r\\n  OnigEncoding use_encs[1];\\r\\n  use_encs[0] = ONIG_ENCODING_UTF8;\\r\\n  onig_initialize(use_encs, sizeof(use_encs) / sizeof(use_encs[0]));\\r\\n```\\r\\n2. Creating regex object:\\r\\n\\r\\n```\\r\\nOnigRegexPtr onigurumaCreateRegex(\\r\\n    const StringView& pattern,\\r\\n    std::string& error) {\\r\\n  regex_t* re{nullptr};\\r\\n  OnigErrorInfo einfo;\\r\\n  int r = onig_new(\\r\\n      &re,\\r\\n      (const OnigUChar*)pattern.begin(),\\r\\n      (const OnigUChar*)pattern.end(),\\r\\n      ONIG_OPTION_DEFAULT,\\r\\n      ONIG_ENCODING_UTF8,\\r\\n      ONIG_SYNTAX_JAVA,\\r\\n      &einfo);\\r\\n  if (r != ONIG_NORMAL) {\\r\\n    error.resize(ONIG_MAX_ERROR_MESSAGE_LEN + 1);\\r\\n    onig_error_code_to_str((UChar*)error.data(), r, &einfo);\\r\\n    onig_free(re);\\r\\n    re = nullptr;\\r\\n  }\\r\\n\\r\\n  return OnigRegexPtr(\\r\\n      reinterpret_cast<VeloxOnigRegex*>(re), onigurumaFreeRegex);\\r\\n}\\r\\n```\\r\\n3. Running onig_search:\\r\\n\\r\\n```\\r\\nbool onigurumaPartialMatch(\\r\\n    StringView str,\\r\\n    VeloxOnigRegex* re,\\r\\n    VeloxOnigRegion* region) {\\r\\n  const OnigUChar* start = (const OnigUChar*)str.data();\\r\\n  const OnigUChar* end = (const OnigUChar*)str.end();\\r\\n  const auto r = onig_search(\\r\\n      reinterpret_cast<regex_t*>(re),\\r\\n      start,\\r\\n      end,\\r\\n      start,\\r\\n      end,\\r\\n      reinterpret_cast<OnigRegion*>(region),\\r\\n      ONIG_OPTION_NONE);\\r\\n  // const auto r = onig_match(re, start, end, start, region, ONIG_OPTION_NONE);\\r\\n  if (r >= 0) {\\r\\n    return true;\\r\\n  } else if (r == ONIG_MISMATCH) {\\r\\n    return false;\\r\\n  }\\r\\n  onigurumaProcessError(r);\\r\\n  return false; // Unreachable.\\r\\n}\\r\\n```\\r\\n\\r\\n\\r\\n\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Below is the test code. ([ /test/test_syntax.c](https://github.com/kkos/oniguruma/blob/master/test/test_syntax.c) )\\r\\n\\r\\n```\\r\\n  // Issue 295\\r\\n  Syntax = ONIG_SYNTAX_ONIGURUMA;\\r\\n  x2(\\\"\\\", \\\"-----onig-----\\\", 0, 0);\\r\\n\\r\\n  n(\\\"(?<!RMA)$\\\", \\\"123RMA\\\");\\r\\n  x2(\\\"(?<=RMA)$\\\", \\\"123RMA\\\", 6, 6);\\r\\n\\r\\n  n(\\\"(?<!ab)$\\\", \\\"ab\\\");\\r\\n  x2(\\\"(?<=ab)$\\\", \\\"ab\\\", 2, 2);\\r\\n\\r\\n  n(\\\"(?<!a)$\\\", \\\"a\\\");\\r\\n  x2(\\\"(?<=a)$\\\", \\\"a\\\", 1, 1);\\r\\n\\r\\n\\r\\n  Syntax = ONIG_SYNTAX_JAVA;\\r\\n  x2(\\\"\\\", \\\"-----JAVA-----\\\", 0, 0);\\r\\n\\r\\n  n(\\\"(?<!RMA)$\\\", \\\"123RMA\\\");\\r\\n  x2(\\\"(?<=RMA)$\\\", \\\"123RMA\\\", 6, 6);\\r\\n\\r\\n  n(\\\"(?<!ab)$\\\", \\\"ab\\\");\\r\\n  x2(\\\"(?<=ab)$\\\", \\\"ab\\\", 2, 2);\\r\\n\\r\\n  n(\\\"(?<!a)$\\\", \\\"a\\\");\\r\\n  x2(\\\"(?<=a)$\\\", \\\"a\\\", 1, 1);\\r\\n\\r\\n  Syntax = ONIG_SYNTAX_PERL;\\r\\n  x2(\\\"\\\", \\\"-----perl-----\\\", 0, 0);\\r\\n\\r\\n  n(\\\"(?<!RMA)$\\\", \\\"123RMA\\\");\\r\\n  x2(\\\"(?<=RMA)$\\\", \\\"123RMA\\\", 6, 6);\\r\\n\\r\\n  n(\\\"(?<!ab)$\\\", \\\"ab\\\");\\r\\n  x2(\\\"(?<=ab)$\\\", \\\"ab\\\", 2, 2);\\r\\n\\r\\n  n(\\\"(?<!a)$\\\", \\\"a\\\");\\r\\n  x2(\\\"(?<=a)$\\\", \\\"a\\\", 1, 1);\\r\\n```\"}, {\"author\": \"spershin\", \"body\": \"@kkos \\r\\n\\r\\nWow, that was fast!\\r\\nThanks!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_296", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"296\", \"title\": \"ONIG_SYNTAX_EMACS doesn't support \\\"shy groups\\\"\", \"author\": \"tavianator\", \"labels\": [], \"description\": \"Emacs regexes have non-capturing groups that look like `\\\\(?:group\\\\)`, as documented here: https://www.gnu.org/software/emacs/manual/html_node/elisp/Regexp-Backslash.html#index-shy-groups\\r\\n\\r\\nHowever, with `ONIG_SYNTAX_EMACS`, the `?:` is matched literally.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_297", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"297\", \"title\": \"With ONIG_SYNTAX_DEFAULT pattern '(?s)ABC' fails with 'undefined group option'.\", \"author\": \"spershin\", \"labels\": [], \"description\": \"We are trying to use Oni as Regex library in [Velox](https://github.com/facebookincubator/velox) for Presto Native Execution.\\r\\nAnother issue we've encountered is:\\r\\n\\r\\nWith `ONIG_SYNTAX_DEFAULT` pattern `(?s)ABC` fails with `undefined group option`.\\r\\n\\r\\nI confirmed that group option `'s'` works with `ONIG_SYNTAX_JAVA`, however the latter does not support named capture groups like `?<digit>`, which is also critical for us.\\r\\n\\r\\nI was wondering if it is possible to add support of `'s'` to `ONIG_SYNTAX_DEFAULT`.\\r\\n\\r\\nThank you!\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Please use `(?m)` .\\r\\n\\r\\n- ONIG_SYNTAX_DEFAULT == ONIG_SYNTAX_ONIGURUMA\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/1b375923dd74367f3ebb58e2ee4dd95ccf7218fc/doc/API#L155\\r\\n\\r\\n\\r\\n- `(?s)` and `(?m)`\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/1b375923dd74367f3ebb58e2ee4dd95ccf7218fc/doc/RE#L520-L528\\r\\n\\r\\n\\r\\n- ONIG_SYNTAX_ONIGURUMA : \\\" ^ matches after newline, $ matches before newline \\\" is valid.\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/1b375923dd74367f3ebb58e2ee4dd95ccf7218fc/doc/RE#L172-L183\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa\\r\\n\\r\\nThank you for replying.\\r\\n\\r\\nI would gladly follow your advice if it was possible.\\r\\nOur situation is the following:\\r\\n\\r\\nWe are migrating from Presto Java to Presto Native (C++) with the latter using Velox library.\\r\\nPresto Java uses JONI (Java port of Oni) for regex implementation.\\r\\nVelox uses RE2, which is missing a lot of crucial functionality such as backtracking.\\r\\n\\r\\nSo, we are looking/investigating at adopting Oni instead.\\r\\nWhy?\\r\\nBecause we have hundreds of customers with established workloads and there is no way we can change their queries - too many queries, too many customers, too much negative impact if we break them.\\r\\nSo, ideally we would like to have functionality and features in Oni to be as close to JONI as possible.\\r\\nThis gives us a lot of headache, honestly. :)\\r\\n\\r\\nWould it be possible to also support `?s` along with `?m`?\\r\\nI don't know the code and never did anything around regex much up until now, so cannot really tell how hard it can be.\\r\\n\\r\\nWe could, potentially, scan and rewrite the pattern before using it with Oni, however in such cases how can we sure that we can safely rewrite any `?s` sequence into `?m`? Also, what it is a combined sequence, like `?isq` or something like that? Such rewrite becomes complicated and error-prone without deep knowledge of the patterns and syntax.\\r\\n\\r\\nThank you!\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"Sorry, I'm an end user so I don't know the details.\\r\\n\\r\\nI think you can add an option '`ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP`' to `ONIG_SYNTAX_JAVA`.\\r\\n https://github.com/kkos/oniguruma/blob/fd33056965547714484831fc16692cb387d3067f/src/regsyntax.c#L146-L169\\r\\n\\r\\nI think [#296 ](https://github.com/kkos/oniguruma/issues/296) is very helpful.\\r\\nPlease see https://github.com/kkos/oniguruma/commit/fd33056965547714484831fc16692cb387d3067f. This is the fix for #296.\\r\\n\\r\\nThis adds  `ONIG_SYN_OP2_QMARK_GROUP_EFFECT` to `OnigSyntaxEmacs`.\\r\\n\\r\\nThese options are documented in SYNTAX.md .\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/SYNTAX.md\\r\\n\\r\\nOr do you want to use ONIG_SYNTAX_DEFAULT?\\r\\nIn this case, I think a fix to the regular expression parser is needed.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nIs the syntax you used \\\"Syntax Java\\\" in JONI ?\\r\\nPlease make sure that the syntax is not something other than \\\"Syntax Java\\\".\\r\\n\\r\\nJONI : options of \\\"Syntax Java\\\"\\r\\nhttps://github.com/jruby/joni/blob/3750dcbf58cb5cfad76c1a3ae11cc2be65ba7fe1/src/org/joni/Syntax.java#L624-L652\\r\\n\\r\\nI did a test to add \\\"ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP\\\" to oniguruma's \\\"ONIG_SYNTAX_JAVA\\\".\\r\\nThe test was successful.\\r\\n\\r\\nI think it would be good to make the syntax options of JONI and oniguruma similar.\\r\\n\\r\\n> Would it be possible to also support ?s along with ?m?\\r\\n\\r\\nThis is a question that should be answered by the Owner so I cannot answer it, sorry.\\r\\n\\r\\n> scan and rewrite the pattern before using it with Oni\\r\\n\\r\\nThis is very difficult and not recommended.\\r\\n\\r\\n------------------\\r\\n\\r\\nPlease try \\\"ONIG_SYNTAX_PERL_NG\\\" of oniguruma.\\r\\n(?s) and \\\"naming capture groups\\\" are available.\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa \\r\\n\\r\\nThis seems useful. Thank you.\\r\\nI haven't read it though thoroughly yet as I'm continuing to investigate other possible issues of using Oni in Velox before spending considerable effort at fixing any of them.\\r\\n\\r\\nTo confirm (or disprove) that I understand it right:\\r\\n\\r\\nDoes it mean that we can build our own `OnigSyntaxType` structure that can encompass multiple features that we need?\\r\\nFor example, in this case we could take `ONIG_SYNTAX_DEFAULT` as the base and then add a bit so `?s` is activated?\\r\\n\\r\\nOr, as you suggested, if `ONIG_SYNTAX_JAVA` is good for us as well and is only missing `?<digit>` support, then we can add `ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP` to it or to our custom syntax based on the `ONIG_SYNTAX_JAVA`.\\r\\n\\r\\nThank you!\\r\\n\\r\\n\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa \\r\\n\\r\\nWe use Java syntax, it seems:\\r\\n```\\r\\nregex = new Regex(pattern.getBytes(), 0, pattern.length(), Option.DEFAULT, NonStrictUTF8Encoding.INSTANCE, Syntax.Java);\\r\\n```\\r\\n\\r\\nHowever, we are most likely be using a forked repo and not the master JONI.\\r\\nTrying to confirm this now.\\r\\nUpdate: Presto Java uses https://github.com/airlift/joni fork of JONI.\\r\\n\\r\\nThe path to the JONI jar is like that:\\r\\n```\\r\\n.../.m2/repository/io/airlift/joni/2.1.5.3/joni-2.1.5.3.jar!/io/airlift/joni/Regex.class\\r\\n```\\r\\n\\r\\nJONI repo does not have such version in the [list of tags](https://github.com/jruby/joni/tags).\\r\\n\\r\\nI agree the syntax should be the same, if possible, however, already there are some serious differences, like the named capture group.\\r\\n\\r\\nI'll try ONIG_SYNTAX_PERL_NG syntax too, thank you!\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I ported the options from JONI-2.1.5.3 's \\\"`Syntax.Java`\\\" to oniguruma's \\\"`OnigSyntaxJava`\\\" .\\r\\n\\r\\n```\\r\\n/*  JONI-2.1.5.3 's options for oniguruma-6.9.9 */\\r\\nOnigSyntaxType OnigSyntaxJava = {\\r\\n  (( SYN_GNU_REGEX_OP | ONIG_SYN_OP_QMARK_NON_GREEDY |\\r\\n     ONIG_SYN_OP_ESC_CONTROL_CHARS | ONIG_SYN_OP_ESC_C_CONTROL |\\r\\n     ONIG_SYN_OP_ESC_OCTAL3 | ONIG_SYN_OP_ESC_X_HEX2 |\\r\\n     ONIG_SYN_OP_ESC_X_BRACE_HEX8 )\\r\\n   & ~ONIG_SYN_OP_ESC_LTGT_WORD_BEGIN_END )\\r\\n  , ( ONIG_SYN_OP2_ESC_CAPITAL_Q_QUOTE | ONIG_SYN_OP2_QMARK_GROUP_EFFECT |\\r\\n      ONIG_SYN_OP2_OPTION_PERL | ONIG_SYN_OP2_PLUS_POSSESSIVE_REPEAT |\\r\\n      ONIG_SYN_OP2_PLUS_POSSESSIVE_INTERVAL | ONIG_SYN_OP2_CCLASS_SET_OP |\\r\\n      ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP | ONIG_SYN_OP2_ESC_K_NAMED_BACKREF |\\r\\n      ONIG_SYN_OP2_ESC_V_VTAB | ONIG_SYN_OP2_ESC_U_HEX4 |\\r\\n      ONIG_SYN_OP2_ESC_P_BRACE_CHAR_PROPERTY )\\r\\n  , ( SYN_GNU_REGEX_BV | ONIG_SYN_ISOLATED_OPTION_CONTINUE_BRANCH |\\r\\n      ONIG_SYN_DIFFERENT_LEN_ALT_LOOK_BEHIND )\\r\\n  , ONIG_OPTION_SINGLELINE\\r\\n  ,\\r\\n  {\\r\\n      (OnigCodePoint )'\\\\\\\\'                       /* esc */\\r\\n    , (OnigCodePoint )ONIG_INEFFECTIVE_META_CHAR /* anychar '.'  */\\r\\n    , (OnigCodePoint )ONIG_INEFFECTIVE_META_CHAR /* anytime '*'  */\\r\\n    , (OnigCodePoint )ONIG_INEFFECTIVE_META_CHAR /* zero or one time '?' */\\r\\n    , (OnigCodePoint )ONIG_INEFFECTIVE_META_CHAR /* one or more time '+' */\\r\\n    , (OnigCodePoint )ONIG_INEFFECTIVE_META_CHAR /* anychar anytime */\\r\\n  }\\r\\n};\\r\\n```\\r\\n```\\r\\n\\r\\n[added option]\\r\\nONIG_SYN_OP_ESC_X_BRACE_HEX8                /* \\\\x{7HHHHHHH} */\\r\\nONIG_SYN_OP2_QMARK_LT_NAMED_GROUP     /* (?<name>...) */\\r\\nONIG_SYN_OP2_ESC_K_NAMED_BACKREF        /* \\\\k<name> */\\r\\n\\r\\n[removed opiton]\\r\\nONIG_SYN_VARIABLE_LEN_LOOK_BEHIND        /* (?<=a+|..) */\\r\\n\\r\\n[ This does not exist in oniguruma ]\\r\\nOP2_ESC_P_CHAR_CHAR_PROPERTY              /* \\\\pX, \\\\PX */\\r\\n\\r\\n[This does not exist in JONI-2.1.5.3]\\r\\nONIG_SYN_ISOLATED_OPTION_CONTINUE_BRANCH      /* ..(?i)...|... */\\r\\n```\\r\\n\\r\\nSYNTAX.md\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/SYNTAX.md\\r\\n\\r\\n-----------------\\r\\n\\r\\nI tested using this syntax and it was successful.\\r\\nSo there is no need to try  \\\"`ONIG_SYNTAX_PERL_NG`\\\" syntax.\\r\\n\\r\\n-----------------\\r\\n\\r\\n>Does it mean that we can build our own `OnigSyntaxType` structure that can encompass multiple features that we need?\\r\\n\\r\\n>For example, in this case we could take `ONIG_SYNTAX_DEFAULT` as the base and then add a bit so `?s` is activated?\\r\\n\\r\\n>Or, as you suggested, if `ONIG_SYNTAX_JAVA` is good for us as well and is only missing `?<digit>` support, then we can add `ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP` to it or to our custom syntax based on the `ONIG_SYNTAX_JAVA`.\\r\\n\\r\\nSorry, I don't have the knowledge to answer these questions.\\r\\nI will let you know if I find out anything.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nSorry for keeping you waiting.\\r\\n\\r\\n> Does it mean that we can build our own` OnigSyntaxType` structure that can encompass multiple features that we need?\\r\\n\\r\\n> For example, in this case we could take `ONIG_SYNTAX_DEFAULT` as the base and then add a bit so ?s is activated?\\r\\n\\r\\n> Or, as you suggested, if `ONIG_SYNTAX_JAVA` is good for us as well and is only missing `?<digit>` support, then we can add` ONIG_SYN_OP2_QMARK_LT_NAMED_GROUP` to it or to our custom syntax based on the `ONIG_SYNTAX_JAVA`.\\r\\n\\r\\nThe answer to all of these questions is \\\"yes\\\".\\r\\nI have actually done this and confirmed that it works.\\r\\n\\r\\nIf you want to write code based on \\\"`ONIG_SYNTAX_JAVA`\\\", I recommend using the JONI-2.1.5.3 syntax above as a starting point. And please use it as your own syntax.\\r\\n\\r\\n--------------------------------\\r\\n\\r\\nIf you want to use `(?s)` in \\\"`ONIG_SYNTAX_DEFAULT`\\\" , please replace the following option:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/regparse.c#L79\\r\\n\\r\\nPlease exchange \\\"`ONIG_SYN_OP2_OPTION_ONIGURUMA`\\\" for \\\"`ONIG_SYN_OP2_OPTION_PERL`\\\" .\\r\\nBelow are descriptions of these options:\\r\\n\\r\\nSYNTAX.md : `ONIG_SYN_OP2_OPTION_ONIGURUMA`\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/SYNTAX.md#30-onig_syn_op2_option_oniguruma-enable-options-imxwsdpy-and--imxwdsp\\r\\n\\r\\nSYNTAX.md : `ONIG_SYN_OP2_OPTION_PERL`\\r\\nhttps://github.com/kkos/oniguruma/blob/master/doc/SYNTAX.md#2-onig_syn_op2_option_perl-enable-options-imsx-and--imsx\\r\\n\\r\\nHowever, this swap makes `(?W)` , `(?D)` , `(?S)` , `(?P)` invalid.\\r\\n\\r\\n\\r\\n--------------------------------\\r\\n\\r\\nIf you want to change only `(?s)` and `(?m)` , please change the code below.\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/regparse.c#L8281-L8302\\r\\n\\r\\n`'m'` : `(?m)` , `(?-m)`\\r\\n`'s'`  : `(?s)`  , `(?-s)`\\r\\n'`-`' negates the effect.\\r\\n\\r\\nBelow is an explanation of \\\"`ONIG_OPTION_SINGLELINE`\\\" and \\\"`ONIG_OPTION_MULTILINE`\\\" .\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/doc/API#L79-L80\\r\\n\\r\\nBut such a change may be confusing to users. If I were a user, I would like to be able to choose between the JONI and oniguruma syntax. And oniguruma can do that.\\r\\n\\r\\n--------------------------------\\r\\n\\r\\nIf you want to replace the default syntax,  please change the following:\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/regparse.c#L164\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/regsyntax.c#L281\\r\\n\\r\\n--------------------------------\\r\\nIf you want to create your own syntax, please refer to the following.\\r\\n\\\"`OnigSyntaxJava`\\\" is registered like this, you can register your own syntax in the same way.\\r\\n\\r\\noniguruma.h\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/oniguruma.h#L427\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/oniguruma.h#L441\\r\\n\\r\\nonigposix.h\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/onigposix.h#L134\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/onigposix.h#L145\\r\\n\\r\\nregsyntax.c\\r\\nhttps://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/src/regsyntax.c#L146\\r\\n\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa \\r\\nThank you very much for so much detailed information!\\r\\nThis is VERY helpful.\\r\\nI am going to try out the options you suggested (especially the one you took from JONI) and see if we are lucky enough to have most of the options working like they do in JONI.\\r\\n\\r\\nI'm sorry that I wasn't able to reply here earlier - was busy implementing the remaining regex functions based on Oni and testing them, collecting issues I can find.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n\\r\\nI'm glad I could be of help to you. Don't worry about the reply. \\r\\n\\r\\nI think the next problem will be that `\\\\pX` and `\\\\PX` cannot be used in oniguruma.\\r\\nThis is too difficult for me.\\r\\n\\r\\nI will close this thread as it has served its purpose. Thank you.\\r\\n\\r\\n------------\\r\\n\\r\\nEDIT: I can't seem to close this thread.\"}, {\"author\": \"spershin\", \"body\": \"@tonco-miyazawa \\r\\nUsing your pointers on how the syntax structures work I managed to make `(?s)` work in `ONIG_SYNTAX_DEFAULT`.\\r\\nNow, I'm yet to do more testing to see if there are possible side effects of this, but unit tests pass.\\r\\n\\r\\nThe code:\\r\\n```\\r\\nstatic OnigSyntaxType myOnigSyntax = *ONIG_SYNTAX_DEFAULT;\\r\\nmyOnigSyntax.op2 |= ONIG_SYN_OP2_OPTION_PERL;\\r\\ngOnigSyntax = &myOnigSyntax;\\r\\n```\\r\\n\\r\\nwhere `gOnigSyntax` is \\r\\n`void* gOnigSyntax = ONIG_SYNTAX_DEFAULT;`\\r\\nand is used in `onig_new()`.\\r\\n\\r\\nSomewhat relevant:\\r\\nI'm also adding \\r\\n```\\r\\n  myOnigSyntax.options |= ONIG_OPTION_SINGLELINE;\\r\\n```\\r\\nTo treat string as a single line, which `ONIG_SYNTAX_DEFAULT` does not do and it does not match JONI in this behavior.\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"@spershin\\r\\n>  unit tests pass.\\r\\n\\r\\nCongratulations! Good job!\\r\\n\\r\\n\\r\\n> `myOnigSyntax.options |= ONIG_OPTION_SINGLELINE;`\\r\\n> To treat string as a single line, which `ONIG_SYNTAX_DEFAULT` does not do\\r\\n> and it does not match JONI in this behavior.\\r\\n\\r\\nI have tested this and found that this option works correctly.\\r\\nThis is a very confusing subject and it's easy to get confused.\\r\\nBecause we are confused by settings like:\\r\\n\\r\\n\\\"`ONIG_OPTION_SINGLELINE`\\\" and \\\"`ONIG_OPTION_MULTILINE`\\\",\\r\\n\\r\\n\\\"`ONIG_SYN_OP2_OPTION_ONIGURUMA`\\\" and \\\"`ONIG_SYN_OP2_OPTION_PERL`\\\"\\r\\n\\r\\n\\\"`(?s)`\\\" and \\\"`(?m)`\\\"\\r\\n\\r\\n\\r\\nSo I created a test to check if the option is valid or Invalid.\\r\\nBelow is the test for \\\"`/test/test_syntax.c`\\\".\\r\\nIf the option is Invalid, these tests will return \\\"`FAIL`\\\" .\\r\\n\\r\\n```\\r\\n  ////////////  Test to see if an option is valid /////////////\\r\\n  Syntax = ONIG_SYNTAX_DEFAULT;\\r\\n\\r\\n  x2(\\\"$\\\", \\\"123\\\\n456\\\", 7, 7);           // 7-7 == ONIG_OPTION_SINGLELINE is valid.\\r\\n  \\r\\n  x2(\\\"\\\\\\\\A.*\\\\\\\\z\\\", \\\"123\\\\n456\\\", 0, 7);    // 0-7 == ONIG_OPTION_MULTILINE is valid.\\r\\n  ///////////////////////////////////////////////////////////////\\r\\n```\\r\\n\\r\\n\\r\\nBelow is the command for testing above.\\r\\nPlease copy \\\"`/test/test_syntax.c`\\\" to \\\"`Documents`\\\" folder. ( This is the same as issue290. )\\r\\n\\r\\n```\\r\\n$ gcc ~/Documents/test_syntax.c  -L/usr/local/lib -lonig\\r\\n$ ./a.out\\r\\n```\\r\\n\\r\\n\\r\\nAlso, please check your `onig_new()` setting.\\r\\nhttps://github.com/kkos/oniguruma/blob/bcfbab2e38956c67029a4743a97644f119dc4be3/doc/API#L76-L104\\r\\n\\r\\n\\r\\nAlso, see below for the values ‚Äã‚Äãof \\\"`ONIG_OPTION_DEFAULT`\\\" .\\r\\nhttps://github.com/kkos/oniguruma/blob/bcfbab2e38956c67029a4743a97644f119dc4be3/src/oniguruma.h#L372\\r\\n\\r\\nYou can also check \\\"`ONIG_OPTION_SINGLELINE`\\\" by using \\\"`ONIG_OPTION_NEGATE_SINGLELINE`\\\" in `onig_new()` .\\r\\nTry using this option to see if it changes your results.\\r\\nhttps://github.com/kkos/oniguruma/blob/bcfbab2e38956c67029a4743a97644f119dc4be3/doc/API#L85\\r\\n\\r\\nI hope your work goes well. Thank you.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_298", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"298\", \"title\": \"Error 'unmatched range specifier in char-class' with hyphen in character class.\", \"author\": \"spershin\", \"labels\": [\"specification\"], \"description\": \"`SELECT regexp_like('data', '[\\\\w\\\\-\\\\.]');`\\r\\nReturns `true` in Oni, JONI and RE2.\\r\\n\\r\\nHowever:\\r\\n`SELECT regexp_like('data', '[\\\\w-\\\\.]');`\\r\\nReturns `true` in JONI and RE2, but fails with '`unmatched range specifier in char-class`' in Oni.\\r\\n\\r\\nAnalysis:\\r\\n`-`: When placed between characters in a character class, the hyphen (`-`) typically specifies a range of characters.\\r\\nHowever, in this case, it is between `\\\\w` (a character class) and `.` (a dot), which does not form a valid range.\\r\\nThus, it matches the literal hyphen (`-`) character.\\r\\n\\r\\nBoth patterns function identically in practice because the hyphen (`-`) is not between two characters that could form a range in the second pattern.\\r\\nThey both match any word character (letters, digits, underscore), a hyphen, or a dot.\\r\\nThe backslash before the hyphen in the first pattern makes it clear that the hyphen is a literal character, but in this specific context, it does not change the meaning of the pattern.\\r\\n\\r\\nI wonder if it makes sense to treat `-` in this case as the literal hyphen (`-`) character, like some other regex libraries do?\\r\\nThank you.\", \"comments\": [{\"author\": \"spershin\", \"body\": \"Thank you for addressing the issue!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_300", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"300\", \"title\": \"typos\", \"author\": \"spaette\", \"labels\": [], \"description\": \"cast\\r\\nimplemented \\r\\nsequential\\r\\n\\r\\n\\r\\n```\\r\\n$ grep -nr casted oniguruma\\r\\noniguruma/HISTORY:1200:                   char > 127 should be casted to unsigned char. (utf8.c)\\r\\n$ grep -nr implemeted oniguruma\\r\\noniguruma/HISTORY:2280:2003/01/17: [bug]  bad implemeted POSIX API options.\\r\\n$ grep -nr sequencial oniguruma\\r\\noniguruma/HISTORY:738:2006/09/20: [impl] change ONIGENC_CTYPE_XXXX to sequencial values.\\r\\n$ \\r\\n```\\r\\n\\r\\nthis would be easier to read\\r\\n\\r\\n```\\r\\nsed -i \\\"s/bad implemeted/badly implemented/g\\\" oniguruma/HISTORY\\r\\n```\\r\\n\\r\\nas in the `sed` command if `bad` (adjective) is replaced with `badly` (adverb) it could also be used on line 2160 \\r\\n\\r\\n```\\r\\n$ grep -n \\\"bad \\\" oniguruma/HISTORY\\r\\n252:2018/02/15: fix #78: bad definition of PV_()\\r\\n1632:                   ex. bad match /a.{0,2}?a/ =~ \\\"0aXXXa0\\\"\\r\\n1816:                   (ex. bad match /(?i)(?-i)a/ =~ \\\"A\\\")\\r\\n2160:2003/02/26: [tune] bad implemented N_ALT case in get_min_match_length().\\r\\n2280:2003/01/17: [bug]  bad implemeted POSIX API options.\\r\\n$ \\r\\n```\\r\\n\\r\\nthe foregoing @k-takata also are present in your fork\\r\\n\\r\\npositive\\r\\n\\r\\n```\\r\\n$ grep -nr postitive oniguruma\\r\\noniguruma/test/test_utf8.c:755:  x2(\\\"(?:\\\\\\\\k'+1'B|(A)C)*\\\", \\\"ACAB\\\", 0, 4); // relative backref by postitive number\\r\\noniguruma/test/testp.c:506:  x2(\\\"(?:\\\\\\\\k'+1'B|(A)C)*\\\", \\\"ACAB\\\", 0, 4); // relative backref by postitive number\\r\\noniguruma/test/test_back.c:612:  x2(\\\"(?:\\\\\\\\k'+1'B|(A)C)*\\\", \\\"ACAB\\\", 4, 4); // relative backref by postitive number\\r\\noniguruma/test/testc.c:523:  x2(\\\"(?:\\\\\\\\k'+1'B|(A)C)*\\\", \\\"ACAB\\\", 0, 4); // relative backref by postitive number\\r\\n$ \\r\\n```\\r\\n\\r\\nWON'T FIX\\r\\n\\r\\ntypos in commit names\\r\\n\\r\\n```\\r\\n$ grep -nr architecutres oniguruma\\r\\noniguruma/HISTORY:308:2017/07/14: fix #65: SIZEOF_SIZE_T doesn't exist on certain architecutres\\r\\n$ grep -nr charcter oniguruma\\r\\noniguruma/HISTORY:17:2022/06/24: (?I) invalid results for charcter classes (Issue #264)\\r\\n$ grep -nr configre oniguruma\\r\\noniguruma/HISTORY:415:2016/03/23: rename configre.in to configure.ac.\\r\\n$ grep -nr incompatibilty oniguruma\\r\\noniguruma/HISTORY:72:2020/10/12: fix #219: Binary incompatibilty between 6.9.5_rev1 -> 6.9.2_rc2: reg_number_of_names\\r\\n$ \\r\\n```\\r\\n\\r\\nWON'T FIX\\r\\n\\r\\ntypo in FSF file\\r\\n\\r\\n```\\r\\n$ grep -nr obsosete oniguruma\\r\\noniguruma/depcomp:201:## Note that this doesn't just cater to obsosete pre-3.x GCC compilers.\\r\\n$ \\r\\n```\", \"comments\": [{\"author\": \"spaette\", \"body\": \"this `refered` was noticed subsequent to the merge\\r\\n\\r\\n```\\r\\n$ ed -s oniguruma/HISTORY <<<'2105,2107p'\\r\\n2003/03/08: [bug]  called group in 0-repeat should not be eliminated from\\r\\n                   compile code.  ex. /(?*n)(?<n>){0}/   (thanks akr)\\r\\n                   add is_refered member to QualifierNode.\\r\\n$ \\r\\n```\\r\\n\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_302", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"302\", \"title\": \":alpha: character class matches \\\"non-letter\\\" unicode characters.\", \"author\": \"spershin\", \"labels\": [\"specification\"], \"description\": \"Hi!\\r\\nI'm not sure if this is a false alarm, but here is what I have found when comparing Oni and JONI behaviors.\\r\\n\\r\\nQuery: `select regexp_replace('Z√ºrich Pushin üÖø', '[^[:alpha:]\\\\s]');`\\r\\n\\r\\nJONI returns: `Z√ºrich Pushin`.\\r\\nOni returns: `Z√ºrich Pushin üÖø`\\r\\nMeaning Oni considers `üÖø` as an alpha character.\\r\\n\\r\\n`üÖø` is the `NEGATIVE SQUARED LATIN CAPITAL LETTER P` character with code `f0 9f 85 bf`.\\r\\nSo, it is not a letter (alphabetic character), per se.\\r\\n\\r\\nAccording to JONI and https://regex101.com/ `üÖø` is not considered as an alphabetic character.\\r\\n101 says: [:alpha:] matches an alphabetic character \\\\p{L}\\r\\nRE2 takes it to extreme of only including ASCII alphabetic characters (one of the reasons we are looking to adopt Oni in Velox).\\r\\n\\r\\nOni's [documentation](https://github.com/kkos/oniguruma/blob/f2f9c695e0ec4584f14e5df29c7df6e8ff38862a/doc/RE#L241) says: `alpha    Letter | Mark for unicode`.\\r\\nNot sure if `üÖø` falls under the `Mark` category (don't know what it means).\\r\\n\\r\\nWould be nice to receive a confirmation if the current behavior is intended or not.\\r\\nAnd also if it is possible to change this behavior with an option (unless it is too complex to implement or maintain).\\r\\n\\r\\nThank you!\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"Below is the test code for [test_utf8.c](https://github.com/kkos/oniguruma/blob/master/test/test_utf8.c) .\\r\\n\\r\\n```\\r\\n  /*  [[:alpha:]]  */\\r\\n  x2(\\\"[[:alpha:]]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  x2(\\\"[^[:^alpha:]]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  n(\\\"[[:^alpha:]]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n  n(\\\"[^[:alpha:]]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n  \\r\\n  /*  \\\\p{Alpha}  */\\r\\n  x2(\\\"\\\\\\\\p{Alpha}\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  x2(\\\"\\\\\\\\P{^Alpha}\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  n(\\\"\\\\\\\\P{Alpha}\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n  n(\\\"\\\\\\\\p{^Alpha}\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n  \\r\\n  /*  \\\\p{Alpha} in character class */\\r\\n  x2(\\\"[\\\\\\\\p{Alpha}]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  x2(\\\"[\\\\\\\\P{^Alpha}]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\", 0, 4);\\r\\n  n(\\\"[\\\\\\\\P{Alpha}]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n  n(\\\"[\\\\\\\\p{^Alpha}]\\\", \\\"\\\\xf0\\\\x9f\\\\x85\\\\xbf\\\");\\r\\n```\\r\\nUnicode Character (U+1F17F)\\r\\nhttps://www.compart.com/en/unicode/U+1F17F\"}, {\"author\": \"kkos\", \"body\": \"That part of the document is quite old.\\r\\nHere's what it looks like now.\\r\\n[[:alpha:]] == \\\\p{Alphabetic}\\r\\n\\r\\nIn perl5, [[:alpha:]] and ‚ÄúüÖø‚Äù matched.\\r\\nThe standard Java and Python libraries do not support POSIX brackets.\\r\\nIn Python's regex module, [[:alpha:]] and ‚ÄúüÖø‚Äù match.\\r\\n\\r\\n```\\r\\nimport regex\\r\\nprint(regex.findall(r'[[:alpha:]]', 'üÖø'))\\r\\n==> ['üÖø']\\r\\n```\"}, {\"author\": \"spershin\", \"body\": \"Another case with `Negative Squared Latin Capital Letter O`:\\r\\n`select regexp_like('üÖû', '(?i)(\\\\b)???????(\\\\b)');` returns `true` in Oni, but `false` in JONI.\\r\\n\\r\\nI don't exactly know what the pattern `(?i)(\\\\b)???????(\\\\b)` supposed to do as it seems a bad pattern (that still, however, runs both n Oni and JONI).\\r\\nI suspect, though, that the patten means to tell is there is a word of any length (non-zero, I suppose) in the string.\\r\\nAnd that's where Oni considers one of those weird negative squared characters to be an alphabetic character.\\r\\n\\r\\nRegex 101 does not accept such pattern, but accepts `(?i)(\\\\b)??(\\\\b)` and returns false on `üÖû`.\"}, {\"author\": \"kkos\", \"body\": \"Since  üÖû is contained in \\\\p{Alphabetic} as well as üÖø, the start of the string is at a word boundary.\\r\\nTherefore, it matches.\\r\\n\\r\\nWhen you write ??, it becomes a reluctant ?(=={0,1}?). Adding any more '?'s does not make sense because it is an reluctance specification.\\r\\nAt the point of parsing the regular expression, it is converted as follows\\r\\n??????? ==> ??\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_303", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"303\", \"title\": \"Sample pattern and content to trigger error in onig_search?\", \"author\": \"codesniffer13\", \"labels\": [\"question\"], \"description\": \"I'm adding unit tests to my code to verify my code's handling of an error return from onig_search.  I've tried various patterns (like catastrophic backtracking), but none of them are triggering an error.\\r\\n\\r\\nDo you have a sample regex pattern + content which causes onig_search to return an error code?\\r\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"```c\\r\\n  static UChar* pattern = (UChar* )\\\"(a+)+b\\\";\\r\\n  static UChar* str = (UChar* )\\\"aaaaaaaaaaaaaaaaaaaaaaaa\\\";\\r\\n  onig_set_retry_limit_in_match(10000000);  // default value\\r\\n```\"}, {\"author\": \"codesniffer13\", \"body\": \"Perfect, thank you!\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_304", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"304\", \"title\": \"Invalid utf8 sequence matches the pattern while it probably should not.\", \"author\": \"spershin\", \"labels\": [\"specification\"], \"description\": \"Found another case where Oni behaves not like JONI:\\r\\n\\r\\nThis test fails:\\r\\n`  EXPECT_EQ(regexExtract(\\\"Blue-\\\\xE7ngel\\\", \\\"[\\\\\\\\w\\\\\\\\-\\\\\\\\\\\\\\\\]*\\\", 0), \\\"Blue-\\\");`\\r\\nBecause the search returns the whole string `Blue-\\\\xE7ngel` or `Blue-ÔøΩngel`, while it should probably return `Blue-`.\\r\\n\\r\\nThis test succeeds - Oni correctly stops on `+`.\\r\\n`  EXPECT_EQ(regexExtract(\\\"Blue-+ngel\\\", \\\"[\\\\\\\\w\\\\\\\\-\\\\\\\\\\\\\\\\]*\\\", 0), \\\"Blue-\\\");`\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Byte sequences that are invalid as strings should not be used, and the result is undefined.\\r\\n\\r\\nonig_search() in doc/API\\r\\n`  Do not pass invalid byte string in the regex character encoding.`\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_305", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"305\", \"title\": \"Test files ( 'e' function )\", \"author\": \"tonco-miyazawa\", \"labels\": [], \"description\": \"This is a fix to make it \\\"`FAIL`\\\" when no error occurred.\\r\\n\\r\\nThe following four fixes:\\r\\n\\r\\nhttps://github.com/kkos/oniguruma/blob/ab444e085f30e8466329b86d836c6e05546e2e15/test/test_utf8.c#L67\\r\\nhttps://github.com/kkos/oniguruma/blob/ab444e085f30e8466329b86d836c6e05546e2e15/test/test_syntax.c#L68\\r\\nhttps://github.com/kkos/oniguruma/blob/ab444e085f30e8466329b86d836c6e05546e2e15/test/test_options.c#L67\\r\\nhttps://github.com/kkos/oniguruma/blob/ab444e085f30e8466329b86d836c6e05546e2e15/test/test_back.c#L67\\r\\n\\r\\nPlease rewrite it as follows.\\r\\n\\r\\n//Before\\r\\n`  if (r < ONIG_MISMATCH) {`\\r\\n\\r\\n//After\\r\\n`  if (r < ONIG_MISMATCH || error_no < ONIG_MISMATCH) {`\\r\\n\\r\\nThis will change the results of the following tests:\\r\\nhttps://github.com/kkos/oniguruma/blob/ab444e085f30e8466329b86d836c6e05546e2e15/test/test_utf8.c#L1651-L1652\\r\\n\\r\\nand\\r\\n\\r\\n```\\r\\n  e(\\\"\\\" , \\\"\\\" , -50000);\\r\\n  e(\\\"a\\\", \\\"a\\\", -50001);\\r\\n  e(\\\"a\\\", \\\"b\\\", -50002);\\r\\n```\\r\\n\\r\\nP.S.  `(*SKIP)` worked fine. Thank you.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_306", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"306\", \"title\": \"How do I statically link the library to my project without installing it on my system\", \"author\": \"aalmkainzi\", \"labels\": [], \"description\": \"I followed the README steps and that puts the library and headers in my user/local directories which I don't want.\\r\\n\\r\\nI just want to compile the lib to ./bin directory without installing it system-wide.\\r\\n\\r\\nHow would I do that?\\r\\n \", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_307", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"307\", \"title\": \"How to build ARM64 platform for Windows\", \"author\": \"asukun\", \"labels\": [\"question\"], \"description\": \"Could you please provide a way to build ARM64 Plaform for Windows?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The way it is written in README.md for Visual Studio does not work?\\r\\nI don't have the ARM64 platform for Windows so I can't check.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_308", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"308\", \"title\": \"Error while installing v6.9.0\", \"author\": \"samtexkos\", \"labels\": [], \"description\": \"Hello,\\r\\n\\r\\nI am trying to install oniguruma v6.9.0 as it is a dependency for another tool I need (pyjq).\\r\\n\\r\\nI am on Ubuntu 24.04, I have autoreconf 2.71 installed and libtool 2.4.7\\r\\n\\r\\nSteps taken :\\r\\ngit clone --depth 1 --branch v6.9.0 https://github.com/kkos/oniguruma.git\\r\\ncd oniguruma\\r\\nautoreconf -vfi\\r\\n./configure\\r\\nmake\\r\\n\\r\\nThe last command returns \\\"make: *** No targets. Stop.\\\" chich means previous step has failed. The Makefile is empty:\\r\\n\\r\\n```\\r\\nls -alGh Makefile\\r\\n-rw-r--r-- 1 myusername 0 Sep  3 11:21 Makefile\\r\\n```\\r\\n\\r\\n\\r\\nHere is the result of autoreconf -vfi\\r\\n\\r\\n```\\r\\nautoreconf: export WARNINGS=\\r\\nautoreconf: Entering directory '.'\\r\\nautoreconf: configure.ac: not using Gettext\\r\\nautoreconf: running: aclocal --force -I m4\\r\\nautoreconf: configure.ac: tracing\\r\\nautoreconf: running: libtoolize --copy --force\\r\\nlibtoolize: putting auxiliary files in '.'.\\r\\nlibtoolize: copying file './ltmain.sh'\\r\\nlibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.\\r\\nlibtoolize: copying file 'm4/libtool.m4'\\r\\nlibtoolize: copying file 'm4/ltoptions.m4'\\r\\nlibtoolize: copying file 'm4/ltsugar.m4'\\r\\nlibtoolize: copying file 'm4/ltversion.m4'\\r\\nlibtoolize: copying file 'm4/lt~obsolete.m4'\\r\\nautoreconf: configure.ac: not using Intltool\\r\\nautoreconf: configure.ac: not using Gtkdoc\\r\\nautoreconf: running: aclocal --force -I m4\\r\\nautoreconf: running: /usr/bin/autoconf --force\\r\\nconfigure.ac:52: warning: The macro `AC_HEADER_STDC' is obsolete.\\r\\nconfigure.ac:52: You should run autoupdate.\\r\\n./lib/autoconf/headers.m4:704: AC_HEADER_STDC is expanded from...\\r\\nconfigure.ac:52: the top level\\r\\nconfigure.ac:60: warning: The macro `AC_HEADER_TIME' is obsolete.\\r\\nconfigure.ac:60: You should run autoupdate.\\r\\n./lib/autoconf/headers.m4:743: AC_HEADER_TIME is expanded from...\\r\\nconfigure.ac:60: the top level\\r\\nconfigure.ac:93: warning: AC_OUTPUT should be used without arguments.\\r\\nconfigure.ac:93: You should run autoupdate.\\r\\nautoreconf: running: /usr/bin/autoheader --force\\r\\nautoreconf: running: automake --add-missing --copy --force-missing\\r\\nconfigure.ac:41: installing './compile'\\r\\nconfigure.ac:6: installing './missing'\\r\\nsample/Makefile.am: installing './depcomp'\\r\\nautoreconf: Leaving directory '.'\\r\\n```\\r\\n\\r\\nand here is the log of ./configure\\r\\n\\r\\n```\\r\\nchecking for a BSD-compatible install... /usr/bin/install -c                                                                                                          \\r\\nchecking whether build environment is sane... yes                                                                                                                     \\r\\nchecking for a race-free mkdir -p... /usr/bin/mkdir -p                                                                                                                \\r\\nchecking for gawk... no                                                                                                                                               \\r\\nchecking for mawk... mawk                                                                                                                                             \\r\\nchecking whether make sets $(MAKE)... yes                                                                                                                             \\r\\nchecking whether make supports nested variables... yes                                                                                                                \\r\\nchecking for gcc... gcc                                                                                                                                               \\r\\nchecking whether the C compiler works... yes                                                                                                                          \\r\\nchecking for C compiler default output file name... a.out                                                                                                             \\r\\nchecking for suffix of executables...                                                                                                                                 \\r\\nchecking whether we are cross compiling... no                                                                                                                         \\r\\nchecking for suffix of object files... o                                                                                                                              \\r\\nchecking whether the compiler supports GNU C... yes                                                                                                                   \\r\\nchecking whether gcc accepts -g... yes                                                                                                                                \\r\\nchecking for gcc option to enable C11 features... none needed                                                                                                         \\r\\nchecking whether gcc understands -c and -o together... yes                                                                                                            \\r\\nchecking whether make supports the include directive... yes (GNU style)                                                                                               \\r\\nchecking dependency style of gcc... gcc3\\r\\nchecking build system type... x86_64-pc-linux-gnu\\r\\nchecking host system type... x86_64-pc-linux-gnu\\r\\nchecking how to print strings... printf\\r\\nchecking for a sed that does not truncate output... /usr/bin/sed\\r\\nchecking for grep that handles long lines and -e... /usr/bin/grep\\r\\nchecking for egrep... /usr/bin/grep -E\\r\\nchecking for fgrep... /usr/bin/grep -F\\r\\nchecking for ld used by gcc... /usr/bin/ld\\r\\nchecking if the linker (/usr/bin/ld) is GNU ld... yes\\r\\nchecking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B\\r\\nchecking the name lister (/usr/bin/nm -B) interface... BSD nm\\r\\nchecking whether ln -s works... yes\\r\\nchecking the maximum length of command line arguments... 1572864\\r\\nchecking how to convert x86_64-pc-linux-gnu file names to x86_64-pc-linux-gnu format... func_convert_file_noop\\r\\nchecking how to convert x86_64-pc-linux-gnu file names to toolchain format... func_convert_file_noop\\r\\nchecking for /usr/bin/ld option to reload object files... -r\\r\\nchecking for file... file\\r\\nchecking for objdump... objdump\\r\\nchecking how to recognize dependent libraries... pass_all\\r\\nchecking for dlltool... no\\r\\nchecking how to associate runtime and link libraries... printf %s\\\\n\\r\\nchecking for ar... ar\\r\\nchecking for archiver @FILE support... @                                                                                                            17:51:43 [29/5700]\\r\\nchecking for strip... strip\\r\\nchecking for ranlib... ranlib\\r\\nchecking command to parse /usr/bin/nm -B output from gcc object... ok\\r\\nchecking for sysroot... no\\r\\nchecking for a working dd... /usr/bin/dd\\r\\nchecking how to truncate binary pipes... /usr/bin/dd bs=4096 count=1\\r\\nchecking for mt... mt\\r\\nchecking if mt is a manifest tool... no\\r\\nchecking for stdio.h... yes\\r\\nchecking for stdlib.h... yes\\r\\nchecking for string.h... yes\\r\\nchecking for inttypes.h... yes\\r\\nchecking for stdint.h... yes\\r\\nchecking for strings.h... yes\\r\\nchecking for sys/stat.h... yes\\r\\nchecking for sys/types.h... yes\\r\\nchecking for unistd.h... yes\\r\\nchecking for sys/time.h... yes\\r\\nchecking for dlfcn.h... yes\\r\\nchecking for objdir... .libs\\r\\nchecking if gcc supports -fno-rtti -fno-exceptions... no\\r\\nchecking for gcc option to produce PIC... -fPIC -DPIC\\r\\nchecking if gcc PIC flag -fPIC -DPIC works... yes\\r\\nchecking if gcc static flag -static works... yes\\r\\nchecking if gcc supports -c -o file.o... yes\\r\\nchecking if gcc supports -c -o file.o... (cached) yes\\r\\nchecking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes\\r\\nchecking whether -lc should be explicitly linked in... no\\r\\nchecking dynamic linker characteristics... GNU/Linux ld.so\\r\\nchecking how to hardcode library paths into programs... immediate\\r\\nchecking whether stripping libraries is possible... yes\\r\\nchecking if libtool supports shared libraries... yes\\r\\nchecking whether to build shared libraries... yes\\r\\nchecking whether to build static libraries... yes\\r\\nchecking whether make sets $(MAKE)... (cached) yes\\r\\nchecking for egrep... (cached) /usr/bin/grep -E\\r\\nchecking for stdlib.h... (cached) yes\\r\\nchecking for string.h... (cached) yes\\r\\nchecking for strings.h... (cached) yes\\r\\nchecking for limits.h... yes\\r\\nchecking for sys/time.h... (cached) yes\\r\\nchecking for unistd.h... (cached) yes\\r\\nchecking for sys/times.h... yes\\r\\nchecking size of int... 4\\r\\nchecking size of short... 2\\r\\nchecking size of long... 8\\r\\nchecking for an ANSI C-conforming const... yes\\r\\nchecking for size_t... yes\\r\\nchecking for working alloca.h... yes\\r\\nchecking for alloca... yes\\r\\nchecking for working memcmp... yes\\r\\nchecking for prototypes... yes\\r\\nchecking for variable length prototypes and stdarg.h... yes\\r\\nchecking that generated files are newer than configure... done\\r\\nconfigure: creating ./config.status\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/build_os='linux-gnu'\\r\\nconfig.status: creating Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating src/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating test/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating sample/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating onig-config\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating src/config.h\\r\\nconfig.status: src/config.h is unchanged\\r\\nconfig.status: executing depfiles commands\\r\\nconfig.status: executing libtool commands \\r\\nconfig.status: executing default commands \\r\\n```\\r\\n\\r\\nThose last few lines suggest an issue withe the sed command, but I am unable to identify it. my sed command is located at /usr/bin/sed\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I created an Ubuntu 24.04 environment with Docker to check it.\\r\\nIn it, from autoreconf to make, it worked fine.\\r\\nI do not know why configure does not run correctly in your environment, but it may work if it is from the released source.\\r\\n\\r\\n```\\r\\nwget https://github.com/kkos/oniguruma/releases/download/v6.9.0/onig-6.9.0.tar.gz\\r\\ncd onig-6.9.0\\r\\n./configure\\r\\nmake\\r\\n```\"}, {\"author\": \"samtexkos\", \"body\": \"I have tried with  https://github.com/kkos/oniguruma/releases/download/v6.9.0/onig-6.9.0.tar.gz, the ./configure commands gives the exact same log as before.\\r\\n\\r\\nI have been trying to identify what's being attempted in the steps that lead to this part in the logs but I can't identify:\\r\\n\\r\\n```\\r\\nconfigure: creating ./config.status\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/build_os='linux-gnu'\\r\\nconfig.status: creating Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating src/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating test/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating sample/Makefile\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating onig-config\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\nconfig.status: creating src/config.h\\r\\n```\"}, {\"author\": \"kkos\", \"body\": \"```\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/build_os='linux-gnu'\\r\\nsed: can't find label for jump to `uild_os='linux-gnu''\\r\\n```\\r\\n\\r\\nI found a similar problem below.\\r\\nhttps://github.com/r-lib/fs/issues/338#issuecomment-1110821139\\r\\n\\r\\n\\r\\nsed in my environment.\\r\\n```\\r\\nroot@e31b0876b06e:~# which sed\\r\\n/usr/bin/sed\\r\\nroot@e31b0876b06e:~# sed --version\\r\\nsed (GNU sed) 4.9\\r\\nPackaged by Debian\\r\\nCopyright (C) 2022 Free Software Foundation, Inc.\\r\\nLicense GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>.\\r\\nThis is free software: you are free to change and redistribute it.\\r\\nThere is NO WARRANTY, to the extent permitted by law.\\r\\n\\r\\nWritten by Jay Fenlason, Tom Lord, Ken Pizzini,\\r\\nPaolo Bonzini, Jim Meyering, and Assaf Gordon.\\r\\n\\r\\nThis sed program was built with SELinux support.\\r\\nSELinux is disabled on this system.\\r\\n\\r\\nGNU sed home page: <https://www.gnu.org/software/sed/>.\\r\\nGeneral help using GNU software: <https://www.gnu.org/gethelp/>.\\r\\nE-mail bug reports to: <bug-sed@gnu.org>.\\r\\n```\"}, {\"author\": \"samtexkos\", \"body\": \"I had seen this issue and checked my sed, I have the same result as you:\\r\\n\\r\\n```\\r\\nmyusername@mymachine : ~$ which sed\\r\\n/usr/bin/sed\\r\\nmyusername@mymachine : ~$ sed --version\\r\\nsed (GNU sed) 4.9\\r\\nPackaged by Debian\\r\\nCopyright ¬© 2022 Free Software Foundation, Inc.\\r\\nLicence GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>.\\r\\nThis is free software: you are free to change and redistribute it.\\r\\nThere is NO WARRANTY, to the extent permitted by law.\\r\\n\\r\\nWritten by Jay Fenlason, Tom Lord, Ken Pizzini,\\r\\nPaolo Bonzini, Jim Meyering, and Assaf Gordon.\\r\\n\\r\\nThis sed program was built with SELinux support.\\r\\nSELinux is disabled on this system.\\r\\n\\r\\nGNU sed home page: <https://www.gnu.org/software/sed/>.\\r\\nGeneral help using GNU software: <https://www.gnu.org/gethelp/>.\\r\\nE-mail bug reports to: <bug-sed@gnu.org>.\\r\\n```\\r\\n\"}, {\"author\": \"kkos\", \"body\": \"Are /bin/sed and /usr/bin/sed the same?\\r\\nIn my case, it was the same, so I did not write it down.\"}, {\"author\": \"samtexkos\", \"body\": \"Yes, my /bin points to /usr/bin, so my /bin/sed = /usr/bin/sed\\r\\n\\r\\nI also checked a diff of the two sed to be sure:\\r\\n\\r\\n`/$ diff bin/sed /usr/bin/sed`\"}, {\"author\": \"samtexkos\", \"body\": \"I wiped my computer and rebooted from a clean ubuntu 24.04 image, a clean reinstall still led me to the same issue\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I have also had trouble installing oniguruma in the past.\\r\\nThe following command solved the problem then.\\r\\n\\r\\n**I'm not familiar with Linux so I'm not sure if the following command is correct.\\r\\nPlease use at your own risk.**\\r\\n\\r\\nPlease download the \\\"`Source code (zip)`\\\" or \\\"`Source code (tar.gz)`\\\" and unzip it.\\r\\nhttps://github.com/kkos/oniguruma/archive/refs/tags/v6.9.0.zip\\r\\nhttps://github.com/kkos/oniguruma/archive/refs/tags/v6.9.0.tar.gz\\r\\n\\r\\n```\\r\\nsudo apt-get install build-essential\\r\\nsudo apt-get install libtool\\r\\nsudo apt install libonig5\\r\\ncd oniguruma-6.9.0\\r\\n./autogen.sh\\r\\n./configure\\r\\nmake\\r\\nsudo make install\\r\\nsudo ldconfig\\r\\nonig-config --version\\r\\n```\\r\\n\\r\\n> sed: can't find label for jump to `uild_os='linux-gnu''\\r\\n\\r\\nThe \\\"b\\\" in \\\"build\\\" is missing.\\r\\n\\r\\nDoes 6.9.9 have the same issue in your environment?\\r\\n\\r\\n------------------------\\r\\n\\r\\n### **[ EDIT : 9/21/2024 ]**\\r\\nThis my comment is not credible because the command log was not saved.\\r\\n9/20/2024: I tried to reproduce this problem. As a result, I failed to reproduce it.\\r\\nEnvironment: windows10 home, VMware Workstation 15 Player, ubuntu20.04.3 LTS, oniguruma 6.9.7\\r\\n\\r\\nFor these reasons, I have marked this my comment \\\"`off topic`\\\" .\\r\\n\\r\\nAt that time (December/2021), the workaround was to use \\\"`sudo apt-get install libonig5`\\\"\\r\\nand \\\"`./autogen.sh`\\\" as an alternative to \\\"`autoreconf -vfi`\\\".\\r\\nOniguruma failed to install with \\\"`./autogen.sh`\\\" alone.\\r\\nThe environment is the same as above. (Same computer)\"}, {\"author\": \"samtexkos\", \"body\": \"I had already tried installing from source, to the same conclusion as before. 6.9.9 does not have an issue for me, but unfortunately for me the tool I'm supposed to use needs python3.10 and a pyjq which uses onig-6.9.0.\\r\\n\\r\\nI suspect an issue with the python3.10 install. With Docker I could install an ubuntu 24.04 and install it with no issue, however on my machine I have an ubuntu 24.04 LTS with a graphical interface whereas the docker image is only CLI. This one already has [python3.12 installed](https://canonical.com/blog/canonical-releases-ubuntu-24-04-noble-numbat). I have noticed weird behavior with python.\\r\\n\\r\\nHere are the steps I used, which worked fine in the ubuntu 24.04 CLI, but not on my ubuntu 24.04 LTS:\\r\\n\\r\\n ```\\r\\n apt update     \\r\\n  apt install software-properties-common -y\\r\\n  add-apt-repository ppa:deadsnakes/ppa   \\r\\n  apt update\\r\\n  apt install python3.10 python3.10-venv python3.10-dev\\r\\n  update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.10 1 \\r\\n  apt install -y python3-pip\\r\\n  pip install pipenv\\r\\n  apt install flex bison libtool make automake autoconf\\r\\n\\r\\n```\\r\\nAfter that, I am able to install onig-6.9.0 in the docker image, not on my machine.\"}, {\"author\": \"kkos\", \"body\": \"I don't know why your following part of output occurs when you run configure from onig-6.9.0.tar.gz without using autoreconf.\\r\\n```\\r\\nconfigure: creating ./config.status\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/build_os='linux-gnu'\\r\\n```\\r\\nThat part in config.status is generated from heredocument in configure.\\r\\nHowever, there is no such line in the configure of the tarball that is being distributed.\\r\\n```\\r\\n$ cd onig-6.9.0\\r\\n$ grep \\\"/@\\\\[a-z\\\" configure\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/!b\\r\\n$ ./configure\\r\\n$ grep \\\"/@\\\\[a-z\\\" config.status\\r\\n/@[a-zA-Z_][a-zA-Z_0-9]*@/!b\\r\\n```\\r\\nI don't see how such a problem could occur unless autoconf is being invoked within the conifugre execution to regenerate the conifgure.\\r\\n\"}, {\"author\": \"samtexkos\", \"body\": \"I have a coworker who has the same issue, same system as me, same versions etc... Another coworker using a Fedora system doesn't have this issue.\\r\\n\\r\\nWe have \\\"fixed\\\" our problem by changing our packages requirement and replace the package that needs onig-6.9.0 by another package entirely.\\r\\n\\r\\nThis issue is not solved, but I will abandon it. I would be curious if anyone figures out the root cause and how to fix.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_309", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"309\", \"title\": \"Line anchor in Windows?\", \"author\": \"TakeCommand\", \"labels\": [], \"description\": \"Previously using Onigmo, there was an option to support CR/LF line endings with $. There does not seem to be an equivalent option in Oniguruma - is there a workaround for this?\", \"comments\": [{\"author\": \"kkos\", \"body\": \"For USE_CRNL_AS_LINE_TERMINATOR, the current implementation is halfway through, so it cannot be used.\\r\\nThere are no plans to complete the implementation, as it will not be enabled by default.\"}, {\"author\": \"vefatica\", \"body\": \"Are you saying that Oniguruma is not (will not be) intended for use in Windows?\"}, {\"author\": \"kkos\", \"body\": \"I don't understand why not supporting that option is made to be not intended for use with Windows.\\r\\nThat option doesn't work effectively unless you define USE_CRNL_AS_LINE_TERMINATOR and recompile the library.\"}, {\"author\": \"vefatica\", \"body\": \"Didn't you say the implementation of USE_CRNL_AS_LINE_TERMINATOR is halfway through and won't be completed?\\r\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_312", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"312\", \"title\": \"Build failure with GCC 15 (C23)\", \"author\": \"kostadinsh\", \"labels\": [], \"description\": \"Upcoming GCC 15 uses -std=gnu23 by default which makes oniguruma fail to build.\\r\\n\\r\\nThe issue can be reproduced on older GCC and Clang versions by adding -std=gnu23 (for GCC) and -std=c23 (for Clang) to CFLAGS.\\r\\n\\r\\n```\\r\\n/bin/sh ../libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I..  -Wall   -g -O2 -MT regparse.lo -MD -MP -MF .deps/regparse.Tpo -c -o regparse.lo regparse.c\\r\\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -Wall -g -O2 -MT regparse.lo -MD -MP -MF .deps/regparse.Tpo -c regparse.c  -fPIC -DPIC -o .libs/regparse.o\\r\\nregparse.c: In function 'names_clear':\\r\\nregparse.c:811:24: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n  811 |     onig_st_foreach(t, i_free_name_entry, 0);\\r\\n      |                        ^~~~~~~~~~~~~~~~~\\r\\n      |                        |\\r\\n      |                        int (*)(OnigUChar *, NameEntry *, void *) {aka int (*)(unsigned char *, NameEntry *, void *)}\\r\\nIn file included from regparse.c:37:\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(OnigUChar *, NameEntry *, void *)' {aka 'int (*)(unsigned char *, NameEntry *, void *)'}\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nregparse.c: In function 'onig_foreach_name':\\r\\nregparse.c:880:24: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n  880 |     onig_st_foreach(t, i_names, (HashDataType )&narg);\\r\\n      |                        ^~~~~~~\\r\\n      |                        |\\r\\n      |                        int (*)(OnigUChar *, NameEntry *, INamesArg *) {aka int (*)(unsigned char *, NameEntry *, INamesArg *)}\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(OnigUChar *, NameEntry *, INamesArg *)' {aka 'int (*)(unsigned char *, NameEntry *, INamesArg *)'}\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nregparse.c: In function 'onig_renumber_name_table':\\r\\nregparse.c:908:24: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n  908 |     onig_st_foreach(t, i_renumber_name, (HashDataType )map);\\r\\n      |                        ^~~~~~~~~~~~~~~\\r\\n      |                        |\\r\\n      |                        int (*)(OnigUChar *, NameEntry *, GroupNumMap *) {aka int (*)(unsigned char *, NameEntry *, GroupNumMap *)}\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(OnigUChar *, NameEntry *, GroupNumMap *)' {aka 'int (*)(unsigned char *, NameEntry *, GroupNumMap *)'}\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nregparse.c: In function 'callout_name_table_clear':\\r\\nregparse.c:1393:24: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n 1393 |     onig_st_foreach(t, i_free_callout_name_entry, 0);\\r\\n      |                        ^~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n      |                        |\\r\\n      |                        int (*)(st_callout_name_key *, CalloutNameEntry *, void *)\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(st_callout_name_key *, CalloutNameEntry *, void *)'\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nregparse.c: In function 'setup_ext_callout_list_values':\\r\\nregparse.c:1891:56: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n 1891 |     onig_st_foreach((CalloutTagTable *)ext->tag_table, i_callout_callout_list_set,\\r\\n      |                                                        ^~~~~~~~~~~~~~~~~~~~~~~~~~\\r\\n      |                                                        |\\r\\n      |                                                        int (*)(OnigUChar *, CalloutTagVal,  void *) {aka int (*)(unsigned char *, long int,  void *)}\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(OnigUChar *, CalloutTagVal,  void *)' {aka 'int (*)(unsigned char *, long int,  void *)'}\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nregparse.c: In function 'callout_tag_table_clear':\\r\\nregparse.c:1939:24: error: passing argument 2 of 'onig_st_foreach' from incompatible pointer type [-Wincompatible-pointer-types]\\r\\n 1939 |     onig_st_foreach(t, i_free_callout_tag_entry, 0);\\r\\n      |                        ^~~~~~~~~~~~~~~~~~~~~~~~\\r\\n      |                        |\\r\\n      |                        int (*)(OnigUChar *, CalloutTagVal,  void *) {aka int (*)(unsigned char *, long int,  void *)}\\r\\nst.h:55:31: note: expected 'int (*)(void)' but argument is of type 'int (*)(OnigUChar *, CalloutTagVal,  void *)' {aka 'int (*)(unsigned char *, long int,  void *)'}\\r\\n   55 | int st_foreach _((st_table *, int (*)(ANYARGS), st_data_t));\\r\\n      |                               ^~~~~~~~~~~~~~~~\\r\\nst.h:35:18: note: in definition of macro '_'\\r\\n   35 | # define _(args) args\\r\\n      |                  ^~~~\\r\\nmake[2]: *** [Makefile:593: regparse.lo] Error 1\\r\\nmake[2]: Leaving directory '/home/kostadin/oniguruma/src'\\r\\nmake[1]: *** [Makefile:428: all] Error 2\\r\\nmake[1]: Leaving directory '/home/kostadin/oniguruma/src'\\r\\nmake: *** [Makefile:500: all-recursive] Error 1\\r\\n```\\r\\n\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_314", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"314\", \"title\": \"Project Oniguruma-To-ES allows transpiling Oniguruma patterns to native JavaScript RegExp\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"Hi @kkos Just wanted to make you aware of this project: [Oniguruma-To-ES](https://github.com/slevithan/oniguruma-to-es). The goal of this library is to make it much easier to use Oniguruma patterns as native JavaScript (especially in browsers where bundle size is important), and it is currently used by the popular [Shiki](https://shiki.style/) project which uses TextMate grammars for syntax highlighting.\\r\\n\\r\\nOne thing that might be of interest is the [Supported features](https://github.com/slevithan/oniguruma-to-es#-supported-features) list I wrote that describes many of the finer details of Oniguruma syntax and behavior in comparison to JavaScript RegExp.\\r\\n\\r\\nAny feedback is of course welcome, but feel free to close this issue without comment!\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think it is very wonderful.\\r\\nThe unsupported features are reasonable.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_315", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"315\", \"title\": \"Print the table in 'SYNTAX.md'\", \"author\": \"tonco-miyazawa\", \"labels\": [], \"description\": \"@seanofw and all\\n\\nThis is a prototype.\\nhttps://github.com/tonco-miyazawa/onig_syn_md/blob/main/onig_syn_md.c\\n\\nThis will read the syntax options for the installed oniguruma.\\nIt is not designed to run on a server as it does not take processing efficiency into consideration.\\n\\nThe action can be changed between '[*** Settings ***](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L25-L45)'.\\n\\n#define NOW_MODE   (1)  ... (OP) mode\\n#define NOW_MODE   (2)  ... (OP2) mode\\n#define NOW_MODE   (3)  ... (BEHAVIOR) mode\\n\\nThe syntax and options must be registered before use. You can add [your own syntax](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L81-L95).\\n\\n[Line: 109](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L109) : Registering syntax types\\n\\n[Line: 159](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L159) : Registering options (op)\\n\\n[Line: 204](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L204) : Registering options (op2)\\n[\\nLine: 245](https://github.com/tonco-miyazawa/onig_syn_md/blob/6f0fe50e6951e64ceec7982a9c885815ec9999da/onig_syn_md.c#L245) : Registering options (behavior)\\n\\nI am thinking of adding this to the oniguruma 'test' folder, Someday.\\nPlease let me know if there are any problems. thank you.\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"@kkos (Owner)\\r\\n\\r\\nI updated the '`Set in`' and table in `SYNTAX.md`. Please apply this to Oniguruma.\\r\\n(I don't remember how to do a pull request.)\\r\\nhttps://github.com/tonco-miyazawa/onig_syn_md/blob/main/SYNTAX_6_9_10.md\\r\\n\\r\\nThe following five flags have been added:\\r\\n\\r\\n------------------\\r\\nGroup Two Flags (op2)\\r\\n------------------\\r\\n31\\\\. `ONIG_SYN_OP2_QMARK_CAPITAL_P_NAME`\\r\\n\\r\\n------------------\\r\\nSyntax Flags (syn)\\r\\n------------------\\r\\n12\\\\. `ONIG_SYN_PYTHON`\\r\\n13\\\\. `ONIG_SYN_WHOLE_OPTIONS`\\r\\n14\\\\. `ONIG_SYN_BRE_ANCHOR_AT_EDGE_OF_SUBEXP`\\r\\n27\\\\. `ONIG_SYN_ALLOW_CHAR_TYPE_FOLLOWED_BY_MINUS_IN_CC` (#298)\\r\\n\\r\\n(I don't understand English so I can't write explanations of the above flags.)\\r\\n\\r\\n-------------------\\r\\nSimilarly, you can add \\\"`onig_syn_md.c`\\\" to Oniguruma at any time without asking my permission. Thank you.\\r\\nhttps://github.com/tonco-miyazawa/onig_syn_md/blob/main/onig_syn_md.c\\r\\n( Please feel free to modify it. Anyone is welcome. )\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_316", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"316\", \"title\": \"New Oniguruma optimizer available\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"Hi @kkos! In addition to [`oniguruma-to-es`](https://github.com/slevithan/oniguruma-to-es) (mentioned in #314, and it's had many improvements since then), I built another tool in JavaScript for Oniguruma that you might be interested to be aware of. My new standalone [`oniguruma-parser`](https://github.com/slevithan/oniguruma-parser) library includes an Optimizer module that minifies Oniguruma regexes and can improve their performance.\\n\\n- [Optimizer readme](https://github.com/slevithan/oniguruma-parser/blob/main/src/optimizer/README.md).\\n- [Optimizer demo](https://slevithan.github.io/oniguruma-parser/demo/).\\n\\nExample:\\n\\n```\\n(?x) (?:\\\\!{1,}) (\\\\p{Nd}aa|\\\\p{Nd}ab|\\\\p{Nd}az) [[^0-9A-Fa-f]\\\\p{ Letter }] [\\\\p{L}\\\\p{M}\\\\p{N}\\\\p{Pc}]\\n```\\n\\nBecomes:\\n\\n```\\n!+(\\\\da[abz])[\\\\H\\\\p{L}]\\\\w\\n```\\n\\n...assuming flags `D`, `P`, `W` aren't enabled, or the result would be different.\\n\\nThe optimizer already includes a long list of transforms (listed in the [readme](https://github.com/slevithan/oniguruma-parser/blob/main/src/optimizer/README.md)), but many more are possible and [will be added](https://github.com/slevithan/oniguruma-parser/issues/7) in future versions.\\n\\nAny feedback is of course welcome, but feel free to close this issue without comment.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_317", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"317\", \"title\": \"AddressSanitizer: heap-buffer-overflow in onigenc_mbn_mbc_case_fold /oniguruma/src/regenc.c:829\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onigenc_mbn_mbc_case_fold which compiled with asan to handle a specific input, AddressSanitizer: heap-buffer-overflow in onigenc_mbn_mbc_case_fold /oniguruma/src/regenc.c:829\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regenc.c#L811-L830\\n\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mbn_mbc_case_fold/onigenc_mbn_mbc_case_fold.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mbn_mbc_case_fold/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mbn_mbc_case_fold/onigenc_mbn_mbc_case_fold) and run the following cmd:\\n```\\n $ ./onigenc_mbn_mbc_case_fold ./poc\\n```\\n\\n## Detail\\n### ASAN report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/big5.c/big5_mbc_case_fold/onigenc_mbn_mbc_case_fold/onigenc_mbn_mbc_case_fold output/default/crashes/id:000000,sig:06,src:000000,time:566,execs:156,op:havoc,rep:4\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n=================================================================\\n==2906435==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7c1ff6c20011 at pc 0x55555567abb0 bp 0x7fffffffd740 sp 0x7fffffffd738\\nREAD of size 1 at 0x7c1ff6c20011 thread T0\\n[Detaching after fork from child process 2906440]\\n    #0 0x55555567abaf in onigenc_mbn_mbc_case_fold /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:829:18\\n    #1 0x55555566bda0 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/big5.c/big5_mbc_case_fold/onigenc_mbn_mbc_case_fold.c:40:18\\n    #2 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n    #3 0x7ffff7a29e3f in __libc_start_main csu/../csu/libc-start.c:392:3\\n    #4 0x555555583404 in _start (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/big5.c/big5_mbc_case_fold/onigenc_mbn_mbc_case_fold/onigenc_mbn_mbc_case_fold+0x2f404) (BuildId: d0c2cafe9cd7f14e400339c5d02ae46dffc838cf)\\n\\n0x7c1ff6c20011 is located 0 bytes after 1-byte region [0x7c1ff6c20010,0x7c1ff6c20011)\\nallocated by thread T0 here:\\n    #0 0x5555556263f4 in malloc (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/big5.c/big5_mbc_case_fold/onigenc_mbn_mbc_case_fold/onigenc_mbn_mbc_case_fold+0xd23f4) (BuildId: d0c2cafe9cd7f14e400339c5d02ae46dffc838cf)\\n    #1 0x55555566bbc7 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/big5.c/big5_mbc_case_fold/onigenc_mbn_mbc_case_fold.c:24:33\\n    #2 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:829:18 in onigenc_mbn_mbc_case_fold\\nShadow bytes around the buggy address:\\n  0x7c1ff6c1fd80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c1ff6c1fe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c1ff6c1fe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c1ff6c1ff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c1ff6c1ff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n=>0x7c1ff6c20000: fa fa[01]fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c1ff6c20080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c1ff6c20100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c1ff6c20180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c1ff6c20200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c1ff6c20280: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==2906435==ABORTING\\n[Inferior 1 (process 2906435) exited with code 01]\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"As already noted in #129, it does not check for invalid byte sequences as character encoding.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_318", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"318\", \"title\": \"Program received signal SIGILL, Illegal instruction. in onigenc_mb2_is_code_ctype  at  /oniguruma/src/regenc.c:925\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the big5_is_code_ctype function to handle a specific input, Program received signal SIGILL, Illegal instruction. in onigenc_mb2_is_code_ctype  at  /oniguruma/src/regenc.c:925\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/big5.c#L119-L122\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regenc.c#L920-L925\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb2_is_code_ctype/big5_is_code_ctype.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb2_is_code_ctype/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb2_is_code_ctype/big5_is_code_ctype) and run the following cmd:\\n```\\n $ ./big5_is_code_ctype ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/big5.c/generate/big5_is_code_ctype/big5_is_code_ctype output/default/crashes/id:000000,sig:04,src:000000,time:1010,execs:247,op:havoc,rep:5\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555567cedc in onigenc_mb2_is_code_ctype (enc=0x5555556c1be0 <OnigEncodingBIG5>, code=71, ctype=5175) at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:925\\n925         return ONIGENC_IS_ASCII_CODE_CTYPE(code, ctype);\\n(gdb) bt\\n#0  0x000055555567cedc in onigenc_mb2_is_code_ctype (enc=0x5555556c1be0 <OnigEncodingBIG5>, code=71, ctype=5175)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:925\\n#1  0x000055555566a2b8 in big5_is_code_ctype (code=71, ctype=5175)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/big5.c:122\\n#2  0x000055555566bc63 in main (argc=2, argv=0x7fffffffdac8)\\n    at output/oniguruma_deepseek24/harness/code/big5.c/generate/big5_is_code_ctype.c:33\\n(gdb) p code\\n$1 = 71\\n(gdb) p ctype\\n$2 = 5175\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_319", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"319\", \"title\": \"Program received signal SIGSEGV, Segmentation fault. in big5_left_adjust_char_head at /oniguruma/src/big5.c:156\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the big5_left_adjust_char_head function to handle a specific input, Program received signal SIGSEGV, Segmentation fault. in big5_left_adjust_char_head at /oniguruma/src/big5.c:156\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/big5.c#L147-L156\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/big5_left_adjust_char_head/big5_left_adjust_char_head.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/big5_left_adjust_char_head/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/big5_left_adjust_char_head/big5_left_adjust_char_head) and run the following cmd:\\n```\\n $ ./big5_left_adjust_char_head ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/big5.c/generate/big5_left_adjust_char_head/big5_left_adjust_char_head output/default/crashes/id:000000,sig:11,src:000004,time:64466,execs:13449,op:havoc,rep:1\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x000055555566a3d5 in big5_left_adjust_char_head (start=0xd <error: Cannot access memory at address 0xd>, s=0x4d <error: Cannot access memory at address 0x4d>) at /home/ambrose/vsproject/TestLib/oniguruma/src/big5.c:156\\n156       if (BIG5_ISMB_TRAIL(*p)) {\\n(gdb) bt\\n#0  0x000055555566a3d5 in big5_left_adjust_char_head (start=0xd <error: Cannot access memory at address 0xd>, \\n    s=0x4d <error: Cannot access memory at address 0x4d>) at /home/ambrose/vsproject/TestLib/oniguruma/src/big5.c:156\\n#1  0x000055555566bc6f in main (argc=2, argv=0x7fffffffda98)\\n    at output/oniguruma_deepseek24/harness/code/big5.c/generate/big5_left_adjust_char_head.c:31\\n(gdb) p *p\\nCannot access memory at address 0x4d\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The mistake is passing an incorrect address as a string.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_320", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"320\", \"title\": \"Program received signal SIGSEGV, Segmentation fault in left_adjust_char_head at /oniguruma/src/euc_jp.c:190\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the left_adjust_char_head function to handle a specific input, Program received signal SIGSEGV, Segmentation fault in left_adjust_char_head at /oniguruma/src/euc_jp.c:190\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/euc_jp.c#L178-L190\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/left_adjust_char_head/left_adjust_char_head.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/left_adjust_char_head/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/left_adjust_char_head/left_adjust_char_head) and run the following cmd:\\n```\\n $ ./ ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/euc_jp.c/generate/left_adjust_char_head/left_adjust_char_head output/default/crashes/id:000000,sig:11,src:000004,time:7499,execs:2051,op:quick,pos:3\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x000055555566c892 in left_adjust_char_head (start=0x7 <error: Cannot access memory at address 0x7>, s=0xc7 <error: Cannot access memory at address 0xc7>) at /home/ambrose/vsproject/TestLib/oniguruma/src/euc_jp.c:190\\n190       while (!eucjp_islead(*p) && p > start) p--;\\n(gdb) bt\\n#0  0x000055555566c892 in left_adjust_char_head (start=0x7 <error: Cannot access memory at address 0x7>, \\n    s=0xc7 <error: Cannot access memory at address 0xc7>)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/euc_jp.c:190\\n#1  0x000055555566e4ff in main (argc=2, argv=0x7fffffffdaa8)\\n    at output/oniguruma_deepseek24/harness/code/euc_jp.c/generate/left_adjust_char_head.c:31\\n(gdb) p p\\n$1 = (const OnigUChar *) 0xc7 <error: Cannot access memory at address 0xc7>\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The mistake is passing an incorrect address as a string.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_321", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"321\", \"title\": \"Program received signal SIGILL, Illegal instruction. in onigenc_mb4_is_code_ctype at /oniguruma/src/regenc.c:940\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onigenc_mb4_is_code_ctype function to handle a specific input, Program received signal SIGILL, Illegal instruction. in onigenc_mb4_is_code_ctype at /oniguruma/src/regenc.c:940\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regenc.c#L935-L940\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb4_is_code_ctype/euctw_is_code_ctype.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb4_is_code_ctype/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_mb4_is_code_ctype/euctw_is_code_ctype) and run the following cmd:\\n```\\n $ ./euctw_is_code_ctype ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/euc_tw.c/generate/euctw_is_code_ctype/euctw_is_code_ctype output/default/crashes/id:000000,sig:04,src:000000,time:512,execs:202,op:havoc,rep:1\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555567d91c in onigenc_mb4_is_code_ctype (enc=0x5555556c1be0 <OnigEncodingEUC_TW>, code=77, ctype=77) at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:940\\n940         return ONIGENC_IS_ASCII_CODE_CTYPE(code, ctype);\\n(gdb) p code \\n$1 = 77\\n(gdb) p ctype\\n$2 = 77\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_322", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"322\", \"title\": \"Program received signal SIGSEGV, Segmentation fault. in euctw_left_adjust_char_head at /oniguruma/src/euc_tw.c:157\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the  function to handle a specific input, Program received signal SIGSEGV, Segmentation fault. in euctw_left_adjust_char_head at /oniguruma/src/euc_tw.c:157\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/euc_tw.c#L145-L157\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/euctw_left_adjust_char_head/euctw_left_adjust_char_head.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/euctw_left_adjust_char_head/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/euctw_left_adjust_char_head/euctw_left_adjust_char_head) and run the following cmd:\\n```\\n $ ./euctw_left_adjust_char_head ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/euc_tw.c/generate/euctw_left_adjust_char_head/euctw_left_adjust_char_head output/default/crashes/id:000000,sig:11,src:000005,time:623,execs:263,op:havoc,rep:4\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x000055555566a652 in euctw_left_adjust_char_head (start=0xb <error: Cannot access memory at address 0xb>, s=0xd <error: Cannot access memory at address 0xd>) at /home/ambrose/vsproject/TestLib/oniguruma/src/euc_tw.c:157\\n157       while (!euctw_islead(*p) && p > start) p--;\\n(gdb) bt\\n#0  0x000055555566a652 in euctw_left_adjust_char_head (start=0xb <error: Cannot access memory at address 0xb>, \\n    s=0xd <error: Cannot access memory at address 0xd>) at /home/ambrose/vsproject/TestLib/oniguruma/src/euc_tw.c:157\\n#1  0x000055555566c10f in main (argc=2, argv=0x7fffffffda88)\\n    at output/oniguruma_deepseek24/harness/code/euc_tw.c/generate/euctw_left_adjust_char_head.c:31\\n(gdb) p p\\n$1 = (const OnigUChar *) 0xd <error: Cannot access memory at address 0xd>\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The mistake is passing an incorrect address as a string.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_323", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"323\", \"title\": \"Program received signal SIGILL, Illegal instruction. in is_code_ctype at /oniguruma/src/iso8859_1.c:249\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the is_code_ctype function to handle a specific input, Program received signal SIGILL, Illegal instruction. in is_code_ctype at /oniguruma/src/iso8859_1(1-16).c:249\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/iso8859_1.c#L245-L249\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_code_ctype/is_code_ctype.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_code_ctype/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_code_ctype/is_code_ctype) and run the following cmd:\\n```\\n $ ./is_code_ctype ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/iso8859_1.c/generate/is_code_ctype/is_code_ctype output/default/crashes/id:000000,sig:04,src:000000,time:854,execs:224,op:havoc,rep:4\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x00005555556705d4 in is_code_ctype (code=25, ctype=156) at /home/ambrose/vsproject/TestLib/oniguruma/src/iso8859_1.c:249\\n249         return ENC_IS_ISO_8859_1_CTYPE(code, ctype);\\n(gdb) bt\\n#0  0x00005555556705d4 in is_code_ctype (code=25, ctype=156)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/iso8859_1.c:249\\n#1  0x0000555555670c63 in main (argc=2, argv=0x7fffffffdac8)\\n    at output/oniguruma_deepseek24/harness/code/iso8859_1.c/generate/is_code_ctype.c:35\\n(gdb) p code\\n$1 = 25\\n(gdb) p ctype\\n$2 = 156\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_324", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"324\", \"title\": \"Program received signal SIGSEGV, Segmentation fault in onigenc_ascii_apply_all_case_fold at /oniguruma/src/regenc.c:519\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onigenc_ascii_apply_all_case_fold  function to handle a specific input, Program received signal SIGSEGV, Segmentation fault in onigenc_ascii_apply_all_case_fold at /oniguruma/src/regenc.c:519\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regenc.c#L508-L519\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_ascii_apply_all_case_fold/apply_all_case_fold.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_ascii_apply_all_case_fold/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_ascii_apply_all_case_fold/apply_all_case_fold) and run the following cmd:\\n```\\n $ ./apply_all_case_fold ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/iso8859_2.c/generate/apply_all_case_fold/apply_all_case_fold output/default/crashes/id:000000,sig:11,src:000001,time:1237,execs:243,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x000055555567053d in onigenc_ascii_apply_all_case_fold (flag=1073741824, f=0x0, arg=0x0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:519\\n519         r = (*f)(OnigAsciiLowerMap[i].from, &code, 1, arg);\\n(gdb) bt\\n#0  0x000055555567053d in onigenc_ascii_apply_all_case_fold (flag=1073741824, f=0x0, arg=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:519\\n#1  0x0000555555671b5e in onigenc_apply_all_case_fold_with_map (map_size=0, map=0x0, ess_tsett_flag=0, \\n    flag=1073741824, f=0x0, arg=0x0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:569\\n#2  0x000055555566afad in main (argc=2, argv=0x7fffffffdaa8)\\n    at output/oniguruma_deepseek24/harness/code/iso8859_2.c/generate/apply_all_case_fold.c:39\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Passing on an incorrect address is a mistake.\\nIt references regenc.h, but does not disclose anything other than oniguruma.h.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_325", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"325\", \"title\": \"Program received signal SIGILL, Illegal instruction. in onigenc_get_case_fold_codes_by_str_with_map at /oniguruma/src/regenc.c:673\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onigenc_get_case_fold_codes_by_str_with_map  function to handle a specific input, Program received signal SIGILL, Illegal instruction. in onigenc_get_case_fold_codes_by_str_with_map at /oniguruma/src/regenc.c:673\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regenc.c#L591-L673\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_get_case_fold_codes_by_str_with_map/get_case_fold_codes_by_str.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_get_case_fold_codes_by_str_with_map/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_get_case_fold_codes_by_str_with_map/get_case_fold_codes_by_str) and run the following cmd:\\n```\\n $ ./get_case_fold_codes_by_str ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/iso8859_13.c/generate/get_case_fold_codes_by_str/get_case_fold_codes_by_str output/default/crashes/id:000000,sig:04,src:000002,time:49,execs:34,op:havoc,rep:1\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x00005555556769f4 in onigenc_get_case_fold_codes_by_str_with_map (map_size=256, map=0x0, ess_tsett_flag=0, flag=1073741824, p=0x7c1ff6c20010 \\\"\\\", end=0x7c1ff6c20010 \\\"\\\", items=0x7bfff5b09020) at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:673\\n673           if (*p == map[i].from) {\\n(gdb) bt\\n#0  0x00005555556769f4 in onigenc_get_case_fold_codes_by_str_with_map (map_size=256, map=0x0, ess_tsett_flag=0, \\n    flag=1073741824, p=0x7c1ff6c20010 \\\"\\\", end=0x7c1ff6c20010 \\\"\\\", items=0x7bfff5b09020)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:673\\n#1  0x000055555566a419 in main (argc=2, argv=0x7fffffffda88)\\n    at output/oniguruma_deepseek24/harness/code/iso8859_13.c/generate/get_case_fold_codes_by_str.c:49\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Passing on an incorrect address is a mistake.\\nIt references regenc.h, but does not disclose anything other than oniguruma.h.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_326", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"326\", \"title\": \"Program received signal SIGILL, Illegal instruction. in koi8_r_is_code_ctype at /oniguruma/src/koi8_r.c:125\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the koi8_r_is_code_ctype function to handle a specific input, Program received signal SIGILL, Illegal instruction. in koi8_r_is_code_ctype at /oniguruma/src/koi8_r.c:125\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/koi8_r.c#L121-L125\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_r_is_code_ctype/koi8_r_is_code_ctype.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_r_is_code_ctype/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_r_is_code_ctype/koi8_r_is_code_ctype) and run the following cmd:\\n```\\n $ ./koi8_r_is_code_ctype ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/koi8_r.c/generate/koi8_r_is_code_ctype/koi8_r_is_code_ctype output/default/crashes/id:000000,sig:04,src:000000,time:892,execs:246,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555566a394 in koi8_r_is_code_ctype (code=2, ctype=143) at /home/ambrose/vsproject/TestLib/oniguruma/src/koi8_r.c:125\\n125         return ENC_IS_KOI8_R_CTYPE(code, ctype);\\n(gdb) bt\\n#0  0x000055555566a394 in koi8_r_is_code_ctype (code=2, ctype=143)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/koi8_r.c:125\\n#1  0x000055555566aa23 in main (argc=2, argv=0x7fffffffdab8)\\n    at output/oniguruma_deepseek24/harness/code/koi8_r.c/generate/koi8_r_is_code_ctype.c:31\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_327", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"327\", \"title\": \"Program received signal SIGILL, Illegal instruction. in koi8_is_code_ctype at /oniguruma/src/koi8.c:126\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the koi8_is_code_ctype function to handle a specific input, Program received signal SIGILL, Illegal instruction. in koi8_is_code_ctype at /oniguruma/src/koi8.c:126\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/koi8.c#L122-L126\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_is_code_ctype/koi8_is_code_ctype.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_is_code_ctype/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/koi8_is_code_ctype/koi8_is_code_ctype) and run the following cmd:\\n```\\n $ ./koi8_is_code_ctype ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/koi8.c/generate/koi8_is_code_ctype/koi8_is_code_ctype output/default/crashes/id:000000,sig:04,src:000000,time:786,execs:222,op:havoc,rep:1\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555566a394 in koi8_is_code_ctype (code=5, ctype=55) at /home/ambrose/vsproject/TestLib/oniguruma/src/koi8.c:126\\n126         return ENC_IS_KOI8_CTYPE(code, ctype);\\n(gdb) bt\\n#0  0x000055555566a394 in koi8_is_code_ctype (code=5, ctype=55)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/koi8.c:126\\n#1  0x000055555566aa23 in main (argc=2, argv=0x7fffffffdac8)\\n    at output/oniguruma_deepseek24/harness/code/koi8.c/generate/koi8_is_code_ctype.c:33\\n```\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_328", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"328\", \"title\": \"Program received signal SIGILL, Illegal instruction. in map_position_value at /oniguruma/src/regcomp.c:6015\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the map_position_value  function to handle a specific input, Program received signal SIGILL, Illegal instruction. in map_position_value at /oniguruma/src/regcomp.c:6015\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L5997-L6015\\n\\nThe value pointed to by Vals[i] is out of the int range, causing the Illegal instruction to exit\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/map_position_value/map_position_value.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/map_position_value/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/map_position_value/map_position_value) and run the following cmd:\\n```\\n $ ./map_position_value ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/alt_merge_opt_map/map_position_value/map_position_value output/default/crashes/id:000000,sig:04,src:000001,time:2401,execs:1154,op:havoc,rep:1\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x00005555556913c5 in map_position_value (enc=0x7ffff7f9c500 <OnigEncodingUTF8>, i=-525) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:6015\\n6015          return (int )Vals[i];\\n(gdb) bt\\n#0  0x00005555556913c5 in map_position_value (enc=0x7ffff7f9c500 <OnigEncodingUTF8>, i=-525)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:6015\\n#1  0x0000555555691112 in main (argc=2, argv=0x7fffffffda98)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/alt_merge_opt_map/map_position_value.c:34\\n(gdb) p Vals\\n$1 = {5, 1, 1, 1, 1, 1, 1, 1, 1, 10, 10, 1, 1, 10, 1 <repeats 18 times>, 12, 4, 7, 4, 4, 4, 4, 4, 4, 5, 5, 5, \\n  5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 7, 6 <repeats 21 times>, 5, 6, 5, \\n  5, 5, 5, 6, 6, 6, 6, 7, 6 <repeats 21 times>, 5, 5, 5, 5, 1}\\n(gdb) p Vals[i]\\n$2 = 26990\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"This is too strange.\\nI can only think that it is done with malicious intent.\\nThere is no way that regcomp.c is publicly available, and there is no way that map_position_value() could be mistaken for a public API.\\nFor now, I'll just block you, but I may well report you to GitHub.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_329", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"329\", \"title\": \"Program received signal SIGILL, Illegal instruction. in node_reduce_in_look_behind  at /oniguruma/src/regcomp.c:4539\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the node_reduce_in_look_behind  function to handle a specific input, Program received signal SIGILL, Illegal instruction. in node_reduce_in_look_behind  at /oniguruma/src/regcomp.c:4539\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L4551-L4558\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L4530-L4539\\n\\nThe primary cause is body points to an inaccessible address, leading to a Illegal instruction.\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_reduce_in_look_behind/list_reduce_in_look_behind.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_reduce_in_look_behind/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_reduce_in_look_behind/list_reduce_in_look_behind) and run the following cmd:\\n```\\n $ ./list_reduce_in_look_behind ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/alt_reduce_in_look_behind/list_reduce_in_look_behind/list_reduce_in_look_behind output/default/crashes/id:000000,sig:04,src:000000,time:17496,execs:8548,op:havoc,rep:8\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555576cbe1 in node_reduce_in_look_behind (node=0x7bfff5a09020) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:4539\\n4539      type = ND_TYPE(body);\\n(gdb) bt\\n#0  0x000055555576cbe1 in node_reduce_in_look_behind (node=0x7bfff5a09020)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:4539\\n#1  0x00005555556913d7 in list_reduce_in_look_behind (node=0x7bfff5a09020)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:4558\\n#2  0x000055555569111f in main (argc=2, argv=0x7fffffffda58)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/alt_reduce_in_look_behind/list_reduce_in_look_behind.c:33\\n(gdb) p body\\n$1 = (Node *) 0xff00000600000005\\n```\\n\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Same as #328..\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_330", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"330\", \"title\": \"Program received signal SIGILL, Illegal instruction. in comp_distance_value  at /oniguruma/src/regcomp.c:6057\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the comp_distance_value   function to handle a specific input, Program received signal SIGILL, Illegal instruction. in comp_distance_value  at /oniguruma/src/regcomp.c:6057\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L6050-L6057\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/comp_distance_value/comp_distance_value.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/comp_distance_value/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/comp_distance_value/comp_distance_value) and run the following cmd:\\n```\\n $ ./comp_distance_value ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/comp_opt_exact_or_map/comp_distance_value/comp_distance_value output/default/crashes/id:000000,sig:04,src:000000,time:2786,execs:1326,op:havoc,rep:5\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x00005555556913b4 in comp_distance_value (d1=0x7bfff5909020, d2=0x7bfff5909040, v1=7, v2=155555555) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:6057\\n6057      v2 *= distance_value(d2);\\n(gdb) bt\\n#0  0x00005555556913b4 in comp_distance_value (d1=0x7bfff5909020, d2=0x7bfff5909040, v1=7, v2=155555555)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:6057\\n#1  0x0000555555691192 in main (argc=2, argv=0x7fffffffda88)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/comp_opt_exact_or_map/comp_distance_value.c:38\\n(gdb) p d2\\n$1 = (MinMaxLen *) 0x7bfff5909040\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Same as #328.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_331", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"331\", \"title\": \"Program received signal SIGILL, Illegal instruction. in compile_call at /oniguruma/src/regcomp.c:1022\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the compile_tree function to handle a specific input, Program received signal SIGILL, Illegal instruction. in compile_call at /oniguruma/src/regcomp.c:1022\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L1006-L1022\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/poc1) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree) and run the following cmd:\\n```\\n $ ./compile_tree ./poc1\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_anchor_node/compile_tree/compile_tree output/default/crashes/id:000002,sig:04,src:000000,time:1641,execs:626,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x00005555557311b0 in compile_call (node=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1022\\n1022      r = unset_addr_list_add(env->unset_addr_list, offset, ND_CALL_BODY(node));\\n(gdb) bt\\n#0  0x00005555557311b0 in compile_call (node=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1022\\n#1  0x00005555556809c6 in compile_tree (node=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2723\\n#2  0x00005555556912e9 in main (argc=2, argv=0x7fffffffdab8)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_anchor_node/compile_tree.c:49\\n(gdb) p env->unset_addr_list\\nCannot access memory at address 0x100\\n(gdb) p offset\\n$1 = 32\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Same as #328.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_332", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"332\", \"title\": \"Program received signal SIGILL, Illegal instruction. in compile_length_tree  at  /oniguruma/src/regcomp.c:2484\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the compile_tree function to handle a specific input, Program received signal SIGILL, Illegal instruction. in compile_length_tree  at  /oniguruma/src/regcomp.c:2484\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L2728\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L1404\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L2479-L2484\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/poc2) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree) and run the following cmd:\\n```\\n $ ./compile_tree ./poc2\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_anchor_node/compile_tree/compile_tree output/default/crashes/id:000003,sig:04,src:000000,time:3366,execs:1265,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555572c013 in compile_length_tree (node=0x0, reg=0x7d4ff6c20300, env=0x0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2484\\n2484      switch (ND_TYPE(node)) {\\n(gdb) bt\\n#0  0x000055555572c013 in compile_length_tree (node=0x0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2484\\n#1  0x00005555557316b4 in compile_quantifier_node (qn=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1404\\n#2  0x0000555555680abe in compile_tree (node=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2728\\n#3  0x00005555556912e9 in main (argc=2, argv=0x7fffffffdab8)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_anchor_node/compile_tree.c:49\\n(gdb) p node\\n$1 = (Node *) 0x0\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Same as #328.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_333", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"333\", \"title\": \"Program received signal SIGILL, Illegal instruction. in compile_tree at /oniguruma/src/regcomp.c:2562\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the compile_tree  function to handle a specific input, Program received signal SIGILL, Illegal instruction. in compile_tree at /oniguruma/src/regcomp.c:2562\\n\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L2557-L2565\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/poc3) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_call/compile_tree) and run the following cmd:\\n```\\n $ ./compile_tree ./poc3\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_anchor_node/compile_tree/compile_tree output/default/crashes/id:000004,sig:04,src:000006,time:4988,execs:1868,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555567a14a in compile_tree (node=0x0, reg=0x7d4ff6c20300, env=0x0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2562\\n2562      switch (ND_TYPE(node)) {\\n(gdb) bt\\n#0  0x000055555567a14a in compile_tree (node=0x0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2562\\n#1  0x000055555567a439 in compile_tree (node=0x7bfff5b090e0, reg=0x7d4ff6c20300, env=0x0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2565\\n#2  0x00005555556912e9 in main (argc=2, argv=0x7fffffffdab8)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_anchor_node/compile_tree.c:49\\n(gdb) p node\\n$1 = (Node *) 0x0\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Same as #328.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_334", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"334\", \"title\": \"AddressSanitizer: stack-buffer-overflow in bitset_is_empty /oniguruma/src/regcomp.c:472\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the bitset_is_empty  function to handle a specific input, AddressSanitizer: stack-buffer-overflow in bitset_is_empty /oniguruma/src/regcomp.c:472\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/bitset_is_empty/bitset_is_empty.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/bitset_is_empty/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/bitset_is_empty/bitset_is_empty) and run the following cmd:\\n```\\n $ ./bitset_is_empty ./poc\\n```\\n\\n## Detail\\n### ASAN report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_cclass_node/bitset_is_empty/bitset_is_empty output/default/crashes/id:000000,sig:06,src:000000,time:587,execs:283,op:havoc,rep:15\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n=================================================================\\n==2386084==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7bfff5809028 at pc 0x555555691542 bp 0x7fffffffd870 sp 0x7fffffffd868\\nREAD of size 4 at 0x7bfff5809028 thread T0\\n[Detaching after fork from child process 2388611]\\n    #0 0x555555691541 in bitset_is_empty /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:472:9\\n    #1 0x555555691261 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/regcomp.c/compile_cclass_node/bitset_is_empty.c:31:18\\n    #2 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n    #3 0x7ffff7a29e3f in __libc_start_main csu/../csu/libc-start.c:392:3\\n    #4 0x555555585434 in _start (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_cclass_node/bitset_is_empty/bitset_is_empty+0x31434) (BuildId: b6a42749754a97482de7c2d725313d1c60e1f958)\\n\\nAddress 0x7bfff5809028 is located in stack of thread T0 at offset 40 in frame\\n    #0 0x555555690b37 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/regcomp.c/compile_cclass_node/bitset_is_empty.c:6\\n\\n  This frame has 1 object(s):\\n    [32, 40) 'bs' (line 20) <== Memory access at offset 40 overflows this variable\\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork\\n      (longjmp and C++ exceptions *are* supported)\\nSUMMARY: AddressSanitizer: stack-buffer-overflow /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:472:9 in bitset_is_empty\\nShadow bytes around the buggy address:\\n  0x7bfff5808d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5808e00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5808e80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5808f00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5808f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n=>0x7bfff5809000: f1 f1 f1 f1 00[f3]f3 f3 00 00 00 00 00 00 00 00\\n  0x7bfff5809080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5809100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5809180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5809200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7bfff5809280: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==2386084==ABORTING\\n[Inferior 1 (process 2386084) exited with code 01]\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The type of bs definition is wrong.\\nAnd bitset_is_empty() is, of course, not publicly available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_335", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"335\", \"title\": \"Program received signal SIGILL, Illegal instruction. in onig_positive_int_multiply  at /oniguruma/src/regcomp.c:350\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onig_positive_int_multiply   function to handle a specific input, Program received signal SIGILL, Illegal instruction. in onig_positive_int_multiply  at /oniguruma/src/regcomp.c:350\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L344-L350\\n\\ninteger overflow\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_positive_int_multiply/onig_positive_int_multiply.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_positive_int_multiply/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_positive_int_multiply/onig_positive_int_multiply) and run the following cmd:\\n```\\n $ ./onig_positive_int_multiply ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_length_bag_node/onig_positive_int_multiply/onig_positive_int_multiply output/default/crashes/id:000000,sig:04,src:000003,time:2815,execs:1323,op:havoc,rep:4\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555566bc1d in onig_positive_int_multiply (x=-1821689639, y=5) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:350\\n350         return x * y;\\n(gdb) bt\\n#0  0x000055555566bc1d in onig_positive_int_multiply (x=-1821689639, y=5)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:350\\n#1  0x0000555555691113 in main (argc=2, argv=0x7fffffffda68)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_length_bag_node/onig_positive_int_multiply.c:31\\n(gdb) p x\\n$1 = -1821689639\\n(gdb) p y\\n$2 = 5\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"onig_positive_int_multiply() is not publicly available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_336", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"336\", \"title\": \"Program received signal SIGILL, Illegal instruction. in compile_length_tree at /oniguruma/src/regcomp.c:2484\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the compile_length_tree  function to handle a specific input, Program received signal SIGILL, Illegal instruction. in compile_length_tree at /oniguruma/src/regcomp.c:2484\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L1324-L1330\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L2479-L2534\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_length_tree/compile_length_tree.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_length_tree/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/compile_length_tree/compile_length_tree) and run the following cmd:\\n```\\n $ ./compile_length_tree ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_length_option_node/compile_length_tree/compile_length_tree output/default/crashes/id:000000,sig:04,src:000002,time:82,execs:59,op:havoc,rep:2\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x0000555555691333 in compile_length_tree (node=0x0, reg=0x7bfff5c09090, env=0x7bfff5c092a0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2484\\n2484      switch (ND_TYPE(node)) {\\n(gdb) bt\\n#0  0x0000555555691333 in compile_length_tree (node=0x0, reg=0x7bfff5c09090, env=0x7bfff5c092a0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2484\\n#1  0x00005555557639c8 in compile_length_quantifier_node (qn=0x7bfff5c09020, reg=0x7bfff5c09090, \\n    env=0x7bfff5c092a0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1330\\n#2  0x00005555556923ef in compile_length_tree (node=0x7bfff5c09020, reg=0x7bfff5c09090, env=0x7bfff5c092a0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:2534\\n#3  0x0000555555691144 in main (argc=2, argv=0x7fffffffda78)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_length_option_node/compile_length_tree.c:34\\n(gdb) p node\\n$1 = (Node *) 0x0\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"compile_length_tree() is not publicly available.\\n\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_337", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"337\", \"title\": \"Program received signal SIGILL, Illegal instruction. in is_anychar_infinite_greedy  at /oniguruma/src/regcomp.c:1315\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the is_anychar_infinite_greedy   function to handle a specific input, Program received signal SIGILL, Illegal instruction. in is_anychar_infinite_greedy  at /oniguruma/src/regcomp.c:1315\\n\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_anychar_infinite_greedy/is_anychar_infinite_greedy.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_anychar_infinite_greedy/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/is_anychar_infinite_greedy/is_anychar_infinite_greedy) and run the following cmd:\\n```\\n $ ./is_anychar_infinite_greedy ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_length_quantifier_node/is_anychar_infinite_greedy/is_anychar_infinite_greedy output/default/crashes/id:000000,sig:11,src:000000,time:603,execs:298,op:havoc,rep:4\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x000055555569157c in is_anychar_infinite_greedy (qn=0x7bfff5909020) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1315\\n1315          ND_IS_ANYCHAR(ND_QUANT_BODY(qn)))\\n(gdb) bt\\n#0  0x000055555569157c in is_anychar_infinite_greedy (qn=0x7bfff5909020)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1315\\n#1  0x0000555555691139 in main (argc=2, argv=0x7fffffffda48)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/compile_length_quantifier_node/is_anychar_infinite_greedy.c:36\\n(gdb) p qn\\n$1 = (QuantNode *) 0x7bfff5909020\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"is_anychar_infinite_greedy() is not publicity available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_338", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"338\", \"title\": \"AddressSanitizer: heap-buffer-overflow in entry_repeat_range /oniguruma/src/regcomp.c:1278\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the entry_repeat_range  function to handle a specific input. AddressSanitizer: heap-buffer-overflow in entry_repeat_range /oniguruma/src/regcomp.c:1278\\n\\nhttps://github.com/kkos/oniguruma/blob/05bb130c9ad54877e73d1caf08dd95e6ff199d99/src/regcomp.c#L1253-L1278\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/entry_repeat_range/entry_repeat_range.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/entry_repeat_range/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/entry_repeat_range/entry_repeat_range) and run the following cmd:\\n```\\n $ ./entry_repeat_range ./poc\\n```\\n\\n## Detail\\n### ASAN report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_range_repeat_node/entry_repeat_range/entry_repeat_range output/default/crashes/id:000000,sig:06,src:000001,time:86,execs:45,op:flip1,pos:0\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n=================================================================\\n==128128==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7c5ff6c200a0 at pc 0x555555692250 bp 0x7fffffffd6e0 sp 0x7fffffffd6d8\\nWRITE of size 4 at 0x7c5ff6c200a0 thread T0\\n[Detaching after fork from child process 131095]\\n    #0 0x55555569224f in entry_repeat_range /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1278:18\\n    #1 0x5555556912f2 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/regcomp.c/compile_range_repeat_node/entry_repeat_range.c:36:18\\n    #2 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n    #3 0x7ffff7a29e3f in __libc_start_main csu/../csu/libc-start.c:392:3\\n    #4 0x555555585434 in _start (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_range_repeat_node/entry_repeat_range/entry_repeat_range+0x31434) (BuildId: 794289a25b2c221f318f20da45d2888d64d63ef3)\\n\\n0x7c5ff6c200a0 is located 64 bytes after 64-byte region [0x7c5ff6c20020,0x7c5ff6c20060)\\nallocated by thread T0 here:\\n    #0 0x555555628424 in malloc (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_range_repeat_node/entry_repeat_range/entry_repeat_range+0xd4424) (BuildId: 794289a25b2c221f318f20da45d2888d64d63ef3)\\n    #1 0x5555556916ee in entry_repeat_range /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1261:24\\n    #2 0x5555556912f2 in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/regcomp.c/compile_range_repeat_node/entry_repeat_range.c:36:18\\n    #3 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n\\nSUMMARY: AddressSanitizer: heap-buffer-overflow /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1278:18 in entry_repeat_range\\nShadow bytes around the buggy address:\\n  0x7c5ff6c1fe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c5ff6c1fe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c5ff6c1ff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c5ff6c1ff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\\n  0x7c5ff6c20000: fa fa fa fa 00 00 00 00 00 00 00 00 fa fa fa fa\\n=>0x7c5ff6c20080: fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c5ff6c20100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c5ff6c20180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c5ff6c20200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c5ff6c20280: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\n  0x7c5ff6c20300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\\nShadow byte legend (one shadow byte represents 8 application bytes):\\n  Addressable:           00\\n  Partially addressable: 01 02 03 04 05 06 07 \\n  Heap left redzone:       fa\\n  Freed heap region:       fd\\n  Stack left redzone:      f1\\n  Stack mid redzone:       f2\\n  Stack right redzone:     f3\\n  Stack after return:      f5\\n  Stack use after scope:   f8\\n  Global redzone:          f9\\n  Global init order:       f6\\n  Poisoned by user:        f7\\n  Container overflow:      fc\\n  Array cookie:            ac\\n  Intra object redzone:    bb\\n  ASan internal:           fe\\n  Left alloca redzone:     ca\\n  Right alloca redzone:    cb\\n==128128==ABORTING\\n[Inferior 1 (process 128128) exited with code 01]\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"entry_repeat_range() is not publicity available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_339", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"339\", \"title\": \"Program received signal SIGSEGV, Segmentation fault. in fetch_token at /oniguruma/src/regparse.c:5560\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the fetch_token  function to handle a specific input, Program received signal SIGSEGV, Segmentation fault. in fetch_token at /oniguruma/src/regparse.c:5560\\n\\nhttps://github.com/kkos/oniguruma/blob/c197d53ec6a25d7b068809130f046c006650d1a5/src/regparse.c#L5559-L5560\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/fetch_token/add_compile_string.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/fetch_token/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/fetch_token/add_compile_string) and run the following cmd:\\n```\\n $ ./add_compile_string ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x0000555555879a9a in fetch_token_cc (tok=0x0, src=0x0, end=0x0, env=0x0, state=0) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:5271\\n5271    {\\n(gdb) bt\\n#0  0x0000555555879a9a in fetch_token_cc (tok=0x0, src=0x0, end=0x0, env=0x0, state=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:5271\\n#1  0x0000555555830952 in prs_cc (np=0x7fffff7ffd20, tok=0x7bfff57090a0, src=0x7fffff7ffc50, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:6978\\n#2  0x0000555555835f48 in prs_cc (np=0x7fffff8006a0, tok=0x7bfff57090a0, src=0x7fffff8005d0, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#3  0x0000555555835f48 in prs_cc (np=0x7fffff801020, tok=0x7bfff57090a0, src=0x7fffff800f50, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#4  0x0000555555835f48 in prs_cc (np=0x7fffff8019a0, tok=0x7bfff57090a0, src=0x7fffff8018d0, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#5  0x0000555555835f48 in prs_cc (np=0x7fffff802320, tok=0x7bfff57090a0, src=0x7fffff802250, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#6  0x0000555555835f48 in prs_cc (np=0x7fffff802ca0, tok=0x7bfff57090a0, src=0x7fffff802bd0, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#7  0x0000555555835f48 in prs_cc (np=0x7fffff803620, tok=0x7bfff57090a0, src=0x7fffff803550, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#8  0x0000555555835f48 in prs_cc (np=0x7fffff803fa0, tok=0x7bfff57090a0, src=0x7fffff803ed0, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#9  0x0000555555835f48 in prs_cc (np=0x7fffff804920, tok=0x7bfff57090a0, src=0x7fffff804850, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#10 0x0000555555835f48 in prs_cc (np=0x7fffff8052a0, tok=0x7bfff57090a0, src=0x7fffff8051d0, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#11 0x0000555555835f48 in prs_cc (np=0x7fffff805c20, tok=0x7bfff57090a0, src=0x7fffff805b50, \\n    end=0x7e7ff6a239f8 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:7223\\n#12 0x0000555555835f48 in prs_cc (np=0x7fffff8065a0, tok=0x7bfff57090a0, src=0x7fffff8064d0, \\n--Type <RET> for more, q to quit, c to continue without paging--\\n```\\n```\\n(gdb) bt\\n#0  0x00005555556283a3 in __interceptor_malloc ()\\n#1  0x00005555557a2e8a in node_new () at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2284\\n#2  0x00005555557a447b in node_new_bag (type=BAG_MEMORY)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2653\\n#3  0x000055555584fe6a in node_new_memory (is_named=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2706\\n#4  0x00005555558236a8 in prs_bag (np=0x7bfff56285a0, tok=0x7bfff57090a0, term=15, src=0x7bfff5956850, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8535\\n#5  0x00005555557fe5c6 in prs_exp (np=0x7bfff56285a0, tok=0x7bfff57090a0, term=15, src=0x7bfff5956850, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8868\\n#6  0x00005555557fca30 in prs_branch (top=0x7bfff5628560, tok=0x7bfff57090a0, term=15, src=0x7bfff5956850, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9272\\n#7  0x00005555557e56ee in prs_alts (top=0x7bfff5956830, tok=0x7bfff57090a0, term=15, src=0x7bfff5956850, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9327\\n#8  0x0000555555823d17 in prs_bag (np=0x7bfff5628520, tok=0x7bfff57090a0, term=15, src=0x7bfff5956450, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8545\\n#9  0x00005555557fe5c6 in prs_exp (np=0x7bfff5628520, tok=0x7bfff57090a0, term=15, src=0x7bfff5956450, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8868\\n#10 0x00005555557fca30 in prs_branch (top=0x7bfff56284e0, tok=0x7bfff57090a0, term=15, src=0x7bfff5956450, \\n    end=0x7ddff6a20ad3 \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9272\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The following code cannot reproduce the phenomenon.\\nI think the stack area has grown so large that it has broken heap area.\\nUsing onig_set_parse_depth_limit() to make the restrictions stronger would solve the problem.\\n(The default value is 4096.)\\n\\nint onig_set_parse_depth_limit(unsigned int depth);\\n\\n```c\\n#include <stdio.h>\\n#include <stdlib.h>\\n#include \\\"regcomp.c\\\"\\n#include \\\"regparse.h\\\"\\n#include \\\"oniguruma.h\\\"\\n\\n\\nint main(int argc, char *argv[]) {\\n    if (argc != 2) {\\n        fprintf(stderr, \\\"Usage: %s <input_file>\\\\n\\\", argv[0]);\\n        return 1;\\n    }\\n\\n    // ÊâìÂºÄÊñá‰ª∂\\n    FILE *inputFile = fopen(argv[1], \\\"r\\\");\\n    if (!inputFile) {\\n        fprintf(stderr, \\\"Error opening file: %s\\\\n\\\", argv[1]);\\n        return 1;\\n    }\\n\\n    // ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ\\n    fseek(inputFile, 0, SEEK_END);\\n    long fileSize = ftell(inputFile);\\n    fseek(inputFile, 0, SEEK_SET);\\n\\n    fprintf(stdout, \\\"fileSize: %ld\\\\n\\\", fileSize);\\n\\n    char *fileContent = (char *)malloc(fileSize + 1);\\n    if (!fileContent) {\\n        fprintf(stderr, \\\"Memory allocation failed\\\\n\\\");\\n        fclose(inputFile);\\n        return 1;\\n    }\\n\\n    fread(fileContent, 1, fileSize, inputFile);\\n    fileContent[fileSize] = '\\\\0';\\n    fclose(inputFile);\\n\\n    int valid = onigenc_is_valid_mbc_string(ONIG_ENCODING_UTF8, (UChar* )fileContent, (UChar* )(fileContent + fileSize));\\n    fprintf(stdout, \\\"is valid mbc string: %d\\\\n\\\", valid);\\n\\n\\n    // ÂàùÂßãÂåñÊ≠£ÂàôË°®ËææÂºèÁªìÊûÑ\\n    OnigRegex reg;\\n    OnigEncoding enc = ONIG_ENCODING_UTF8;\\n    OnigErrorInfo einfo;\\n    int r = onig_new(&reg, (UChar *)fileContent, (UChar *)(fileContent + fileSize),\\n                     ONIG_OPTION_DEFAULT, enc, ONIG_SYNTAX_DEFAULT, &einfo);\\n    if (r != ONIG_NORMAL) {\\n        char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\n        onig_error_code_to_str((UChar *)s, r, &einfo);\\n        fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\n        free(fileContent);\\n        return 1;\\n    }\\n\\n    // Ë∞ÉÁî® add_compile_string ÂáΩÊï∞\\n    // ËøôÈáåÂÅáËÆæ fileContent ÊòØÊàë‰ª¨Ë¶Å‰º†ÈÄíÁöÑÂ≠óÁ¨¶‰∏≤\\n    // Áî±‰∫é add_compile_string ÈúÄË¶ÅÊõ¥Â§ö‰∏ä‰∏ãÊñáÔºåËøôÈáå‰ªÖ‰Ωú‰∏∫Á§∫‰æã\\n    int slen = 1; // ÂÅáËÆæÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰∏∫1\\n    r = add_compile_string((UChar *)fileContent, 1, slen, reg);\\n    if (r != 0) {\\n        fprintf(stderr, \\\"Error in add_compile_string\\\\n\\\");\\n        free(fileContent);\\n        onig_free(reg);\\n        return 1;\\n    }\\n\\n    // ÈáäÊîæËµÑÊ∫ê\\n    free(fileContent);\\n    onig_free(reg);\\n\\n    return 0;\\n}\\n```\\n\\n```\\nfileSize: 14584\\nis valid mbc string: 1\\nERROR: parse depth limit over\\n```\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_340", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"340\", \"title\": \"AddressSanitizer: unknown-crash in onigenc_strdup /oniguruma/src/regenc.c:159\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the onigenc_strdup  function to handle a specific input, AddressSanitizer: unknown-crash in onigenc_strdup /oniguruma/src/regenc.c:159\\n\\nhttps://github.com/kkos/oniguruma/blob/c197d53ec6a25d7b068809130f046c006650d1a5/src/regenc.c#L148-L159\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_strdup/compile_string_crude_node.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_strdup/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onigenc_strdup/compile_string_crude_node) and run the following cmd:\\n```\\n $ ./compile_string_crude_node ./poc\\n```\\n\\n## Detail\\n### ASAN report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_tree/compile_string_crude_node/compile_string_crude_node output/default/crashes/id:000000,sig:06,src:000001,time:4038,execs:1300,op:havoc,rep:3\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n=================================================================\\n==3109493==ERROR: AddressSanitizer: unknown-crash on address 0x5a5a5af7f7f7f72a at pc 0x55555562617b bp 0x7fffffffd510 sp 0x7fffffffccd0\\nREAD of size 959734576 at 0x5a5a5af7f7f7f72a thread T0\\n[Detaching after fork from child process 3112710]\\n    #0 0x55555562617a in __asan_memcpy (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_tree/compile_string_crude_node/compile_string_crude_node+0xd217a) (BuildId: a5fc0395143cab52a913ecd987ccfd4524f3b5a9)\\n    #1 0x55555576fb3b in onigenc_strdup /home/ambrose/vsproject/TestLib/oniguruma/src/regenc.c:159:3\\n    #2 0x55555574ef30 in add_compile_string /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1071:9\\n    #3 0x555555691d72 in compile_string_crude_node /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:1177:10\\n    #4 0x5555556916ef in main /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/harness/code/regcomp.c/compile_tree/compile_string_crude_node.c:54:9\\n    #5 0x7ffff7a29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16\\n    #6 0x7ffff7a29e3f in __libc_start_main csu/../csu/libc-start.c:392:3\\n    #7 0x555555585444 in _start (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_tree/compile_string_crude_node/compile_string_crude_node+0x31444) (BuildId: a5fc0395143cab52a913ecd987ccfd4524f3b5a9)\\n\\nAddress 0x5a5a5af7f7f7f72a is a wild pointer inside of access range of size 0x000039346330.\\nSUMMARY: AddressSanitizer: unknown-crash (/home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/compile_tree/compile_string_crude_node/compile_string_crude_node+0xd217a) (BuildId: a5fc0395143cab52a913ecd987ccfd4524f3b5a9) in __asan_memcpy\\n==3109493==ABORTING\\n[Inferior 1 (process 3109493) exited with code 01]\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"compile_string_crude_node() is not publicity available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_341", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"341\", \"title\": \"Program received signal SIGSEGV, Segmentation fault. in node_new () at /oniguruma/src/regparse.c:2284\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the node_new  function to handle a specific input,Program received signal SIGSEGV, Segmentation fault. in node_new () at /oniguruma/src/regparse.c:2284 \\n\\nhttps://github.com/kkos/oniguruma/blob/c197d53ec6a25d7b068809130f046c006650d1a5/src/regparse.c#L2279-L2284\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_new/onig_new.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_new/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/node_new/onig_new) and run the following cmd:\\n```\\n $ ./onig_new ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/generate/onig_new/onig_new output/default/crashes/id:000000,sig:11,src:001463,time:49140458,execs:3357193,op:havoc,rep:5\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGSEGV, Segmentation fault.\\n0x0000555555628393 in __interceptor_malloc ()\\n(gdb) bt\\n#0  0x0000555555628393 in __interceptor_malloc ()\\n#1  0x00005555557a2b7a in node_new () at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2284\\n#2  0x00005555557a416b in node_new_bag (type=BAG_MEMORY)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2653\\n#3  0x000055555584fb5a in node_new_memory (is_named=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:2706\\n#4  0x0000555555823398 in prs_bag (np=0x7bfff5626c60, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa650, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8535\\n#5  0x00005555557fe2b6 in prs_exp (np=0x7bfff5626c60, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa650, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8868\\n#6  0x00005555557fc720 in prs_branch (top=0x7bfff5626c20, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa650, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9272\\n#7  0x00005555557e53de in prs_alts (top=0x7bfff59fa630, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa650, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9327\\n#8  0x0000555555823a07 in prs_bag (np=0x7bfff5626be0, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa250, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040) at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8545\\n#9  0x00005555557fe2b6 in prs_exp (np=0x7bfff5626be0, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa250, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:8868\\n#10 0x00005555557fc720 in prs_branch (top=0x7bfff5626ba0, tok=0x7bfff57090a0, term=15, src=0x7bfff59fa250, \\n    end=0x7bfff5b0941f \\\"\\\", env=0x7bfff5909040, group_head=0)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regparse.c:9272\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"The following code cannot reproduce the phenomenon.\\nI think the stack area has grown so large that it has broken heap area.\\n\\n```c\\n#include <stdio.h>\\n#include <stdlib.h>\\n#include <string.h>\\n//#include \\\"regcomp.c\\\"\\n//#include \\\"regparse.h\\\"\\n#include \\\"oniguruma.h\\\"\\n\\nint main(int argc, char *argv[]) {\\n    if (argc != 2) {\\n        fprintf(stderr, \\\"Usage: %s <input_file>\\\\n\\\", argv[0]);\\n        return 1;\\n    }\\n\\n    // Open the input file\\n    FILE *inputFile = fopen(argv[1], \\\"r\\\");\\n    if (!inputFile) {\\n        fprintf(stderr, \\\"Error opening file: %s\\\\n\\\", argv[1]);\\n        return 1;\\n    }\\n\\n    // Read the pattern from the file\\n    char pattern[1024];\\n    if (fgets(pattern, sizeof(pattern), inputFile) == NULL) {\\n        fprintf(stderr, \\\"Error reading pattern from file.\\\\n\\\");\\n        fclose(inputFile);\\n        return 1;\\n    }\\n\\n    // Close the file\\n    fclose(inputFile);\\n\\n    fprintf(stdout, \\\"len: %lu\\\\n\\\", strlen(pattern));\\n\\n    int valid = onigenc_is_valid_mbc_string(ONIG_ENCODING_UTF8, (UChar* )pattern, (UChar* )(pattern + strlen(pattern)));\\n    fprintf(stdout, \\\"is valid mbc string: %d\\\\n\\\", valid);\\n\\n    // Initialize Oniguruma\\n    regex_t *reg;\\n    OnigErrorInfo einfo;\\n    OnigEncoding enc = ONIG_ENCODING_UTF8;\\n    OnigSyntaxType *syntax = ONIG_SYNTAX_DEFAULT;\\n    int option = ONIG_OPTION_NONE;\\n\\n    // Call onig_new\\n    int r = onig_new(&reg, (const OnigUChar *)pattern, (const OnigUChar *)(pattern + strlen(pattern)), option, enc, syntax, &einfo);\\n    if (r != ONIG_NORMAL) {\\n        fprintf(stderr, \\\"Error in onig_new: %d\\\\n\\\", r);\\n        return 1;\\n    }\\n\\n    // Free the regex object\\n    onig_free(reg);\\n\\n    return 0;\\n}\\n```\\n\\n```\\nlen: 1023\\nis valid mbc string: 1\\nError in onig_new: -117\\n```\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_342", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"342\", \"title\": \"Program received signal SIGILL, Illegal instruction.  in onig_is_code_in_cc  at /oniguruma/src/regcomp.c:7889\", \"author\": \"ambrosecm\", \"labels\": [], \"description\": \"## Desctiption\\nWhen I used the  function to handle a specific input, Program received signal SIGILL, Illegal instruction.  in onig_is_code_in_cc  at /oniguruma/src/regcomp.c:7889\\n\\nhttps://github.com/kkos/oniguruma/blob/c197d53ec6a25d7b068809130f046c006650d1a5/src/regcomp.c#L7884-L7889\\n\\n## Test Environment\\nUbuntu 22.04.1, 64bit\\noniguruma(v6.9.10 master https://github.com/kkos/oniguruma/commit/05bb130c9ad54877e73d1caf08dd95e6ff199d99)\\n[program source file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_is_code_in_cc/onig_is_code_in_cc.c)\\n\\n## How to trigger\\nDownload the [poc file](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_is_code_in_cc/poc) , [program](https://github.com/ambrosecm/pocs/blob/main/oniguruma/onig_is_code_in_cc/onig_is_code_in_cc) and run the following cmd:\\n```\\n $ ./onig_is_code_in_cc ./poc\\n```\\n\\n## Detail\\n### GDB report\\n```\\n(gdb) r\\nStarting program: /home/ambrose/vsproject/HIMFuzz/harness/output/oniguruma_deepseek24/crashes/regcomp.c/is_exclusive/onig_is_code_in_cc/onig_is_code_in_cc output/default/crashes/id:000000,sig:04,src:000003,time:10435,execs:4684,op:havoc,rep:30\\n[Thread debugging using libthread_db enabled]\\nUsing host libthread_db library \\\"/lib/x86_64-linux-gnu/libthread_db.so.1\\\".\\n\\nProgram received signal SIGILL, Illegal instruction.\\n0x0000555555689f0f in onig_is_code_in_cc (enc=0x22, code=0, cc=0x7bfff5a09050) at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:7889\\n7889      if (ONIGENC_MBC_MINLEN(enc) > 1) {\\n(gdb) bt\\n#0  0x0000555555689f0f in onig_is_code_in_cc (enc=0x22, code=0, cc=0x7bfff5a09050)\\n    at /home/ambrose/vsproject/TestLib/oniguruma/src/regcomp.c:7889\\n#1  0x0000555555691156 in main (argc=2, argv=0x7fffffffdaa8)\\n    at output/oniguruma_deepseek24/harness/code/regcomp.c/is_exclusive/onig_is_code_in_cc.c:35\\n(gdb) p enc\\n$1 = (OnigEncoding) 0x22\\n```\", \"comments\": [{\"author\": \"kkos\", \"body\": \"onig_is_code_in_cc() is not publicity available.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_343", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"343\", \"title\": \"Pattern-terminating `\\\\x` and `\\\\u` are handled as identity escapes\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"- If used at the very end of a pattern, `\\\\x` matches a literal `x` rather than a ‚êÄ character like it does at other positions.\\n- If used at the very end of a pattern, `\\\\u` matches a literal `u` rather than throwing an error like it does at other positions.\\n\\nThese feel like bugs, since I'm not sure why they should behave differently only at the very end of a pattern.\\n\\n<sup>Disclosure: I'm testing using Oniguruma 6.9.8 via vscode-oniguruma. However, the release notes for subsequent versions don't mention any related changes.<sup>\\n\\n---\\n\\nMore details:\\n\\nCurrent behavior for `\\\\x`: It's an escape for the ‚êÄ character (equivalent to `\\\\0`, `\\\\x00`, etc.) if it's not followed by `{` or a hexadecimal digit.\\n\\n- `\\\\x` is an error if followed by a `{` that's followed by a hexadecimal digit but doesn't form a valid `\\\\x{‚Ä¶}` code point escape. Ex: `\\\\x{F` and `\\\\x{0,2}` are errors.\\n- `\\\\x` is an identity escape (matching a literal `x`) if followed by a `{` that isn't followed by a hexadecimal digit. Ex: `\\\\x{` matches `x{`, `\\\\x{G` matches `x{G`, `\\\\x{}` matches `x{}`, and `\\\\x{,2}` matches 0‚Äì2 `x` characters, since `{,2}` is a quantifier with an implicit 0 min.\\n- `\\\\x` is treated as an identity escape (matching a literal `x`) if it appears at the very end of a pattern.\\n  - **This feels like a bug.**\\n\\nCurrent behavior for `\\\\u`:\\n\\n- Normally, any incomplete `\\\\uHHHH` (including bare `\\\\u`) throws an error.\\n- `\\\\u` is treated as an identity escape (matching a literal `u`) if it appears at the very end of a pattern.\\n  - **This feels like a bug.**\\n\\n---\\n\\nNote: PCRE2 v10.45 recently removed the ability for `\\\\x` to match a ‚êÄ character, and [recommends](https://github.com/PCRE2Project/pcre2/blob/pcre2-10.45/NEWS) using `\\\\x00` instead.\\n\\n> \\\\* (Minor pattern syntax change) Parsing of the \\\\x escape is stricter, and is\\n> no longer parsed as an escape for the NUL character if not followed by '{' or\\n> a hexadecimal digit. Use \\\\x00 instead.\", \"comments\": []}"}]}}
{"custom_id": "kkos_oniguruma_issue_345", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"345\", \"title\": \"Handling of invalid standalone encoded bytes `\\\\x80` to `\\\\xFF`\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"Oniguruma docs simply state: \\\"Do not pass invalid byte string in the regex character encoding.\\\"\\n\\nBased on my testing, following are the behavior details for invalid standalone encoded bytes:\\n\\n- Standalone `\\\\x80` to `\\\\xBF` throw error \\\"invalid code point value\\\".\\n- Standalone `\\\\xC0` to `\\\\xF4` throw error \\\"too short multibyte code string\\\".\\n- Standalone `\\\\xF5` to `\\\\xFF` fail to match anything, but don't throw. <mark>This feels like a bug.</mark>\\n\\nThe behavior changes if an invalid standalone encoded byte is used as the end value of a character class range (due to option `ONIG_SYN_ALLOW_INVALID_CODE_END_OF_RANGE_IN_CC`):\\n\\n- Standalone `\\\\x80` to `\\\\xBF` are treated as `\\\\x7F`.\\n- Standalone `\\\\xC0` to `\\\\xF4` throw error \\\"too short multibyte code string\\\". <mark>This feels like a bug.</mark>\\n- Standalone `\\\\xF5` to `\\\\xFF` are treated as `\\\\x7F`.\\n  - If the range is within a *negated*, *non-nested* character class (ex: `[^\\\\0-\\\\xFF]`), `\\\\xF5` to `\\\\xFF` are handled like `\\\\x{10FFFF}`. <mark>This feels like a bug.</mark> For example, `[^\\\\x01-\\\\xFF]` matches only `\\\\x00`. The bug can be worked around by nesting the class. For example, `[[^\\\\0-\\\\xFF]]` matches `\\\\x80` and higher.\\n\\nDisclosure: I'm testing using Oniguruma 6.9.8 via vscode-oniguruma. However, the release notes for subsequent versions don't mention any related changes.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"Basically, only the correctness of byte length is checked, and no strict checks are made on byte values.\\nBut only for UTF-8, I modified the checks to be a little stricter, though not perfect.\\nONIG_SYN_ALLOW_INVALID_CODE_END_OF_RANGE_IN_CC is not about byte values but about code points.\"}, {\"author\": \"slevithan\", \"body\": \"Thank you for the details and changes!\\n\\nFor posterity, it looks like the related commits were https://github.com/kkos/oniguruma/commit/ed4910930d8a902687749e0ce5fbd4d265494045, https://github.com/kkos/oniguruma/commit/3f966829ee4350682428d4269f46d8099adf29e1, https://github.com/kkos/oniguruma/commit/4fb6e11003f4644b7b93c19c79143a9ff0c79809, https://github.com/kkos/oniguruma/commit/7306eb837a89fa88504933385016b531aea46322, and https://github.com/kkos/oniguruma/commit/3eb317dc4413692e4eaa92a68839c74aa74fbc77.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_346", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"346\", \"title\": \"Regexes with 1000+ capturing groups never match\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"*(I apologize in advance that I'm testing v6.9.8 via vscode-oniguruma, since I'm not a C coder. However, I haven't seen anything related to this in the release notes for subsequent versions.)*\\n\\nOniguruma seems to theoretically support backreference `\\\\1000` and higher when as many capturing groups appear to the left, but regexes with more than 999 captures never actually work. They fail to match anything, with no error.\\n\\nFor example, `()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(999)` matches the string `999`, but if you add an empty `()` on the end of the regex, it will no longer match anything.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I could not reproduce that problem in either version 6.9.8 or 6.9.10.\\n\\n```c\\n#include <stdio.h>\\n#include <string.h>\\n#include \\\"oniguruma.h\\\"\\n\\nextern int main(int argc, char* argv[])\\n{\\n  int r;\\n  const unsigned char* start;\\n  const unsigned char* range;\\n  const unsigned char* end;\\n  regex_t* reg;\\n  OnigErrorInfo einfo;\\n  OnigRegion *region;\\n  OnigEncoding use_encs[1];\\n\\n  static const UChar* pattern = (const UChar* )\\\"()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(999)()\\\";\\n\\n  static const UChar* str     = (const UChar* )\\\"999\\\";\\n\\n  use_encs[0] = ONIG_ENCODING_UTF8;\\n  onig_initialize(use_encs, sizeof(use_encs)/sizeof(use_encs[0]));\\n\\n  r = onig_new(&reg, pattern, pattern + strlen((const char* )pattern),\\n        ONIG_OPTION_DEFAULT, ONIG_ENCODING_UTF8, ONIG_SYNTAX_DEFAULT, &einfo);\\n  if (r != ONIG_NORMAL) {\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\n    onig_error_code_to_str((UChar* )s, r, &einfo);\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\n    return -1;\\n  }\\n\\n  region = onig_region_new();\\n\\n  end   = str + strlen((const char* )str);\\n  start = str;\\n  range = end;\\n  r = onig_search(reg, str, end, start, range, region, ONIG_OPTION_NONE);\\n  if (r >= 0) {\\n    fprintf(stderr, \\\"match at %d\\\\n\\\", r);\\n    for (int i = 0; i < region->num_regs; i++) {\\n      fprintf(stderr, \\\"%d: (%d-%d)\\\\n\\\", i, region->beg[i], region->end[i]);\\n    }\\n  }\\n  else if (r == ONIG_MISMATCH) {\\n    fprintf(stderr, \\\"search fail\\\\n\\\");\\n  }\\n  else { /* error */\\n    char s[ONIG_MAX_ERROR_MESSAGE_LEN];\\n    onig_error_code_to_str((UChar* )s, r);\\n    fprintf(stderr, \\\"ERROR: %s\\\\n\\\", s);\\n    onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\n    onig_free(reg);\\n    onig_end();\\n    return -1;\\n  }\\n\\n  onig_region_free(region, 1 /* 1:free self, 0:free contents only */);\\n  onig_free(reg);\\n\\n  fprintf(stdout, \\\"Version: %s\\\\n\\\", onig_version());\\n\\n  onig_end();\\n  return 0;\\n}\\n```\\n\\n```\\n% gcc -Wall -g -o 346.8 -I/Users/kosako/work/oniguruma/onig-6.9.8/src 346.c /Users/kosako/work/oniguruma/onig-6.9.8/src/.libs/libonig.a\\n% otool -L 346.8\\n346.8:\\n\\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1351.0.0)\\n% ./346.8\\nmatch at 0\\n0: (0-3)\\n1: (0-0)\\n2: (0-0)\\n3: (0-0)\\n...\\n...\\n997: (0-0)\\n998: (0-0)\\n999: (0-3)\\n1000: (3-3)\\nVersion: 6.9.8\\n%\\n```\\n\"}, {\"author\": \"tonco-miyazawa\", \"body\": \"I was unable to reproduce this issue in v6.9.8 and current master branch too.\\n\\nThe cause may be the following value in vscode-oniguruma. (I don't know.)\\nhttps://github.com/microsoft/vscode-oniguruma/blob/f84e6ee8c5914366ce969346c489f7fb492d0b34/src/onig.cc#L99\\n\\nRelated source code\\nhttps://github.com/kkos/oniguruma/blob/3eb317dc4413692e4eaa92a68839c74aa74fbc77/src/regparse.c#L282-L293\\nhttps://github.com/kkos/oniguruma/blob/3eb317dc4413692e4eaa92a68839c74aa74fbc77/src/oniguruma.h#L363\\n\\n`ONIG_MAX_CAPTURE_NUM` does not appear to be used.\"}, {\"author\": \"slevithan\", \"body\": \"@kkos Thank you for checking and for sharing your code for testing. Sorry for the false bug report!\\n\\n@tonco-miyazawa Thanks for identifying the possible cause in vscode-oniguruma!\"}, {\"author\": \"slevithan\", \"body\": \"In case it's relevant, note that vscode-oniguruma enables the compile-time option `ONIG_OPTION_CAPTURE_GROUP` [by default](https://github.com/microsoft/vscode-oniguruma/blob/f84e6ee8c5914366ce969346c489f7fb492d0b34/src/index.ts#L380).\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_347", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"347\", \"title\": \"Lookbehind followed by greedy dot or `\\\\N` prevents the regex from matching\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"*(I apologize in advance that I'm testing v6.9.8 via vscode-oniguruma, since I'm not a C coder. However, I haven't seen anything related to this in the release notes for subsequent versions.)*\\n\\nA lookbehind immediately followed by a greedily or possessively quantified `.` or `\\\\N` prevent the regex from matching.\\n\\nA reduced test case is `(?<=.).+` or `(?<=.)\\\\N+`. These do not find a match within `aa`. This bug seems very specific to a greedily or possessively quantified `.` or `\\\\N` following a lookbehind. If we replace the reduced regex with any of the following, the bug is not triggered and the regex finds a match:\\n\\n- Exactly equivalent:\\n  - `(?<=.)[^\\\\n]+`\\n- Equivalent in line-by-line search:\\n  - `(?<=.)[\\\\0-\\\\x{10FFFF}]+`\\n  - `(?<=.)\\\\O+`\\n  - `(?<=.)\\\\p{Any}+`\\n  - `(?<=.)(?m:.+)`\\n- Not equivalent, but shows that even slight changes avoid the bug:\\n  - `(?<=.).+?`\\n  - `(?<=.).`\\n\", \"comments\": [{\"author\": \"tonco-miyazawa\", \"body\": \"> `(?<=.).+` or `(?<=.)\\\\N+`\\n\\nI was unable to reproduce this issue in v6.9.8 and current master branch. All of these were successfully matched.\\n\\nTest code for [/sample/callout.c](https://github.com/kkos/oniguruma/blob/master/sample/callout.c)\\n```\\n  test(enc, mp, \\\"(?<=.).+\\\"  , \\\"aa\\\");\\n  test(enc, mp, \\\"(?<=.)\\\\\\\\N+\\\"  , \\\"aa\\\");\\n```\\n\\nResult:\\n```\\nmatch at 1\\n0: (1-2)    // Matched the range from position 1 to position 2.\\nmatch at 1\\n0: (1-2)\\n```\\n\\nThis may also be caused by vscode-oniguruma??\"}, {\"author\": \"slevithan\", \"body\": \"> This may also be caused by vscode-oniguruma??\\n\\nWow, unlike the other issue (where it's easier to imagine issues caused by the wrapper), it's extremely surprising that this one could be caused by the vscode-oniguruma wrapper around Oniguruma 6.9.8.\\n\\nThanks for testing it.\\n\\nEdit: I'll leave this one for @kkos to close, in case there are any ideas/conditions that jump out for him that could cause this to be coming from Oniguruma itself.\\n\\n(Note that vscode-oniguruma enables the compile-time option `ONIG_OPTION_CAPTURE_GROUP` [by default](https://github.com/microsoft/vscode-oniguruma/blob/f84e6ee8c5914366ce969346c489f7fb492d0b34/src/index.ts#L380).)\"}, {\"author\": \"kkos\", \"body\": \"I could not reproduce that problem by specifying ONIG_OPTION_CAPTURE_GROUP.\\nI don't know why the results are different than when run in vscode.\"}, {\"author\": \"slevithan\", \"body\": \"Thanks for confirming.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_349", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"349\", \"title\": \"Flag `W` should not interfere with Unicode case folding from flag `i`\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"Currently, flag `\\\\W` and `\\\\P` prevent Unicode case folding (via flag `i`) from applying to `\\\\w` and its friends (`\\\\b`, `\\\\p{Word}`, `[:word:]`, and inversions). But this is handled inconsistently, depending on nonintuitive factors. I know that this is by design (this issue was previously discussed in #264 from @tonco-miyazawa), but I want to argue that (in all cases) `\\\\W` and `\\\\P` should *allow* Unicode case folding when flag `i` is enabled (if whole-pattern modifier `(?I)` is not enabled).\\n\\nIn other words, `\\\\w` with flags `iW` should always match the same characters as `[0-9A-Z_a-z≈ø‚Ñ™]` (including U+017F \\\"small long s\\\" and U+212A Kelvin). (Of course, the same logic should apply to `\\\\w`'s friends, plus everything affected by flag `P`, but it's easier to focus on just `\\\\w` here.)\\n\\nTo describe this in rules:\\n\\n- Flag `W`/`P` should always change `\\\\w` to match ASCII-only `[0-9A-Z_a-z]`.\\n- Flag `i` should always expand ASCII `s`/`S` to include `≈ø` and `k`/`K` to include `‚Ñ™`, based on Unicode case folding.\\n- Flag `W`/`P` should not change the above behavior of flag `i`.\\n\\nIn addition to the above rules being logical and simple, there is precedent in JavaScript. JavaScript regexes use ASCII-only `\\\\w` (and `\\\\b`, etc.). And, when using Unicode-aware case insensitivity (via flags `iu` or `iv`), JavaScript's `\\\\w` is equivalent to `[0-9A-Z_a-z≈ø‚Ñ™]`.\\n\\nCurrently, the rules above are already followed by Oniguruma in *some* cases. Specifically, when using flags `(?iW)` and the `\\\\w` appears inside of a character class (if the outermost class is not negated). This is shown in the following match results.\\n\\n‚úÖ = match\\n‚ùå = no match\\nüö© = the result is not what I think it should be\\n\\n```\\nTarget string: '≈ø' U+017F\\n-----------------------\\ns                 // ‚ùå\\n(?i)s             // ‚úÖ\\n\\\\w                // ‚úÖ\\n(?W)\\\\w            // ‚ùå\\n-----------------------\\n(?iW)\\\\w           // ‚ùå üö©\\n(?iW)[\\\\w]         // ‚úÖ\\n(?iW)[^\\\\W]        // ‚ùå üö©\\n(?iW)[[^\\\\W]]      // ‚úÖ\\n(?iW)[^[\\\\W]]      // ‚ùå üö©\\n(?iW)[\\\\w&&[^\\\\W]]  // ‚úÖ\\n```\\n\\nAs I mentioned at the top, this inconsistency was previously discussed in #264. And it was documented [here](https://github.com/kkos/oniguruma/blob/09604e72328401a28aab08020b13ffc5ac828833/doc/RE#L290):\\n\\n> \\\\* (?i) option has no effect on word types (\\\\w, \\\\p{Word}). However, if the word types are used within a character class, it is valid. But, this would only be a concern when word types are used with the (?W) option.\\n\\nIn #264, @kkos [wrote](https://github.com/kkos/oniguruma/issues/264#issuecomment-1166383458):\\n\\n> I agree that it is odd that these four results do not match.\\n> However, for word type, it is difficult to have exactly the same behavior because of the particular implementation method.\\n> Therefore, only word type has a special specification for IGNORECASE. But if you are not using the (?W) option, you probably don't need to worry about it.\\n\\nFair enough. But two things:\\n\\n- The behavior is more complicated than just whether `\\\\w` is in a character class, since the negation status of the outermost class matters, as shown in the examples above. That makes it quite unpredictable for users.\\n- I don't know, but maybe the assumption before was that the ideal behavior for flag `W` was to always make `\\\\w` match `[0-9A-Z_a-z]`, even with flag `i`. Could it be that having flags `iW` result in matching `[0-9A-Z_a-z≈ø‚Ñ™]` would make it easier for the implementation methods to be consistent?\\n\\nAlso, I'm just guessing, but maybe the implementation methods are harder to make consistent because of the how Oniguruma also sometimes applies Unicode's [SpecialCasing.txt](https://www.unicode.org/Public/UNIDATA/SpecialCasing.txt) (like `√ü` ‚Üî `ss`)? I've filed #351 to see if it's possible to change that behavior, too.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I forget what the current implementation is, so I can't decide now what to do.\\nI will write when it is decided.\"}, {\"author\": \"slevithan\", \"body\": \"Quoting from [#351](https://github.com/kkos/oniguruma/issues/351#issuecomment-2818389363), since this detail was more relevant here:\\n\\n> JS also ensures that `/\\\\w/iu` is the inverse of `/\\\\W/iu`. This is relevant since JS's `\\\\w` is ASCII-only `[0-9A-Z_a-z]`, which means that `\\\\W` matches U+017F and U+212A. But `/\\\\w/iu` is equivalent to `[0-9A-Z_a-z\\\\u017F\\\\u212A]`, so `/\\\\W/iu` is the inverse of `/\\\\w/iu`. That means `/\\\\W/iu` is equivalent to `/[^0-9A-Z_a-z\\\\u017F\\\\u212A]/u`.\\n\\nCurrently, in Oniguruma, `(?iW)[\\\\w]` and `(?iW)[\\\\W]` both match `'s'`. The second pattern should not match it, because ‚Äî in addition to following how the JavaScript specification handles it ‚Äî that would follow the intuitive and reasonable expectation that `\\\\W` is always the inversion of `\\\\w`, even when flags like `i` and `W` change what `\\\\w` matches.\\n\\nHistorical note: When JavaScript's flag `u` was introduced in the ES2015 standard, this detail wasn't handled correctly. There was a [specification fix in 2016](https://github.com/tc39/ecma262/pull/525) (earlier discussion in https://github.com/tc39/ecma262/issues/512) that corrected it.\\n\\nJS test cases:\\n\\n```js\\n/\\\\w/iu.test('\\\\u017F') // true\\n/\\\\w/iu.test('\\\\u212A') // true\\n/\\\\W/iu.test('\\\\u017F') // false\\n/\\\\W/iu.test('\\\\u212A') // false\\n/\\\\W/iu.test('s')      // false\\n/\\\\W/iu.test('S')      // false\\n/\\\\W/iu.test('K')      // false\\n/\\\\W/iu.test('k')      // false\\n/\\\\b/iu.test('\\\\u017F') // true\\n/\\\\b/iu.test('\\\\u212A') // true\\n/\\\\b/iu.test('s')      // true\\n/\\\\b/iu.test('S')      // true\\n/\\\\B/iu.test('\\\\u017F') // false\\n/\\\\B/iu.test('\\\\u212A') // false\\n/\\\\B/iu.test('s')      // false\\n/\\\\B/iu.test('S')      // false\\n/\\\\B/iu.test('K')      // false\\n/\\\\B/iu.test('k')      // false\\n```\"}, {\"author\": \"kkos\", \"body\": \"Now, I'm doing case expansion for the entire character class, but I need to change it to do case expansion for individual elements of the character class and apply ASCII only mode there.\\n```\\n(?iW)[...\\\\w...]\\n```\\nHowever, it is quite difficult to make such a change.\\nCurrently, I do not have any good ideas.\"}, {\"author\": \"kkos\", \"body\": \"It is not impossible to fix, but it is quite tedious.\\nMoreover, it is likely to be a fix for Unicode only, leaving other character encodings untouched.\\nI think it was a mistake to add the ASCII-only mode options without deeply considering how to implement it in the character classes.\\nI have decided that it is not worth continuing this project any further, so I am terminating it.\\nThank you very much.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_350", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"350\", \"title\": \"Make character classes atomic with flag `i`\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"As discussed in #290, character classes with flag `i` can randomly (from the user's perspective) lead to performance problems, as a result of other seemingly-unrelated things (again, from the user's perspective) like whether the character class is repeated with a quantifier. This is because of how some characters are case-folded to multiple characters in Unicode, and as a result, choices for elements other than the character class are generated after the character class.\\n\\nAll of the things that come together to trigger the resulting performance problem (flag `i`, character classes, sets like `\\\\S` that contain affected characters, and quantifiers) are extremely commonly used, so this seems like it could be a relatively common issue.\\n\\nBut it also seems like there is a simple solution: Make character classes atomic. This is already done for `\\\\R` and `\\\\X`, which are very similar in concept.\\n\\nThis would of course be a breaking change in some edge cases. But since it would avoid a potentially serious issue, maybe that's worth it?\\n\\nNote: My preferred solution would not be to make character classes atomic, but rather to remove the current case expansion to multiple characters, as discussed in #351. If that behavior was moved behind its own flag, I'm not sure whether it would still make sense to make character classes atomic, since, despite the hazards, backtracking for character classes does result in more intuitive match results if the class contains multi-character elements.\", \"comments\": [{\"author\": \"kkos\", \"body\": \"I think this is possible, but will hold off because I haven't decided what to do with #351.\"}]}"}]}}
{"custom_id": "kkos_oniguruma_issue_351", "method": "POST", "url": "/v1/chat/completions", "body": {"model": "gpt-5-mini", "temperature": 1, "response_format": {"type": "json_schema", "json_schema": {"name": "RegexIssueClassification", "schema": {"type": "object", "properties": {"number": {"type": "string"}, "is_real_bug": {"type": "boolean"}, "is_fixed": {"type": "boolean"}, "found_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "fixed_pointer": {"type": "array", "items": {"type": "object", "properties": {"type": {"type": ["string", "null"], "enum": ["Version", "Commit Hash", "Pull Request Number", "Other", null]}, "value": {"type": ["string", "null"]}}, "required": ["type", "value"], "additionalProperties": false}}, "bug_kind": {"type": ["string", "null"], "enum": ["SEMANTIC", "CRASH", "DIFF", "PERF", "MEMORY", "DOC", "OTHER", null]}, "how_found": {"type": ["string", "null"], "enum": ["FUZZING", "STATIC_ANALYSIS", "MANUAL_REVIEW", "DIFFERENTIAL_TESTING", "OTHER", null]}, "reproduction_pattern_and_input": {"type": "array", "items": {"type": "object", "properties": {"pattern": {"type": ["string", "null"]}, "input": {"type": ["string", "null"]}}, "required": ["pattern", "input"], "additionalProperties": false}}, "log": {"type": ["string", "null"]}, "summary": {"type": "string"}}, "required": ["number", "is_real_bug", "is_fixed", "found_pointer", "fixed_pointer", "bug_kind", "how_found", "reproduction_pattern_and_input", "log", "summary"], "additionalProperties": false}, "strict": true}}, "messages": [{"role": "system", "content": "You are a **software engineering and cybersecurity researcher** specializing in **regular expression (regex) engine analysis**.\nYour research project aims to **systematically evaluate and categorize bugs** in regex engines by mining and interpreting historical issue reports.\n\nYou are currently analyzing the **oniguruma** regex engine, developed by **kkos**.\n\nFor each task, you will be given **one issue report** in the following JSON format:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"title\": \"Issue Title\",\n    \"author\": \"johndoe\",\n    \"labels\": [\"bug\", \"feature\"],\n    \"description\": \"Issue Description\",\n    \"comments\": [\n        {\n            \"author\": \"johndoe\",\n            \"body\": \"Comment Body\"\n        }\n    ]\n}\n```\n\n---\n\n# **Your Goal**\n\nYour task is to decide whether the issue describes a **real bug** related to the oniguruma regex engine and to **extract structured information** about the bug.\nYou must rely **only on the content explicitly stated or strongly implied** in the issue description and comments.\n\nIf the issue is **not** about an actual bug (e.g., question, misunderstanding, expected behavior, usage error, unsupported feature), then you must produce the **null-filled output** described later.\n\n---\n\n# **What Counts as a ‚ÄúReal Bug‚Äù**\n\n\nA real bug includes **any confirmed or strongly evidenced defect**, including:\n\n* **Semantic bugs**: incorrect match results, wrong interpretation of patterns.\n* **Crashes**: segmentation faults, aborts, panics.\n* **Performance bugs**: timeouts, catastrophic backtracking, unexpected slowdowns.\n* **Memory bugs**: leaks, buffer issues, tool-reported memory errors (ASan, UBSan, etc.).\n* **Differential bugs**: behavior differs between versions or across engines.\n* **Documentation bugs**: incorrect, misleading, incomplete, or inconsistent documentation associated with regex behavior or API usage.\n\nDo **not** classify as a bug:\n\n* misuse of the API\n* misunderstandings of regex semantics\n* invalid input or unsupported features\n* documentation or enhancement requests\n* behavioral questions with no confirmed fault\n\nWhen the existence of a bug is unclear, respond with **all null values**.\n\n---\n\n# **Output Format**\n\nYour output must be a valid JSON object with the following structure:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": true | false,\n    \"is_fixed\": true | false,\n    \"found_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"fixed_pointer\": [\n        {\n            \"type\": \"Version\" | \"Commit Hash\" | \"Pull Request Number\" | \"Other\" | null,\n            \"value\": \"Value\" | null\n        }\n    ],\n    \"bug_kind\": \"SEMANTIC\" | \"CRASH\" | \"DIFF\" | \"PERF\" | \"MEMORY\" | \"DOC\" | \"OTHER\" | null,\n    \"how_found\": \"FUZZING\" | \"STATIC_ANALYSIS\" | \"MANUAL_REVIEW\" | \"DIFFERENTIAL_TESTING\" | \"OTHER\" | null,\n    \"reproduction_pattern_and_input\": [\n        {\n            \"pattern\": \"Pattern\" | null,\n            \"input\": \"Input\" | null\n        }\n    ],\n    \"log\": \"Log\" | null,\n    \"summary\": \"Short summary of what the issue is about and the LLM's reasoning for the classification.\"\n}\n```\n\n### **Field Definitions**\n\n#### **is_real_bug**\n\n* Whether the issue is a real bug.\n* Set to `true` if the issue is a real bug, `false` otherwise.\n\n#### **is_fixed**\n\n* Whether the bug was fixed.\n* Set to `true` if the bug was fixed, `false` otherwise.\n\n#### **number**\n\n* The issue number.\n* You already know this from the issue report input, but you need to output it as well.\n\n#### **found_pointer**\n\n* The version, commit hash, or pull request number where the bug was observed.\n* The primary aim here is to pinpoint the locations so that we can rollback and reproduce the bug.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was found is explicitly stated.\n\n#### **fixed_pointer**\n\n* The version, commit hash, or pull request number where the bug was fixed.\n* If multiple of those are mentioned, you can add them all to the array.\n* Must come directly from the issue text or comments.\n* Return `[]` if not any kind of pointer to at which point the bug was fixed is explicitly stated.\n\n#### **bug_kind**\n\nChoose exactly one:\n\n| Value        | Meaning                                                                   |\n| ------------ | ------------------------------------------------------------------------- |\n| **SEMANTIC** | Incorrect matching, parsing, or interpretation of patterns                |\n| **CRASH**    | Crashes, panics, segmentation faults, unrecoverable errors                |\n| **DIFF**     | Behavioral differences (across versions or engines)                       |\n| **BUILD**    | Build issues or compilation errors when building the engine               |\n| **PERF**     | Performance issues, backtracking blowups, unexplained slowness            |\n| **MEMORY**   | Memory errors, leaks, invalid access, sanitizer outputs                   |\n| **DOC**      | **Documentation issues: misleading, incomplete, incorrect documentation** |\n| **OTHER**    | A genuine bug that does not fit any other category                        |\n\n\nFor `DIFF` bugs, behavioral differences can be observed in the two different versions of the same engine (e.g., new version vs. old version)\nand between different engines (e.g., oniguruma vs. other engines). The behavioral difference can be in the acceptance of a pattern, \nthe span of the match, the captures, the number of matches, flag behavior, etc.\n\n#### **how_found**\n\nIdentify how the bug was discovered, if stated or there is enough evidence (e.g., usage of ASan for fuzzing):\n\n* FUZZING ‚Äì found via fuzzing tools\n* STATIC_ANALYSIS ‚Äì found via automated static analysis\n* MANUAL_REVIEW ‚Äì found manually (e.g., user investigation)\n* DIFFERENTIAL_TESTING ‚Äì found by comparing results with other engines\n* OTHER ‚Äì explicitly stated custom method\n* `null` ‚Äì if no discovery method is stated or implied\n\n#### **reproduction_pattern_and_input**\n\n* Extract all reproducible test cases provided.\n* Store each `(pattern, input)` pair separately (there can be multiple pairs).\n* Use `null` values only when the pattern or input is missing.\n* Sometimes, the provided pattern or input string is too long to be fit in the output format (e.g., excessive repeats of the same character or pattern).\n  * For example, the issue author might state a regex pattern or input similar to \"()()()...()\" (10000 times \"()\"). \n  * In this case, you can output a shorter representation like \"()()...()\" (50 times \"()\"). Mention that truncation in your summary.\n\n#### **log**\n\n* Include any crash logs, sanitizer output, stack traces, or diagnostic logs.\n* Store **exactly** what is provided, do not invent or summarize.\n* Use `null` if not present.\n\n#### **summary**\n\nA **2‚Äì6 sentence** explanation summarizing:\n\n* What the issue reports.\n* Whether and why it qualifies (or does not qualify) as a real bug.\n* Your reasoning for the chosen bug category and extracted fields.\n\nThis is the **only place where your reasoning may appear**.\nAll other fields should contain **no justification‚Äîonly extracted data**.\n\n---\n\n# **If the Issue Is NOT a Real Bug**\n\nOutput the structure with all fields set to null or empty as below:\n\n```json\n{\n    \"number\": \"1234567890\",\n    \"is_real_bug\": false,\n    \"is_fixed\": false,\n    \"found_pointer\": [],\n    \"fixed_pointer\": [],\n    \"bug_kind\": null,\n    \"how_found\": null,\n    \"reproduction_pattern_and_input\": [],\n    \"log\": null,\n    \"summary\": \"Explanation of why this issue does not represent a real bug.\"\n}\n```\n\nThe number and summary must still be present; all other fields must be null or empty.\n\n---\n\n# **General Constraints**\n\n1. **Do not guess.** Only extract what is explicitly stated or can be strongly inferred from the issue description and comments.\n2. **Do not modify or correct the issue's content.** Extract it faithfully.\n3. **Only JSON output, no extra text.**\n4. **Ensure JSON is valid, syntactically correct, and uses only the allowed values.**\n5. **Never fabricate version numbers, logs, or test cases.**\n6. **Be consistent and precise.**\n"}, {"role": "user", "content": "{\"number\": \"351\", \"title\": \"Don't expand character match length with flag `i` (unless using a new flag)\", \"author\": \"slevithan\", \"labels\": [], \"description\": \"Currently, Oniguruma sometimes applies Unicode's [SpecialCasing.txt](https://www.unicode.org/Public/UNIDATA/SpecialCasing.txt) rules when using flag `i`, which can lengthen the match of a character, character class, or set (like `\\\\w` or `\\\\S`). For example, `(?i)^√ü$` matches `'ss'`, and `(?i)^ss$` matches `'√ü'`.\\n\\nI don't think Oniguruma should do that, unless the behavior is applied behind a dedicated flag or option. And if such a flag was added, that would allow applying the behavior more consistently than it is now, since users would be opting in and it could be documented that there are performance implications.\\n\\nFollowing is my understanding of the reasons for and against the current behavior. Are there additional reasons I'm missing?\\n\\n### Reasons to continue expanding the length of a match\\n\\n- Changing it now would be a breaking change.\\n- It follows Unicode recommendations and the Unicode org's ICU regex engine.\\n- It might be a big or complex change in the code (a lot of work).\\n- It sometimes solves a real issue with complex case differences.\\n\\nOpinion: Even though it solves a real casing problem, the problem usually isn't relevant in the context of regular expressions. And when it is, there's usually an easy workaround, or the problem didn't need solving in the first place (for example, because the user wrote `\\\\w+` and so it would already match both `√ü` and `ss`).\\n\\n### Reasons to stop expanding the length\\n\\n- It is currently applied inconsistently anyway, based on complicated and nonintuitive conditions that few users will understand (I will show examples below).\\n- The fact that e.g. `(?i)\\\\w` and `(?i)[\\\\w]` are not equivalent makes it hard to reason about or refactor regexes (similar to #349).\\n- It hurts performance (sometimes catastrophically), as discussed in #350.\\n- It cannot be fully \\\"fixed\\\" (applied consistently) without hurting performance even more, for things like the dot `.`.\\n- It is not portable with other regex flavors that don't do this, including Perl, PCRE2, JavaScript, Java, .NET, and Rust.\\n- Most of the time, the behavior is surprising (this would change if users had to opt in).\\n- Most of the time, the behavior is undesired, since it is simply wrong in terms of following user intent. For example, if someone uses `\\\\S` in a character class, in essentially 100% of cases they do not mean to match `'ss'`, `'ff'`, `'fl'`, etc. They mean \\\"any *single* character that is not whitespace\\\". And despite \\\"ss\\\" being the case conversion of a single character, it is not itself a single character in any context/language.\\n\\nIf you accept my statements above, unfortunately it means that, in exchange for ‚ë† the added complexity in the engine, ‚ë° the inconsistency/unpredictability for users, and ‚ë¢ the resulting performance problems, users get behavior that in almost all cases they didn't expect or want.\\n\\n### Recent precedent from JavaScript\\n\\nJavaScript is an interesting regex flavor to compare to, because in version ES2024 it added flag `v` (`unicodeSets`), which allows character classes and Unicode properties to match more than one character at a time using a few specific \\\"properties of strings\\\" like `\\\\p{RGI_Emoji}` (which can also be used in character classes) or the new syntax `[‚Ä¶\\\\q{‚Ä¶|‚Ä¶}]`. However, even though JavaScript character classes and Unicode properties can now match more than one character, and even though JavaScript flags `u`/`v` change flag `i` to use Unicode case folding, nevertheless JavaScript did not chose to apply Unicode's special casing rules that change match length (like `√ü` ‚Üî `ss`).\\n\\n### Current Oniguruma behavior\\n\\nFollowing are the tests I ran to help me understand the current behavior. It shows the regex and target string for each test. `r` is for raw strings (without backslash escaping).\\n\\n‚úÖ = match\\n‚ùå = no match\\nü§î = inconsistent or questionable behavior\\nü§Ø = very surprising\\n\\n```js\\n[\\n  // Single `s` doesn't map to small sharp s (German eszett, √ü) or its case equivalents\\n  [r`(?i)^s$`, '√ü'], // ‚ùå\\n  [r`(?i)^s$`, 'ss'], // ‚ùå\\n  [r`(?i)^[s]$`, '√ü'], // ‚ùå\\n  [r`(?i)^[s]$`, 'ss'], // ‚ùå\\n  [r`(?i)^√ü$`, 's'], // ‚ùå\\n  [r`(?i)^[√ü]$`, 's'], // ‚ùå\\n\\n  // Single `s` does map to its case equivalent small long s\\n  [r`(?i)^s$`, '≈ø'], // ‚úÖ\\n\\n  // Single `√ü` maps to `ss` and its case equivalents\\n  [r`(?i)^√ü$`, '√ü'], // ‚úÖ\\n  [r`(?i)^√ü$`, 'ss'], // ‚úÖ\\n  [r`(?i)^√ü$`, 'SS'], // ‚úÖ\\n  [r`(?i)^√ü$`, '≈ø≈ø'], // ‚úÖ\\n  [r`(?i)^√ü$`, 'sS'], // ‚úÖ\\n  [r`(?i)^√ü$`, 's≈ø'], // ‚úÖ\\n  [r`(?i)^√ü$`, 'Ss'], // ‚úÖ\\n  [r`(?i)^√ü$`, 'S≈ø'], // ‚úÖ\\n  [r`(?i)^√ü$`, '≈øs'], // ‚úÖ\\n  [r`(?i)^√ü$`, '≈øS'], // ‚úÖ\\n  [r`(?i)^√ü$`, '·∫û'], // ‚úÖ Uppercase `·∫û` in target\\n  [r`(?i)^·∫û$`, '√ü'], // ‚úÖ Uppercase `·∫û` in pattern\\n\\n  // The same, within a positive class\\n  [r`(?i)^[√ü]$`, '√ü'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 'SS'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, '≈ø≈ø'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 'sS'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 's≈ø'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 'Ss'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, 'S≈ø'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, '≈øs'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, '≈øS'], // ‚úÖ\\n  [r`(?i)^[√ü]$`, '·∫û'], // ‚úÖ Uppercase `·∫û` in target\\n  [r`(?i)^[·∫û]$`, '√ü'], // ‚úÖ Uppercase `·∫û` in pattern\\n\\n  // Negated class basics; nothing surprising here\\n  [r`(?i)^[^√ü]$`, '√ü'], // ‚ùå\\n  [r`(?i)^[^√ü]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^s]$`, '√ü'], // ‚úÖ\\n  [r`(?i)^[^s]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^≈ø]$`, '√ü'], // ‚úÖ\\n  [r`(?i)^[^≈ø]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^·∫û]$`, '√ü'], // ‚ùå Uppercase `·∫û` in pattern\\n  [r`(?i)^[^·∫û]$`, 'ss'], // ‚ùå Uppercase `·∫û` in pattern\\n\\n  // Other representations of exactly `√ü` are OK\\n  [r`(?i)^\\\\x{DF}$`, 'ss'], // ‚úÖ\\n\\n  // But not sets that include `√ü` ü§î\\n  [r`(?i)^\\\\w$`, 'ss'], // ‚ùå\\n  [r`(?i)^\\\\p{Word}$`, 'ss'], // ‚ùå\\n  [r`(?i)^\\\\D$`, 'ss'], // ‚ùå\\n  [r`(?i)^.$`, 'ss'], // ‚ùå\\n  [r`(?i)^\\\\O$`, 'ss'], // ‚ùå\\n  [r`(?i)^\\\\p{Any}$`, 'ss'], // ‚ùå\\n\\n  // Within positive classes, other representations of `√ü`, and sets/ranges that include `√ü`, are OK\\n  [r`(?i)^[\\\\x{DF}]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\x{DE}-\\\\x{E0}]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\w]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\p{Word}]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[[:word:]]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\D]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\P{M}]$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\p{Any}]$`, 'ss'], // ‚úÖ\\n\\n  // But not within negated classes ü§î\\n  [r`(?i)^[^[^\\\\x{DF}]]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^\\\\0]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^\\\\W]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^\\\\d]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[^\\\\p{M}]$`, 'ss'], // ‚ùå\\n\\n  // The negation rule is about negation of the outermost class, only ü§î\\n  [r`(?i)^[^[\\\\W]]$`, 'ss'], // ‚ùå\\n  [r`(?i)^[[^\\\\W]]$`, 'ss'], // ‚úÖ ü§Ø\\n  [r`(?i)^[\\\\w&&[^\\\\W]]$`, 'ss'], // ‚úÖ ü§Ø\\n\\n  // Flags `W` and `P` exclude `√ü` from `\\\\w`\\n  [r`(?iP)^[\\\\w]$`, 'ss'], // ‚ùå\\n  [r`(?iW)^[\\\\w]$`, 'ss'], // ‚ùå\\n  [r`(?iW)^\\\\w$`, 'ss'], // ‚ùå\\n  [r`(?iW)^[√ü]$`, 'ss'], // ‚úÖ\\n  [r`(?iW)^√ü$`, 'ss'], // ‚úÖ\\n  [r`(?iW)^\\\\x{DF}$`, 'ss'], // ‚úÖ\\n\\n  // Quantifier basics; nothing surprising here\\n  [r`(?i)^√ü{2}$`, '√ü√ü'], // ‚úÖ\\n  [r`(?i)^√ü{2}$`, 'ss'], // ‚ùå\\n  [r`(?i)^√ü{2}$`, 'ssss'], // ‚úÖ\\n  [r`(?i)^[√ü]{2}$`, 'ss'], // ‚ùå\\n  [r`(?i)^[√ü]{2}$`, 'ssss'], // ‚úÖ\\n  [r`(?i)^[^√ü]{2}$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[^√ü]{2}$`, 'ssss'], // ‚ùå\\n\\n  // Character classes are affected by backtracking (bad news for performance!) ü§î\\n  [r`(?i)^[\\\\w]{2}$`, 'ss'], // ‚úÖ\\n  [r`(?i)^[\\\\w]{2}$`, 'sss'], // ‚úÖ\\n  [r`(?i)^[\\\\w]{2}$`, 'ssss'], // ‚úÖ\\n\\n  // In the reverse direction\\n  [r`(?i)^ss$`, 'ss'], // ‚úÖ\\n  [r`(?i)^ss$`, '√ü'], // ‚úÖ\\n  [r`(?i)^≈ø≈ø$`, '√ü'], // ‚úÖ\\n  [r`(?i)^ss$`, '·∫û'], // ‚úÖ Uppercase `·∫û`\\n\\n  // In the reverse direction with quantifiers; nothing surprising here\\n  [r`(?i)^s{2}$`, '√ü'], // ‚ùå\\n  [r`(?i)^ss{2}$`, '√ü√ü'], // ‚ùå\\n  [r`(?i)^(?:ss){2}$`, '√ü√ü'], // ‚úÖ\\n]\\n```\", \"comments\": [{\"author\": \"slevithan\", \"body\": \"If you are open to the breaking change proposed above, I see at least three paths:\\n\\n1. Simply no longer provide this functionality. Although this feels like a loss, it would match the majority of other modern regex flavors (though there are exceptions like ICU and Swift).\\n2. Preserve the functionality behind a new flag, whole-pattern modifier, or compile-time option.\\n3. Provide the functionality via a new metacharacter. This could be similar to but different than `\\\\O` and `\\\\X`. For the sake of example, I'll call it `\\\\U`. To narrow what it matches, you could do things like `(?=\\\\w)\\\\U`. And if you also adopted set subtraction like `[‚Ä¶--‚Ä¶]` (from several regex flavors include JavaScript), you could do `[\\\\U--\\\\W]` (which would be equivalent to Oniguruma's current `(?i)[\\\\w]`).\"}, {\"author\": \"kkos\", \"body\": \"I would consider changing the spec to not match different number of characters with flag i.\"}, {\"author\": \"slevithan\", \"body\": \"I'm guessing you already understand Unicode much better than me, but in case it's helpful, what JavaScript seems to do when both the `i` and `u` (or `v`) flag are set is that all symbols are implicitly [case-folded using the simple mapping provided by the Unicode standard](http://unicode.org/Public/UCD/latest/ucd/CaseFolding.txt) immediately before they are compared.\\n\\nJS also ensures that `/\\\\w/iu` is the inverse of `/\\\\W/iu`. This is relevant since JS's `\\\\w` is ASCII-only `[0-9A-Z_a-z]`, which means that `\\\\W` matches U+017F and U+212A. But `/\\\\w/iu` is equivalent to `[0-9A-Z_a-z\\\\u017F\\\\u212A]`, so `/\\\\W/iu` is the inverse of `/\\\\w/iu`. That means `/\\\\W/iu` is equivalent to `/[^0-9A-Z_a-z\\\\u017F\\\\u212A]/u`.\"}, {\"author\": \"kkos\", \"body\": \"Fixed #351 in branch fix_351_349.\"}]}"}]}}
